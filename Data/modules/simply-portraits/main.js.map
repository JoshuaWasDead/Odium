{
  "version": 3,
  "sources": ["../src/settings.ts", "../src/main.ts"],
  "sourcesContent": ["export function registerSettings() {\n  game.settings.register('simply-portraits', 'size', {\n    name: 'Portrait Size (px)',\n    hint: 'The width and height of chat portraits in the chat log, given in pixels',\n    scope: 'client',\n    type: Number,\n    default: 36,\n    config: true,\n    requiresReload: true\n  });\n}\n", "import { registerSettings } from \"./settings.js\"\n\nfunction createImgElement(imgSrc: string): HTMLImageElement {\n  const img: HTMLImageElement = document.createElement(\"img\");\n  const size = game.settings.get('simply-portraits', 'size');\n  img.src = imgSrc;\n  img.width = size;\n  img.height = size;\n  img.classList.add('simply-portraits');\n  return img;\n}\n\nfunction createVideoElement(videoSrc: string): HTMLVideoElement {\n  const video = document.createElement('video');\n  const size = game.settings.get('simply-portraits', 'size');\n  video.src = videoSrc;\n  video.width = size;\n  video.height = size;\n  video.autoplay = false;\n  video.controls = false;\n  video.muted = true;\n  video.classList.add('simply-portraits');\n  return video;\n}\n\nfunction isVideo(imgSrc: string): boolean {\n  const re = /(?:\\.([^.]+))?$/;\n  const ext = re.exec(imgSrc)?.[1];\n  return ext === \"webm\";\n}\n\nfunction getTokenSrc(speaker: any): string | null {\n  const scene = game.scenes.get(speaker.scene);\n  const token = scene?.tokens.get(speaker.token);\n  return token?.texture?.src;\n}\n\nfunction getPrototypeSrc(speaker: any): string | null {\n  const actor = game.actors.get(speaker.actor);\n  const token = actor?.prototypeToken;\n  if (token?.randomImg)\n    return null;\n  return token?.texture?.src;\n}\n\nfunction getSrc(message: ChatMessage): string | null {\n  const speaker = message.speaker;\n  if (speaker.token)\n    return getTokenSrc(speaker);\n  return getPrototypeSrc(speaker);\n}\n\nHooks.on(\"init\", registerSettings);\n\nHooks.on(\n  \"preCreateChatMessage\",\n  (message: ChatMessage, options: any, render: any, userId: string) => {\n    const src = getSrc(message);\n    if (src)\n      message.updateSource({\n        flags: {\n          'simply-portraits': {\n            src: src\n          }\n        }\n      });\n  }\n);\n\nHooks.on(\n  \"renderChatMessage\", (message, html, data) => {\n    const header = html.find('.message-header')?.[0];\n    const src = message.flags?.['simply-portraits']?.src;\n\n    if (!header || !src)\n      return;\n\n    const portrait = isVideo(src) ? createVideoElement(src) : createImgElement(src);\n    header.prepend(portrait);\n    header.style.paddingBottom = '3px';\n\n    const sender = html.find('.message-sender')?.[0];\n    if (!sender)\n      return;\n    sender.style.alignSelf = 'center';\n  }\n);\n"],
  "mappings": "mBAAO,SAASA,GAAmB,CACjC,KAAK,SAAS,SAAS,mBAAoB,OAAQ,CACjD,KAAM,qBACN,KAAM,0EACN,MAAO,SACP,KAAM,OACN,QAAS,GACT,OAAQ,GACR,eAAgB,EAClB,CAAC,CACH,CCRA,SAASC,EAAiBC,EAAkC,CAC1D,IAAMC,EAAwB,SAAS,cAAc,KAAK,EACpDC,EAAO,KAAK,SAAS,IAAI,mBAAoB,MAAM,EACzD,OAAAD,EAAI,IAAMD,EACVC,EAAI,MAAQC,EACZD,EAAI,OAASC,EACbD,EAAI,UAAU,IAAI,kBAAkB,EAC7BA,CACT,CAEA,SAASE,EAAmBC,EAAoC,CAC9D,IAAMC,EAAQ,SAAS,cAAc,OAAO,EACtCH,EAAO,KAAK,SAAS,IAAI,mBAAoB,MAAM,EACzD,OAAAG,EAAM,IAAMD,EACZC,EAAM,MAAQH,EACdG,EAAM,OAASH,EACfG,EAAM,SAAW,GACjBA,EAAM,SAAW,GACjBA,EAAM,MAAQ,GACdA,EAAM,UAAU,IAAI,kBAAkB,EAC/BA,CACT,CAEA,SAASC,EAAQN,EAAyB,CAGxC,MAFW,kBACI,KAAKA,CAAM,IAAI,KACf,MACjB,CAEA,SAASO,EAAYC,EAA6B,CAGhD,OAFc,KAAK,OAAO,IAAIA,EAAQ,KAAK,GACtB,OAAO,IAAIA,EAAQ,KAAK,GAC/B,SAAS,GACzB,CAEA,SAASC,EAAgBD,EAA6B,CAEpD,IAAME,EADQ,KAAK,OAAO,IAAIF,EAAQ,KAAK,GACtB,eACrB,OAAIE,GAAO,UACF,KACFA,GAAO,SAAS,GACzB,CAEA,SAASC,EAAOC,EAAqC,CACnD,IAAMJ,EAAUI,EAAQ,QACxB,OAAIJ,EAAQ,MACHD,EAAYC,CAAO,EACrBC,EAAgBD,CAAO,CAChC,CAEA,MAAM,GAAG,OAAQK,CAAgB,EAEjC,MAAM,GACJ,uBACA,CAACD,EAAsBE,EAAcC,EAAaC,IAAmB,CACnE,IAAMC,EAAMN,EAAOC,CAAO,EACtBK,GACFL,EAAQ,aAAa,CACnB,MAAO,CACL,mBAAoB,CAClB,IAAKK,CACP,CACF,CACF,CAAC,CACL,CACF,EAEA,MAAM,GACJ,oBAAqB,CAACL,EAASM,EAAMC,IAAS,CAC5C,IAAMC,EAASF,EAAK,KAAK,iBAAiB,IAAI,GACxCD,EAAML,EAAQ,QAAQ,qBAAqB,IAEjD,GAAI,CAACQ,GAAU,CAACH,EACd,OAEF,IAAMI,EAAWf,EAAQW,CAAG,EAAId,EAAmBc,CAAG,EAAIlB,EAAiBkB,CAAG,EAC9EG,EAAO,QAAQC,CAAQ,EACvBD,EAAO,MAAM,cAAgB,MAE7B,IAAME,EAASJ,EAAK,KAAK,iBAAiB,IAAI,GAC1C,CAACI,IAELA,EAAO,MAAM,UAAY,SAC3B,CACF",
  "names": ["registerSettings", "createImgElement", "imgSrc", "img", "size", "createVideoElement", "videoSrc", "video", "isVideo", "getTokenSrc", "speaker", "getPrototypeSrc", "token", "getSrc", "message", "registerSettings", "options", "render", "userId", "src", "html", "data", "header", "portrait", "sender"]
}
