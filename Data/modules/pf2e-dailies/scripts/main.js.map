{
  "version": 3,
  "sources": ["../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/purry.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/add.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/addProp.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/allPass.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/anyPass.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/_withPrecision.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/ceil.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/chunk.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/clamp.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/type.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/clone.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/isTruthy.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/compact.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/concat.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/_purryOn.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/conditional.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/countBy.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/pipe.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/createPipe.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/debounce.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/_reduceLazy.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/difference.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/differenceWith.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/divide.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/drop.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/_swapInPlace.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/_heap.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/_purryOrderRules.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/dropFirstBy.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/dropLast.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/dropLastWhile.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/dropWhile.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/equals.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/toPairs.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/evolve.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/_toLazyIndexed.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/filter.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/_toSingle.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/find.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/findIndex.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/findLast.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/findLastIndex.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/first.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/hasAtLeast.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/firstBy.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/flatten.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/flatMap.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/flatMapToObj.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/flattenDeep.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/floor.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/forEach.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/forEachObj.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/fromPairs.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/groupBy.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/identity.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/indexBy.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/intersection.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/intersectionWith.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/invert.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/isArray.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/isBoolean.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/isDate.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/isDefined.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/isObject.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/isString.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/isEmpty.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/isError.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/isFunction.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/isNil.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/isNonNull.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/isNot.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/isNumber.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/isObjectType.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/isPlainObject.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/isPromise.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/isSymbol.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/join.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/keys.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/last.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/length.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/map.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/mapKeys.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/mapToObj.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/mapValues.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/maxBy.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/meanBy.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/merge.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/mergeAll.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/mergeDeep.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/minBy.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/multiply.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/noop.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/_quickSelect.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/nthBy.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/objOf.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/omit.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/omitBy.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/once.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/only.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/partition.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/pathOr.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/pick.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/pickBy.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/prop.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/range.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/randomString.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/rankBy.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/reduce.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/reject.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/reverse.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/round.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/sample.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/set.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/setPath.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/shuffle.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/sliceString.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/sort.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/sortBy.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/_binarySearchCutoffIndex.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/sortedIndex.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/sortedIndexBy.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/sortedIndexWith.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/sortedLastIndex.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/sortedLastIndexBy.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/splice.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/splitAt.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/splitWhen.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/stringToPath.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/subtract.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/sumBy.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/swapIndices.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/swapProps.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/take.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/takeFirstBy.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/takeLastWhile.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/takeWhile.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/tap.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/times.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/uniq.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/uniqBy.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/uniqWith.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/values.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/zip.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/zipObj.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/zipWith.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/index.js", "../../../../../dev/foundry-api/dist/actor.js", "../../../../../dev/foundry-api/dist/application.js", "../../../../../dev/foundry-api/dist/array.js", "../../../../../dev/foundry-api/dist/canvas.js", "../../../../../dev/foundry-api/dist/chat.js", "../../../../../dev/foundry-api/dist/delay.js", "../../../../../dev/foundry-api/dist/dialog.js", "../../../../../dev/foundry-api/dist/document.js", "../../../../../dev/foundry-api/dist/event-manager.js", "../../../../../dev/foundry-api/dist/flags.js", "../../../../../dev/foundry-api/dist/handlebars.js", "../../../../../dev/foundry-api/dist/hooks.js", "../../../../../dev/foundry-api/dist/html.js", "../../../../../dev/foundry-api/dist/item.js", "../../../../../dev/foundry-api/dist/localize.js", "../../../../../dev/foundry-api/dist/module.js", "../../../../../dev/foundry-api/dist/keybindings.js", "../../../../../dev/foundry-api/dist/libwrapper.js", "../../../../../dev/foundry-api/dist/notifications.js", "../../../../../dev/foundry-api/dist/object.js", "../../../../../dev/foundry-api/dist/settings.js", "../../../../../dev/foundry-api/dist/socket.js", "../../../../../dev/foundry-api/dist/string.js", "../../../../../dev/foundry-api/dist/user.js", "../../../../../dev/foundry-api/dist/index.js", "../../../../../dev/foundry-api/index.js", "../../../../../dev/pf2e-api/dist/utils.js", "../../../../../dev/pf2e-api/dist/actor.js", "../../../../../dev/pf2e-api/dist/application.js", "../../../../../dev/pf2e-api/dist/browser.js", "../../../../../dev/pf2e-api/dist/rules.js", "../../../../../dev/pf2e-api/dist/chat.js", "../../../../../dev/pf2e-api/dist/classes.js", "../../../../../dev/pf2e-api/dist/data.js", "../../../../../dev/pf2e-api/dist/effect.js", "../../../../../dev/pf2e-api/dist/item.js", "../../../../../dev/pf2e-api/dist/notes.js", "../../../../../dev/pf2e-api/dist/spell.js", "../../../../../dev/pf2e-api/dist/spell-consumables.js", "../../../../../dev/pf2e-api/dist/skills.js", "../../../../../dev/pf2e-api/dist/template.js", "../../../../../dev/pf2e-api/dist/index.js", "../../../../../dev/pf2e-api/index.js", "../src/daily.ts", "../src/utils.ts", "../src/data/ancestral-longevity.ts", "../src/data/blade-ally.ts", "../src/data/ceremonial-knife.ts", "../src/data/combat-flexibility.ts", "../src/data/experimental-spellshaping.ts", "../src/data/familiar.ts", "../src/data/languages.ts", "../src/data/mind-smith.ts", "../src/data/rations.ts", "../src/data/resistances.ts", "../src/data/root-magic.ts", "../src/data/scroll-adept.ts", "../src/data/scrolls.ts", "../src/data/skills.ts", "../src/data/staves.ts", "../src/data/thaumaturge-tome.ts", "../src/data/trickster-ace.ts", "../src/dailies.ts", "../src/apps/config.ts", "../src/apps/interface.ts", "../src/api.ts", "../src/actor.ts", "../src/apps/customs.ts", "../src/rest.ts", "../src/spellcasting.ts", "../src/main.ts"],
  "sourcesContent": ["\"use strict\";\nvar __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n        if (ar || !(i in from)) {\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n            ar[i] = from[i];\n        }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.purry = void 0;\nfunction purry(fn, args, lazy) {\n    var diff = fn.length - args.length;\n    var arrayArgs = Array.from(args);\n    if (diff === 0) {\n        return fn.apply(void 0, arrayArgs);\n    }\n    if (diff === 1) {\n        var ret = function (data) { return fn.apply(void 0, __spreadArray([data], arrayArgs, false)); };\n        if (lazy || fn.lazy) {\n            ret.lazy = lazy || fn.lazy;\n            ret.lazyArgs = args;\n        }\n        return ret;\n    }\n    throw new Error('Wrong number of arguments');\n}\nexports.purry = purry;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.add = void 0;\nvar purry_1 = require(\"./purry\");\nfunction add() {\n    return (0, purry_1.purry)(_add, arguments);\n}\nexports.add = add;\nfunction _add(value, addend) {\n    return value + addend;\n}\n", "\"use strict\";\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.addProp = void 0;\nvar purry_1 = require(\"./purry\");\nfunction addProp() {\n    return (0, purry_1.purry)(_addProp, arguments);\n}\nexports.addProp = addProp;\nfunction _addProp(obj, prop, value) {\n    var _a;\n    return __assign(__assign({}, obj), (_a = {}, _a[prop] = value, _a));\n}\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.allPass = void 0;\nvar purry_1 = require(\"./purry\");\nfunction allPass() {\n    return (0, purry_1.purry)(_allPass, arguments);\n}\nexports.allPass = allPass;\nfunction _allPass(data, fns) {\n    return fns.every(function (fn) { return fn(data); });\n}\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.anyPass = void 0;\nvar purry_1 = require(\"./purry\");\nfunction anyPass() {\n    return (0, purry_1.purry)(_anyPass, arguments);\n}\nexports.anyPass = anyPass;\nfunction _anyPass(data, fns) {\n    return fns.some(function (fn) { return fn(data); });\n}\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports._withPrecision = void 0;\nvar MAX_PRECISION = 15;\nfunction _withPrecision(roundingFn) {\n    return function (value, precision) {\n        if (precision === 0) {\n            return roundingFn(value);\n        }\n        if (!Number.isInteger(precision)) {\n            throw new TypeError(\"precision must be an integer: \".concat(precision));\n        }\n        if (precision > MAX_PRECISION || precision < -MAX_PRECISION) {\n            throw new RangeError(\"precision must be between -15 and 15\");\n        }\n        if (Number.isNaN(value) || !Number.isFinite(value)) {\n            return roundingFn(value);\n        }\n        var multiplier = Math.pow(10, precision);\n        return roundingFn(value * multiplier) / multiplier;\n    };\n}\nexports._withPrecision = _withPrecision;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.ceil = void 0;\nvar _withPrecision_1 = require(\"./_withPrecision\");\nvar purry_1 = require(\"./purry\");\nfunction ceil() {\n    return (0, purry_1.purry)((0, _withPrecision_1._withPrecision)(Math.ceil), arguments);\n}\nexports.ceil = ceil;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.chunk = void 0;\nvar purry_1 = require(\"./purry\");\nfunction chunk() {\n    return (0, purry_1.purry)(_chunk, arguments);\n}\nexports.chunk = chunk;\nfunction _chunk(array, size) {\n    var ret = Array.from({\n        length: Math.ceil(array.length / size),\n    });\n    for (var index = 0; index < ret.length; index += 1) {\n        ret[index] = array.slice(index * size, (index + 1) * size);\n    }\n    return ret;\n}\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.clamp = void 0;\nvar purry_1 = require(\"./purry\");\nfunction clamp() {\n    return (0, purry_1.purry)(_clamp, arguments);\n}\nexports.clamp = clamp;\nfunction _clamp(value, limits) {\n    if (limits.min != null) {\n        if (limits.min > value) {\n            return limits.min;\n        }\n    }\n    if (limits.max != null) {\n        if (limits.max < value) {\n            return limits.max;\n        }\n    }\n    return value;\n}\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.type = void 0;\nfunction type(val) {\n    return val === null\n        ? 'Null'\n        : val === undefined\n            ? 'Undefined'\n            : Object.prototype.toString.call(val).slice(8, -1);\n}\nexports.type = type;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.clone = void 0;\nvar type_1 = require(\"./type\");\nfunction _cloneRegExp(pattern) {\n    return new RegExp(pattern.source, (pattern.global ? 'g' : '') +\n        (pattern.ignoreCase ? 'i' : '') +\n        (pattern.multiline ? 'm' : '') +\n        (pattern.sticky ? 'y' : '') +\n        (pattern.unicode ? 'u' : ''));\n}\nfunction _clone(value, refFrom, refTo, deep) {\n    function copy(copiedValue) {\n        var len = refFrom.length;\n        var idx = 0;\n        while (idx < len) {\n            if (value === refFrom[idx]) {\n                return refTo[idx];\n            }\n            idx += 1;\n        }\n        refFrom[idx + 1] = value;\n        refTo[idx + 1] = copiedValue;\n        for (var key in value) {\n            copiedValue[key] = deep\n                ? _clone(value[key], refFrom, refTo, true)\n                : value[key];\n        }\n        return copiedValue;\n    }\n    switch ((0, type_1.type)(value)) {\n        case 'Object':\n            return copy({});\n        case 'Array':\n            return copy([]);\n        case 'Date':\n            return new Date(value.valueOf());\n        case 'RegExp':\n            return _cloneRegExp(value);\n        default:\n            return value;\n    }\n}\nfunction clone(value) {\n    return value != null && typeof value.clone === 'function'\n        ? value.clone()\n        : _clone(value, [], [], true);\n}\nexports.clone = clone;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.isTruthy = void 0;\nfunction isTruthy(data) {\n    return !!data;\n}\nexports.isTruthy = isTruthy;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.compact = void 0;\nvar isTruthy_1 = require(\"./isTruthy\");\nfunction compact(items) {\n    return items.filter(isTruthy_1.isTruthy);\n}\nexports.compact = compact;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.concat = void 0;\nvar purry_1 = require(\"./purry\");\nfunction concat() {\n    return (0, purry_1.purry)(_concat, arguments);\n}\nexports.concat = concat;\nfunction _concat(arr1, arr2) {\n    return arr1.concat(arr2);\n}\n", "\"use strict\";\nvar __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n        if (ar || !(i in from)) {\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n            ar[i] = from[i];\n        }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.purryOn = void 0;\nfunction purryOn(isArg, implementation, args) {\n    var callArgs = Array.from(args);\n    var dataOrArg = callArgs[0], rest = callArgs.slice(1);\n    return isArg(dataOrArg)\n        ? function (data) { return implementation.apply(void 0, __spreadArray([data], callArgs, false)); }\n        : implementation.apply(void 0, __spreadArray([dataOrArg], rest, false));\n}\nexports.purryOn = purryOn;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.conditional = void 0;\nvar _purryOn_1 = require(\"./_purryOn\");\nfunction conditional() {\n    return (0, _purryOn_1.purryOn)(isCase, conditionalImplementation, arguments);\n}\nexports.conditional = conditional;\nfunction conditionalImplementation(data) {\n    var cases = [];\n    for (var _i = 1; _i < arguments.length; _i++) {\n        cases[_i - 1] = arguments[_i];\n    }\n    for (var _a = 0, cases_1 = cases; _a < cases_1.length; _a++) {\n        var _b = cases_1[_a], when = _b[0], then = _b[1];\n        if (when(data)) {\n            return then(data);\n        }\n    }\n    throw new Error('conditional: data failed for all cases');\n}\nfunction isCase(maybeCase) {\n    if (!Array.isArray(maybeCase)) {\n        return false;\n    }\n    var when = maybeCase[0], then = maybeCase[1], rest = maybeCase.slice(2);\n    return (typeof when === 'function' &&\n        when.length <= 1 &&\n        typeof then === 'function' &&\n        then.length <= 1 &&\n        rest.length === 0);\n}\n(function (conditional) {\n    conditional.defaultCase = function (then) {\n        if (then === void 0) { then = trivialDefaultCase; }\n        return [function () { return true; }, then];\n    };\n})(conditional || (exports.conditional = conditional = {}));\nvar trivialDefaultCase = function () { return undefined; };\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.countBy = void 0;\nvar purry_1 = require(\"./purry\");\nvar _countBy = function (indexed) {\n    return function (array, fn) {\n        return array.reduce(function (ret, item, index) {\n            var value = indexed ? fn(item, index, array) : fn(item);\n            return ret + (value ? 1 : 0);\n        }, 0);\n    };\n};\nfunction countBy() {\n    return (0, purry_1.purry)(_countBy(false), arguments);\n}\nexports.countBy = countBy;\n(function (countBy) {\n    function indexed() {\n        return (0, purry_1.purry)(_countBy(true), arguments);\n    }\n    countBy.indexed = indexed;\n})(countBy || (exports.countBy = countBy = {}));\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.pipe = void 0;\nfunction pipe(value) {\n    var operations = [];\n    for (var _i = 1; _i < arguments.length; _i++) {\n        operations[_i - 1] = arguments[_i];\n    }\n    var ret = value;\n    var lazyOps = operations.map(function (op) {\n        var _a = op, lazy = _a.lazy, lazyArgs = _a.lazyArgs;\n        if (lazy) {\n            var fn = lazy.apply(void 0, (lazyArgs || []));\n            fn.indexed = lazy.indexed;\n            fn.single = lazy.single;\n            fn.index = 0;\n            fn.items = [];\n            return fn;\n        }\n        return null;\n    });\n    var opIdx = 0;\n    while (opIdx < operations.length) {\n        var op = operations[opIdx];\n        var lazyOp = lazyOps[opIdx];\n        if (!lazyOp) {\n            ret = op(ret);\n            opIdx++;\n            continue;\n        }\n        var lazySeq = [];\n        for (var j = opIdx; j < operations.length; j++) {\n            if (lazyOps[j]) {\n                lazySeq.push(lazyOps[j]);\n                if (lazyOps[j].single) {\n                    break;\n                }\n            }\n            else {\n                break;\n            }\n        }\n        var acc = [];\n        for (var _a = 0, ret_1 = ret; _a < ret_1.length; _a++) {\n            var item = ret_1[_a];\n            if (_processItem({ item: item, acc: acc, lazySeq: lazySeq })) {\n                break;\n            }\n        }\n        var lastLazySeq = lazySeq[lazySeq.length - 1];\n        if (lastLazySeq.single) {\n            ret = acc[0];\n        }\n        else {\n            ret = acc;\n        }\n        opIdx += lazySeq.length;\n    }\n    return ret;\n}\nexports.pipe = pipe;\nfunction _processItem(_a) {\n    var item = _a.item, lazySeq = _a.lazySeq, acc = _a.acc;\n    if (lazySeq.length === 0) {\n        acc.push(item);\n        return false;\n    }\n    var lazyResult = { done: false, hasNext: false };\n    var isDone = false;\n    for (var i = 0; i < lazySeq.length; i++) {\n        var lazyFn = lazySeq[i];\n        var indexed = lazyFn.indexed;\n        var index = lazyFn.index;\n        var items = lazyFn.items;\n        items.push(item);\n        lazyResult = indexed ? lazyFn(item, index, items) : lazyFn(item);\n        lazyFn.index++;\n        if (lazyResult.hasNext) {\n            if (lazyResult.hasMany) {\n                var nextValues = lazyResult.next;\n                for (var _i = 0, nextValues_1 = nextValues; _i < nextValues_1.length; _i++) {\n                    var subItem = nextValues_1[_i];\n                    var subResult = _processItem({\n                        item: subItem,\n                        acc: acc,\n                        lazySeq: lazySeq.slice(i + 1),\n                    });\n                    if (subResult) {\n                        return true;\n                    }\n                }\n                return false;\n            }\n            else {\n                item = lazyResult.next;\n            }\n        }\n        if (!lazyResult.hasNext) {\n            break;\n        }\n        if (lazyResult.done) {\n            isDone = true;\n        }\n    }\n    if (lazyResult.hasNext) {\n        acc.push(item);\n    }\n    if (isDone) {\n        return true;\n    }\n    return false;\n}\n", "\"use strict\";\nvar __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n        if (ar || !(i in from)) {\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n            ar[i] = from[i];\n        }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.createPipe = void 0;\nvar pipe_1 = require(\"./pipe\");\nfunction createPipe() {\n    var operations = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        operations[_i] = arguments[_i];\n    }\n    return function (value) { return pipe_1.pipe.apply(void 0, __spreadArray([value], operations, false)); };\n}\nexports.createPipe = createPipe;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.debounce = void 0;\nfunction debounce(func, _a) {\n    var waitMs = _a.waitMs, _b = _a.timing, timing = _b === void 0 ? 'trailing' : _b, maxWaitMs = _a.maxWaitMs;\n    if (maxWaitMs !== undefined && waitMs !== undefined && maxWaitMs < waitMs) {\n        throw new Error(\"debounce: maxWaitMs (\".concat(maxWaitMs, \") cannot be less than waitMs (\").concat(waitMs, \")\"));\n    }\n    var coolDownTimeoutId;\n    var maxWaitTimeoutId;\n    var latestCallArgs;\n    var result;\n    var handleInvoke = function () {\n        if (latestCallArgs === undefined) {\n            return;\n        }\n        if (maxWaitTimeoutId !== undefined) {\n            var timeoutId = maxWaitTimeoutId;\n            maxWaitTimeoutId = undefined;\n            clearTimeout(timeoutId);\n        }\n        var args = latestCallArgs;\n        latestCallArgs = undefined;\n        result = func.apply(void 0, args);\n    };\n    var handleCoolDownEnd = function () {\n        if (coolDownTimeoutId === undefined) {\n            return;\n        }\n        var timeoutId = coolDownTimeoutId;\n        coolDownTimeoutId = undefined;\n        clearTimeout(timeoutId);\n        if (latestCallArgs !== undefined) {\n            handleInvoke();\n        }\n    };\n    var handleDebouncedCall = function (args) {\n        latestCallArgs = args;\n        if (maxWaitMs !== undefined && maxWaitTimeoutId === undefined) {\n            maxWaitTimeoutId = setTimeout(handleInvoke, maxWaitMs);\n        }\n    };\n    return {\n        call: function () {\n            var _a;\n            var args = [];\n            for (var _i = 0; _i < arguments.length; _i++) {\n                args[_i] = arguments[_i];\n            }\n            if (coolDownTimeoutId === undefined) {\n                if (timing === 'trailing') {\n                    handleDebouncedCall(args);\n                }\n                else {\n                    result = func.apply(void 0, args);\n                }\n            }\n            else {\n                if (timing !== 'leading') {\n                    handleDebouncedCall(args);\n                }\n                var timeoutId = coolDownTimeoutId;\n                coolDownTimeoutId = undefined;\n                clearTimeout(timeoutId);\n            }\n            coolDownTimeoutId = setTimeout(handleCoolDownEnd, (_a = waitMs !== null && waitMs !== void 0 ? waitMs : maxWaitMs) !== null && _a !== void 0 ? _a : 0);\n            return result;\n        },\n        cancel: function () {\n            if (coolDownTimeoutId !== undefined) {\n                var timeoutId = coolDownTimeoutId;\n                coolDownTimeoutId = undefined;\n                clearTimeout(timeoutId);\n            }\n            if (maxWaitTimeoutId !== undefined) {\n                var timeoutId = maxWaitTimeoutId;\n                maxWaitTimeoutId = undefined;\n                clearTimeout(timeoutId);\n            }\n            latestCallArgs = undefined;\n        },\n        flush: function () {\n            handleCoolDownEnd();\n            return result;\n        },\n        get isPending() {\n            return coolDownTimeoutId !== undefined;\n        },\n        get cachedValue() {\n            return result;\n        },\n    };\n}\nexports.debounce = debounce;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports._reduceLazy = void 0;\nfunction _reduceLazy(array, lazy, indexed) {\n    var newArray = [];\n    for (var index = 0; index < array.length; index++) {\n        var item = array[index];\n        var result = indexed ? lazy(item, index, array) : lazy(item);\n        if (result.hasMany === true) {\n            newArray.push.apply(newArray, result.next);\n        }\n        else if (result.hasNext) {\n            newArray.push(result.next);\n        }\n    }\n    return newArray;\n}\nexports._reduceLazy = _reduceLazy;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.difference = void 0;\nvar purry_1 = require(\"./purry\");\nvar _reduceLazy_1 = require(\"./_reduceLazy\");\nfunction difference() {\n    return (0, purry_1.purry)(_difference, arguments, difference.lazy);\n}\nexports.difference = difference;\nfunction _difference(array, other) {\n    var lazy = difference.lazy(other);\n    return (0, _reduceLazy_1._reduceLazy)(array, lazy);\n}\n(function (difference) {\n    function lazy(other) {\n        var set = new Set(other);\n        return function (value) {\n            if (!set.has(value)) {\n                return {\n                    done: false,\n                    hasNext: true,\n                    next: value,\n                };\n            }\n            return {\n                done: false,\n                hasNext: false,\n            };\n        };\n    }\n    difference.lazy = lazy;\n})(difference || (exports.difference = difference = {}));\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.differenceWith = void 0;\nvar purry_1 = require(\"./purry\");\nvar _reduceLazy_1 = require(\"./_reduceLazy\");\nfunction differenceWith() {\n    return (0, purry_1.purry)(_differenceWith, arguments, differenceWith.lazy);\n}\nexports.differenceWith = differenceWith;\nfunction _differenceWith(array, other, isEquals) {\n    var lazy = differenceWith.lazy(other, isEquals);\n    return (0, _reduceLazy_1._reduceLazy)(array, lazy);\n}\n(function (differenceWith) {\n    function lazy(other, isEquals) {\n        return function (value) {\n            if (other.every(function (otherValue) { return !isEquals(value, otherValue); })) {\n                return {\n                    done: false,\n                    hasNext: true,\n                    next: value,\n                };\n            }\n            return {\n                done: false,\n                hasNext: false,\n            };\n        };\n    }\n    differenceWith.lazy = lazy;\n})(differenceWith || (exports.differenceWith = differenceWith = {}));\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.divide = void 0;\nvar purry_1 = require(\"./purry\");\nfunction divide() {\n    return (0, purry_1.purry)(_divide, arguments);\n}\nexports.divide = divide;\nfunction _divide(value, divisor) {\n    return value / divisor;\n}\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.drop = void 0;\nvar purry_1 = require(\"./purry\");\nvar _reduceLazy_1 = require(\"./_reduceLazy\");\nfunction drop() {\n    return (0, purry_1.purry)(_drop, arguments, drop.lazy);\n}\nexports.drop = drop;\nfunction _drop(array, n) {\n    return (0, _reduceLazy_1._reduceLazy)(array, drop.lazy(n));\n}\n(function (drop) {\n    function lazy(n) {\n        var left = n;\n        return function (value) {\n            if (left > 0) {\n                left--;\n                return {\n                    done: false,\n                    hasNext: false,\n                };\n            }\n            return {\n                done: false,\n                hasNext: true,\n                next: value,\n            };\n        };\n    }\n    drop.lazy = lazy;\n})(drop || (exports.drop = drop = {}));\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.swapInPlace = void 0;\nfunction swapInPlace(data, i, j) {\n    var _a;\n    _a = [data[j], data[i]], data[i] = _a[0], data[j] = _a[1];\n}\nexports.swapInPlace = swapInPlace;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.heapMaybeInsert = exports.heapify = void 0;\nvar _swapInPlace_1 = require(\"./_swapInPlace\");\nfunction heapify(heap, compareFn) {\n    for (var i = Math.floor(heap.length / 2) - 1; i >= 0; i--) {\n        heapSiftDown(heap, i, compareFn);\n    }\n}\nexports.heapify = heapify;\nfunction heapMaybeInsert(heap, compareFn, item) {\n    var head = heap[0];\n    if (compareFn(item, head) >= 0) {\n        return;\n    }\n    heap[0] = item;\n    heapSiftDown(heap, 0, compareFn);\n    return head;\n}\nexports.heapMaybeInsert = heapMaybeInsert;\nfunction heapSiftDown(heap, index, compareFn) {\n    var currentIndex = index;\n    while (currentIndex * 2 + 1 < heap.length) {\n        var firstChildIndex = currentIndex * 2 + 1;\n        var swapIndex = compareFn(heap[currentIndex], heap[firstChildIndex]) < 0\n            ?\n                firstChildIndex\n            : currentIndex;\n        var secondChildIndex = firstChildIndex + 1;\n        if (secondChildIndex < heap.length &&\n            compareFn(heap[swapIndex], heap[secondChildIndex]) < 0) {\n            swapIndex = secondChildIndex;\n        }\n        if (swapIndex === currentIndex) {\n            return;\n        }\n        (0, _swapInPlace_1.swapInPlace)(heap, currentIndex, swapIndex);\n        currentIndex = swapIndex;\n    }\n}\n", "\"use strict\";\nvar __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n        if (ar || !(i in from)) {\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n            ar[i] = from[i];\n        }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.purryOrderRulesWithArgument = exports.purryOrderRules = void 0;\nvar COMPARATORS = {\n    asc: function (x, y) { return x > y; },\n    desc: function (x, y) { return x < y; },\n};\nfunction purryOrderRules(func, inputArgs) {\n    var _a = (Array.isArray(inputArgs) ? inputArgs : Array.from(inputArgs)), dataOrRule = _a[0], rules = _a.slice(1);\n    if (!isOrderRule(dataOrRule)) {\n        var compareFn_1 = orderRuleComparer.apply(void 0, rules);\n        return func(dataOrRule, compareFn_1);\n    }\n    var compareFn = orderRuleComparer.apply(void 0, __spreadArray([dataOrRule], rules, false));\n    return function (data) { return func(data, compareFn); };\n}\nexports.purryOrderRules = purryOrderRules;\nfunction purryOrderRulesWithArgument(func, inputArgs) {\n    var _a = Array.from(inputArgs), first = _a[0], second = _a[1], rest = _a.slice(2);\n    var arg;\n    var argRemoved;\n    if (isOrderRule(second)) {\n        arg = first;\n        argRemoved = __spreadArray([second], rest, true);\n    }\n    else {\n        arg = second;\n        argRemoved = __spreadArray([first], rest, true);\n    }\n    return purryOrderRules(function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        return func.apply(void 0, __spreadArray(__spreadArray([], args, false), [arg], false));\n    }, argRemoved);\n}\nexports.purryOrderRulesWithArgument = purryOrderRulesWithArgument;\nfunction orderRuleComparer(primaryRule, secondaryRule) {\n    var otherRules = [];\n    for (var _i = 2; _i < arguments.length; _i++) {\n        otherRules[_i - 2] = arguments[_i];\n    }\n    var projector = typeof primaryRule === 'function' ? primaryRule : primaryRule[0];\n    var direction = typeof primaryRule === 'function' ? 'asc' : primaryRule[1];\n    var comparator = COMPARATORS[direction];\n    var nextComparer = secondaryRule === undefined\n        ? undefined\n        : orderRuleComparer.apply(void 0, __spreadArray([secondaryRule], otherRules, false));\n    return function (a, b) {\n        var _a;\n        var projectedA = projector(a);\n        var projectedB = projector(b);\n        if (comparator(projectedA, projectedB)) {\n            return 1;\n        }\n        if (comparator(projectedB, projectedA)) {\n            return -1;\n        }\n        return (_a = nextComparer === null || nextComparer === void 0 ? void 0 : nextComparer(a, b)) !== null && _a !== void 0 ? _a : 0;\n    };\n}\nfunction isOrderRule(x) {\n    if (isProjection(x)) {\n        return true;\n    }\n    if (typeof x !== 'object' || !Array.isArray(x)) {\n        return false;\n    }\n    var maybeProjection = x[0], maybeDirection = x[1], rest = x.slice(2);\n    return (isProjection(maybeProjection) &&\n        maybeDirection in COMPARATORS &&\n        rest.length === 0);\n}\nvar isProjection = function (x) {\n    return typeof x === 'function' && x.length === 1;\n};\n", "\"use strict\";\nvar __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n        if (ar || !(i in from)) {\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n            ar[i] = from[i];\n        }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.dropFirstBy = void 0;\nvar _heap_1 = require(\"./_heap\");\nvar _purryOrderRules_1 = require(\"./_purryOrderRules\");\nfunction dropFirstBy() {\n    return (0, _purryOrderRules_1.purryOrderRulesWithArgument)(dropFirstByImplementation, arguments);\n}\nexports.dropFirstBy = dropFirstBy;\nfunction dropFirstByImplementation(data, compareFn, n) {\n    if (n >= data.length) {\n        return [];\n    }\n    if (n <= 0) {\n        return __spreadArray([], data, true);\n    }\n    var heap = data.slice(0, n);\n    (0, _heap_1.heapify)(heap, compareFn);\n    var out = [];\n    var rest = data.slice(n);\n    for (var _i = 0, rest_1 = rest; _i < rest_1.length; _i++) {\n        var item = rest_1[_i];\n        var previousHead = (0, _heap_1.heapMaybeInsert)(heap, compareFn, item);\n        out.push(previousHead !== null && previousHead !== void 0 ? previousHead : item);\n    }\n    return out;\n}\n", "\"use strict\";\nvar __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n        if (ar || !(i in from)) {\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n            ar[i] = from[i];\n        }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.dropLast = void 0;\nvar purry_1 = require(\"./purry\");\nfunction dropLast() {\n    return (0, purry_1.purry)(_dropLast, arguments);\n}\nexports.dropLast = dropLast;\nfunction _dropLast(array, n) {\n    var copy = __spreadArray([], array, true);\n    if (n > 0) {\n        copy.splice(-n);\n    }\n    return copy;\n}\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.dropLastWhile = void 0;\nvar purry_1 = require(\"./purry\");\nfunction dropLastWhile() {\n    return (0, purry_1.purry)(_dropLastWhile, arguments);\n}\nexports.dropLastWhile = dropLastWhile;\nfunction _dropLastWhile(data, predicate) {\n    for (var i = data.length - 1; i >= 0; i--) {\n        if (!predicate(data[i])) {\n            return data.slice(0, i + 1);\n        }\n    }\n    return [];\n}\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.dropWhile = void 0;\nvar purry_1 = require(\"./purry\");\nfunction dropWhile() {\n    return (0, purry_1.purry)(_dropWhile, arguments);\n}\nexports.dropWhile = dropWhile;\nfunction _dropWhile(data, predicate) {\n    for (var i = 0; i < data.length; i++) {\n        if (!predicate(data[i])) {\n            return data.slice(i);\n        }\n    }\n    return [];\n}\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.equals = void 0;\nvar purry_1 = require(\"./purry\");\nvar isArray = Array.isArray;\nvar keyList = Object.keys;\nfunction equals() {\n    return (0, purry_1.purry)(_equals, arguments);\n}\nexports.equals = equals;\nfunction _equals(a, b) {\n    if (a === b) {\n        return true;\n    }\n    if (a && b && typeof a === 'object' && typeof b === 'object') {\n        var arrA = isArray(a);\n        var arrB = isArray(b);\n        var i = void 0;\n        var length_1;\n        var key = void 0;\n        if (arrA && arrB) {\n            length_1 = a.length;\n            if (length_1 !== b.length) {\n                return false;\n            }\n            for (i = length_1; i-- !== 0;) {\n                if (!equals(a[i], b[i])) {\n                    return false;\n                }\n            }\n            return true;\n        }\n        if (arrA !== arrB) {\n            return false;\n        }\n        var dateA = a instanceof Date;\n        var dateB = b instanceof Date;\n        if (dateA !== dateB) {\n            return false;\n        }\n        if (dateA && dateB) {\n            return a.getTime() === b.getTime();\n        }\n        var regexpA = a instanceof RegExp;\n        var regexpB = b instanceof RegExp;\n        if (regexpA !== regexpB) {\n            return false;\n        }\n        if (regexpA && regexpB) {\n            return a.toString() === b.toString();\n        }\n        var keys = keyList(a);\n        length_1 = keys.length;\n        if (length_1 !== keyList(b).length) {\n            return false;\n        }\n        for (i = length_1; i-- !== 0;) {\n            if (!Object.prototype.hasOwnProperty.call(b, keys[i])) {\n                return false;\n            }\n        }\n        for (i = length_1; i-- !== 0;) {\n            key = keys[i];\n            if (!equals(a[key], b[key])) {\n                return false;\n            }\n        }\n        return true;\n    }\n    return a !== a && b !== b;\n}\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.toPairs = void 0;\nfunction toPairs(object) {\n    return Object.entries(object);\n}\nexports.toPairs = toPairs;\n(function (toPairs) {\n    function strict(object) {\n        return Object.entries(object);\n    }\n    toPairs.strict = strict;\n})(toPairs || (exports.toPairs = toPairs = {}));\n", "\"use strict\";\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.evolve = void 0;\nvar purry_1 = require(\"./purry\");\nvar toPairs_1 = require(\"./toPairs\");\nfunction evolve() {\n    return (0, purry_1.purry)(_evolve, arguments);\n}\nexports.evolve = evolve;\nfunction _evolve(data, evolver) {\n    if (typeof data !== 'object' || data === null) {\n        return data;\n    }\n    return toPairs_1.toPairs.strict(evolver).reduce(function (result, _a) {\n        var key = _a[0], value = _a[1];\n        if (key in result) {\n            result[key] =\n                typeof value === 'function'\n                    ? value(result[key])\n                    : _evolve(result[key], value);\n        }\n        return result;\n    }, __assign({}, data));\n}\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports._toLazyIndexed = void 0;\nvar _toLazyIndexed = function (fn) {\n    fn.indexed = true;\n    return fn;\n};\nexports._toLazyIndexed = _toLazyIndexed;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.filter = void 0;\nvar purry_1 = require(\"./purry\");\nvar _reduceLazy_1 = require(\"./_reduceLazy\");\nvar _toLazyIndexed_1 = require(\"./_toLazyIndexed\");\nfunction filter() {\n    return (0, purry_1.purry)(_filter(false), arguments, filter.lazy);\n}\nexports.filter = filter;\nvar _filter = function (indexed) {\n    return function (array, fn) {\n        return (0, _reduceLazy_1._reduceLazy)(array, indexed ? filter.lazyIndexed(fn) : filter.lazy(fn), indexed);\n    };\n};\nvar _lazy = function (indexed) {\n    return function (fn) {\n        return function (value, index, array) {\n            var valid = indexed ? fn(value, index, array) : fn(value);\n            if (valid) {\n                return {\n                    done: false,\n                    hasNext: true,\n                    next: value,\n                };\n            }\n            return {\n                done: false,\n                hasNext: false,\n            };\n        };\n    };\n};\n(function (filter) {\n    function indexed() {\n        return (0, purry_1.purry)(_filter(true), arguments, filter.lazyIndexed);\n    }\n    filter.indexed = indexed;\n    filter.lazy = _lazy(false);\n    filter.lazyIndexed = (0, _toLazyIndexed_1._toLazyIndexed)(_lazy(true));\n})(filter || (exports.filter = filter = {}));\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports._toSingle = void 0;\nvar _toSingle = function (fn) {\n    fn.single = true;\n    return fn;\n};\nexports._toSingle = _toSingle;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.find = void 0;\nvar purry_1 = require(\"./purry\");\nvar _toLazyIndexed_1 = require(\"./_toLazyIndexed\");\nvar _toSingle_1 = require(\"./_toSingle\");\nfunction find() {\n    return (0, purry_1.purry)(_find(false), arguments, find.lazy);\n}\nexports.find = find;\nvar _find = function (indexed) {\n    return function (array, fn) {\n        if (indexed) {\n            return array.find(fn);\n        }\n        return array.find(function (x) { return fn(x); });\n    };\n};\nvar _lazy = function (indexed) {\n    return function (fn) {\n        return function (value, index, array) {\n            var valid = indexed ? fn(value, index, array) : fn(value);\n            return {\n                done: valid,\n                hasNext: valid,\n                next: value,\n            };\n        };\n    };\n};\n(function (find) {\n    function indexed() {\n        return (0, purry_1.purry)(_find(true), arguments, find.lazyIndexed);\n    }\n    find.indexed = indexed;\n    find.lazy = (0, _toSingle_1._toSingle)(_lazy(false));\n    find.lazyIndexed = (0, _toSingle_1._toSingle)((0, _toLazyIndexed_1._toLazyIndexed)(_lazy(true)));\n})(find || (exports.find = find = {}));\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.findIndex = void 0;\nvar purry_1 = require(\"./purry\");\nvar _toLazyIndexed_1 = require(\"./_toLazyIndexed\");\nvar _toSingle_1 = require(\"./_toSingle\");\nfunction findIndex() {\n    return (0, purry_1.purry)(_findIndex(false), arguments, findIndex.lazy);\n}\nexports.findIndex = findIndex;\nvar _findIndex = function (indexed) {\n    return function (array, fn) {\n        if (indexed) {\n            return array.findIndex(fn);\n        }\n        return array.findIndex(function (x) { return fn(x); });\n    };\n};\nvar _lazy = function (indexed) {\n    return function (fn) {\n        var i = 0;\n        return function (value, index, array) {\n            var valid = indexed ? fn(value, index, array) : fn(value);\n            if (valid) {\n                return {\n                    done: true,\n                    hasNext: true,\n                    next: i,\n                };\n            }\n            i++;\n            return {\n                done: false,\n                hasNext: false,\n            };\n        };\n    };\n};\n(function (findIndex) {\n    function indexed() {\n        return (0, purry_1.purry)(_findIndex(true), arguments, findIndex.lazyIndexed);\n    }\n    findIndex.indexed = indexed;\n    findIndex.lazy = (0, _toSingle_1._toSingle)(_lazy(false));\n    findIndex.lazyIndexed = (0, _toSingle_1._toSingle)((0, _toLazyIndexed_1._toLazyIndexed)(_lazy(true)));\n})(findIndex || (exports.findIndex = findIndex = {}));\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.findLast = void 0;\nvar purry_1 = require(\"./purry\");\nfunction findLast() {\n    return (0, purry_1.purry)(_findLast(false), arguments);\n}\nexports.findLast = findLast;\nvar _findLast = function (indexed) {\n    return function (array, fn) {\n        for (var i = array.length - 1; i >= 0; i--) {\n            if (indexed ? fn(array[i], i, array) : fn(array[i])) {\n                return array[i];\n            }\n        }\n    };\n};\n(function (findLast) {\n    function indexed() {\n        return (0, purry_1.purry)(_findLast(true), arguments);\n    }\n    findLast.indexed = indexed;\n})(findLast || (exports.findLast = findLast = {}));\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.findLastIndex = void 0;\nvar purry_1 = require(\"./purry\");\nfunction findLastIndex() {\n    return (0, purry_1.purry)(_findLastIndex(false), arguments);\n}\nexports.findLastIndex = findLastIndex;\nvar _findLastIndex = function (indexed) {\n    return function (array, fn) {\n        for (var i = array.length - 1; i >= 0; i--) {\n            if (indexed ? fn(array[i], i, array) : fn(array[i])) {\n                return i;\n            }\n        }\n        return -1;\n    };\n};\n(function (findLastIndex) {\n    function indexed() {\n        return (0, purry_1.purry)(_findLastIndex(true), arguments);\n    }\n    findLastIndex.indexed = indexed;\n})(findLastIndex || (exports.findLastIndex = findLastIndex = {}));\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.first = void 0;\nvar purry_1 = require(\"./purry\");\nfunction first() {\n    return (0, purry_1.purry)(_first, arguments, first.lazy);\n}\nexports.first = first;\nfunction _first(_a) {\n    var first = _a[0];\n    return first;\n}\n(function (first) {\n    function lazy() {\n        return function (value) {\n            return {\n                done: true,\n                hasNext: true,\n                next: value,\n            };\n        };\n    }\n    first.lazy = lazy;\n    (function (lazy) {\n        lazy.single = true;\n    })(lazy = first.lazy || (first.lazy = {}));\n})(first || (exports.first = first = {}));\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.hasAtLeast = void 0;\nvar purry_1 = require(\"./purry\");\nfunction hasAtLeast() {\n    var args = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n    }\n    return (0, purry_1.purry)(hasAtLeastImplementation, args);\n}\nexports.hasAtLeast = hasAtLeast;\nvar hasAtLeastImplementation = function (data, minimum) { return data.length >= minimum; };\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.firstBy = void 0;\nvar _purryOrderRules_1 = require(\"./_purryOrderRules\");\nvar hasAtLeast_1 = require(\"./hasAtLeast\");\nfunction firstBy() {\n    return (0, _purryOrderRules_1.purryOrderRules)(firstByImplementation, arguments);\n}\nexports.firstBy = firstBy;\nfunction firstByImplementation(data, compareFn) {\n    var currentFirst = data[0];\n    if (!(0, hasAtLeast_1.hasAtLeast)(data, 2)) {\n        return currentFirst;\n    }\n    var rest = data.slice(1);\n    for (var _i = 0, rest_1 = rest; _i < rest_1.length; _i++) {\n        var item = rest_1[_i];\n        if (compareFn(item, currentFirst) < 0) {\n            currentFirst = item;\n        }\n    }\n    return currentFirst;\n}\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.flatten = void 0;\nvar _reduceLazy_1 = require(\"./_reduceLazy\");\nvar purry_1 = require(\"./purry\");\nfunction flatten() {\n    return (0, purry_1.purry)(_flatten, arguments, flatten.lazy);\n}\nexports.flatten = flatten;\nfunction _flatten(items) {\n    return (0, _reduceLazy_1._reduceLazy)(items, flatten.lazy());\n}\n(function (flatten) {\n    function lazy() {\n        return function (next) {\n            if (Array.isArray(next)) {\n                return {\n                    done: false,\n                    hasNext: true,\n                    hasMany: true,\n                    next: next,\n                };\n            }\n            return {\n                done: false,\n                hasNext: true,\n                next: next,\n            };\n        };\n    }\n    flatten.lazy = lazy;\n})(flatten || (exports.flatten = flatten = {}));\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.flatMap = void 0;\nvar flatten_1 = require(\"./flatten\");\nvar purry_1 = require(\"./purry\");\nfunction flatMap() {\n    return (0, purry_1.purry)(_flatMap, arguments, flatMap.lazy);\n}\nexports.flatMap = flatMap;\nfunction _flatMap(array, fn) {\n    return (0, flatten_1.flatten)(array.map(function (item) { return fn(item); }));\n}\n(function (flatMap) {\n    function lazy(fn) {\n        return function (value) {\n            var next = fn(value);\n            if (Array.isArray(next)) {\n                return {\n                    done: false,\n                    hasNext: true,\n                    hasMany: true,\n                    next: next,\n                };\n            }\n            return {\n                done: false,\n                hasNext: true,\n                next: next,\n            };\n        };\n    }\n    flatMap.lazy = lazy;\n})(flatMap || (exports.flatMap = flatMap = {}));\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.flatMapToObj = void 0;\nvar purry_1 = require(\"./purry\");\nfunction flatMapToObj() {\n    return (0, purry_1.purry)(_flatMapToObj(false), arguments);\n}\nexports.flatMapToObj = flatMapToObj;\nvar _flatMapToObj = function (indexed) {\n    return function (array, fn) {\n        return array.reduce(function (result, element, index) {\n            var items = indexed ? fn(element, index, array) : fn(element);\n            items.forEach(function (_a) {\n                var key = _a[0], value = _a[1];\n                result[key] = value;\n            });\n            return result;\n        }, {});\n    };\n};\n(function (flatMapToObj) {\n    function indexed() {\n        return (0, purry_1.purry)(_flatMapToObj(true), arguments);\n    }\n    flatMapToObj.indexed = indexed;\n})(flatMapToObj || (exports.flatMapToObj = flatMapToObj = {}));\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.flattenDeep = void 0;\nvar _reduceLazy_1 = require(\"./_reduceLazy\");\nvar purry_1 = require(\"./purry\");\nfunction flattenDeep() {\n    return (0, purry_1.purry)(_flattenDeep, arguments, flattenDeep.lazy);\n}\nexports.flattenDeep = flattenDeep;\nfunction _flattenDeep(items) {\n    return (0, _reduceLazy_1._reduceLazy)(items, flattenDeep.lazy());\n}\nfunction _flattenDeepValue(value) {\n    if (!Array.isArray(value)) {\n        return value;\n    }\n    var ret = [];\n    value.forEach(function (item) {\n        if (Array.isArray(item)) {\n            ret.push.apply(ret, flattenDeep(item));\n        }\n        else {\n            ret.push(item);\n        }\n    });\n    return ret;\n}\n(function (flattenDeep) {\n    function lazy() {\n        return function (value) {\n            var next = _flattenDeepValue(value);\n            if (Array.isArray(next)) {\n                return {\n                    done: false,\n                    hasNext: true,\n                    hasMany: true,\n                    next: next,\n                };\n            }\n            return {\n                done: false,\n                hasNext: true,\n                next: next,\n            };\n        };\n    }\n    flattenDeep.lazy = lazy;\n})(flattenDeep || (exports.flattenDeep = flattenDeep = {}));\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.floor = void 0;\nvar _withPrecision_1 = require(\"./_withPrecision\");\nvar purry_1 = require(\"./purry\");\nfunction floor() {\n    return (0, purry_1.purry)((0, _withPrecision_1._withPrecision)(Math.floor), arguments);\n}\nexports.floor = floor;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.forEach = void 0;\nvar purry_1 = require(\"./purry\");\nvar _reduceLazy_1 = require(\"./_reduceLazy\");\nvar _toLazyIndexed_1 = require(\"./_toLazyIndexed\");\nfunction forEach() {\n    return (0, purry_1.purry)(_forEach(false), arguments, forEach.lazy);\n}\nexports.forEach = forEach;\nvar _forEach = function (indexed) {\n    return function (array, fn) {\n        return (0, _reduceLazy_1._reduceLazy)(array, indexed ? forEach.lazyIndexed(fn) : forEach.lazy(fn), indexed);\n    };\n};\nvar _lazy = function (indexed) {\n    return function (fn) {\n        return function (value, index, array) {\n            if (indexed) {\n                fn(value, index, array);\n            }\n            else {\n                fn(value);\n            }\n            return {\n                done: false,\n                hasNext: true,\n                next: value,\n            };\n        };\n    };\n};\n(function (forEach) {\n    function indexed() {\n        return (0, purry_1.purry)(_forEach(true), arguments, forEach.lazyIndexed);\n    }\n    forEach.indexed = indexed;\n    forEach.lazy = _lazy(false);\n    forEach.lazyIndexed = (0, _toLazyIndexed_1._toLazyIndexed)(_lazy(true));\n})(forEach || (exports.forEach = forEach = {}));\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.forEachObj = void 0;\nvar purry_1 = require(\"./purry\");\nfunction forEachObj() {\n    return (0, purry_1.purry)(_forEachObj(false), arguments);\n}\nexports.forEachObj = forEachObj;\nvar _forEachObj = function (indexed) {\n    return function (object, fn) {\n        for (var key in object) {\n            if (Object.prototype.hasOwnProperty.call(object, key)) {\n                var val = object[key];\n                if (indexed)\n                    fn(val, key, object);\n                else\n                    fn(val);\n            }\n        }\n        return object;\n    };\n};\n(function (forEachObj) {\n    function indexed() {\n        return (0, purry_1.purry)(_forEachObj(true), arguments);\n    }\n    forEachObj.indexed = indexed;\n})(forEachObj || (exports.forEachObj = forEachObj = {}));\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.fromPairs = void 0;\nfunction fromPairs(entries) {\n    var out = {};\n    for (var _i = 0, entries_1 = entries; _i < entries_1.length; _i++) {\n        var _a = entries_1[_i], key = _a[0], value = _a[1];\n        out[key] = value;\n    }\n    return out;\n}\nexports.fromPairs = fromPairs;\n(function (fromPairs) {\n    fromPairs.strict = fromPairs;\n})(fromPairs || (exports.fromPairs = fromPairs = {}));\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.groupBy = void 0;\nvar purry_1 = require(\"./purry\");\nfunction groupBy() {\n    return (0, purry_1.purry)(_groupBy(false), arguments);\n}\nexports.groupBy = groupBy;\nvar _groupBy = function (indexed) {\n    return function (array, fn) {\n        var ret = {};\n        array.forEach(function (item, index) {\n            var key = indexed ? fn(item, index, array) : fn(item);\n            if (key !== undefined) {\n                var actualKey = String(key);\n                if (!ret[actualKey]) {\n                    ret[actualKey] = [];\n                }\n                ret[actualKey].push(item);\n            }\n        });\n        return ret;\n    };\n};\n(function (groupBy) {\n    function indexed() {\n        return (0, purry_1.purry)(_groupBy(true), arguments);\n    }\n    groupBy.indexed = indexed;\n    groupBy.strict = groupBy;\n})(groupBy || (exports.groupBy = groupBy = {}));\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.identity = void 0;\nfunction identity(value) {\n    return value;\n}\nexports.identity = identity;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.indexBy = void 0;\nvar purry_1 = require(\"./purry\");\nfunction indexBy() {\n    return (0, purry_1.purry)(_indexBy(false), arguments);\n}\nexports.indexBy = indexBy;\nvar _indexBy = function (indexed) {\n    return function (array, fn) {\n        return array.reduce(function (ret, item, index) {\n            var value = indexed ? fn(item, index, array) : fn(item);\n            var key = String(value);\n            ret[key] = item;\n            return ret;\n        }, {});\n    };\n};\nfunction indexByStrict() {\n    return (0, purry_1.purry)(_indexByStrict, arguments);\n}\nvar _indexByStrict = function (array, fn) {\n    return array.reduce(function (ret, item) {\n        var key = fn(item);\n        ret[key] = item;\n        return ret;\n    }, {});\n};\n(function (indexBy) {\n    function indexed() {\n        return (0, purry_1.purry)(_indexBy(true), arguments);\n    }\n    indexBy.indexed = indexed;\n    indexBy.strict = indexByStrict;\n})(indexBy || (exports.indexBy = indexBy = {}));\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.intersection = void 0;\nvar purry_1 = require(\"./purry\");\nvar _reduceLazy_1 = require(\"./_reduceLazy\");\nfunction intersection() {\n    return (0, purry_1.purry)(_intersection, arguments, intersection.lazy);\n}\nexports.intersection = intersection;\nfunction _intersection(array, other) {\n    var lazy = intersection.lazy(other);\n    return (0, _reduceLazy_1._reduceLazy)(array, lazy);\n}\n(function (intersection) {\n    function lazy(other) {\n        return function (value) {\n            var set = new Set(other);\n            if (set.has(value)) {\n                return {\n                    done: false,\n                    hasNext: true,\n                    next: value,\n                };\n            }\n            return {\n                done: false,\n                hasNext: false,\n            };\n        };\n    }\n    intersection.lazy = lazy;\n})(intersection || (exports.intersection = intersection = {}));\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.intersectionWith = void 0;\nvar _reduceLazy_1 = require(\"./_reduceLazy\");\nvar purry_1 = require(\"./purry\");\nfunction intersectionWith() {\n    return (0, purry_1.purry)(_intersectionWith, arguments, intersectionWith.lazy);\n}\nexports.intersectionWith = intersectionWith;\nfunction _intersectionWith(array, other, comparator) {\n    var lazy = intersectionWith.lazy(other, comparator);\n    return (0, _reduceLazy_1._reduceLazy)(array, lazy);\n}\n(function (intersectionWith) {\n    function lazy(other, comparator) {\n        return function (value) {\n            if (other.some(function (otherValue) { return comparator(value, otherValue); })) {\n                return {\n                    done: false,\n                    hasNext: true,\n                    next: value,\n                };\n            }\n            return {\n                done: false,\n                hasNext: false,\n            };\n        };\n    }\n    intersectionWith.lazy = lazy;\n})(intersectionWith || (exports.intersectionWith = intersectionWith = {}));\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.invert = void 0;\nvar purry_1 = require(\"./purry\");\nfunction invert() {\n    return (0, purry_1.purry)(_invert, arguments);\n}\nexports.invert = invert;\nfunction _invert(object) {\n    var result = {};\n    for (var key in object) {\n        result[object[key]] = key;\n    }\n    return result;\n}\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.isArray = void 0;\nfunction isArray(data) {\n    return Array.isArray(data);\n}\nexports.isArray = isArray;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.isBoolean = void 0;\nfunction isBoolean(data) {\n    return typeof data === 'boolean';\n}\nexports.isBoolean = isBoolean;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.isDate = void 0;\nfunction isDate(data) {\n    return data instanceof Date;\n}\nexports.isDate = isDate;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.isDefined = void 0;\nfunction isDefined(data) {\n    return typeof data !== 'undefined' && data !== null;\n}\nexports.isDefined = isDefined;\n(function (isDefined) {\n    function strict(data) {\n        return data !== undefined;\n    }\n    isDefined.strict = strict;\n})(isDefined || (exports.isDefined = isDefined = {}));\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.isObject = void 0;\nfunction isObject(data) {\n    return !!data && !Array.isArray(data) && typeof data === 'object';\n}\nexports.isObject = isObject;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.isString = void 0;\nfunction isString(data) {\n    return typeof data === 'string';\n}\nexports.isString = isString;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.isEmpty = void 0;\nvar isArray_1 = require(\"./isArray\");\nvar isObject_1 = require(\"./isObject\");\nvar isString_1 = require(\"./isString\");\nfunction isEmpty(data) {\n    if (data === undefined) {\n        return true;\n    }\n    if ((0, isArray_1.isArray)(data) || (0, isString_1.isString)(data)) {\n        return data.length === 0;\n    }\n    if ((0, isObject_1.isObject)(data)) {\n        return Object.keys(data).length === 0;\n    }\n    return false;\n}\nexports.isEmpty = isEmpty;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.isError = void 0;\nfunction isError(data) {\n    return data instanceof Error;\n}\nexports.isError = isError;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.isFunction = void 0;\nfunction isFunction(data) {\n    return typeof data === 'function';\n}\nexports.isFunction = isFunction;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.isNil = void 0;\nfunction isNil(data) {\n    return data == null;\n}\nexports.isNil = isNil;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.isNonNull = void 0;\nfunction isNonNull(data) {\n    return data !== null;\n}\nexports.isNonNull = isNonNull;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.isNot = void 0;\nfunction isNot(predicate) {\n    return function (data) {\n        return !predicate(data);\n    };\n}\nexports.isNot = isNot;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.isNumber = void 0;\nfunction isNumber(data) {\n    return typeof data === 'number' && !isNaN(data);\n}\nexports.isNumber = isNumber;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.isObjectType = void 0;\nvar isObjectType = function (data) { return typeof data === 'object' && data !== null; };\nexports.isObjectType = isObjectType;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.isPlainObject = void 0;\nfunction isPlainObject(data) {\n    if (typeof data !== 'object' || data === null) {\n        return false;\n    }\n    var proto = Object.getPrototypeOf(data);\n    return proto === null || proto === Object.prototype;\n}\nexports.isPlainObject = isPlainObject;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.isPromise = void 0;\nfunction isPromise(data) {\n    return data instanceof Promise;\n}\nexports.isPromise = isPromise;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.isSymbol = void 0;\nfunction isSymbol(data) {\n    return typeof data === 'symbol';\n}\nexports.isSymbol = isSymbol;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.join = void 0;\nvar purry_1 = require(\"./purry\");\nfunction join() {\n    return (0, purry_1.purry)(joinImplementation, arguments);\n}\nexports.join = join;\nvar joinImplementation = function (data, glue) { return data.join(glue); };\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.keys = void 0;\nfunction keys(source) {\n    return Object.keys(source);\n}\nexports.keys = keys;\n(function (keys) {\n    keys.strict = keys;\n})(keys || (exports.keys = keys = {}));\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.last = void 0;\nvar purry_1 = require(\"./purry\");\nfunction last() {\n    return (0, purry_1.purry)(_last, arguments);\n}\nexports.last = last;\nfunction _last(array) {\n    return array[array.length - 1];\n}\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.length = void 0;\nvar purry_1 = require(\"./purry\");\nfunction length() {\n    return (0, purry_1.purry)(_length, arguments);\n}\nexports.length = length;\nfunction _length(items) {\n    return 'length' in items ? items.length : Array.from(items).length;\n}\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.map = void 0;\nvar purry_1 = require(\"./purry\");\nvar _reduceLazy_1 = require(\"./_reduceLazy\");\nvar _toLazyIndexed_1 = require(\"./_toLazyIndexed\");\nfunction map() {\n    return (0, purry_1.purry)(_map(false), arguments, map.lazy);\n}\nexports.map = map;\nvar _map = function (indexed) {\n    return function (array, fn) {\n        return (0, _reduceLazy_1._reduceLazy)(array, indexed ? map.lazyIndexed(fn) : map.lazy(fn), indexed);\n    };\n};\nvar _lazy = function (indexed) {\n    return function (fn) {\n        return function (value, index, array) {\n            return {\n                done: false,\n                hasNext: true,\n                next: indexed ? fn(value, index, array) : fn(value),\n            };\n        };\n    };\n};\n(function (map) {\n    function indexed() {\n        return (0, purry_1.purry)(_map(true), arguments, map.lazyIndexed);\n    }\n    map.indexed = indexed;\n    map.lazy = _lazy(false);\n    map.lazyIndexed = (0, _toLazyIndexed_1._toLazyIndexed)(_lazy(true));\n    map.strict = map;\n})(map || (exports.map = map = {}));\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.mapKeys = void 0;\nfunction mapKeys(arg1, arg2) {\n    if (arguments.length === 1) {\n        return function (data) { return _mapKeys(data, arg1); };\n    }\n    return _mapKeys(arg1, arg2);\n}\nexports.mapKeys = mapKeys;\nfunction _mapKeys(obj, fn) {\n    return Object.keys(obj).reduce(function (acc, key) {\n        acc[fn(key, obj[key])] = obj[key];\n        return acc;\n    }, {});\n}\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.mapToObj = void 0;\nvar purry_1 = require(\"./purry\");\nfunction mapToObj() {\n    return (0, purry_1.purry)(_mapToObj(false), arguments);\n}\nexports.mapToObj = mapToObj;\nvar _mapToObj = function (indexed) {\n    return function (array, fn) {\n        return array.reduce(function (result, element, index) {\n            var _a = indexed ? fn(element, index, array) : fn(element), key = _a[0], value = _a[1];\n            result[key] = value;\n            return result;\n        }, {});\n    };\n};\n(function (mapToObj) {\n    function indexed() {\n        return (0, purry_1.purry)(_mapToObj(true), arguments);\n    }\n    mapToObj.indexed = indexed;\n})(mapToObj || (exports.mapToObj = mapToObj = {}));\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.mapValues = void 0;\nfunction mapValues(arg1, arg2) {\n    if (arguments.length === 1) {\n        return function (data) { return _mapValues(data, arg1); };\n    }\n    return _mapValues(arg1, arg2);\n}\nexports.mapValues = mapValues;\nfunction _mapValues(obj, fn) {\n    return Object.keys(obj).reduce(function (acc, key) {\n        acc[key] = fn(obj[key], key);\n        return acc;\n    }, {});\n}\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.maxBy = void 0;\nvar purry_1 = require(\"./purry\");\nvar _maxBy = function (indexed) {\n    return function (array, fn) {\n        var ret = undefined;\n        var retMax = undefined;\n        array.forEach(function (item, i) {\n            var max = indexed ? fn(item, i, array) : fn(item);\n            if (retMax === undefined || max > retMax) {\n                ret = item;\n                retMax = max;\n            }\n        });\n        return ret;\n    };\n};\nfunction maxBy() {\n    return (0, purry_1.purry)(_maxBy(false), arguments);\n}\nexports.maxBy = maxBy;\n(function (maxBy) {\n    function indexed() {\n        return (0, purry_1.purry)(_maxBy(true), arguments);\n    }\n    maxBy.indexed = indexed;\n})(maxBy || (exports.maxBy = maxBy = {}));\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.meanBy = void 0;\nvar purry_1 = require(\"./purry\");\nvar _meanBy = function (indexed) {\n    return function (array, fn) {\n        if (array.length === 0) {\n            return NaN;\n        }\n        var sum = 0;\n        array.forEach(function (item, i) {\n            sum += indexed ? fn(item, i, array) : fn(item);\n        });\n        return sum / array.length;\n    };\n};\nfunction meanBy() {\n    return (0, purry_1.purry)(_meanBy(false), arguments);\n}\nexports.meanBy = meanBy;\n(function (meanBy) {\n    function indexed() {\n        return (0, purry_1.purry)(_meanBy(true), arguments);\n    }\n    meanBy.indexed = indexed;\n})(meanBy || (exports.meanBy = meanBy = {}));\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.merge = void 0;\nvar purry_1 = require(\"./purry\");\nfunction merge() {\n    return (0, purry_1.purry)(_merge, arguments);\n}\nexports.merge = merge;\nfunction _merge(a, b) {\n    return Object.assign({}, a, b);\n}\n", "\"use strict\";\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.mergeAll = void 0;\nfunction mergeAll(items) {\n    return items.reduce(function (acc, x) { return (__assign(__assign({}, acc), x)); }, {});\n}\nexports.mergeAll = mergeAll;\n", "\"use strict\";\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.mergeDeep = void 0;\nvar purry_1 = require(\"./purry\");\nfunction mergeDeep() {\n    return (0, purry_1.purry)(mergeDeepImplementation, arguments);\n}\nexports.mergeDeep = mergeDeep;\nfunction mergeDeepImplementation(destination, source) {\n    var output = __assign(__assign({}, destination), source);\n    for (var key in source) {\n        if (!(key in destination)) {\n            continue;\n        }\n        var destinationValue = destination[key];\n        if (!isRecord(destinationValue)) {\n            continue;\n        }\n        var sourceValue = source[key];\n        if (!isRecord(sourceValue)) {\n            continue;\n        }\n        output[key] = mergeDeepImplementation(destinationValue, sourceValue);\n    }\n    return output;\n}\nfunction isRecord(object) {\n    return (typeof object === 'object' &&\n        object !== null &&\n        Object.getPrototypeOf(object) === Object.prototype);\n}\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.minBy = void 0;\nvar purry_1 = require(\"./purry\");\nvar _minBy = function (indexed) {\n    return function (array, fn) {\n        var ret = undefined;\n        var retMin = undefined;\n        array.forEach(function (item, i) {\n            var min = indexed ? fn(item, i, array) : fn(item);\n            if (retMin === undefined || min < retMin) {\n                ret = item;\n                retMin = min;\n            }\n        });\n        return ret;\n    };\n};\nfunction minBy() {\n    return (0, purry_1.purry)(_minBy(false), arguments);\n}\nexports.minBy = minBy;\n(function (minBy) {\n    function indexed() {\n        return (0, purry_1.purry)(_minBy(true), arguments);\n    }\n    minBy.indexed = indexed;\n})(minBy || (exports.minBy = minBy = {}));\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.multiply = void 0;\nvar purry_1 = require(\"./purry\");\nfunction multiply() {\n    return (0, purry_1.purry)(_multiply, arguments);\n}\nexports.multiply = multiply;\nfunction _multiply(value, multiplicand) {\n    return value * multiplicand;\n}\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.noop = void 0;\nvar noop = function () { return undefined; };\nexports.noop = noop;\n", "\"use strict\";\nvar __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n        if (ar || !(i in from)) {\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n            ar[i] = from[i];\n        }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.quickSelect = void 0;\nvar _swapInPlace_1 = require(\"./_swapInPlace\");\nvar quickSelect = function (data, index, compareFn) {\n    return index < 0 || index >= data.length\n        ?\n            undefined\n        : quickSelectImplementation(__spreadArray([], data, true), 0, data.length - 1, index, compareFn);\n};\nexports.quickSelect = quickSelect;\nfunction quickSelectImplementation(data, left, right, index, compareFn) {\n    if (left === right) {\n        return data[left];\n    }\n    var pivotIndex = partition(data, left, right, compareFn);\n    return index === pivotIndex\n        ?\n            data[index]\n        : quickSelectImplementation(data, index < pivotIndex ? left : pivotIndex + 1, index < pivotIndex ? pivotIndex - 1 : right, index, compareFn);\n}\nfunction partition(data, left, right, compareFn) {\n    var pivot = data[right];\n    var i = left;\n    for (var j = left; j < right; j++) {\n        if (compareFn(data[j], pivot) < 0) {\n            (0, _swapInPlace_1.swapInPlace)(data, i, j);\n            i++;\n        }\n    }\n    (0, _swapInPlace_1.swapInPlace)(data, i, right);\n    return i;\n}\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.nthBy = void 0;\nvar _purryOrderRules_1 = require(\"./_purryOrderRules\");\nvar _quickSelect_1 = require(\"./_quickSelect\");\nfunction nthBy() {\n    return (0, _purryOrderRules_1.purryOrderRulesWithArgument)(nthByImplementation, arguments);\n}\nexports.nthBy = nthBy;\nvar nthByImplementation = function (data, compareFn, index) {\n    return (0, _quickSelect_1.quickSelect)(data, index >= 0 ? index : data.length + index, compareFn);\n};\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.objOf = void 0;\nvar purry_1 = require(\"./purry\");\nfunction objOf() {\n    return (0, purry_1.purry)(_objOf, arguments);\n}\nexports.objOf = objOf;\nfunction _objOf(value, key) {\n    var _a;\n    return _a = {}, _a[key] = value, _a;\n}\n", "\"use strict\";\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.omit = void 0;\nvar fromPairs_1 = require(\"./fromPairs\");\nvar purry_1 = require(\"./purry\");\nfunction omit() {\n    return (0, purry_1.purry)(_omit, arguments);\n}\nexports.omit = omit;\nfunction _omit(data, propNames) {\n    if (propNames.length === 0) {\n        return __assign({}, data);\n    }\n    if (propNames.length === 1) {\n        var propName = propNames[0];\n        var _a = data, _b = propName, omitted = _a[_b], remaining = __rest(_a, [typeof _b === \"symbol\" ? _b : _b + \"\"]);\n        return remaining;\n    }\n    if (!propNames.some(function (propName) { return propName in data; })) {\n        return __assign({}, data);\n    }\n    var asSet = new Set(propNames);\n    return (0, fromPairs_1.fromPairs)(Object.entries(data).filter(function (_a) {\n        var key = _a[0];\n        return !asSet.has(key);\n    }));\n}\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.omitBy = void 0;\nvar purry_1 = require(\"./purry\");\nfunction omitBy() {\n    return (0, purry_1.purry)(_omitBy, arguments);\n}\nexports.omitBy = omitBy;\nfunction _omitBy(object, fn) {\n    return Object.keys(object).reduce(function (acc, key) {\n        if (!fn(object[key], key)) {\n            acc[key] = object[key];\n        }\n        return acc;\n    }, {});\n}\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.once = void 0;\nfunction once(fn) {\n    var called = false;\n    var ret;\n    return function () {\n        if (!called) {\n            ret = fn();\n            called = true;\n        }\n        return ret;\n    };\n}\nexports.once = once;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.only = void 0;\nvar purry_1 = require(\"./purry\");\nfunction only() {\n    return (0, purry_1.purry)(_only, arguments);\n}\nexports.only = only;\nfunction _only(array) {\n    if (array.length === 1) {\n        return array[0];\n    }\n    return undefined;\n}\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.partition = void 0;\nvar purry_1 = require(\"./purry\");\nfunction partition() {\n    return (0, purry_1.purry)(_partition(false), arguments);\n}\nexports.partition = partition;\nvar _partition = function (indexed) {\n    return function (array, fn) {\n        var ret = [[], []];\n        array.forEach(function (item, index) {\n            var matches = indexed ? fn(item, index, array) : fn(item);\n            ret[matches ? 0 : 1].push(item);\n        });\n        return ret;\n    };\n};\n(function (partition) {\n    function indexed() {\n        return (0, purry_1.purry)(_partition(true), arguments);\n    }\n    partition.indexed = indexed;\n})(partition || (exports.partition = partition = {}));\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.pathOr = void 0;\nvar purry_1 = require(\"./purry\");\nfunction pathOr() {\n    return (0, purry_1.purry)(_pathOr, arguments);\n}\nexports.pathOr = pathOr;\nfunction _pathOr(object, path, defaultValue) {\n    var current = object;\n    for (var _i = 0, path_1 = path; _i < path_1.length; _i++) {\n        var prop = path_1[_i];\n        if (current == null || current[prop] == null) {\n            return defaultValue;\n        }\n        current = current[prop];\n    }\n    return current;\n}\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.pick = void 0;\nvar purry_1 = require(\"./purry\");\nfunction pick() {\n    return (0, purry_1.purry)(_pick, arguments);\n}\nexports.pick = pick;\nfunction _pick(object, names) {\n    if (object == null) {\n        return {};\n    }\n    return names.reduce(function (acc, name) {\n        if (name in object) {\n            acc[name] = object[name];\n        }\n        return acc;\n    }, {});\n}\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.pickBy = void 0;\nvar purry_1 = require(\"./purry\");\nfunction pickBy() {\n    return (0, purry_1.purry)(_pickBy, arguments);\n}\nexports.pickBy = pickBy;\nfunction _pickBy(object, fn) {\n    if (object == null) {\n        return {};\n    }\n    return Object.keys(object).reduce(function (acc, key) {\n        if (fn(object[key], key)) {\n            acc[key] = object[key];\n        }\n        return acc;\n    }, {});\n}\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.prop = void 0;\nvar prop = function (propName) {\n    return function (_a) {\n        var _b = propName, value = _a[_b];\n        return value;\n    };\n};\nexports.prop = prop;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.range = void 0;\nvar purry_1 = require(\"./purry\");\nfunction range() {\n    return (0, purry_1.purry)(_range, arguments);\n}\nexports.range = range;\nfunction _range(start, end) {\n    var ret = [];\n    for (var i = start; i < end; i++) {\n        ret.push(i);\n    }\n    return ret;\n}\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.randomString = void 0;\nvar range_1 = require(\"./range\");\nfunction randomString(length) {\n    var characterSet = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';\n    var randomChar = function () {\n        return characterSet[Math.floor(Math.random() * characterSet.length)];\n    };\n    return (0, range_1.range)(0, length).reduce(function (text) { return text + randomChar(); }, '');\n}\nexports.randomString = randomString;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.rankBy = void 0;\nvar _purryOrderRules_1 = require(\"./_purryOrderRules\");\nfunction rankBy() {\n    return (0, _purryOrderRules_1.purryOrderRulesWithArgument)(rankByImplementation, arguments);\n}\nexports.rankBy = rankBy;\nfunction rankByImplementation(data, compareFn, targetItem) {\n    var rank = 0;\n    for (var _i = 0, data_1 = data; _i < data_1.length; _i++) {\n        var item = data_1[_i];\n        if (compareFn(targetItem, item) > 0) {\n            rank++;\n        }\n    }\n    return rank;\n}\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.reduce = void 0;\nvar purry_1 = require(\"./purry\");\nfunction reduce() {\n    return (0, purry_1.purry)(_reduce(false), arguments);\n}\nexports.reduce = reduce;\nvar _reduce = function (indexed) {\n    return function (items, fn, initialValue) {\n        return items.reduce(function (acc, item, index) {\n            return indexed ? fn(acc, item, index, items) : fn(acc, item);\n        }, initialValue);\n    };\n};\n(function (reduce) {\n    function indexed() {\n        return (0, purry_1.purry)(_reduce(true), arguments);\n    }\n    reduce.indexed = indexed;\n})(reduce || (exports.reduce = reduce = {}));\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.reject = void 0;\nvar purry_1 = require(\"./purry\");\nvar _reduceLazy_1 = require(\"./_reduceLazy\");\nvar _toLazyIndexed_1 = require(\"./_toLazyIndexed\");\nfunction reject() {\n    return (0, purry_1.purry)(_reject(false), arguments, reject.lazy);\n}\nexports.reject = reject;\nvar _reject = function (indexed) {\n    return function (array, fn) {\n        return (0, _reduceLazy_1._reduceLazy)(array, indexed ? reject.lazyIndexed(fn) : reject.lazy(fn), indexed);\n    };\n};\nvar _lazy = function (indexed) {\n    return function (fn) {\n        return function (value, index, array) {\n            var valid = indexed ? fn(value, index, array) : fn(value);\n            if (!valid) {\n                return {\n                    done: false,\n                    hasNext: true,\n                    next: value,\n                };\n            }\n            return {\n                done: false,\n                hasNext: false,\n            };\n        };\n    };\n};\n(function (reject) {\n    function indexed() {\n        return (0, purry_1.purry)(_reject(true), arguments, reject.lazyIndexed);\n    }\n    reject.indexed = indexed;\n    reject.lazy = _lazy(false);\n    reject.lazyIndexed = (0, _toLazyIndexed_1._toLazyIndexed)(_lazy(true));\n})(reject || (exports.reject = reject = {}));\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.reverse = void 0;\nvar purry_1 = require(\"./purry\");\nfunction reverse() {\n    return (0, purry_1.purry)(_reverse, arguments);\n}\nexports.reverse = reverse;\nfunction _reverse(array) {\n    return array.slice().reverse();\n}\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.round = void 0;\nvar _withPrecision_1 = require(\"./_withPrecision\");\nvar purry_1 = require(\"./purry\");\nfunction round() {\n    return (0, purry_1.purry)((0, _withPrecision_1._withPrecision)(Math.round), arguments);\n}\nexports.round = round;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.sample = void 0;\nvar purry_1 = require(\"./purry\");\nfunction sample() {\n    var args = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n    }\n    return (0, purry_1.purry)(sampleImplementation, args);\n}\nexports.sample = sample;\nfunction sampleImplementation(data, sampleSize) {\n    if (sampleSize < 0) {\n        throw new RangeError(\"sampleSize must cannot be negative: \".concat(sampleSize));\n    }\n    if (!Number.isInteger(sampleSize)) {\n        throw new TypeError(\"sampleSize must be an integer: \".concat(sampleSize));\n    }\n    if (sampleSize >= data.length) {\n        return data;\n    }\n    if (sampleSize === 0) {\n        return [];\n    }\n    var actualSampleSize = Math.min(sampleSize, data.length - sampleSize);\n    var sampleIndices = new Set();\n    while (sampleIndices.size < actualSampleSize) {\n        var randomIndex = Math.floor(Math.random() * data.length);\n        sampleIndices.add(randomIndex);\n    }\n    if (sampleSize === actualSampleSize) {\n        return Array.from(sampleIndices)\n            .sort(function (a, b) { return a - b; })\n            .map(function (index) { return data[index]; });\n    }\n    return data.filter(function (_, index) { return !sampleIndices.has(index); });\n}\n", "\"use strict\";\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.set = void 0;\nvar purry_1 = require(\"./purry\");\nfunction set() {\n    return (0, purry_1.purry)(_set, arguments);\n}\nexports.set = set;\nfunction _set(obj, prop, value) {\n    var _a;\n    return __assign(__assign({}, obj), (_a = {}, _a[prop] = value, _a));\n}\n", "\"use strict\";\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports._setPath = exports.setPath = void 0;\nvar purry_1 = require(\"./purry\");\nfunction setPath() {\n    return (0, purry_1.purry)(_setPath, arguments);\n}\nexports.setPath = setPath;\nfunction _setPath(object, path, value) {\n    var _a;\n    if (path.length === 0)\n        return value;\n    if (Array.isArray(object)) {\n        return object.map(function (item, index) {\n            if (index === path[0]) {\n                return _setPath(item, path.slice(1), value);\n            }\n            return item;\n        });\n    }\n    return __assign(__assign({}, object), (_a = {}, _a[path[0]] = _setPath(object[path[0]], path.slice(1), value), _a));\n}\nexports._setPath = _setPath;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.shuffle = void 0;\nvar purry_1 = require(\"./purry\");\nfunction shuffle() {\n    return (0, purry_1.purry)(_shuffle, arguments);\n}\nexports.shuffle = shuffle;\nfunction _shuffle(items) {\n    var result = items.slice();\n    for (var index = 0; index < items.length; index += 1) {\n        var rand = index + Math.floor(Math.random() * (items.length - index));\n        var value = result[rand];\n        result[rand] = result[index];\n        result[index] = value;\n    }\n    return result;\n}\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.sliceString = void 0;\nvar sliceString = function (indexStart, indexEnd) {\n    return function (data) {\n        return data.slice(indexStart, indexEnd);\n    };\n};\nexports.sliceString = sliceString;\n", "\"use strict\";\nvar __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n        if (ar || !(i in from)) {\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n            ar[i] = from[i];\n        }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.sort = void 0;\nvar purry_1 = require(\"./purry\");\nfunction sort() {\n    return (0, purry_1.purry)(_sort, arguments);\n}\nexports.sort = sort;\nfunction _sort(items, cmp) {\n    var ret = __spreadArray([], items, true);\n    ret.sort(cmp);\n    return ret;\n}\n(function (sort) {\n    sort.strict = sort;\n})(sort || (exports.sort = sort = {}));\n", "\"use strict\";\nvar __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n        if (ar || !(i in from)) {\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n            ar[i] = from[i];\n        }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.sortBy = void 0;\nvar _purryOrderRules_1 = require(\"./_purryOrderRules\");\nfunction sortBy() {\n    return (0, _purryOrderRules_1.purryOrderRules)(_sortBy, arguments);\n}\nexports.sortBy = sortBy;\nvar _sortBy = function (data, compareFn) {\n    return __spreadArray([], data, true).sort(compareFn);\n};\n(function (sortBy) {\n    sortBy.strict = sortBy;\n})(sortBy || (exports.sortBy = sortBy = {}));\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports._binarySearchCutoffIndex = void 0;\nfunction _binarySearchCutoffIndex(array, predicate) {\n    var lowIndex = 0;\n    var highIndex = array.length;\n    while (lowIndex < highIndex) {\n        var pivotIndex = (lowIndex + highIndex) >>> 1;\n        var pivot = array[pivotIndex];\n        if (predicate(pivot, pivotIndex)) {\n            lowIndex = pivotIndex + 1;\n        }\n        else {\n            highIndex = pivotIndex;\n        }\n    }\n    return highIndex;\n}\nexports._binarySearchCutoffIndex = _binarySearchCutoffIndex;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.sortedIndex = void 0;\nvar purry_1 = require(\"./purry\");\nvar _binarySearchCutoffIndex_1 = require(\"./_binarySearchCutoffIndex\");\nfunction sortedIndex() {\n    return (0, purry_1.purry)(sortedIndexImplementation, arguments);\n}\nexports.sortedIndex = sortedIndex;\nvar sortedIndexImplementation = function (array, item) { return (0, _binarySearchCutoffIndex_1._binarySearchCutoffIndex)(array, function (pivot) { return pivot < item; }); };\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.sortedIndexBy = void 0;\nvar purry_1 = require(\"./purry\");\nvar _binarySearchCutoffIndex_1 = require(\"./_binarySearchCutoffIndex\");\nfunction sortedIndexBy() {\n    return (0, purry_1.purry)(sortedIndexByImplementation, arguments);\n}\nexports.sortedIndexBy = sortedIndexBy;\n(function (sortedIndexBy) {\n    function indexed() {\n        return (0, purry_1.purry)(sortedIndexByImplementation, arguments);\n    }\n    sortedIndexBy.indexed = indexed;\n})(sortedIndexBy || (exports.sortedIndexBy = sortedIndexBy = {}));\nfunction sortedIndexByImplementation(array, item, valueFunction) {\n    var value = valueFunction(item);\n    return (0, _binarySearchCutoffIndex_1._binarySearchCutoffIndex)(array, function (pivot, index) { return valueFunction(pivot, index) < value; });\n}\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.sortedIndexWith = void 0;\nvar purry_1 = require(\"./purry\");\nvar _binarySearchCutoffIndex_1 = require(\"./_binarySearchCutoffIndex\");\nfunction sortedIndexWith() {\n    return (0, purry_1.purry)(_binarySearchCutoffIndex_1._binarySearchCutoffIndex, arguments);\n}\nexports.sortedIndexWith = sortedIndexWith;\n(function (sortedIndexWith) {\n    function indexed() {\n        return (0, purry_1.purry)(_binarySearchCutoffIndex_1._binarySearchCutoffIndex, arguments);\n    }\n    sortedIndexWith.indexed = indexed;\n})(sortedIndexWith || (exports.sortedIndexWith = sortedIndexWith = {}));\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.sortedLastIndex = void 0;\nvar purry_1 = require(\"./purry\");\nvar _binarySearchCutoffIndex_1 = require(\"./_binarySearchCutoffIndex\");\nfunction sortedLastIndex() {\n    return (0, purry_1.purry)(sortedLastIndexImplementation, arguments);\n}\nexports.sortedLastIndex = sortedLastIndex;\nvar sortedLastIndexImplementation = function (array, item) {\n    return (0, _binarySearchCutoffIndex_1._binarySearchCutoffIndex)(array, function (pivot) { return pivot <= item; });\n};\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.sortedLastIndexBy = void 0;\nvar purry_1 = require(\"./purry\");\nvar _binarySearchCutoffIndex_1 = require(\"./_binarySearchCutoffIndex\");\nfunction sortedLastIndexBy() {\n    return (0, purry_1.purry)(sortedLastIndexByImplementation, arguments);\n}\nexports.sortedLastIndexBy = sortedLastIndexBy;\n(function (sortedLastIndexBy) {\n    function indexed() {\n        return (0, purry_1.purry)(sortedLastIndexByImplementation, arguments);\n    }\n    sortedLastIndexBy.indexed = indexed;\n})(sortedLastIndexBy || (exports.sortedLastIndexBy = sortedLastIndexBy = {}));\nfunction sortedLastIndexByImplementation(array, item, valueFunction) {\n    var value = valueFunction(item);\n    return (0, _binarySearchCutoffIndex_1._binarySearchCutoffIndex)(array, function (pivot, index) { return valueFunction(pivot, index) <= value; });\n}\n", "\"use strict\";\nvar __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n        if (ar || !(i in from)) {\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n            ar[i] = from[i];\n        }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.splice = void 0;\nvar purry_1 = require(\"./purry\");\nfunction splice() {\n    return (0, purry_1.purry)(_splice, arguments);\n}\nexports.splice = splice;\nfunction _splice(items, start, deleteCount, replacement) {\n    var result = __spreadArray([], items, true);\n    result.splice.apply(result, __spreadArray([start, deleteCount], replacement, false));\n    return result;\n}\n", "\"use strict\";\nvar __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n        if (ar || !(i in from)) {\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n            ar[i] = from[i];\n        }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.splitAt = void 0;\nvar purry_1 = require(\"./purry\");\nfunction splitAt() {\n    return (0, purry_1.purry)(_splitAt, arguments);\n}\nexports.splitAt = splitAt;\nfunction _splitAt(array, index) {\n    var copy = __spreadArray([], array, true);\n    var tail = copy.splice(index);\n    return [copy, tail];\n}\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.splitWhen = void 0;\nvar splitAt_1 = require(\"./splitAt\");\nvar purry_1 = require(\"./purry\");\nfunction splitWhen() {\n    return (0, purry_1.purry)(_splitWhen, arguments);\n}\nexports.splitWhen = splitWhen;\nfunction _splitWhen(array, fn) {\n    for (var i = 0; i < array.length; i++) {\n        if (fn(array[i])) {\n            return (0, splitAt_1.splitAt)(array, i);\n        }\n    }\n    return [array, []];\n}\n", "\"use strict\";\nvar __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n        if (ar || !(i in from)) {\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n            ar[i] = from[i];\n        }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.stringToPath = void 0;\nfunction stringToPath(path) {\n    return _stringToPath(path);\n}\nexports.stringToPath = stringToPath;\nfunction _stringToPath(path) {\n    var _a;\n    if (path.length === 0)\n        return [];\n    var match = (_a = path.match(/^\\[(.+?)\\](.*)$/)) !== null && _a !== void 0 ? _a : path.match(/^\\.?([^.[\\]]+)(.*)$/);\n    if (match) {\n        var key = match[1], rest = match[2];\n        return __spreadArray([key], _stringToPath(rest), true);\n    }\n    return [path];\n}\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.subtract = void 0;\nvar purry_1 = require(\"./purry\");\nfunction subtract() {\n    return (0, purry_1.purry)(_subtract, arguments);\n}\nexports.subtract = subtract;\nfunction _subtract(value, subtrahend) {\n    return value - subtrahend;\n}\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.sumBy = void 0;\nvar purry_1 = require(\"./purry\");\nvar _sumBy = function (indexed) {\n    return function (array, fn) {\n        var sum = 0;\n        array.forEach(function (item, i) {\n            var summand = indexed ? fn(item, i, array) : fn(item);\n            sum += summand;\n        });\n        return sum;\n    };\n};\nfunction sumBy() {\n    return (0, purry_1.purry)(_sumBy(false), arguments);\n}\nexports.sumBy = sumBy;\n(function (sumBy) {\n    function indexed() {\n        return (0, purry_1.purry)(_sumBy(true), arguments);\n    }\n    sumBy.indexed = indexed;\n})(sumBy || (exports.sumBy = sumBy = {}));\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.swapIndices = void 0;\nvar purry_1 = require(\"./purry\");\nfunction swapIndices() {\n    return (0, purry_1.purry)(_swapIndices, arguments);\n}\nexports.swapIndices = swapIndices;\nfunction _swapIndices(item, index1, index2) {\n    return typeof item === 'string'\n        ? _swapString(item, index1, index2)\n        : _swapArray(item, index1, index2);\n}\nfunction _swapArray(item, index1, index2) {\n    var result = item.slice();\n    if (isNaN(index1) || isNaN(index2)) {\n        return result;\n    }\n    var positiveIndexA = index1 < 0 ? item.length + index1 : index1;\n    var positiveIndexB = index2 < 0 ? item.length + index2 : index2;\n    if (positiveIndexA < 0 || positiveIndexA > item.length) {\n        return result;\n    }\n    if (positiveIndexB < 0 || positiveIndexB > item.length) {\n        return result;\n    }\n    result[positiveIndexA] = item[positiveIndexB];\n    result[positiveIndexB] = item[positiveIndexA];\n    return result;\n}\nfunction _swapString(item, index1, index2) {\n    var result = _swapArray(item.split(''), index1, index2);\n    return result.join('');\n}\n", "\"use strict\";\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.swapProps = void 0;\nvar purry_1 = require(\"./purry\");\nfunction swapProps() {\n    return (0, purry_1.purry)(_swapProps, arguments);\n}\nexports.swapProps = swapProps;\nfunction _swapProps(obj, key1, key2) {\n    var _a;\n    var _b = obj, _c = key1, value1 = _b[_c], _d = key2, value2 = _b[_d];\n    return __assign(__assign({}, obj), (_a = {}, _a[key1] = value2, _a[key2] = value1, _a));\n}\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.take = void 0;\nvar purry_1 = require(\"./purry\");\nvar _reduceLazy_1 = require(\"./_reduceLazy\");\nfunction take() {\n    return (0, purry_1.purry)(_take, arguments, take.lazy);\n}\nexports.take = take;\nfunction _take(array, n) {\n    return (0, _reduceLazy_1._reduceLazy)(array, take.lazy(n));\n}\n(function (take) {\n    function lazy(n) {\n        return function (value) {\n            if (n === 0) {\n                return {\n                    done: true,\n                    hasNext: false,\n                };\n            }\n            n--;\n            if (n === 0) {\n                return {\n                    done: true,\n                    hasNext: true,\n                    next: value,\n                };\n            }\n            return {\n                done: false,\n                hasNext: true,\n                next: value,\n            };\n        };\n    }\n    take.lazy = lazy;\n})(take || (exports.take = take = {}));\n", "\"use strict\";\nvar __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n        if (ar || !(i in from)) {\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n            ar[i] = from[i];\n        }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.takeFirstBy = void 0;\nvar _heap_1 = require(\"./_heap\");\nvar _purryOrderRules_1 = require(\"./_purryOrderRules\");\nfunction takeFirstBy() {\n    return (0, _purryOrderRules_1.purryOrderRulesWithArgument)(takeFirstByImplementation, arguments);\n}\nexports.takeFirstBy = takeFirstBy;\nfunction takeFirstByImplementation(data, compareFn, n) {\n    if (n <= 0) {\n        return [];\n    }\n    if (n >= data.length) {\n        return __spreadArray([], data, true);\n    }\n    var heap = data.slice(0, n);\n    (0, _heap_1.heapify)(heap, compareFn);\n    var rest = data.slice(n);\n    for (var _i = 0, rest_1 = rest; _i < rest_1.length; _i++) {\n        var item = rest_1[_i];\n        (0, _heap_1.heapMaybeInsert)(heap, compareFn, item);\n    }\n    return heap;\n}\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.takeLastWhile = void 0;\nvar purry_1 = require(\"./purry\");\nfunction takeLastWhile() {\n    return (0, purry_1.purry)(_takeLastWhile, arguments);\n}\nexports.takeLastWhile = takeLastWhile;\nfunction _takeLastWhile(data, predicate) {\n    for (var i = data.length - 1; i >= 0; i--) {\n        if (!predicate(data[i])) {\n            return data.slice(i + 1);\n        }\n    }\n    return data.slice();\n}\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.takeWhile = void 0;\nvar purry_1 = require(\"./purry\");\nfunction takeWhile() {\n    return (0, purry_1.purry)(_takeWhile, arguments);\n}\nexports.takeWhile = takeWhile;\nfunction _takeWhile(array, fn) {\n    var ret = [];\n    for (var _i = 0, array_1 = array; _i < array_1.length; _i++) {\n        var item = array_1[_i];\n        if (!fn(item)) {\n            break;\n        }\n        ret.push(item);\n    }\n    return ret;\n}\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.tap = void 0;\nvar purry_1 = require(\"./purry\");\nfunction tap() {\n    return (0, purry_1.purry)(_tap, arguments);\n}\nexports.tap = tap;\nfunction _tap(value, fn) {\n    fn(value);\n    return value;\n}\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.times = void 0;\nvar purry_1 = require(\"./purry\");\nfunction times() {\n    return (0, purry_1.purry)(_times, arguments);\n}\nexports.times = times;\nfunction _times(count, fn) {\n    if (count < 0) {\n        throw new RangeError('n must be a non-negative number');\n    }\n    var res = [];\n    for (var i = 0; i < count; i++) {\n        res.push(fn(i));\n    }\n    return res;\n}\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.uniq = void 0;\nvar purry_1 = require(\"./purry\");\nvar _reduceLazy_1 = require(\"./_reduceLazy\");\nfunction uniq() {\n    return (0, purry_1.purry)(_uniq, arguments, uniq.lazy);\n}\nexports.uniq = uniq;\nfunction _uniq(array) {\n    return (0, _reduceLazy_1._reduceLazy)(array, uniq.lazy());\n}\n(function (uniq) {\n    function lazy() {\n        var set = new Set();\n        return function (value) {\n            if (set.has(value)) {\n                return {\n                    done: false,\n                    hasNext: false,\n                };\n            }\n            set.add(value);\n            return {\n                done: false,\n                hasNext: true,\n                next: value,\n            };\n        };\n    }\n    uniq.lazy = lazy;\n})(uniq || (exports.uniq = uniq = {}));\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.uniqBy = void 0;\nvar purry_1 = require(\"./purry\");\nvar _reduceLazy_1 = require(\"./_reduceLazy\");\nfunction uniqBy() {\n    return (0, purry_1.purry)(_uniqBy, arguments, lazyUniqBy);\n}\nexports.uniqBy = uniqBy;\nfunction _uniqBy(array, transformer) {\n    return (0, _reduceLazy_1._reduceLazy)(array, lazyUniqBy(transformer));\n}\nfunction lazyUniqBy(transformer) {\n    var set = new Set();\n    return function (value) {\n        var appliedItem = transformer(value);\n        if (set.has(appliedItem)) {\n            return {\n                done: false,\n                hasNext: false,\n            };\n        }\n        set.add(appliedItem);\n        return {\n            done: false,\n            hasNext: true,\n            next: value,\n        };\n    };\n}\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.uniqWith = void 0;\nvar purry_1 = require(\"./purry\");\nvar _reduceLazy_1 = require(\"./_reduceLazy\");\nvar _toLazyIndexed_1 = require(\"./_toLazyIndexed\");\nfunction uniqWith() {\n    return (0, purry_1.purry)(_uniqWith, arguments, uniqWith.lazy);\n}\nexports.uniqWith = uniqWith;\nfunction _uniqWith(array, isEquals) {\n    var lazy = uniqWith.lazy(isEquals);\n    return (0, _reduceLazy_1._reduceLazy)(array, lazy, true);\n}\nfunction _lazy(isEquals) {\n    return function (value, index, array) {\n        if (array &&\n            array.findIndex(function (otherValue) { return isEquals(value, otherValue); }) === index) {\n            return {\n                done: false,\n                hasNext: true,\n                next: value,\n            };\n        }\n        return {\n            done: false,\n            hasNext: false,\n        };\n    };\n}\n(function (uniqWith) {\n    uniqWith.lazy = (0, _toLazyIndexed_1._toLazyIndexed)(_lazy);\n})(uniqWith || (exports.uniqWith = uniqWith = {}));\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.values = void 0;\nfunction values(source) {\n    return Object.values(source);\n}\nexports.values = values;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.zip = void 0;\nvar purry_1 = require(\"./purry\");\nfunction zip() {\n    return (0, purry_1.purry)(_zip, arguments);\n}\nexports.zip = zip;\nfunction _zip(first, second) {\n    var resultLength = first.length > second.length ? second.length : first.length;\n    var result = [];\n    for (var i = 0; i < resultLength; i++) {\n        result.push([first[i], second[i]]);\n    }\n    return result;\n}\n(function (zip) {\n    zip.strict = zip;\n})(zip || (exports.zip = zip = {}));\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.zipObj = void 0;\nvar purry_1 = require(\"./purry\");\nfunction zipObj() {\n    return (0, purry_1.purry)(_zipObj, arguments);\n}\nexports.zipObj = zipObj;\nfunction _zipObj(first, second) {\n    var resultLength = first.length > second.length ? second.length : first.length;\n    var result = {};\n    for (var i = 0; i < resultLength; i++) {\n        result[first[i]] = second[i];\n    }\n    return result;\n}\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.zipWith = void 0;\nfunction zipWith() {\n    var args = Array.from(arguments);\n    if (typeof args[0] === 'function' && args.length === 1) {\n        return function (f, s) {\n            return _zipWith(f, s, args[0]);\n        };\n    }\n    if (typeof args[0] === 'function' && args.length === 2) {\n        return function (f) {\n            return _zipWith(f, args[1], args[0]);\n        };\n    }\n    if (args.length === 3) {\n        return _zipWith(args[0], args[1], args[2]);\n    }\n}\nexports.zipWith = zipWith;\nfunction _zipWith(first, second, fn) {\n    var resultLength = first.length > second.length ? second.length : first.length;\n    var result = [];\n    for (var i = 0; i < resultLength; i++) {\n        result.push(fn(first[i], second[i]));\n    }\n    return result;\n}\n", "\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __exportStar = (this && this.__exportStar) || function(m, exports) {\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(exports, p)) __createBinding(exports, m, p);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\n__exportStar(require(\"./add\"), exports);\n__exportStar(require(\"./addProp\"), exports);\n__exportStar(require(\"./allPass\"), exports);\n__exportStar(require(\"./anyPass\"), exports);\n__exportStar(require(\"./ceil\"), exports);\n__exportStar(require(\"./chunk\"), exports);\n__exportStar(require(\"./clamp\"), exports);\n__exportStar(require(\"./clone\"), exports);\n__exportStar(require(\"./compact\"), exports);\n__exportStar(require(\"./concat\"), exports);\n__exportStar(require(\"./conditional\"), exports);\n__exportStar(require(\"./countBy\"), exports);\n__exportStar(require(\"./createPipe\"), exports);\n__exportStar(require(\"./debounce\"), exports);\n__exportStar(require(\"./difference\"), exports);\n__exportStar(require(\"./differenceWith\"), exports);\n__exportStar(require(\"./divide\"), exports);\n__exportStar(require(\"./drop\"), exports);\n__exportStar(require(\"./dropFirstBy\"), exports);\n__exportStar(require(\"./dropLast\"), exports);\n__exportStar(require(\"./dropLastWhile\"), exports);\n__exportStar(require(\"./dropWhile\"), exports);\n__exportStar(require(\"./equals\"), exports);\n__exportStar(require(\"./evolve\"), exports);\n__exportStar(require(\"./filter\"), exports);\n__exportStar(require(\"./find\"), exports);\n__exportStar(require(\"./findIndex\"), exports);\n__exportStar(require(\"./findLast\"), exports);\n__exportStar(require(\"./findLastIndex\"), exports);\n__exportStar(require(\"./first\"), exports);\n__exportStar(require(\"./firstBy\"), exports);\n__exportStar(require(\"./flatMap\"), exports);\n__exportStar(require(\"./flatMapToObj\"), exports);\n__exportStar(require(\"./flatten\"), exports);\n__exportStar(require(\"./flattenDeep\"), exports);\n__exportStar(require(\"./floor\"), exports);\n__exportStar(require(\"./forEach\"), exports);\n__exportStar(require(\"./forEachObj\"), exports);\n__exportStar(require(\"./fromPairs\"), exports);\n__exportStar(require(\"./groupBy\"), exports);\n__exportStar(require(\"./hasAtLeast\"), exports);\n__exportStar(require(\"./identity\"), exports);\n__exportStar(require(\"./indexBy\"), exports);\n__exportStar(require(\"./intersection\"), exports);\n__exportStar(require(\"./intersectionWith\"), exports);\n__exportStar(require(\"./invert\"), exports);\n__exportStar(require(\"./isArray\"), exports);\n__exportStar(require(\"./isBoolean\"), exports);\n__exportStar(require(\"./isDate\"), exports);\n__exportStar(require(\"./isDefined\"), exports);\n__exportStar(require(\"./isEmpty\"), exports);\n__exportStar(require(\"./isError\"), exports);\n__exportStar(require(\"./isFunction\"), exports);\n__exportStar(require(\"./isNil\"), exports);\n__exportStar(require(\"./isNonNull\"), exports);\n__exportStar(require(\"./isNot\"), exports);\n__exportStar(require(\"./isNumber\"), exports);\n__exportStar(require(\"./isObject\"), exports);\n__exportStar(require(\"./isObjectType\"), exports);\n__exportStar(require(\"./isPlainObject\"), exports);\n__exportStar(require(\"./isPromise\"), exports);\n__exportStar(require(\"./isString\"), exports);\n__exportStar(require(\"./isSymbol\"), exports);\n__exportStar(require(\"./isTruthy\"), exports);\n__exportStar(require(\"./join\"), exports);\n__exportStar(require(\"./keys\"), exports);\n__exportStar(require(\"./last\"), exports);\n__exportStar(require(\"./length\"), exports);\n__exportStar(require(\"./map\"), exports);\n__exportStar(require(\"./mapKeys\"), exports);\n__exportStar(require(\"./mapToObj\"), exports);\n__exportStar(require(\"./mapValues\"), exports);\n__exportStar(require(\"./maxBy\"), exports);\n__exportStar(require(\"./meanBy\"), exports);\n__exportStar(require(\"./merge\"), exports);\n__exportStar(require(\"./mergeAll\"), exports);\n__exportStar(require(\"./mergeDeep\"), exports);\n__exportStar(require(\"./minBy\"), exports);\n__exportStar(require(\"./multiply\"), exports);\n__exportStar(require(\"./noop\"), exports);\n__exportStar(require(\"./nthBy\"), exports);\n__exportStar(require(\"./objOf\"), exports);\n__exportStar(require(\"./omit\"), exports);\n__exportStar(require(\"./omitBy\"), exports);\n__exportStar(require(\"./once\"), exports);\n__exportStar(require(\"./only\"), exports);\n__exportStar(require(\"./partition\"), exports);\n__exportStar(require(\"./pathOr\"), exports);\n__exportStar(require(\"./pick\"), exports);\n__exportStar(require(\"./pickBy\"), exports);\n__exportStar(require(\"./pipe\"), exports);\n__exportStar(require(\"./prop\"), exports);\n__exportStar(require(\"./purry\"), exports);\n__exportStar(require(\"./randomString\"), exports);\n__exportStar(require(\"./range\"), exports);\n__exportStar(require(\"./rankBy\"), exports);\n__exportStar(require(\"./reduce\"), exports);\n__exportStar(require(\"./reject\"), exports);\n__exportStar(require(\"./reverse\"), exports);\n__exportStar(require(\"./round\"), exports);\n__exportStar(require(\"./sample\"), exports);\n__exportStar(require(\"./set\"), exports);\n__exportStar(require(\"./setPath\"), exports);\n__exportStar(require(\"./shuffle\"), exports);\n__exportStar(require(\"./sliceString\"), exports);\n__exportStar(require(\"./sort\"), exports);\n__exportStar(require(\"./sortBy\"), exports);\n__exportStar(require(\"./sortedIndex\"), exports);\n__exportStar(require(\"./sortedIndexBy\"), exports);\n__exportStar(require(\"./sortedIndexWith\"), exports);\n__exportStar(require(\"./sortedLastIndex\"), exports);\n__exportStar(require(\"./sortedLastIndexBy\"), exports);\n__exportStar(require(\"./splice\"), exports);\n__exportStar(require(\"./splitAt\"), exports);\n__exportStar(require(\"./splitWhen\"), exports);\n__exportStar(require(\"./stringToPath\"), exports);\n__exportStar(require(\"./subtract\"), exports);\n__exportStar(require(\"./sumBy\"), exports);\n__exportStar(require(\"./swapIndices\"), exports);\n__exportStar(require(\"./swapProps\"), exports);\n__exportStar(require(\"./take\"), exports);\n__exportStar(require(\"./takeFirstBy\"), exports);\n__exportStar(require(\"./takeLastWhile\"), exports);\n__exportStar(require(\"./takeWhile\"), exports);\n__exportStar(require(\"./tap\"), exports);\n__exportStar(require(\"./times\"), exports);\n__exportStar(require(\"./toPairs\"), exports);\n__exportStar(require(\"./type\"), exports);\n__exportStar(require(\"./uniq\"), exports);\n__exportStar(require(\"./uniqBy\"), exports);\n__exportStar(require(\"./uniqWith\"), exports);\n__exportStar(require(\"./values\"), exports);\n__exportStar(require(\"./zip\"), exports);\n__exportStar(require(\"./zipObj\"), exports);\n__exportStar(require(\"./zipWith\"), exports);\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.isPlayedActor = exports.isOwner = exports.getOwner = exports.getHighestName = void 0;\nfunction isPlayedActor(actor) {\n    return !!actor?.id && !actor.pack && game.actors.has(actor.id);\n}\nexports.isPlayedActor = isPlayedActor;\nfunction getHighestName(actor) {\n    return actor.token?.name ?? actor.prototypeToken?.name ?? actor.name;\n}\nexports.getHighestName = getHighestName;\nfunction getOwner(actor) {\n    const isValidUser = (user) => user.active && !user.isGM;\n    let owners = game.users.filter((user) => isValidUser(user) && user.character === actor);\n    if (!owners.length) {\n        owners = game.users.filter((user) => isValidUser(user) && actor.testUserPermission(user, \"OWNER\"));\n    }\n    owners.sort((a, b) => (a.id > b.id ? 1 : -1));\n    return owners[0] || null;\n}\nexports.getOwner = getOwner;\nfunction isOwner(actor) {\n    return getOwner(actor) === game.user;\n}\nexports.isOwner = isOwner;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.renderApplication = exports.canRender = exports.refreshApplication = exports.openApplication = void 0;\nfunction openApplication(constructor, ...args) {\n    const id = args.at(-1).id;\n    const app = Object.values(ui.windows).find((a) => a instanceof constructor && a.id === id);\n    if (app) {\n        app.bringToTop();\n        return app;\n    }\n    return new constructor(...args).render(true);\n}\nexports.openApplication = openApplication;\nfunction refreshApplication(app) {\n    app.setPosition({ height: \"auto\" });\n}\nexports.refreshApplication = refreshApplication;\nfunction canRender(app, force) {\n    return force || app._state <= Application.RENDER_STATES.NONE;\n}\nexports.canRender = canRender;\nfunction renderApplication(id) {\n    const app = Object.values(ui.windows).find((app) => app.id === id);\n    app?.render();\n}\nexports.renderApplication = renderApplication;\n", "\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.getOnly = exports.compareArrays = exports.arrayIncludesOne = void 0;\nconst R = __importStar(require(\"remeda\"));\nfunction arrayIncludesOne(array, other) {\n    return other.some((value) => array.includes(value));\n}\nexports.arrayIncludesOne = arrayIncludesOne;\nfunction compareArrays(arr1, arr2, unique = false) {\n    arr1 = unique ? R.compact(arr1) : arr1;\n    arr2 = unique ? R.compact(arr2) : arr2.slice();\n    if (arr1.length !== arr2.length)\n        return false;\n    for (const value1 of arr1) {\n        const index = arr2.findIndex((value2) => value1 === value2);\n        if (index === -1)\n            return false;\n        arr2.splice(index, 1);\n    }\n    return true;\n}\nexports.compareArrays = compareArrays;\nfunction getOnly(collection, condition) {\n    if (!collection)\n        return;\n    const isArray = Array.isArray(collection);\n    if ((isArray && collection.length !== 1) || (!isArray && collection.size !== 1))\n        return;\n    const value = isArray ? collection[0] : collection.first();\n    if (!value)\n        return;\n    return ((!condition || condition(value)) && value) || undefined;\n}\nexports.getOnly = getOnly;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.getDropTarget = void 0;\nfunction getDropTarget(canvas, data, filter) {\n    return [...canvas.tokens.placeables]\n        .sort((a, b) => b.document.sort - a.document.sort)\n        .find((token) => {\n        if (filter && !filter(token))\n            return false;\n        const maximumX = token.x + (token.hitArea?.right ?? 0);\n        const maximumY = token.y + (token.hitArea?.bottom ?? 0);\n        return (data.x >= token.x && data.y >= token.y && data.x <= maximumX && data.y <= maximumY);\n    });\n}\nexports.getDropTarget = getDropTarget;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.latestChatMessages = exports.refreshLatestMessages = exports.createChatLink = void 0;\nfunction createChatLink(docOrUuid, { label, html } = {}) {\n    const isDocument = docOrUuid instanceof foundry.abstract.Document;\n    if (!label && isDocument) {\n        label = docOrUuid.name;\n    }\n    let link = `@UUID[${isDocument ? docOrUuid.uuid : docOrUuid}]`;\n    if (label) {\n        link = `${link}{${label}}`;\n    }\n    return html ? TextEditor.enrichHTML(link) : link;\n}\nexports.createChatLink = createChatLink;\nfunction* latestChatMessages(nb, fromMessage) {\n    const chat = ui.chat?.element;\n    if (!chat)\n        return;\n    const messages = game.messages.contents;\n    const start = (fromMessage ? messages.findLastIndex((m) => m === fromMessage) : messages.length) - 1;\n    for (let i = start; i >= start - nb; i--) {\n        const message = messages[i];\n        if (!message)\n            return;\n        const li = chat.find(`[data-message-id=${message.id}]`);\n        if (!li.length)\n            continue;\n        yield { message, li };\n    }\n}\nexports.latestChatMessages = latestChatMessages;\nasync function refreshLatestMessages(nb) {\n    for (const { message, li } of latestChatMessages(20)) {\n        const html = await message.getHTML();\n        li.replaceWith(html);\n    }\n}\nexports.refreshLatestMessages = refreshLatestMessages;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.createTimeout = void 0;\nfunction createTimeout(callback, delay = 1) {\n    let timeoutId = null;\n    const cancel = () => {\n        if (timeoutId === null)\n            return;\n        clearTimeout(timeoutId);\n        timeoutId = null;\n    };\n    const fn = (...args) => {\n        if (timeoutId !== null) {\n            cancel();\n        }\n        if (delay < 1) {\n            callback(...args);\n        }\n        else {\n            timeoutId = setTimeout(callback, delay, ...args);\n        }\n    };\n    Object.defineProperty(fn, \"start\", {\n        value: (delay, ...args) => {\n            if (timeoutId !== null) {\n                cancel();\n            }\n            if (delay < 1) {\n                callback(...args);\n            }\n            else {\n                timeoutId = setTimeout(callback, delay, ...args);\n            }\n        },\n        enumerable: false,\n        configurable: false,\n    });\n    Object.defineProperty(fn, \"cancel\", {\n        value: cancel,\n        enumerable: false,\n        configurable: false,\n    });\n    return fn;\n}\nexports.createTimeout = createTimeout;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.waitDialog = void 0;\nconst _1 = require(\".\");\nasync function waitDialog(options) {\n    const yesIcon = options.yes.icon ?? \"fa-solid fa-check\";\n    const noIcon = options.no.icon ?? \"fa-solid fa-xmark\";\n    const buttons = {\n        yes: {\n            icon: `<i class='${yesIcon}'></i>`,\n            label: options.yes.label,\n            callback: options.yes.callback,\n        },\n        no: {\n            icon: `<i class='${noIcon}'></i>`,\n            label: options.no.label,\n            callback: options.no.callback ?? (() => null),\n        },\n    };\n    const content = await (0, _1.render)(options.template, options.data);\n    return Dialog.wait({\n        title: options.title,\n        content,\n        buttons,\n        default: options.default ?? \"yes\",\n        close: () => null,\n    }, {\n        id: options.id,\n    });\n}\nexports.waitDialog = waitDialog;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.getSortBounds = exports.getSourceIdCondition = exports.getSourceId = void 0;\nfunction getSourceId(doc) {\n    return doc.getFlag(\"core\", \"sourceId\");\n}\nexports.getSourceId = getSourceId;\nfunction includesSourceId(doc, list) {\n    const sourceId = getSourceId(doc);\n    return sourceId ? list.includes(sourceId) : false;\n}\nfunction getSourceIdCondition(sourceId) {\n    return Array.isArray(sourceId)\n        ? (item) => includesSourceId(item, sourceId)\n        : (item) => getSourceId(item) === sourceId;\n}\nexports.getSourceIdCondition = getSourceIdCondition;\nfunction getSortBounds(collection) {\n    let min = 0;\n    let max = 0;\n    for (const entry of collection) {\n        if (entry.sort > max)\n            max = entry.sort;\n        else if (entry.sort < min)\n            min = entry.sort;\n    }\n    return { min, max };\n}\nexports.getSortBounds = getSortBounds;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.withEventManager = void 0;\nfunction withEventManager(constructor) {\n    let _id = 1;\n    let _listeners = {};\n    return class extends constructor {\n        registerListener(event, listener, options) {\n            _listeners[event] ??= [];\n            const id = _id++;\n            _listeners[event].push({\n                id,\n                listener,\n                once: typeof options === \"boolean\" ? options : options?.once ?? false,\n                context: typeof options === \"object\" ? options.context : undefined,\n            });\n            return id;\n        }\n        removeListener(event, listener) {\n            const findFn = typeof listener === \"number\"\n                ? (x) => x.id === listener\n                : (x) => x.listener === listener;\n            const index = _listeners[event]?.findIndex(findFn) ?? -1;\n            if (index === -1)\n                return false;\n            _listeners[event].splice(index, 1);\n            return true;\n        }\n        emitEvent(event, ...args) {\n            const listeners = _listeners[event];\n            if (!listeners)\n                return;\n            for (const { listener, once, context, id } of listeners) {\n                if (context) {\n                    listener.apply(context, args);\n                }\n                else {\n                    listener(...args);\n                }\n                if (once) {\n                    this.removeListener(event, id);\n                }\n            }\n        }\n        purgeListeners() {\n            _listeners = {};\n        }\n    };\n}\nexports.withEventManager = withEventManager;\n", "\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.updateSourceFlag = exports.updateFlag = exports.unsetMofuleFlag = exports.unsetFlag = exports.setFlagProperty = exports.setFlag = exports.hasModuleFlag = exports.getFlagProperty = exports.getModuleFlag = exports.getFlag = exports.flagPath = void 0;\nconst R = __importStar(require(\"remeda\"));\nconst _1 = require(\".\");\nfunction getFlag(doc, ...path) {\n    return doc.getFlag(_1.MODULE.id, path.join(\".\"));\n}\nexports.getFlag = getFlag;\nfunction setFlag(doc, ...args) {\n    const value = args.pop();\n    return doc.setFlag(_1.MODULE.id, args.join(\".\"), value);\n}\nexports.setFlag = setFlag;\nfunction unsetFlag(doc, ...path) {\n    return doc.unsetFlag(_1.MODULE.id, path.join(\".\"));\n}\nexports.unsetFlag = unsetFlag;\nfunction flagPath(...path) {\n    return `flags.${_1.MODULE.path(path)}`;\n}\nexports.flagPath = flagPath;\nfunction updateFlag(doc, updates) {\n    const pathed = R.mapKeys(updates, (key) => flagPath(key));\n    return doc.update(pathed);\n}\nexports.updateFlag = updateFlag;\nfunction updateSourceFlag(doc, ...args) {\n    const value = args.pop();\n    return doc.updateSource({\n        [flagPath(...args)]: value,\n    });\n}\nexports.updateSourceFlag = updateSourceFlag;\nfunction getFlagProperty(obj, ...path) {\n    return getProperty(obj, flagPath(...path));\n}\nexports.getFlagProperty = getFlagProperty;\nfunction setFlagProperty(obj, ...args) {\n    const value = args.pop();\n    setProperty(obj, flagPath(...args), value);\n    return obj;\n}\nexports.setFlagProperty = setFlagProperty;\nfunction getModuleFlag(doc) {\n    return getProperty(doc, `flags.${_1.MODULE.id}`);\n}\nexports.getModuleFlag = getModuleFlag;\nfunction hasModuleFlag(doc) {\n    return getModuleFlag(doc) !== undefined;\n}\nexports.hasModuleFlag = hasModuleFlag;\nfunction unsetMofuleFlag(doc) {\n    return doc.update({\n        [`flags.-=${_1.MODULE.id}`]: true,\n    });\n}\nexports.unsetMofuleFlag = unsetMofuleFlag;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.render = exports.templatePath = void 0;\nconst _1 = require(\".\");\nfunction templatePath(...path) {\n    return `modules/${_1.MODULE.id}/templates/${(0, _1.joinStr)(\"/\", path)}.hbs`;\n}\nexports.templatePath = templatePath;\nfunction render(...args) {\n    const data = typeof args.at(-1) === \"object\" ? args.pop() : {};\n    const path = templatePath(...args);\n    return renderTemplate(path, data);\n}\nexports.render = render;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.registerUpstreamHook = exports.createHook = void 0;\nfunction registerUpstreamHook(event, listener) {\n    const id = Hooks.on(event, listener);\n    const index = Hooks.events[event].findIndex((x) => x.id === id);\n    if (index !== 0) {\n        const [hooked] = Hooks.events[event].splice(index, 1);\n        Hooks.events[event].unshift(hooked);\n    }\n    return id;\n}\nexports.registerUpstreamHook = registerUpstreamHook;\nfunction createHook(hook, listener) {\n    let hookId = null;\n    return {\n        activate() {\n            if (hookId !== null)\n                return;\n            hookId = Hooks.on(hook, listener);\n        },\n        disable() {\n            if (hookId === null)\n                return;\n            Hooks.off(hook, hookId);\n            hookId = null;\n        },\n        toggle(enabled) {\n            if (enabled)\n                this.activate();\n            else\n                this.disable();\n        },\n    };\n}\nexports.createHook = createHook;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.queryInParent = exports.queryInClosest = exports.querySelectorArray = exports.querySelector = exports.prependHTMLFromString = exports.parentElement = exports.isCheckboxElement = exports.htmlElement = exports.elementData = exports.dataToDatasetString = exports.createHTMLFromString = exports.closest = exports.beforeHTMLFromString = exports.appendHTMLFromString = exports.afterHTMLFromString = exports.addListenerAll = exports.addListener = void 0;\nfunction htmlElement(el) {\n    return el instanceof HTMLElement ? el : el[0];\n}\nexports.htmlElement = htmlElement;\nfunction isCheckboxElement(el) {\n    return el instanceof HTMLInputElement && el.type === \"checkbox\";\n}\nexports.isCheckboxElement = isCheckboxElement;\nfunction createHTMLFromString(content, wrap = true) {\n    const tmp = document.createElement(\"div\");\n    tmp.innerHTML = content;\n    const children = tmp.children;\n    return (children.length === 1 ? children[0] : wrap ? tmp : children);\n}\nexports.createHTMLFromString = createHTMLFromString;\nfunction applyHtmlMethod(fn, children, context) {\n    const fnc = context ? fn.bind(context) : fn;\n    if (children instanceof HTMLCollection) {\n        fnc(...children);\n    }\n    else {\n        fnc(children);\n    }\n}\nfunction insertHTMLFromString(parent, content, prepend = false) {\n    if (!parent)\n        return;\n    const html = createHTMLFromString(content, false);\n    applyHtmlMethod(prepend ? parent.prepend : parent.append, html, parent);\n    return html;\n}\nfunction appendHTMLFromString(parent, content) {\n    return insertHTMLFromString(parent, content, false);\n}\nexports.appendHTMLFromString = appendHTMLFromString;\nfunction prependHTMLFromString(parent, content) {\n    return insertHTMLFromString(parent, content, true);\n}\nexports.prependHTMLFromString = prependHTMLFromString;\nfunction beforeHTMLFromString(element, content) {\n    if (!element)\n        return;\n    const html = createHTMLFromString(content, false);\n    applyHtmlMethod(element.before, html, element);\n    return html;\n}\nexports.beforeHTMLFromString = beforeHTMLFromString;\nfunction afterHTMLFromString(element, content) {\n    if (!element)\n        return;\n    const html = createHTMLFromString(content, false);\n    applyHtmlMethod(element.after, html, element);\n    return html;\n}\nexports.afterHTMLFromString = afterHTMLFromString;\nfunction addListener(parent, selector, arg1, arg2, arg3) {\n    const element = parent.querySelector(selector);\n    if (!element)\n        return;\n    const event = typeof arg1 === \"string\" ? arg1 : \"click\";\n    const listener = typeof arg1 === \"function\" ? arg1 : arg2;\n    const useCapture = typeof arg2 === \"boolean\" ? arg2 : arg3;\n    element.addEventListener(event, (e) => listener(e, element), useCapture);\n    return element;\n}\nexports.addListener = addListener;\nfunction addListenerAll(parent, selector, arg1, arg2) {\n    const elements = parent.querySelectorAll(selector);\n    const event = typeof arg1 === \"string\" ? arg1 : \"click\";\n    const listener = typeof arg1 === \"function\" ? arg1 : arg2;\n    for (const element of elements) {\n        element.addEventListener(event, (e) => listener(e, element));\n    }\n    return elements;\n}\nexports.addListenerAll = addListenerAll;\nfunction querySelector(parent, selector) {\n    if (!parent)\n        return null;\n    return parent.querySelector(selector);\n}\nexports.querySelector = querySelector;\nfunction querySelectorArray(parent, selector) {\n    if (!parent)\n        return [];\n    return Array.from(parent.querySelectorAll(selector));\n}\nexports.querySelectorArray = querySelectorArray;\nfunction queryInClosest(el, parentSelector, childSelector) {\n    const parent = closest(el, parentSelector);\n    return querySelector(parent, childSelector);\n}\nexports.queryInClosest = queryInClosest;\nfunction queryInParent(el, childSelector) {\n    return querySelector(el.parentElement, childSelector);\n}\nexports.queryInParent = queryInParent;\nfunction closest(el, selector) {\n    if (!el)\n        return null;\n    return el.closest(selector);\n}\nexports.closest = closest;\nfunction parentElement(el) {\n    return el.parentElement;\n}\nexports.parentElement = parentElement;\nfunction elementData(el) {\n    return el.dataset;\n}\nexports.elementData = elementData;\nfunction dataToDatasetString(data) {\n    return Object.entries(data)\n        .map(([key, value]) => {\n        const stringified = typeof value === \"object\" ? JSON.stringify(value) : value;\n        return `data-${key}='${stringified}'`;\n    })\n        .join(\" \");\n}\nexports.dataToDatasetString = dataToDatasetString;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.getItems = exports.hasItemWithSourceId = exports.getItemWithSourceId = void 0;\nconst _1 = require(\".\");\nfunction getItems(actor, itemTypes = []) {\n    const types = typeof itemTypes === \"string\" ? [itemTypes] : itemTypes;\n    return types.length ? types.flatMap((type) => actor.itemTypes[type]) : actor.items;\n}\nexports.getItems = getItems;\nfunction hasItemWithSourceId(actor, sourceId, itemTypes) {\n    return getItems(actor, itemTypes).some((0, _1.getSourceIdCondition)(sourceId));\n}\nexports.hasItemWithSourceId = hasItemWithSourceId;\nfunction getItemWithSourceId(actor, sourceId, itemTypes) {\n    return getItems(actor, itemTypes).find((0, _1.getSourceIdCondition)(sourceId));\n}\nexports.getItemWithSourceId = getItemWithSourceId;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.subLocalize = exports.templateLocalize = exports.localizePath = exports.hasLocalization = exports.localizeIfExist = exports.localize = exports.localeCompare = void 0;\nconst _1 = require(\".\");\nfunction localize(...args) {\n    args.unshift(_1.MODULE.id);\n    const data = typeof args.at(-1) === \"object\" ? args.pop() : undefined;\n    const path = (0, _1.joinStr)(\".\", args);\n    if (typeof data === \"object\") {\n        return game.i18n.format(path, data);\n    }\n    return game.i18n.localize(path);\n}\nexports.localize = localize;\nfunction localizeIfExist(...args) {\n    args.unshift(_1.MODULE.id);\n    const data = typeof args.at(-1) === \"object\" ? args.pop() : undefined;\n    const path = (0, _1.joinStr)(\".\", args);\n    if (!game.i18n.has(path, false))\n        return;\n    if (typeof data === \"object\") {\n        return game.i18n.format(path, data);\n    }\n    return game.i18n.localize(path);\n}\nexports.localizeIfExist = localizeIfExist;\nfunction hasLocalization(...path) {\n    return game.i18n.has(`${_1.MODULE.path(path)}`, false);\n}\nexports.hasLocalization = hasLocalization;\nfunction localizePath(...path) {\n    return _1.MODULE.path(path);\n}\nexports.localizePath = localizePath;\nfunction templateLocalize(subKey) {\n    const fn = (key, { hash }) => localize(subKey, key, hash);\n    Object.defineProperties(fn, {\n        path: {\n            value: (key) => localizePath(subKey, key),\n            enumerable: false,\n            configurable: false,\n        },\n        sub: {\n            value: (key) => {\n                const joinedKey = subKey ? `${subKey}.${key}` : key;\n                return subLocalize(joinedKey).i18n;\n            },\n            enumerable: false,\n            configurable: false,\n        },\n    });\n    return fn;\n}\nexports.templateLocalize = templateLocalize;\nfunction subLocalize(subKey) {\n    const fn = (...args) => localize(subKey, ...args);\n    Object.defineProperties(fn, {\n        ifExist: {\n            value: (...args) => localizeIfExist(subKey, ...args),\n            enumerable: false,\n            configurable: false,\n        },\n        warn: {\n            value: (str, arg1, arg2) => (0, _1.warn)(`${subKey}.${str}`, arg1, arg2),\n            enumerable: false,\n            configurable: false,\n        },\n        info: {\n            value: (str, arg1, arg2) => (0, _1.info)(`${subKey}.${str}`, arg1, arg2),\n            enumerable: false,\n            configurable: false,\n        },\n        error: {\n            value: (str, arg1, arg2) => (0, _1.error)(`${subKey}.${str}`, arg1, arg2),\n            enumerable: false,\n            configurable: false,\n        },\n        has: {\n            value: (key) => hasLocalization(subKey, key),\n            enumerable: false,\n            configurable: false,\n        },\n        path: {\n            value: (key) => localizePath(subKey, key),\n            enumerable: false,\n            configurable: false,\n        },\n        sub: {\n            value: (key) => subLocalize(`${subKey}.${key}`),\n            enumerable: false,\n            configurable: false,\n        },\n        i18n: {\n            get() {\n                return templateLocalize(subKey);\n            },\n            enumerable: false,\n            configurable: false,\n        },\n    });\n    return fn;\n}\nexports.subLocalize = subLocalize;\nfunction localeCompare(a, b) {\n    return a.localeCompare(b, game.i18n.lang);\n}\nexports.localeCompare = localeCompare;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.getActiveModule = exports.MODULE = void 0;\nconst _1 = require(\".\");\nlet MODULE_ID = \"\";\nlet MODULE_NAME = \"\";\nconst MODULE = {\n    get id() {\n        if (!MODULE_ID) {\n            throw new Error(\"Module needs to be registered.\");\n        }\n        return MODULE_ID;\n    },\n    get name() {\n        if (!MODULE_ID) {\n            throw new Error(\"Module needs to be registered.\");\n        }\n        return MODULE_NAME;\n    },\n    get current() {\n        return game.modules.get(this.id);\n    },\n    throwError(str) {\n        throw new Error(`\\n[${this.name}] ${str}`);\n    },\n    error(str, error) {\n        let message = `[${this.name}] ${str}`;\n        if (error instanceof Error) {\n            message += `\\n${error.message}`;\n        }\n        else if (typeof error === \"string\") {\n            message += `\\n${error}`;\n        }\n        console.error(message);\n    },\n    log(str) {\n        console.log(`[${this.name}] ${str}`);\n    },\n    path(...path) {\n        return `${this.id}.${(0, _1.joinStr)(\".\", ...path)}`;\n    },\n    register(id, name) {\n        if (MODULE_ID) {\n            throw new Error(\"Module was already registered.\");\n        }\n        MODULE_ID = id;\n        MODULE_NAME = name;\n    },\n};\nexports.MODULE = MODULE;\nfunction getActiveModule(name) {\n    const module = game.modules.get(name);\n    return module?.active ? module : undefined;\n}\nexports.getActiveModule = getActiveModule;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.registerKeybind = void 0;\nconst localize_1 = require(\"./localize\");\nconst module_1 = require(\"./module\");\nfunction registerKeybind(name, data) {\n    game.keybindings.register(module_1.MODULE.id, name, {\n        ...data,\n        name: (0, localize_1.localizePath)(\"keybindings\", name, \"name\"),\n        hint: (0, localize_1.localizePath)(\"keybindings\", name, \"hint\"),\n    });\n}\nexports.registerKeybind = registerKeybind;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.unregisterWrapper = exports.registerWrapper = exports.createWrapper = void 0;\nconst _1 = require(\".\");\nfunction registerWrapper(path, fn, type) {\n    const ids = [];\n    const paths = Array.isArray(path) ? path : [path];\n    for (const key of paths) {\n        const id = libWrapper.register(_1.MODULE.id, key, fn, type);\n        ids.push(id);\n    }\n    // @ts-ignore\n    return ids.length === 1 ? ids[0] : ids;\n}\nexports.registerWrapper = registerWrapper;\nfunction unregisterWrapper(id) {\n    libWrapper.unregister(_1.MODULE.id, id);\n}\nexports.unregisterWrapper = unregisterWrapper;\nfunction createWrapper(path, callback, type, options) {\n    let wrapperId = null;\n    return {\n        activate() {\n            if (wrapperId !== null)\n                return;\n            //  @ts-ignore\n            wrapperId = registerWrapper(path, callback, type ?? \"WRAPPER\");\n            options?.onActivate?.();\n        },\n        disable() {\n            if (wrapperId === null)\n                return;\n            unregisterWrapper(wrapperId);\n            wrapperId = null;\n            options?.onDisable?.();\n        },\n        toggle(enabled) {\n            if (enabled)\n                this.activate();\n            else\n                this.disable();\n        },\n    };\n}\nexports.createWrapper = createWrapper;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.warn = exports.info = exports.error = void 0;\nconst _1 = require(\".\");\nfunction notify(str, arg1, arg2, arg3) {\n    const type = typeof arg1 === \"string\" ? arg1 : \"info\";\n    const data = typeof arg1 === \"object\" ? arg1 : typeof arg2 === \"object\" ? arg2 : undefined;\n    const permanent = typeof arg1 === \"boolean\" ? arg1 : typeof arg2 === \"boolean\" ? arg2 : arg3 ?? false;\n    ui.notifications.notify((0, _1.localize)(str, data), type, { permanent });\n}\nfunction warn(str, arg1, arg2) {\n    notify(str, \"warning\", arg1, arg2);\n}\nexports.warn = warn;\nfunction info(str, arg1, arg2) {\n    notify(str, \"info\", arg1, arg2);\n}\nexports.info = info;\nfunction error(str, arg1, arg2) {\n    notify(str, \"error\", arg1, arg2);\n}\nexports.error = error;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.setInMemory = exports.getInMemoryAndSetIfNot = exports.getInMemory = exports.isInstanceOf = exports.deleteInMemory = exports.AsyncFunction = void 0;\nconst module_1 = require(\"./module\");\nconst AsyncFunction = Object.getPrototypeOf(async function () { }).constructor;\nexports.AsyncFunction = AsyncFunction;\nfunction isInstanceOf(obj, name) {\n    if (typeof obj !== \"object\")\n        return false;\n    let cursor = Reflect.getPrototypeOf(obj);\n    while (cursor) {\n        if (cursor.constructor.name === name)\n            return true;\n        cursor = Reflect.getPrototypeOf(cursor);\n    }\n    return false;\n}\nexports.isInstanceOf = isInstanceOf;\nfunction getInMemory(obj, ...path) {\n    return getProperty(obj, `modules.${module_1.MODULE.id}.${path.join(\".\")}`);\n}\nexports.getInMemory = getInMemory;\nfunction setInMemory(obj, ...args) {\n    const value = args.pop();\n    return setProperty(obj, `modules.${module_1.MODULE.id}.${args.join(\".\")}`, value);\n}\nexports.setInMemory = setInMemory;\nfunction getInMemoryAndSetIfNot(obj, ...args) {\n    const value = args.pop();\n    const current = getInMemory(obj, ...args);\n    if (current != null)\n        return current;\n    // @ts-ignore\n    const result = typeof value === \"function\" ? value() : value;\n    setInMemory(obj, ...args, result);\n    return result;\n}\nexports.getInMemoryAndSetIfNot = getInMemoryAndSetIfNot;\nfunction deleteInMemory(obj, ...path) {\n    const split = [\"modules\", module_1.MODULE.id, ...path.flatMap((x) => x.split(\".\"))];\n    const last = split.pop();\n    let cursor = obj;\n    for (const key of split) {\n        if (typeof cursor !== \"object\" || !(key in cursor))\n            return true;\n        cursor = cursor[key];\n    }\n    return delete cursor[last];\n}\nexports.deleteInMemory = deleteInMemory;\n", "\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.settingPath = exports.setSetting = exports.registerSettingMenu = exports.registerSetting = exports.isClientSetting = exports.isWorldSetting = exports.isMenuSetting = exports.getSetting = void 0;\nconst R = __importStar(require(\"remeda\"));\nconst _1 = require(\".\");\n/**\n * scope = \"world\"\n *\n * config = true\n */\nfunction registerSetting(options) {\n    if (\"choices\" in options && Array.isArray(options.choices)) {\n        options.choices = R.mapToObj(options.choices, (choice) => [\n            choice,\n            settingPath(options.key, \"choices\", choice),\n        ]);\n    }\n    options.name ??= settingPath(options.key, \"name\");\n    options.hint ??= settingPath(options.key, \"hint\");\n    options.scope ??= \"world\";\n    options.config ??= true;\n    game.settings.register(_1.MODULE.id, options.key, options);\n}\nexports.registerSetting = registerSetting;\nfunction registerSettingMenu(options) {\n    options.name ??= settingPath(\"menus\", options.key, \"name\");\n    options.label ??= settingPath(\"menus\", options.key, \"label\");\n    options.hint ??= settingPath(\"menus\", options.key, \"hint\");\n    options.restricted ??= true;\n    options.icon ??= \"fas fa-cogs\";\n    game.settings.registerMenu(_1.MODULE.id, options.key, options);\n}\nexports.registerSettingMenu = registerSettingMenu;\nfunction settingPath(...path) {\n    return _1.MODULE.path(\"settings\", ...path);\n}\nexports.settingPath = settingPath;\nfunction getSetting(key) {\n    return game.settings.get(_1.MODULE.id, key);\n}\nexports.getSetting = getSetting;\nfunction setSetting(key, value) {\n    return game.settings.set(_1.MODULE.id, key, value);\n}\nexports.setSetting = setSetting;\nfunction isClientSetting(setting) {\n    if (\"restricted\" in setting)\n        return !setting.restricted;\n    return \"scope\" in setting && setting.scope === \"client\";\n}\nexports.isClientSetting = isClientSetting;\nfunction isWorldSetting(setting) {\n    if (\"restricted\" in setting)\n        return !!setting.restricted;\n    return \"scope\" in setting && setting.scope === \"world\";\n}\nexports.isWorldSetting = isWorldSetting;\nfunction isMenuSetting(setting) {\n    return setting.type.prototype instanceof FormApplication;\n}\nexports.isMenuSetting = isMenuSetting;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.socketOn = exports.socketOff = exports.socketEmit = void 0;\nconst module_1 = require(\"./module\");\nfunction socketOn(callback) {\n    game.socket.on(`module.${module_1.MODULE.id}`, callback);\n}\nexports.socketOn = socketOn;\nfunction socketOff(callback) {\n    game.socket.off(`module.${module_1.MODULE.id}`, callback);\n}\nexports.socketOff = socketOff;\nfunction socketEmit(packet) {\n    game.socket.emit(`module.${module_1.MODULE.id}`, packet);\n}\nexports.socketEmit = socketEmit;\n", "\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.stringNumber = exports.stringBoolean = exports.safeSplit = exports.joinStr = exports.beautity = void 0;\nconst R = __importStar(require(\"remeda\"));\nfunction joinStr(separator, ...path) {\n    return R.pipe(path, R.flatten(), R.filter((x) => typeof x === \"string\"), R.join(separator));\n}\nexports.joinStr = joinStr;\nfunction safeSplit(str, selector = \",\") {\n    return str\n        .split(selector)\n        .map((s) => s.trim())\n        .filter(Boolean);\n}\nexports.safeSplit = safeSplit;\nfunction beautity(str) {\n    return str.replaceAll(/[-_.]([a-z])/g, (_, c) => ` ${c.toUpperCase()}`).capitalize();\n}\nexports.beautity = beautity;\nfunction stringBoolean(b) {\n    return String(b);\n}\nexports.stringBoolean = stringBoolean;\nfunction stringNumber(n) {\n    return String(n);\n}\nexports.stringNumber = stringNumber;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.userIsGM = exports.isActiveGM = exports.hasGMOnline = void 0;\nfunction getCurrentUser() {\n    return game.user ?? game.data.users.find((x) => x._id === game.data.userId);\n}\nfunction isActiveGM() {\n    return game.user === game.users.activeGM;\n}\nexports.isActiveGM = isActiveGM;\nfunction userIsGM(user) {\n    user ??= getCurrentUser();\n    return user && user.role >= CONST.USER_ROLES.ASSISTANT;\n}\nexports.userIsGM = userIsGM;\nfunction hasGMOnline() {\n    return game.users.some((user) => user.active && user.isGM);\n}\nexports.hasGMOnline = hasGMOnline;\n", "\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __exportStar = (this && this.__exportStar) || function(m, exports) {\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(exports, p)) __createBinding(exports, m, p);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.isOfType = void 0;\n__exportStar(require(\"./actor\"), exports);\n__exportStar(require(\"./application\"), exports);\n__exportStar(require(\"./array\"), exports);\n__exportStar(require(\"./canvas\"), exports);\n__exportStar(require(\"./chat\"), exports);\n__exportStar(require(\"./delay\"), exports);\n__exportStar(require(\"./dialog\"), exports);\n__exportStar(require(\"./document\"), exports);\n__exportStar(require(\"./event-manager\"), exports);\n__exportStar(require(\"./flags\"), exports);\n__exportStar(require(\"./handlebars\"), exports);\n__exportStar(require(\"./hooks\"), exports);\n__exportStar(require(\"./html\"), exports);\n__exportStar(require(\"./item\"), exports);\n__exportStar(require(\"./keybindings\"), exports);\n__exportStar(require(\"./libwrapper\"), exports);\n__exportStar(require(\"./localize\"), exports);\n__exportStar(require(\"./module\"), exports);\n__exportStar(require(\"./notifications\"), exports);\n__exportStar(require(\"./object\"), exports);\n__exportStar(require(\"./settings\"), exports);\n__exportStar(require(\"./socket\"), exports);\n__exportStar(require(\"./string\"), exports);\n__exportStar(require(\"./user\"), exports);\nfunction isOfType(variable, ...types) {\n    const type = typeof variable;\n    return types.includes(type);\n}\nexports.isOfType = isOfType;\n", "export * as R from \"remeda\";\r\nexport * from \"./dist\";\r\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.tupleHasValue = exports.traitSlugToObject = exports.setHasElement = exports.ordinalString = exports.objectHasKey = exports.localizer = exports.htmlQuery = exports.htmlClosest = exports.getActionGlyph = exports.extractNotes = exports.ErrorPF2e = exports.createHTMLElement = void 0;\nconst foundry_api_1 = require(\"foundry-api\");\nfunction ErrorPF2e(message) {\n    return Error(`PF2e System | ${message}`);\n}\nexports.ErrorPF2e = ErrorPF2e;\nfunction objectHasKey(obj, key) {\n    return (typeof key === \"string\" || typeof key === \"number\") && key in obj;\n}\nexports.objectHasKey = objectHasKey;\nfunction tupleHasValue(array, value) {\n    return array.includes(value);\n}\nexports.tupleHasValue = tupleHasValue;\nfunction setHasElement(set, value) {\n    return set.has(value);\n}\nexports.setHasElement = setHasElement;\nfunction ordinalString(value) {\n    const pluralRules = new Intl.PluralRules(game.i18n.lang, { type: \"ordinal\" });\n    const suffix = game.i18n.localize(`PF2E.OrdinalSuffixes.${pluralRules.select(value)}`);\n    return game.i18n.format(\"PF2E.OrdinalNumber\", { value, suffix });\n}\nexports.ordinalString = ordinalString;\nfunction htmlClosest(child, selectors) {\n    if (!(child instanceof Element))\n        return null;\n    return child.closest(selectors);\n}\nexports.htmlClosest = htmlClosest;\nfunction htmlQuery(parent, selectors) {\n    if (!(parent instanceof Element || parent instanceof Document))\n        return null;\n    return parent.querySelector(selectors);\n}\nexports.htmlQuery = htmlQuery;\nfunction localizer(prefix) {\n    return (...[suffix, formatArgs]) => formatArgs\n        ? game.i18n.format(`${prefix}.${suffix}`, formatArgs)\n        : game.i18n.localize(`${prefix}.${suffix}`);\n}\nexports.localizer = localizer;\nfunction traitSlugToObject(trait, dictionary) {\n    const traitObject = {\n        name: trait,\n        label: game.i18n.localize(dictionary[trait] ?? trait),\n        description: null,\n    };\n    if (objectHasKey(CONFIG.PF2E.traitsDescriptions, trait)) {\n        traitObject.description = CONFIG.PF2E.traitsDescriptions[trait];\n    }\n    return traitObject;\n}\nexports.traitSlugToObject = traitSlugToObject;\nconst actionGlyphMap = {\n    0: \"F\",\n    free: \"F\",\n    1: \"1\",\n    2: \"2\",\n    3: \"3\",\n    \"1 or 2\": \"1/2\",\n    \"1 to 3\": \"1 - 3\",\n    \"2 or 3\": \"2/3\",\n    \"2 rounds\": \"3,3\",\n    reaction: \"R\",\n};\nfunction getActionGlyph(action) {\n    if (!action && action !== 0)\n        return \"\";\n    const value = typeof action !== \"object\" ? action : action.type === \"action\" ? action.value : action.type;\n    const sanitized = String(value ?? \"\")\n        .toLowerCase()\n        .trim();\n    return actionGlyphMap[sanitized]?.replace(\"-\", \"\u2013\") ?? \"\";\n}\nexports.getActionGlyph = getActionGlyph;\nfunction extractNotes(rollNotes, selectors) {\n    return selectors.flatMap((s) => (rollNotes[s] ?? []).map((n) => n.clone()));\n}\nexports.extractNotes = extractNotes;\nfunction createHTMLElement(nodeName, { classes = [], dataset = {}, children = [], innerHTML } = {}) {\n    const element = document.createElement(nodeName);\n    if (classes.length > 0)\n        element.classList.add(...classes);\n    for (const [key, value] of Object.entries(dataset).filter(([, v]) => !foundry_api_1.R.isNil(v) && v !== false)) {\n        element.dataset[key] = value === true ? \"\" : String(value);\n    }\n    if (innerHTML) {\n        element.innerHTML = innerHTML;\n    }\n    else {\n        for (const child of children) {\n            const childElement = child instanceof HTMLElement ? child : new Text(child);\n            element.appendChild(childElement);\n        }\n    }\n    return element;\n}\nexports.createHTMLElement = createHTMLElement;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.transferItemToActor = exports.resetActors = void 0;\nconst foundry_api_1 = require(\"foundry-api\");\nconst utils_1 = require(\"./utils\");\nasync function transferItemToActor(targetActor, item, quantity, containerId, newStack = false) {\n    if (!item.isOfType(\"physical\")) {\n        throw (0, utils_1.ErrorPF2e)(\"Only physical items (with quantities) can be transfered between actors\");\n    }\n    const container = targetActor.inventory.get(containerId ?? \"\");\n    if (container && !container?.isOfType(\"backpack\")) {\n        throw (0, utils_1.ErrorPF2e)(\"containerId refers to a non-container\");\n    }\n    quantity = Math.min(quantity, item.quantity);\n    const newQuantity = item.quantity - quantity;\n    const removeFromSource = newQuantity < 1;\n    if (removeFromSource) {\n        await item.delete();\n    }\n    else {\n        await item.update({ \"system.quantity\": newQuantity });\n    }\n    const newItemData = item.toObject();\n    newItemData.system.quantity = quantity;\n    newItemData.system.equipped.carryType = \"worn\";\n    if (\"invested\" in newItemData.system.equipped) {\n        newItemData.system.equipped.invested = item.traits.has(\"invested\") ? false : null;\n    }\n    return targetActor.addToInventory(newItemData, container, newStack);\n}\nexports.transferItemToActor = transferItemToActor;\nasync function resetActors(actors, options = {}) {\n    actors ??= [\n        game.actors.contents,\n        game.scenes.contents\n            .flatMap((s) => s.tokens.contents)\n            .flatMap((t) => t.actor ?? []),\n    ].flat();\n    actors = foundry_api_1.R.uniq(Array.from(actors));\n    options.sheets ??= true;\n    for (const actor of actors) {\n        actor.reset();\n        if (options.sheets)\n            actor.render();\n    }\n    game.pf2e.effectPanel.refresh();\n    const refreshScenes = game.settings.get(\"pf2e\", \"automation.effectExpiration\") &&\n        !game.settings.get(\"pf2e\", \"automation.removeExpiredEffects\");\n    if (refreshScenes) {\n        const scenes = foundry_api_1.R.uniq(Array.from(actors)\n            .flatMap((a) => a.getActiveTokens(false, true))\n            .flatMap((t) => t.scene));\n        for (const scene of scenes) {\n            scene.reset();\n            if (scene.isView) {\n                canvas.perception.update({ initializeVision: true }, true);\n            }\n        }\n    }\n    if (options.tokens) {\n        for (const token of foundry_api_1.R.uniq(Array.from(actors).flatMap((a) => a.getActiveTokens(true, true)))) {\n            token.simulateUpdate();\n        }\n    }\n}\nexports.resetActors = resetActors;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.renderItemSheets = exports.renderCharacterSheets = exports.renderActorSheets = void 0;\nconst foundry_api_1 = require(\"foundry-api\");\nfunction renderApplication(type) {\n    const types = Array.isArray(type) ? type : [type];\n    const apps = Object.values(ui.windows).filter((app) => types.some((x) => (0, foundry_api_1.isInstanceOf)(app, x)));\n    for (const app of apps) {\n        app.render();\n    }\n}\nfunction renderActorSheets(type = [\"ActorSheetPF2e\"]) {\n    renderApplication(type);\n}\nexports.renderActorSheets = renderActorSheets;\nfunction renderCharacterSheets() {\n    renderActorSheets([\"CharacterSheetPF2e\"]);\n}\nexports.renderCharacterSheets = renderCharacterSheets;\nfunction renderItemSheets(type = [\"ItemSheetPF2e\"]) {\n    renderApplication(type);\n}\nexports.renderItemSheets = renderItemSheets;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.getTabFilterData = exports.filterTraits = void 0;\nfunction getTabFilterData(tabName) {\n    const tab = game.pf2e.compendiumBrowser.tabs[tabName];\n    return deepClone(tab.defaultFilterData ?? tab.filterData);\n}\nexports.getTabFilterData = getTabFilterData;\nfunction filterTraits(traits, selected, condition) {\n    const selectedTraits = selected.filter((s) => !s.not).map((s) => s.value);\n    const notTraits = selected.filter((t) => t.not).map((s) => s.value);\n    if (selectedTraits.length || notTraits.length) {\n        if (notTraits.some((t) => traits.includes(t))) {\n            return false;\n        }\n        const fullfilled = condition === \"and\"\n            ? selectedTraits.every((t) => traits.includes(t))\n            : selectedTraits.some((t) => traits.includes(t));\n        if (!fullfilled)\n            return false;\n    }\n    return true;\n}\nexports.filterTraits = filterTraits;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.extractEphemeralEffects = void 0;\nasync function extractEphemeralEffects({ affects, origin, target, item, domains, options, }) {\n    if (!(origin && target))\n        return [];\n    const [effectsFrom, effectsTo] = affects === \"target\" ? [origin, target] : [target, origin];\n    const fullOptions = [\n        ...options,\n        effectsFrom.getRollOptions(domains),\n        effectsTo.getSelfRollOptions(affects),\n    ].flat();\n    const resolvables = item ? (item.isOfType(\"spell\") ? { spell: item } : { weapon: item }) : {};\n    return (await Promise.all(domains\n        .flatMap((s) => effectsFrom.synthetics.ephemeralEffects[s]?.[affects] ?? [])\n        .map((d) => d({ test: fullOptions, resolvables })))).flatMap((e) => e ?? []);\n}\nexports.extractEphemeralEffects = extractEphemeralEffects;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.toggleOffShieldBlock = exports.selfApplyEffectFromMessage = exports.onClickShieldBlock = exports.createTradeMessage = exports.createTradeContent = exports.applyDamageFromMessage = void 0;\nconst foundry_api_1 = require(\"foundry-api\");\nconst utils_1 = require(\"./utils\");\nconst rules_1 = require(\"./rules\");\nfunction createTradeContent(message, img) {\n    return renderTemplate(\"systems/pf2e/templates/chat/action/content.hbs\", {\n        imgPath: img,\n        message: message.replace(/\\b1 \u00D7 /, \"\"),\n    });\n}\nexports.createTradeContent = createTradeContent;\nasync function createTradeMessage(subtitle, message, actor, item, senderId) {\n    const content = await createTradeContent(message, item.img);\n    return createManipulationMessage(subtitle, content, actor, senderId);\n}\nexports.createTradeMessage = createTradeMessage;\nasync function createManipulationMessage(subtitle, content, actor, senderId) {\n    return ChatMessage.implementation.create({\n        user: senderId ?? game.user.id,\n        speaker: {\n            alias: (0, foundry_api_1.getHighestName)(actor),\n        },\n        flavor: await createManipulateFlavor(subtitle),\n        content: content,\n        type: CONST.CHAT_MESSAGE_TYPES.EMOTE,\n    });\n}\nfunction createManipulateFlavor(subtitle) {\n    return renderTemplate(\"systems/pf2e/templates/chat/action/flavor.hbs\", {\n        action: {\n            title: \"PF2E.Actions.Interact.Title\",\n            subtitle: subtitle,\n            glyph: (0, utils_1.getActionGlyph)(1),\n        },\n        traits: [\n            {\n                name: \"manipulate\",\n                label: CONFIG.PF2E.featTraits.manipulate,\n                description: CONFIG.PF2E.traitsDescriptions.manipulate,\n            },\n        ],\n    });\n}\nasync function applyDamageFromMessage({ message, multiplier = 1, addend = 0, promptModifier = false, rollIndex = 0, \n// added\ntokens, onDamageApplied, }) {\n    if (promptModifier)\n        return shiftAdjustDamage(message, multiplier, rollIndex, \n        // added\n        tokens, onDamageApplied);\n    const html = (0, utils_1.htmlQuery)(ui.chat.element[0], `li.chat-message[data-message-id=\"${message.id}\"]`);\n    // changed\n    tokens ??=\n        html?.dataset.actorIsTarget && message.token\n            ? [message.token]\n            : game.user.getActiveTokens();\n    if (tokens.length === 0) {\n        ui.notifications.error(\"PF2E.ErrorMessage.NoTokenSelected\", { localize: true });\n        return;\n    }\n    const shieldBlockRequest = CONFIG.PF2E.chatDamageButtonShieldToggle;\n    const roll = message.rolls.at(rollIndex);\n    if (!(0, foundry_api_1.isInstanceOf)(roll, \"DamageRoll\"))\n        throw (0, utils_1.ErrorPF2e)(\"Unexpected error retrieving damage roll\");\n    const damage = multiplier < 0 ? multiplier * roll.total + addend : roll.alter(multiplier, addend);\n    const messageRollOptions = [...(message.flags.pf2e.context?.options ?? [])];\n    const originRollOptions = messageRollOptions\n        .filter((o) => o.startsWith(\"self:\"))\n        .map((o) => o.replace(/^self/, \"origin\"));\n    const messageItem = message.item;\n    const effectRollOptions = messageItem?.isOfType(\"affliction\", \"condition\", \"effect\")\n        ? messageItem.getRollOptions(\"item\")\n        : [];\n    for (const token of tokens) {\n        if (!token.actor)\n            continue;\n        if (!messageRollOptions.some((o) => o.startsWith(\"target\"))) {\n            messageRollOptions.push(...token.actor.getSelfRollOptions(\"target\"));\n        }\n        const domain = multiplier > 0 ? \"damage-received\" : \"healing-received\";\n        const ephemeralEffects = multiplier > 0\n            ? await (0, rules_1.extractEphemeralEffects)({\n                affects: \"target\",\n                origin: message.actor,\n                target: token.actor,\n                item: message.item,\n                domains: [domain],\n                options: messageRollOptions,\n            })\n            : [];\n        const contextClone = token.actor.getContextualClone(originRollOptions, ephemeralEffects);\n        const rollOptions = new Set([\n            ...messageRollOptions.filter((o) => !/^(?:self|target):/.test(o)),\n            ...effectRollOptions,\n            ...originRollOptions,\n            ...contextClone.getSelfRollOptions(),\n        ]);\n        await contextClone.applyDamage({\n            damage,\n            token,\n            item: message.item,\n            skipIWR: multiplier <= 0,\n            rollOptions,\n            shieldBlockRequest,\n            outcome: message.flags.pf2e.context?.outcome,\n        });\n    }\n    toggleOffShieldBlock(message.id);\n    // added\n    onDamageApplied?.(message, tokens, rollIndex);\n}\nexports.applyDamageFromMessage = applyDamageFromMessage;\nasync function shiftAdjustDamage(message, multiplier, rollIndex, \n// added\ntokens, onDamageApplied) {\n    const content = await renderTemplate(\"systems/pf2e/templates/chat/damage/adjustment-dialog.hbs\");\n    const AdjustmentDialog = class extends Dialog {\n        activateListeners($html) {\n            super.activateListeners($html);\n            $html[0].querySelector(\"input\")?.focus();\n        }\n    };\n    const isHealing = multiplier < 0;\n    new AdjustmentDialog({\n        title: game.i18n.localize(isHealing ? \"PF2E.UI.shiftModifyHealingTitle\" : \"PF2E.UI.shiftModifyDamageTitle\"),\n        content,\n        buttons: {\n            ok: {\n                label: game.i18n.localize(\"PF2E.OK\"),\n                callback: async ($dialog) => {\n                    const adjustment = (Number($dialog[0].querySelector(\"input\")?.value) || 0) *\n                        Math.sign(multiplier);\n                    applyDamageFromMessage({\n                        message,\n                        multiplier,\n                        addend: adjustment,\n                        promptModifier: false,\n                        rollIndex,\n                        // added\n                        tokens,\n                        onDamageApplied,\n                    });\n                },\n            },\n            cancel: {\n                label: \"Cancel\",\n            },\n        },\n        default: \"ok\",\n        close: () => {\n            toggleOffShieldBlock(message.id);\n        },\n    }).render(true);\n}\nfunction toggleOffShieldBlock(messageId) {\n    for (const app of [\"#chat-log\", \"#chat-popout\"]) {\n        const selector = `${app} > li.chat-message[data-message-id=\"${messageId}\"] button[data-action$=shield-block]`;\n        // changed\n        for (const button of document.body.querySelectorAll(selector)) {\n            button?.classList.remove(\"shield-activated\");\n        }\n    }\n    CONFIG.PF2E.chatDamageButtonShieldToggle = false;\n}\nexports.toggleOffShieldBlock = toggleOffShieldBlock;\nfunction onClickShieldBlock(shieldButton, messageEl, \n// added\ntoken) {\n    const getTokens = () => {\n        // added\n        if (token) {\n            return [token];\n        }\n        const tokens = game.user.getActiveTokens();\n        if (tokens.length === 0) {\n            ui.notifications.error(\"PF2E.ErrorMessage.NoTokenSelected\", { localize: true });\n        }\n        return tokens;\n    };\n    const getNonBrokenShields = (tokens) => {\n        const actor = tokens.find((t) => !!t.actor)?.actor;\n        return (actor?.itemTypes.shield.filter((s) => s.isEquipped && !s.isBroken && !s.isDestroyed) ??\n            []);\n    };\n    if (!shieldButton.classList.contains(\"tooltipstered\")) {\n        $(shieldButton)\n            .tooltipster({\n            animation: \"fade\",\n            trigger: \"click\",\n            arrow: false,\n            content: (0, utils_1.htmlQuery)(messageEl, \"div.hover-content\"),\n            contentAsHTML: true,\n            contentCloning: true,\n            debug: false,\n            interactive: true,\n            side: [\"top\"],\n            theme: \"crb-hover\",\n            functionBefore: () => {\n                const tokens = getTokens();\n                if (tokens.length === 0)\n                    return false;\n                const nonBrokenShields = getNonBrokenShields(tokens);\n                const hasMultipleShields = tokens.length === 1 && nonBrokenShields.length > 1;\n                const shieldActivated = shieldButton.classList.contains(\"shield-activated\");\n                if (hasMultipleShields && !shieldActivated) {\n                    return true;\n                }\n                if (hasMultipleShields && shieldButton.dataset.shieldId) {\n                    shieldButton.attributes.removeNamedItem(\"data-shield-id\");\n                    shieldButton.classList.remove(\"shield-activated\");\n                    CONFIG.PF2E.chatDamageButtonShieldToggle = false;\n                    return true;\n                }\n                shieldButton.classList.toggle(\"shield-activated\");\n                CONFIG.PF2E.chatDamageButtonShieldToggle =\n                    !CONFIG.PF2E.chatDamageButtonShieldToggle;\n                return false;\n            },\n            functionFormat: (instance, _helper, contentEl) => {\n                const tokens = getTokens();\n                const nonBrokenShields = getNonBrokenShields(tokens);\n                const multipleShields = tokens.length === 1 && nonBrokenShields.length > 1;\n                const shieldActivated = shieldButton.classList.contains(\"shield-activated\");\n                if (multipleShields && !shieldActivated) {\n                    const listEl = (0, utils_1.htmlQuery)(contentEl, \"ul.shield-options\");\n                    if (!listEl)\n                        return $(contentEl);\n                    const shieldList = nonBrokenShields.map((shield) => {\n                        const input = document.createElement(\"input\");\n                        input.classList.add(\"data\");\n                        input.type = \"radio\";\n                        input.name = \"shield-id\";\n                        input.value = shield.id;\n                        input.addEventListener(\"click\", () => {\n                            shieldButton.dataset.shieldId = input.value;\n                            shieldButton.classList.add(\"shield-activated\");\n                            CONFIG.PF2E.chatDamageButtonShieldToggle = true;\n                            instance.close();\n                        });\n                        const shieldName = document.createElement(\"span\");\n                        shieldName.classList.add(\"label\");\n                        shieldName.innerHTML = shield.name;\n                        const hardness = document.createElement(\"span\");\n                        hardness.classList.add(\"tag\");\n                        const hardnessLabel = game.i18n.localize(\"PF2E.HardnessLabel\");\n                        hardness.innerHTML = `${hardnessLabel}: ${shield.hardness}`;\n                        const itemLi = document.createElement(\"li\");\n                        itemLi.classList.add(\"item\");\n                        itemLi.append(input, shieldName, hardness);\n                        return itemLi;\n                    });\n                    listEl.replaceChildren(...shieldList);\n                }\n                return $(contentEl);\n            },\n        })\n            .tooltipster(\"open\");\n    }\n}\nexports.onClickShieldBlock = onClickShieldBlock;\nasync function selfApplyEffectFromMessage(message, html) {\n    const item = message.item;\n    const actor = item?.actor ?? message.actor;\n    if (!item || !actor)\n        return;\n    const button = html.querySelector(\".message-content .message-buttons button[data-action='apply-effect'][data-targets]\");\n    if (!button)\n        return;\n    button.disabled = true;\n    const target = fromUuidSync(button.dataset.targets ?? \"\");\n    const effect = item.isOfType(\"action\", \"feat\") && item.system.selfEffect\n        ? await fromUuid(item.system.selfEffect.uuid)\n        : null;\n    if ((0, foundry_api_1.isInstanceOf)(target, \"ActorPF2e\") &&\n        (0, foundry_api_1.isInstanceOf)(effect, \"EffectPF2e\")) {\n        const traits = item.system.traits.value?.filter((t) => t in CONFIG.PF2E.effectTraits) ?? [];\n        const effectSource = mergeObject(effect.toObject(), {\n            _id: null,\n            system: {\n                context: {\n                    origin: {\n                        actor: actor.uuid,\n                        token: message.token?.uuid ?? null,\n                        item: item.uuid,\n                        spellcasting: null,\n                        rollOptions: item.getOriginData().rollOptions,\n                    },\n                    target: {\n                        actor: target.uuid,\n                        token: target.getActiveTokens(true, true).at(0)?.uuid ?? null,\n                    },\n                    roll: null,\n                },\n                traits: { value: traits },\n            },\n        });\n        await target.createEmbeddedDocuments(\"Item\", [effectSource]);\n        const parsedMessageContent = (() => {\n            const container = document.createElement(\"div\");\n            container.innerHTML = message.content;\n            return container;\n        })();\n        const buttons = (0, utils_1.htmlQuery)(parsedMessageContent, \".message-buttons\");\n        if (buttons) {\n            const span = (0, utils_1.createHTMLElement)(\"span\", { classes: [\"effect-applied\"] });\n            const anchor = effect.toAnchor({ attrs: { draggable: \"true\" } });\n            const locKey = \"PF2E.Item.Action.SelfAppliedEffect.Applied\";\n            const statement = game.i18n.format(locKey, { effect: anchor.outerHTML });\n            span.innerHTML = statement;\n            buttons.replaceChildren(span);\n            await message.update({ content: parsedMessageContent.innerHTML });\n        }\n    }\n}\nexports.selfApplyEffectFromMessage = selfApplyEffectFromMessage;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.getSpellCollectionClass = exports.getStatisticClass = exports.getSpellClass = exports.getDamageRollClass = void 0;\nfunction getStatisticClass(statistic) {\n    return statistic.constructor;\n}\nexports.getStatisticClass = getStatisticClass;\nfunction getSpellCollectionClass(actor) {\n    return actor.spellcasting.get(\"rituals\").spells\n        .constructor;\n}\nexports.getSpellCollectionClass = getSpellCollectionClass;\nfunction getSpellClass() {\n    return CONFIG.PF2E.Item.documentClasses.spell;\n}\nexports.getSpellClass = getSpellClass;\nfunction getDamageRollClass() {\n    return CONFIG.Dice.rolls.find((Roll) => Roll.name === \"DamageRoll\");\n}\nexports.getDamageRollClass = getDamageRollClass;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.saveTypes = void 0;\nconst saveTypes = [\"fortitude\", \"reflex\", \"will\"];\nexports.saveTypes = saveTypes;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.calculateRemainingDuration = void 0;\nconst DURATION_UNITS = {\n    rounds: 6,\n    minutes: 60,\n    hours: 3600,\n    days: 86400,\n};\nfunction calculateRemainingDuration(effect, durationData, \n//added stuff\nfightyActor) {\n    if (durationData.unit === \"encounter\") {\n        const isExpired = effect.system.expired;\n        return { expired: !!isExpired, remaining: isExpired ? 0 : Infinity };\n    }\n    else if (durationData.unit === \"unlimited\" || !(\"start\" in effect.system)) {\n        return { expired: false, remaining: Infinity };\n    }\n    const start = effect.system.start.value;\n    const { combatant } = game.combat ?? {};\n    const { unit, expiry } = durationData;\n    const duration = durationData.value * (DURATION_UNITS[durationData.unit] ?? 0);\n    const addend = !combatant &&\n        duration === 0 &&\n        unit === \"rounds\" &&\n        [\"turn-end\", \"round-end\"].includes(expiry ?? \"\")\n        ? 1\n        : 0;\n    const remaining = start + duration + addend - game.time.worldTime;\n    const result = { remaining, expired: remaining <= 0 };\n    if (remaining === 0 && combatant?.actor) {\n        const startInitiative = effect.system.start.initiative ?? 0;\n        const currentInitiative = combatant.initiative ?? 0;\n        fightyActor ??= effect.actor?.isOfType(\"familiar\")\n            ? effect.actor.master ?? effect.actor\n            : effect.actor;\n        const atTurnStart = () => startInitiative === currentInitiative &&\n            combatant.actor === (effect.origin ?? fightyActor);\n        result.expired =\n            expiry === \"turn-start\"\n                ? atTurnStart()\n                : expiry === \"turn-end\"\n                    ? currentInitiative < startInitiative\n                    : expiry === \"round-end\"\n                        ? remaining <= 0 && game.time.worldTime > start\n                        : false;\n    }\n    return result;\n}\nexports.calculateRemainingDuration = calculateRemainingDuration;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.hasFreePropertySlot = exports.getEquippedHandwraps = exports.getCarryTypeActionData = exports.getAnnotationLabel = exports.consumeItem = exports.changeCarryType = exports.calculateItemPrice = exports.MoveLootPopup = exports.HANDWRAPS_SLUG = exports.BANDS_OF_FORCE_SLUGS = void 0;\nconst foundry_api_1 = require(\"foundry-api\");\nconst classes_1 = require(\"./classes\");\nconst utils_1 = require(\"./utils\");\nconst HANDWRAPS_SLUG = \"handwraps-of-mighty-blows\";\nexports.HANDWRAPS_SLUG = HANDWRAPS_SLUG;\nconst BANDS_OF_FORCE_SLUGS = [\n    \"bands-of-force\",\n    \"bands-of-force-greater\",\n    \"bands-of-force-major\",\n];\nexports.BANDS_OF_FORCE_SLUGS = BANDS_OF_FORCE_SLUGS;\nfunction getAnnotationLabel(annotation, hands) {\n    if (!annotation)\n        return null;\n    const fullAnnotation = [\"draw\", \"pick-up\", \"retrieve\"].includes(annotation)\n        ? `${annotation}${hands}H`\n        : [\"grip\", \"sheathe\", \"modular\", \"drop\"].includes(annotation)\n            ? annotation\n            : null;\n    return fullAnnotation ? game.pf2e.system.sluggify(fullAnnotation, { camel: \"bactrian\" }) : null;\n}\nexports.getAnnotationLabel = getAnnotationLabel;\nfunction getCarryTypeActionData(item, annotation, action = \"interact\") {\n    switch (annotation) {\n        case \"draw\":\n            return [1, \"held\"];\n        case \"pick-up\":\n            return [1, \"held\"];\n        case \"retrieve\": {\n            const { container } = item;\n            if (container?.isHeld)\n                return [1, \"held\"];\n            const usage = container?.system.usage;\n            const actionCost = usage?.type === \"held\" || usage?.where === \"backpack\" ? 2 : 1;\n            return [actionCost, \"held\"];\n        }\n        case \"grip\":\n            return [action === \"interact\" ? 1 : 0, \"held\"];\n        case \"sheathe\":\n            return [1, \"worn\"];\n        case \"modular\":\n            return [1, null];\n        case \"drop\":\n            return [0, \"dropped\"];\n        case \"tower-shield\": {\n            const cost = action === \"take-cover\" ? 1 : 0;\n            return [cost, null];\n        }\n        default:\n            return [1, null];\n    }\n}\nexports.getCarryTypeActionData = getCarryTypeActionData;\nasync function changeCarryType(actor, item, handsHeld, annotation, action = \"interact\") {\n    const [actionCost, carryType] = getCarryTypeActionData(item, annotation, action);\n    if (!carryType)\n        return;\n    await actor.changeCarryType(item, { carryType, handsHeld });\n    if (!game.combat)\n        return;\n    const templates = {\n        flavor: \"./systems/pf2e/templates/chat/action/flavor.hbs\",\n        content: \"./systems/pf2e/templates/chat/action/content.hbs\",\n    };\n    const sluggify = game.pf2e.system.sluggify;\n    const actionKey = sluggify(action, { camel: \"bactrian\" });\n    const annotationKey = annotation ? sluggify(annotation, { camel: \"bactrian\" }) : null;\n    const fullAnnotationKey = getAnnotationLabel(annotation, handsHeld);\n    const flavorAction = {\n        title: `PF2E.Actions.${actionKey}.Title`,\n        subtitle: fullAnnotationKey ? `PF2E.Actions.${actionKey}.${fullAnnotationKey}.Title` : null,\n        glyph: (0, utils_1.getActionGlyph)(actionCost),\n    };\n    const [traits, message] = action === \"raise-a-shield\"\n        ? [[], `PF2E.Actions.${actionKey}.Content`]\n        : [\"take-cover\", \"end-cover\"].includes(action)\n            ? [[], `PF2E.Actions.${actionKey}.${annotationKey}.Description`]\n            : [\n                [(0, utils_1.traitSlugToObject)(\"manipulate\", CONFIG.PF2E.actionTraits)],\n                `PF2E.Actions.${actionKey}.${fullAnnotationKey}.Description`,\n            ];\n    const flavor = await renderTemplate(templates.flavor, { action: flavorAction, traits });\n    const content = await renderTemplate(templates.content, {\n        imgPath: item.img,\n        message: game.i18n.format(message, {\n            actor: actor.name,\n            weapon: item.name,\n            // shield: item.shield?.name ?? item.name,\n            // damageType: game.i18n.localize(`PF2E.Damage.RollFlavor.${selection}`),\n        }),\n    });\n    const token = actor.getActiveTokens(false, true).shift();\n    await ChatMessage.implementation.create({\n        content,\n        speaker: ChatMessage.getSpeaker({ actor, token }),\n        flavor,\n        type: CONST.CHAT_MESSAGE_TYPES.EMOTE,\n    });\n}\nexports.changeCarryType = changeCarryType;\nfunction hasFreePropertySlot(item) {\n    const potency = item.system.runes.potency;\n    return potency > 0 && item.system.runes.property.length < potency;\n}\nexports.hasFreePropertySlot = hasFreePropertySlot;\nfunction getEquippedHandwraps(actor) {\n    return actor.itemTypes.weapon.find((weapon) => {\n        const { category, slug, equipped, identification } = weapon._source.system;\n        const { carryType, invested, inSlot } = equipped;\n        return (category === \"unarmed\" &&\n            carryType === \"worn\" &&\n            inSlot &&\n            invested &&\n            identification.status === \"identified\" &&\n            slug === HANDWRAPS_SLUG);\n    });\n}\nexports.getEquippedHandwraps = getEquippedHandwraps;\nfunction calculateItemPrice(item, quantity = 1, ratio = 1) {\n    const coins = game.pf2e.Coins.fromPrice(item.price, quantity);\n    return ratio === 1 ? coins : coins.scale(ratio);\n}\nexports.calculateItemPrice = calculateItemPrice;\nasync function consumeItem(event, item) {\n    const uses = item.uses;\n    if (uses.max && uses.value < 1)\n        return null;\n    if ([\"wand\", \"scroll\"].includes(item.category) && item.system.spell) {\n        return item.consume();\n    }\n    const actor = item.actor;\n    const multiUse = uses.max > 1;\n    const key = uses.value === 1 && multiUse ? \"UseExhausted\" : multiUse ? \"UseMulti\" : \"UseSingle\";\n    const flags = {\n        pf2e: {\n            origin: {\n                sourceId: item.sourceId,\n                uuid: item.uuid,\n                type: item.type,\n            },\n        },\n    };\n    const speaker = ChatMessage.getSpeaker({ actor });\n    const template = (await item.toMessage(event, { create: false })).content;\n    const contentHTML = (0, foundry_api_1.createHTMLFromString)(template);\n    contentHTML.querySelector(\"button[data-action='consume']\")?.remove();\n    contentHTML.querySelector(\"footer\")?.remove();\n    const flavor = contentHTML.outerHTML;\n    if (item.system.damage) {\n        const DamageRoll = (0, classes_1.getDamageRollClass)();\n        const { formula, type, kind } = item.system.damage;\n        const roll = new DamageRoll(`(${formula})[${type},${kind}]`);\n        roll.toMessage({\n            speaker,\n            flavor,\n            flags,\n        });\n    }\n    else {\n        ChatMessage.create({ speaker, content: flavor, flags });\n    }\n    if (item.system.uses.autoDestroy && uses.value <= 1) {\n        const quantityRemaining = item.quantity;\n        const isPreservedAmmo = item.category === \"ammo\" && item.system.rules.length > 0;\n        if (quantityRemaining <= 1 && !isPreservedAmmo) {\n            return item.delete();\n        }\n        else {\n            return item.update({\n                \"system.quantity\": Math.max(quantityRemaining - 1, 0),\n                \"system.uses.value\": uses.max,\n            });\n        }\n    }\n    else {\n        return item.update({\n            \"system.uses.value\": Math.max(uses.value - 1, 0),\n        });\n    }\n}\nexports.consumeItem = consumeItem;\nclass MoveLootPopup extends FormApplication {\n    onSubmitCallback;\n    constructor(object, options, callback) {\n        super(object, options);\n        this.onSubmitCallback = callback;\n    }\n    async getData() {\n        const [prompt, buttonLabel] = this.options.isPurchase\n            ? [\"PF2E.loot.PurchaseLootMessage\", \"PF2E.loot.PurchaseLoot\"]\n            : [\"PF2E.loot.MoveLootMessage\", \"PF2E.loot.MoveLoot\"];\n        return {\n            ...(await super.getData()),\n            quantity: {\n                default: this.options.quantity.default,\n                max: this.options.quantity.max,\n            },\n            newStack: this.options.newStack,\n            lockStack: this.options.lockStack,\n            prompt,\n            buttonLabel,\n        };\n    }\n    static get defaultOptions() {\n        return {\n            ...super.defaultOptions,\n            id: \"MoveLootPopup\",\n            classes: [],\n            title: game.i18n.localize(\"PF2E.loot.MoveLootPopupTitle\"),\n            template: \"systems/pf2e/templates/popups/loot/move-loot-popup.hbs\",\n            width: \"auto\",\n            quantity: {\n                default: 1,\n                max: 1,\n            },\n            newStack: false,\n            lockStack: false,\n            isPurchase: false,\n        };\n    }\n    async _updateObject(_event, formData) {\n        this.onSubmitCallback(formData.quantity, formData.newStack);\n    }\n}\nexports.MoveLootPopup = MoveLootPopup;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.RollNotePF2e = void 0;\nconst utils_1 = require(\"./utils\");\nclass RollNotePF2e {\n    selector;\n    title;\n    text;\n    predicate;\n    outcome;\n    visibility;\n    rule;\n    constructor(params) {\n        this.selector = params.selector;\n        this.title = params.title ?? null;\n        this.text = params.text;\n        this.predicate = new game.pf2e.Predicate(params.predicate ?? []);\n        this.outcome = [...(params.outcome ?? [])];\n        this.visibility = params.visibility ?? null;\n        this.rule = params.rule ?? null;\n    }\n    static notesToHTML(notes) {\n        if (notes.length === 0)\n            return null;\n        return (0, utils_1.createHTMLElement)(\"ul\", {\n            classes: [\"notes\"],\n            children: [...notes.flatMap((n) => [\"\\n\", n.toHTML()]), \"\\n\"],\n        });\n    }\n    toHTML() {\n        const element = (0, utils_1.createHTMLElement)(\"li\", {\n            classes: [\"roll-note\"],\n            dataset: {\n                itemId: this.rule?.item.id,\n                visibility: this.visibility,\n            },\n            innerHTML: game.i18n.localize(this.text),\n        });\n        if (element.childNodes.length === 1 && element.firstChild instanceof HTMLElement) {\n            element.innerHTML = element.firstChild.innerHTML;\n        }\n        if (this.title) {\n            const strong = (0, utils_1.createHTMLElement)(\"strong\", {\n                innerHTML: game.i18n.localize(this.title),\n            });\n            element.prepend(strong, \" \");\n        }\n        return element;\n    }\n    clone() {\n        return new RollNotePF2e({ ...this.toObject(), rule: this.rule });\n    }\n    toObject() {\n        return {\n            selector: this.selector,\n            title: this.title,\n            text: this.text,\n            predicate: this.predicate.toObject(),\n            outcome: this.outcome,\n            visibility: this.visibility,\n        };\n    }\n}\nexports.RollNotePF2e = RollNotePF2e;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.warnInvalidDrop = exports.upgradeStatisticRank = exports.spellSlotGroupIdToNumber = exports.getSummarizedSpellsDataForRender = exports.getRankLabel = exports.getHighestSyntheticStatistic = exports.getHighestSpellcastingStatistic = exports.getActorMaxRank = exports.createCounteractStatistic = exports.coerceToSpellGroupId = exports.MAGIC_TRADITIONS = exports.EFFECT_AREA_SHAPES = void 0;\nconst foundry_api_1 = require(\"foundry-api\");\nconst _1 = require(\".\");\nconst EFFECT_AREA_SHAPES = [\n    \"burst\",\n    \"cone\",\n    \"cube\",\n    \"cylinder\",\n    \"emanation\",\n    \"line\",\n    \"square\",\n];\nexports.EFFECT_AREA_SHAPES = EFFECT_AREA_SHAPES;\nconst MAGIC_TRADITIONS = new Set([\"arcane\", \"divine\", \"occult\", \"primal\"]);\nexports.MAGIC_TRADITIONS = MAGIC_TRADITIONS;\nfunction getStatisticData(statistic) {\n    const data = deepClone(statistic.data);\n    data.modifiers = (statistic.modifiers ?? []).map((modifier) => modifier.toObject());\n    return data;\n}\nfunction createStatisticFromRawData(actor, data) {\n    const Statistic = (0, _1.getStatisticClass)(actor.skills.acrobatics);\n    const statisticData = deepClone(data);\n    statisticData.modifiers = data.modifiers.map((modifier) => new game.pf2e.Modifier(modifier));\n    return new Statistic(actor, statisticData);\n}\nfunction upgradeStatisticRank(statistic, rank) {\n    if (statistic.rank && statistic.rank >= rank) {\n        return statistic;\n    }\n    const statisticData = getStatisticData(statistic);\n    return createStatisticFromRawData(statistic.actor, statisticData);\n}\nexports.upgradeStatisticRank = upgradeStatisticRank;\nfunction createCounteractStatistic(ability) {\n    const actor = ability.actor;\n    const baseModifier = actor.isOfType(\"npc\")\n        ? ability.statistic.check.modifiers\n            .find((m) => m.type === \"untyped\" && m.slug === \"base\")\n            ?.clone()\n        : null;\n    const Statistic = (0, _1.getStatisticClass)(ability.statistic);\n    return new Statistic(actor, {\n        slug: \"counteract\",\n        label: \"PF2E.Item.Spell.Counteract.Label\",\n        attribute: ability.statistic.attribute,\n        rank: ability.statistic.rank || 1,\n        check: { type: \"check\", modifiers: foundry_api_1.R.compact([baseModifier]) },\n    });\n}\nexports.createCounteractStatistic = createCounteractStatistic;\nfunction getHighestSyntheticStatistic(actor, withClassDcs = true) {\n    const synthetics = Array.from(actor.synthetics.statistics.values());\n    const statistics = withClassDcs\n        ? [...synthetics, ...Object.values(actor.classDCs)]\n        : synthetics;\n    if (!statistics.length)\n        return;\n    const classStatistic = actor.classDC;\n    const groupedStatistics = foundry_api_1.R.groupBy(statistics, foundry_api_1.R.prop(\"mod\"));\n    const highestMod = foundry_api_1.R.pipe(groupedStatistics, foundry_api_1.R.keys, foundry_api_1.R.sortBy([foundry_api_1.R.identity, \"desc\"]), foundry_api_1.R.first());\n    if (classStatistic && highestMod && classStatistic.mod === highestMod) {\n        return classStatistic;\n    }\n    return groupedStatistics[highestMod][0];\n}\nexports.getHighestSyntheticStatistic = getHighestSyntheticStatistic;\nfunction getHighestSpellcastingStatistic(actor) {\n    const entries = actor.spellcasting.spellcastingFeatures;\n    if (!entries.length)\n        return;\n    const classAttribute = actor.classDC?.attribute;\n    const groupedEntries = foundry_api_1.R.groupBy(entries, (entry) => entry.statistic.mod);\n    const highestMod = foundry_api_1.R.pipe(groupedEntries, foundry_api_1.R.keys, foundry_api_1.R.sortBy([(x) => Number(x), \"desc\"]), foundry_api_1.R.first());\n    const highestResults = groupedEntries[highestMod].map((entry) => ({\n        tradition: entry.tradition,\n        statistic: entry.statistic,\n    }));\n    if (highestResults.length === 1 || !classAttribute) {\n        return highestResults[0];\n    }\n    return (highestResults.find((entry) => entry.statistic.attribute === classAttribute) ||\n        highestResults[0]);\n}\nexports.getHighestSpellcastingStatistic = getHighestSpellcastingStatistic;\nfunction getActorMaxRank(actor) {\n    return Math.max(1, Math.ceil(actor.level / 2));\n}\nexports.getActorMaxRank = getActorMaxRank;\nfunction getRankLabel(rank) {\n    return game.i18n.format(\"PF2E.Item.Spell.Rank.Ordinal\", {\n        rank: (0, _1.ordinalString)(rank),\n    });\n}\nexports.getRankLabel = getRankLabel;\nfunction coerceToSpellGroupId(value) {\n    if (value === \"cantrips\")\n        return value;\n    const numericValue = Number(value) || NaN;\n    return numericValue.between(1, 10) ? numericValue : null;\n}\nexports.coerceToSpellGroupId = coerceToSpellGroupId;\nfunction spellSlotGroupIdToNumber(groupId) {\n    if (groupId === \"cantrips\")\n        return 0;\n    const numericValue = Number(groupId ?? NaN);\n    return numericValue.between(0, 10) ? numericValue : null;\n}\nexports.spellSlotGroupIdToNumber = spellSlotGroupIdToNumber;\nfunction warnInvalidDrop(warning, { spell, groupId }) {\n    const localize = (0, _1.localizer)(\"PF2E.Item.Spell.Warning\");\n    if (warning === \"invalid-rank\" && typeof groupId === \"number\") {\n        const spellRank = game.i18n.format(\"PF2E.Item.Spell.Rank.Ordinal\", {\n            rank: (0, _1.ordinalString)(spell.baseRank),\n        });\n        const targetRank = game.i18n.format(\"PF2E.Item.Spell.Rank.Ordinal\", {\n            rank: (0, _1.ordinalString)(groupId),\n        });\n        ui.notifications.warn(localize(\"InvalidRank\", { spell: spell.name, spellRank, targetRank }));\n    }\n    else if (warning === \"cantrip-mismatch\") {\n        const locKey = spell.isCantrip ? \"CantripToRankedSlots\" : \"NonCantripToCantrips\";\n        ui.notifications.warn(localize(locKey, { spell: spell.name }));\n    }\n    else if (warning === \"invalid-spell\") {\n        const type = game.i18n.localize(\"PF2E.TraitFocus\");\n        ui.notifications.warn(localize(\"WrongSpellType\", { type }));\n    }\n}\nexports.warnInvalidDrop = warnInvalidDrop;\nasync function getSummarizedSpellsDataForRender(actor, sortByType, localize, entries) {\n    entries ??= await Promise.all(actor.spellcasting.collections.map((spells) => spells.entry.getSheetData({ spells })));\n    const focusPool = actor.system.resources?.focus ?? { value: 0, max: 0 };\n    const pf2eDailies = (0, foundry_api_1.getActiveModule)(\"pf2e-dailies\");\n    const spells = [];\n    const labels = [];\n    let hasFocusCantrip = false;\n    for (const entry of entries) {\n        const entryId = entry.id;\n        const entryDc = entry.statistic?.dc.value;\n        const entryTooltip = entryDc\n            ? `${entry.name} - ${game.i18n.format(\"PF2E.DCWithValue\", { dc: entryDc, text: \"\" })}`\n            : entry.name;\n        const isFocus = entry.isFocusPool;\n        const isRitual = entry.isRitual;\n        const isCharges = entry.category === \"charges\";\n        const isStaff = entry.isStaff;\n        const isInnate = entry.isInnate;\n        const isPrepared = entry.isPrepared;\n        const isSpontaneous = entry.isSpontaneous;\n        const isFlexible = entry.isFlexible;\n        const consumable = entry.category === \"items\"\n            ? actor.items.get(entryId.split(\"-\")[0])\n            : undefined;\n        for (const group of entry.groups) {\n            if (!group.active.length || group.uses?.max === 0)\n                continue;\n            const groupNumber = spellSlotGroupIdToNumber(group.id);\n            const slotSpells = [];\n            const isCantrip = group.id === \"cantrips\";\n            const isBroken = !isCantrip && isCharges && !pf2eDailies?.active;\n            const groupUses = typeof group.uses?.value === \"number\" ? group.uses : undefined;\n            for (let slotId = 0; slotId < group.active.length; slotId++) {\n                const active = group.active[slotId];\n                if (!active?.spell || active.uses?.max === 0)\n                    continue;\n                const { spell } = active;\n                const spellId = spell.id;\n                const uses = isCantrip || isFocus || consumable || (isPrepared && !isFlexible)\n                    ? undefined\n                    : isCharges && !isBroken\n                        ? entry.uses\n                        : active.uses ?? groupUses;\n                slotSpells.push({\n                    name: spell.name,\n                    itemId: spellId,\n                    entryId,\n                    groupId: group.id,\n                    slotId,\n                    action: spell.system.time.value,\n                    castRank: active.castRank ?? spell.rank,\n                    expended: isFocus ? !isCantrip && focusPool.value <= 0 : active.expended,\n                    img: spell.img,\n                    range: spell.system.range.value || \"-&nbsp;\",\n                    rank: spell.rank,\n                    entryName: entry.name,\n                    entryDc,\n                    entryTooltip,\n                    consumable,\n                    isBroken,\n                    isFocus,\n                    isRitual,\n                    isCharges,\n                    isStaff,\n                    isInnate,\n                    isPrepared,\n                    isSpontaneous,\n                    isFlexible,\n                    uses: uses\n                        ? {\n                            ...uses,\n                            input: isStaff\n                                ? \"\"\n                                : isCharges\n                                    ? \"system.slots.slot1.value\"\n                                    : isInnate\n                                        ? \"system.location.uses.value\"\n                                        : `system.slots.slot${groupNumber}.value`,\n                            itemId: isStaff ? \"\" : isInnate ? spellId : entryId,\n                        }\n                        : undefined,\n                    order: isCharges\n                        ? 0\n                        : isPrepared\n                            ? 1\n                            : isFocus\n                                ? 2\n                                : isInnate\n                                    ? 3\n                                    : isSpontaneous\n                                        ? 4\n                                        : 5,\n                    category: consumable\n                        ? `PF2E.Item.Consumable.Category.${consumable.category}`\n                        : isStaff\n                            ? localize(\"staff\")\n                            : isCharges\n                                ? localize(\"charges\")\n                                : isInnate\n                                    ? \"PF2E.PreparationTypeInnate\"\n                                    : isSpontaneous\n                                        ? \"PF2E.PreparationTypeSpontaneous\"\n                                        : isFlexible\n                                            ? \"PF2E.SpellFlexibleLabel\"\n                                            : isFocus\n                                                ? \"PF2E.TraitFocus\"\n                                                : \"PF2E.SpellPreparedLabel\",\n                });\n            }\n            if (slotSpells.length) {\n                if (isFocus) {\n                    if (isCantrip) {\n                        hasFocusCantrip = true;\n                    }\n                    else {\n                        spells[12] ??= [];\n                        spells[12].push(...slotSpells);\n                        continue;\n                    }\n                }\n                else if (isRitual) {\n                    spells[13] ??= [];\n                    spells[13].push(...slotSpells);\n                    continue;\n                }\n                labels[groupNumber] ??= group.label;\n                spells[groupNumber] ??= [];\n                spells[groupNumber].push(...slotSpells);\n            }\n        }\n    }\n    if (spells.length) {\n        const orderSort = (a, b) => a.order === b.order ? (0, foundry_api_1.localeCompare)(a.name, b.name) : a.order - b.order;\n        const nameSort = (a, b) => (0, foundry_api_1.localeCompare)(a.name, b.name);\n        const sort = sortByType ? orderSort : nameSort;\n        for (let i = 0; i < spells.length; i++) {\n            const entry = spells[i];\n            if (!entry || i > 11)\n                continue;\n            entry.sort(sort);\n        }\n    }\n    labels[12] = \"PF2E.Focus.Spells\";\n    labels[13] = \"PF2E.Actor.Character.Spellcasting.Tab.Rituals\";\n    return {\n        labels,\n        spells,\n        focusPool,\n        isOwner: actor.isOwner,\n        hasFocusCantrip,\n    };\n}\nexports.getSummarizedSpellsDataForRender = getSummarizedSpellsDataForRender;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.createConsumableFromSpell = void 0;\nconst foundry_api_1 = require(\"foundry-api\");\nconst _1 = require(\".\");\nconst CANTRIP_DECK_ID = \"tLa4bewBhyqzi6Ow\";\nconst scrollCompendiumIds = {\n    1: \"RjuupS9xyXDLgyIr\",\n    2: \"Y7UD64foDbDMV9sx\",\n    3: \"ZmefGBXGJF3CFDbn\",\n    4: \"QSQZJ5BC3DeHv153\",\n    5: \"tjLvRWklAylFhBHQ\",\n    6: \"4sGIy77COooxhQuC\",\n    7: \"fomEZZ4MxVVK3uVu\",\n    8: \"iPki3yuoucnj7bIt\",\n    9: \"cFHomF3tty8Wi1e5\",\n    10: \"o1XIHJ4MJyroAHfF\",\n};\nconst wandCompendiumIds = {\n    1: \"UJWiN0K3jqVjxvKk\",\n    2: \"vJZ49cgi8szuQXAD\",\n    3: \"wrDmWkGxmwzYtfiA\",\n    4: \"Sn7v9SsbEDMUIwrO\",\n    5: \"5BF7zMnrPYzyigCs\",\n    6: \"kiXh4SUWKr166ZeM\",\n    7: \"nmXPj9zuMRQBNT60\",\n    8: \"Qs8RgNH6thRPv2jt\",\n    9: \"Fgv722039TVM5JTc\",\n};\nconst SPELL_CONSUMABLE_NAME_TEMPLATES = {\n    cantripDeck5: \"PF2E.Item.Physical.FromSpell.CantripDeck5\",\n    scroll: \"PF2E.Item.Physical.FromSpell.Scroll\",\n    wand: \"PF2E.Item.Physical.FromSpell.Wand\",\n};\nfunction getIdForSpellConsumable(type, heightenedLevel) {\n    switch (type) {\n        case \"cantripDeck5\":\n            return CANTRIP_DECK_ID;\n        case \"scroll\":\n            return scrollCompendiumIds[heightenedLevel] ?? null;\n        default:\n            return wandCompendiumIds[heightenedLevel] ?? null;\n    }\n}\nfunction getNameForSpellConsumable(type, spellName, heightenedLevel) {\n    const templateId = SPELL_CONSUMABLE_NAME_TEMPLATES[type] ||\n        `${type} of {name} (Rank {level})`;\n    return game.i18n.format(templateId, { name: spellName, level: heightenedLevel });\n}\nasync function createConsumableFromSpell(spell, { type, heightenedLevel = spell.baseRank, mystified = false, temp, itemName, itemImg, }) {\n    const pack = game.packs.find((p) => p.collection === \"pf2e.equipment-srd\");\n    const itemId = getIdForSpellConsumable(type, heightenedLevel);\n    const consumable = await pack?.getDocument(itemId ?? \"\");\n    if (!(0, foundry_api_1.isInstanceOf)(consumable, \"ConsumablePF2e\")) {\n        throw (0, _1.ErrorPF2e)(\"Failed to retrieve consumable item\");\n    }\n    const consumableSource = { ...consumable.toObject(), _id: null }; // Clear _id\n    const traits = consumableSource.system.traits;\n    traits.value = foundry_api_1.R.uniq([...traits.value, ...spell.traits]);\n    traits.rarity = spell.rarity;\n    if (traits.value.includes(\"magical\") &&\n        traits.value.some((t) => (0, _1.setHasElement)(_1.MAGIC_TRADITIONS, t))) {\n        traits.value.splice(traits.value.indexOf(\"magical\"), 1);\n    }\n    traits.value.sort();\n    consumableSource.name = getNameForSpellConsumable(itemName ?? type, spell.name, heightenedLevel);\n    const description = consumableSource.system.description.value;\n    consumableSource.system.description.value = (() => {\n        const paragraphElement = document.createElement(\"p\");\n        paragraphElement.append(spell.sourceId ? `@UUID[${spell.sourceId}]{${spell.name}}` : spell.description);\n        const containerElement = document.createElement(\"div\");\n        const hrElement = document.createElement(\"hr\");\n        containerElement.append(paragraphElement, hrElement);\n        hrElement.insertAdjacentHTML(\"afterend\", description);\n        return containerElement.innerHTML;\n    })();\n    // Cantrip deck casts at level 1\n    if (type !== \"cantripDeck5\") {\n        consumableSource.system.spell = mergeObject(spell._source, { _id: randomID(), system: { location: { value: null, heightenedLevel } } }, { inplace: false });\n    }\n    if (mystified) {\n        consumableSource.system.identification.status = \"unidentified\";\n    }\n    if (typeof itemImg === \"string\") {\n        consumableSource.img = itemImg;\n    }\n    if (temp) {\n        consumableSource.system.temporary = true;\n    }\n    return consumableSource;\n}\nexports.createConsumableFromSpell = createConsumableFromSpell;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.getTranslatedSkills = exports.SKILL_LONG_FORMS = exports.SKILL_EXPANDED = exports.SKILL_DICTIONARY = exports.SKILL_ABBREVIATIONS = exports.ATTRIBUTE_ABBREVIATIONS = void 0;\nconst SKILL_ABBREVIATIONS = [\n    \"acr\",\n    \"arc\",\n    \"ath\",\n    \"cra\",\n    \"dec\",\n    \"dip\",\n    \"itm\",\n    \"med\",\n    \"nat\",\n    \"occ\",\n    \"prf\",\n    \"rel\",\n    \"soc\",\n    \"ste\",\n    \"sur\",\n    \"thi\",\n];\nexports.SKILL_ABBREVIATIONS = SKILL_ABBREVIATIONS;\nconst SKILL_DICTIONARY = {\n    acr: \"acrobatics\",\n    arc: \"arcana\",\n    ath: \"athletics\",\n    cra: \"crafting\",\n    dec: \"deception\",\n    dip: \"diplomacy\",\n    itm: \"intimidation\",\n    med: \"medicine\",\n    nat: \"nature\",\n    occ: \"occultism\",\n    prf: \"performance\",\n    rel: \"religion\",\n    soc: \"society\",\n    ste: \"stealth\",\n    sur: \"survival\",\n    thi: \"thievery\",\n};\nexports.SKILL_DICTIONARY = SKILL_DICTIONARY;\nconst SKILL_EXPANDED = {\n    acrobatics: { attribute: \"dex\", shortForm: \"acr\" },\n    arcana: { attribute: \"int\", shortForm: \"arc\" },\n    athletics: { attribute: \"str\", shortForm: \"ath\" },\n    crafting: { attribute: \"int\", shortForm: \"cra\" },\n    deception: { attribute: \"cha\", shortForm: \"dec\" },\n    diplomacy: { attribute: \"cha\", shortForm: \"dip\" },\n    intimidation: { attribute: \"cha\", shortForm: \"itm\" },\n    medicine: { attribute: \"wis\", shortForm: \"med\" },\n    nature: { attribute: \"wis\", shortForm: \"nat\" },\n    occultism: { attribute: \"int\", shortForm: \"occ\" },\n    performance: { attribute: \"cha\", shortForm: \"prf\" },\n    religion: { attribute: \"wis\", shortForm: \"rel\" },\n    society: { attribute: \"int\", shortForm: \"soc\" },\n    stealth: { attribute: \"dex\", shortForm: \"ste\" },\n    survival: { attribute: \"wis\", shortForm: \"sur\" },\n    thievery: { attribute: \"dex\", shortForm: \"thi\" },\n};\nexports.SKILL_EXPANDED = SKILL_EXPANDED;\nconst ATTRIBUTE_ABBREVIATIONS = new Set([\"str\", \"dex\", \"con\", \"int\", \"wis\", \"cha\"]);\nexports.ATTRIBUTE_ABBREVIATIONS = ATTRIBUTE_ABBREVIATIONS;\nconst SKILL_LONG_FORMS = new Set(Object.values(SKILL_DICTIONARY));\nexports.SKILL_LONG_FORMS = SKILL_LONG_FORMS;\nlet TRANSLATED_SKILL;\nfunction getTranslatedSkills() {\n    if (!TRANSLATED_SKILL) {\n        TRANSLATED_SKILL = {};\n        for (const [key, value] of Object.entries(CONFIG.PF2E.skillList)) {\n            TRANSLATED_SKILL[key] = game.i18n\n                .localize(value)\n                .toLocaleLowerCase(game.i18n.lang);\n        }\n    }\n    return deepClone(TRANSLATED_SKILL);\n}\nexports.getTranslatedSkills = getTranslatedSkills;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.getTemplateTokens = void 0;\n/**\n * @param {unknown} measuredTemplate\n * @param {{collisionOrigin?: {x: number, y: number}, collisionType?: \"move\" | \"sight\"}} [options]\n * @returns {unknown[]}\n */\nfunction getTemplateTokens(measuredTemplate, { collisionOrigin, collisionType = \"move\", } = {}) {\n    const { grid, dimensions } = canvas;\n    const template = measuredTemplate instanceof MeasuredTemplateDocument\n        ? measuredTemplate.object\n        : measuredTemplate;\n    if (!canvas.scene || !template?.highlightId || !grid || !dimensions)\n        return [];\n    const gridHighlight = grid.getHighlightLayer(template.highlightId);\n    if (!gridHighlight || grid.type !== CONST.GRID_TYPES.SQUARE)\n        return [];\n    const origin = collisionOrigin ?? template.center;\n    const tokens = canvas.tokens.quadtree.getObjects(gridHighlight.getLocalBounds(undefined, true));\n    const gridSize = grid.size;\n    const containedTokens = [];\n    for (const token of tokens) {\n        const tokenDoc = token.document;\n        const tokenPositions = [];\n        for (let h = 0; h < tokenDoc.height; h++) {\n            const tokenX = Math.floor(token.x / gridSize) * gridSize;\n            const tokenY = Math.floor(token.y / gridSize) * gridSize;\n            const y = tokenY + h * gridSize;\n            tokenPositions.push(`${tokenX}.${y}`);\n            if (tokenDoc.width > 1) {\n                for (let w = 1; w < tokenDoc.width; w++) {\n                    tokenPositions.push(`${tokenX + w * gridSize}.${y}`);\n                }\n            }\n        }\n        for (const position of tokenPositions) {\n            if (!gridHighlight.positions.has(position)) {\n                continue;\n            }\n            const [gx, gy] = position.split(\".\").map((s) => Number(s));\n            const destination = {\n                x: gx + dimensions.size * 0.5,\n                y: gy + dimensions.size * 0.5,\n            };\n            if (destination.x < 0 || destination.y < 0)\n                continue;\n            const hasCollision = canvas.ready &&\n                collisionType &&\n                CONFIG.Canvas.polygonBackends[collisionType].testCollision(origin, destination, {\n                    type: collisionType,\n                    mode: \"any\",\n                });\n            if (!hasCollision) {\n                containedTokens.push(token);\n                break;\n            }\n        }\n    }\n    return containedTokens;\n}\nexports.getTemplateTokens = getTemplateTokens;\n", "\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __exportStar = (this && this.__exportStar) || function(m, exports) {\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(exports, p)) __createBinding(exports, m, p);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\n__exportStar(require(\"./actor\"), exports);\n__exportStar(require(\"./application\"), exports);\n__exportStar(require(\"./browser\"), exports);\n__exportStar(require(\"./chat\"), exports);\n__exportStar(require(\"./classes\"), exports);\n__exportStar(require(\"./classes\"), exports);\n__exportStar(require(\"./data\"), exports);\n__exportStar(require(\"./effect\"), exports);\n__exportStar(require(\"./item\"), exports);\n__exportStar(require(\"./notes\"), exports);\n__exportStar(require(\"./rules\"), exports);\n__exportStar(require(\"./spell\"), exports);\n__exportStar(require(\"./spell-consumables\"), exports);\n__exportStar(require(\"./skills\"), exports);\n__exportStar(require(\"./template\"), exports);\n__exportStar(require(\"./utils\"), exports);\n", "export * from 'foundry-api'\r\nexport * from './dist'\r\n", "import type {\r\n    Daily,\r\n    DailyCustom,\r\n    DailyItem,\r\n    DailyRow,\r\n    DailyRowDropFilter,\r\n    DailyRowDropFilters,\r\n    DailyRowDropType,\r\n    DailyRowType,\r\n    DailyRows,\r\n} from \"./types\";\r\n\r\nfunction createDaily<\r\n    TItemSlug extends string = string,\r\n    TCustom extends DailyCustom = {},\r\n    TRowSlug extends string = string,\r\n    TItems extends DailyItem<TItemSlug>[] = DailyItem<TItemSlug>[],\r\n    TRows extends DailyRow<TRowSlug>[] = DailyRow<TRowSlug>[]\r\n>(config: Daily<TItemSlug, TCustom, TRowSlug, TItems, TRows>): Daily {\r\n    return config as unknown as Daily;\r\n}\r\n\r\nfunction filterIsOfType<T extends DailyRowDropType>(\r\n    filter: DailyRowDropFilter,\r\n    type: T\r\n): filter is DailyRowDropFilters[T] {\r\n    return filter.type === type;\r\n}\r\n\r\nfunction rowIsOfType<T extends DailyRowType>(row: DailyRow, ...types: T[]): row is DailyRows[T] {\r\n    return types.some((type) => row.type === type);\r\n}\r\n\r\nexport { createDaily, filterIsOfType, rowIsOfType };\r\n", "import {\r\n    R,\r\n    createChatLink,\r\n    createConsumableFromSpell,\r\n    getActorMaxRank,\r\n    getRankLabel,\r\n    getSetting,\r\n    hasFreePropertySlot,\r\n    setFlagProperty,\r\n} from \"pf2e-api\";\r\n\r\ntype SimplifiableRuleValue = string | number | \"half\" | \"level\";\r\n\r\ntype CreateSpellConsumableSourceOptions = {\r\n    uuid: string;\r\n    level?: number;\r\n    itemName?: string;\r\n    itemImg?: string;\r\n};\r\n\r\nconst utils = {\r\n    getChoiSetRuleSelection: <T>(item: ItemPF2e, option?: string) => {\r\n        const rules = item._source.system.rules;\r\n        const rule = rules.find(\r\n            (rule: ChoiceSetSource): rule is ChoiceSetSource =>\r\n                rule.key === \"ChoiceSet\" && (!option || rule.rollOption === option)\r\n        );\r\n        return rule?.selection as T | undefined;\r\n    },\r\n    hasFreePropertySlot: (item: WeaponPF2e<CharacterPF2e>) => {\r\n        return hasFreePropertySlot(item);\r\n    },\r\n    getResistanceLabel: (resistance: string, localize = true) => {\r\n        const label = CONFIG.PF2E.resistanceTypes[resistance];\r\n        return localize ? game.i18n.localize(label).capitalize() : label;\r\n    },\r\n    getResistances: () => {\r\n        return configToOptions(\"resistanceTypes\").map(({ label, value }) => ({\r\n            value,\r\n            label: label.capitalize(),\r\n        }));\r\n    },\r\n    getLanguageLabel: (language: string, localize = true) => {\r\n        const label = CONFIG.PF2E.languages[language];\r\n        return localize ? game.i18n.localize(label) : label;\r\n    },\r\n    getLanguages: () => {\r\n        return configToOptions(\"languages\");\r\n    },\r\n    getSkillLabel: (skill: SkillLongForm, localize = true) => {\r\n        const label = CONFIG.PF2E.skillList[skill];\r\n        return localize ? game.i18n.localize(label) : label;\r\n    },\r\n    getSkills: () => {\r\n        return configToOptions(\"skillList\").filter(\r\n            (x): x is { value: SkillLongForm; label: string } => x.value !== \"lore\"\r\n        );\r\n    },\r\n    getSpellRankLabel: (rank: ZeroToTen) => {\r\n        return getRankLabel(rank);\r\n    },\r\n    createExcludeFeatList: (actor: CharacterPF2e, categories: FeatCategory[], traits: string[]) => {\r\n        return R.pipe(\r\n            actor.itemTypes.feat,\r\n            R.filter((feat) => categories.some((category) => feat.category === category)),\r\n            R.filter((feat) => traits.every((trait) => feat.traits.has(trait))),\r\n            R.map((feat) => feat.sourceId)\r\n        );\r\n    },\r\n    getActorMaxRank,\r\n    getSpellcastingMaxRank: (\r\n        actor: CharacterPF2e,\r\n        { tradition }: { tradition?: MagicTradition } = {}\r\n    ) => {\r\n        const maxRank = R.pipe(\r\n            actor.spellcasting.spellcastingFeatures,\r\n            tradition ? R.filter((entry) => entry.tradition === tradition) : R.identity,\r\n            R.map((entry) => entry.highestRank),\r\n            R.firstBy([R.identity, \"desc\"])\r\n        );\r\n        return maxRank ?? 0;\r\n    },\r\n    getActors: (actor?: CharacterPF2e) => {\r\n        const list =\r\n            actor && getSetting(\"partyMembers\") && actor.parties.size\r\n                ? Array.from(actor.parties).flatMap((party) => party.members)\r\n                : game.actors.filter((a) => a.hasPlayerOwner);\r\n        return list.filter((a) => a !== actor);\r\n    },\r\n    getProficiencyLabel: (rank: OneToFour) => {\r\n        return game.i18n.localize(CONFIG.PF2E.proficiencyLevels[rank]);\r\n    },\r\n    getWeaponPropertyRuneLabel: (rune: WeaponPropertyRuneType) => {\r\n        return game.i18n.localize(`PF2E.WeaponPropertyRune.${rune}.Name`);\r\n    },\r\n    getWeaponPotencyRuneLabel: (potency: ZeroToFour) => {\r\n        return game.i18n.localize(`PF2E.WeaponPotencyRune${potency}`);\r\n    },\r\n    getWeaponTraitLabel: (trait: string) => {\r\n        return game.i18n.localize(CONFIG.PF2E.weaponTraits[trait]);\r\n    },\r\n    getWeaponDamageLabel: (damage: DamageType) => {\r\n        return game.i18n.localize(CONFIG.PF2E.damageTypes[damage]);\r\n    },\r\n    getWeaponGroupLabel: (group: WeaponGroup) => {\r\n        return game.i18n.localize(CONFIG.PF2E.weaponGroups[group]);\r\n    },\r\n    getPreciousMaterialLabel(material: PreciousMaterialType) {\r\n        return game.i18n.localize(CONFIG.PF2E.preciousMaterials[material]);\r\n    },\r\n    createFeatSource: async (uuid: string) => {\r\n        const source = (await fromUuid<FeatPF2e>(uuid))?.toObject();\r\n\r\n        if (source?.type !== \"feat\") {\r\n            throw new Error(\r\n                `An error occured while trying to create a feat source with uuid: ${uuid}`\r\n            );\r\n        }\r\n\r\n        return source;\r\n    },\r\n    createSpellScrollSource: (options: CreateSpellConsumableSourceOptions) => {\r\n        return createSpellConsumableSource(\"scroll\", options);\r\n    },\r\n    createWandSource: (options: CreateSpellConsumableSourceOptions) => {\r\n        return createSpellConsumableSource(\"wand\", options);\r\n    },\r\n    createSkillRuleElement: ({\r\n        skill,\r\n        mode = \"upgrade\",\r\n        value,\r\n        predicate,\r\n    }: {\r\n        skill: SkillLongForm;\r\n        mode?: \"upgrade\";\r\n        value: number;\r\n        predicate?: any[];\r\n    }) => {\r\n        const rule = {\r\n            key: \"ActiveEffectLike\",\r\n            mode,\r\n            path: `system.skills.${skill}.rank`,\r\n            value,\r\n            predicate,\r\n        };\r\n\r\n        return rule;\r\n    },\r\n    createLoreSource: ({ name, rank }: { name: string; rank: ZeroToFour }) => {\r\n        const data: PreCreate<LoreSource> = {\r\n            type: \"lore\",\r\n            img: \"systems/pf2e/icons/default-icons/lore.svg\",\r\n            name,\r\n            system: { proficient: { value: rank } },\r\n        } as const;\r\n\r\n        return data;\r\n    },\r\n    createResistanceRuleElement: ({\r\n        type,\r\n        value,\r\n        predicate,\r\n    }: {\r\n        type: string;\r\n        value: SimplifiableRuleValue;\r\n        predicate?: any[];\r\n    }) => {\r\n        const rule = {\r\n            key: \"Resistance\",\r\n            type,\r\n            value: simplifyRuleValue(value),\r\n            predicate,\r\n        };\r\n\r\n        return rule;\r\n    },\r\n    createLanguageRuleElement: ({\r\n        language,\r\n        mode = \"add\",\r\n        predicate,\r\n    }: {\r\n        language: string;\r\n        mode?: \"add\";\r\n        predicate?: any[];\r\n    }) => {\r\n        const rule = {\r\n            key: \"ActiveEffectLike\",\r\n            mode,\r\n            path: \"system.build.languages.granted\",\r\n            value: {\r\n                slug: language,\r\n                source: \"{item|name}\",\r\n            },\r\n            predicate,\r\n        };\r\n\r\n        return rule;\r\n    },\r\n    createChatLink: (itemOrUuid: ItemPF2e | string, label?: string) => {\r\n        const uuid =\r\n            itemOrUuid instanceof Item ? itemOrUuid.sourceId ?? itemOrUuid.uuid : itemOrUuid;\r\n        return createChatLink(uuid, { label });\r\n    },\r\n    selectRandomOption: (\r\n        options: (string | { value: string })[] | HTMLSelectElement | HTMLOptionsCollection\r\n    ) => {\r\n        options = options instanceof HTMLSelectElement ? options.options : options;\r\n        options =\r\n            options instanceof HTMLOptionsCollection\r\n                ? Array.from(options).map((option) => option.value)\r\n                : options;\r\n\r\n        if (options.length === 0) return \"\";\r\n\r\n        const roll = new Roll(`1d${options.length}`).evaluate({ async: false });\r\n        const result = options[roll.total - 1];\r\n\r\n        return typeof result === \"object\" ? result.value : result;\r\n    },\r\n    createSpellcastingEntrySource: ({\r\n        category,\r\n        identifier,\r\n        name,\r\n        sort,\r\n        attribute,\r\n        proficiencySlug,\r\n        showSlotlessRanks,\r\n        proficiencyRank,\r\n        tradition,\r\n        flags,\r\n    }: {\r\n        category: SpellcastingCategory;\r\n        identifier: string;\r\n        name: string;\r\n        sort?: number;\r\n        attribute?: AttributeString | null;\r\n        proficiencySlug?: string;\r\n        showSlotlessRanks?: boolean;\r\n        proficiencyRank?: ZeroToFour | null;\r\n        tradition?: MagicTradition;\r\n        flags?: Record<string, JSONValue>;\r\n    }) => {\r\n        const source: PreCreate<SpellcastingEntrySource> = {\r\n            type: \"spellcastingEntry\",\r\n            name,\r\n            sort: sort ?? 0,\r\n            system: {\r\n                ability: {\r\n                    value: (!proficiencySlug && attribute) || \"\",\r\n                },\r\n                prepared: {\r\n                    value: category,\r\n                },\r\n                showSlotlessLevels: {\r\n                    value: showSlotlessRanks ?? false,\r\n                },\r\n                proficiency: {\r\n                    value: proficiencyRank ?? 1,\r\n                    slug: proficiencySlug ?? \"\",\r\n                },\r\n                tradition: {\r\n                    value: tradition ?? \"arcane\",\r\n                },\r\n            },\r\n        };\r\n\r\n        setFlagProperty(source, \"identifier\", identifier);\r\n\r\n        if (R.isPlainObject(flags)) {\r\n            setFlagProperty(source, \"extra\", flags);\r\n        }\r\n\r\n        return source;\r\n    },\r\n    createSpellSource: async (\r\n        uuid: string,\r\n        { identifier, rank }: { identifier?: string; rank?: ZeroToTen } = {}\r\n    ) => {\r\n        const source = (await fromUuid<SpellPF2e>(uuid))?.toObject();\r\n\r\n        if (source?.type !== \"spell\") {\r\n            throw new Error(\r\n                `An error occured while trying to create a spell source with uuid: ${uuid}`\r\n            );\r\n        }\r\n\r\n        if (identifier) {\r\n            setFlagProperty(source, \"identifier\", identifier);\r\n        }\r\n\r\n        if (R.isNumber(rank)) {\r\n            setFlagProperty(source, \"rank\", rank);\r\n        }\r\n\r\n        return source;\r\n    },\r\n    getSpellWithRankLabel: (uuid: string, rank: OneToTen) => {\r\n        const name = fromUuidSync(uuid)?.name ?? \"\";\r\n        return `${name} (${getRankLabel(rank)})`;\r\n    },\r\n};\r\n\r\nfunction configToOptions<T extends keyof typeof CONFIG.PF2E>(type: T, capitalize = false) {\r\n    return R.pipe(\r\n        CONFIG.PF2E[type],\r\n        R.toPairs.strict,\r\n        R.map(([value, label]) => ({ value, label }))\r\n    );\r\n}\r\n\r\nasync function createSpellConsumableSource(\r\n    type: SpellConsumableItemType,\r\n    { uuid, level, itemName, itemImg }: CreateSpellConsumableSourceOptions\r\n) {\r\n    const spell = await fromUuid<SpellPF2e>(uuid);\r\n\r\n    if (!spell?.isOfType(\"spell\")) {\r\n        throw new Error(\r\n            `An error occured while trying to create a spell scroll source with uuid: ${uuid}`\r\n        );\r\n    }\r\n\r\n    return createConsumableFromSpell(spell, {\r\n        type,\r\n        heightenedLevel: level,\r\n        temp: true,\r\n        itemName,\r\n        itemImg,\r\n    });\r\n}\r\n\r\nfunction simplifyRuleValue(value: SimplifiableRuleValue) {\r\n    return value === \"half\"\r\n        ? \"max(1,floor(@actor.level/2))\"\r\n        : value === \"level\"\r\n        ? \"max(1,@actor.level)\"\r\n        : value;\r\n}\r\n\r\nexport { utils };\r\nexport type { SimplifiableRuleValue };\r\n", "import { createDaily } from \"../daily\";\r\nimport { DailyRowComboData } from \"../types\";\r\nimport { utils } from \"../utils\";\r\n\r\nconst ancestralUUID = \"Compendium.pf2e.feats-srd.Item.WoLh16gyDp8y9WOZ\";\r\nconst expertUUID = \"Compendium.pf2e.feats-srd.Item.vfuHVSuExvtyajkW\";\r\n\r\nconst ancestralLongevity = createDaily({\r\n    key: \"ancestral-longevity\",\r\n    items: [\r\n        {\r\n            slug: \"trained\", // Ancestral Longevity\r\n            uuid: ancestralUUID,\r\n            required: true,\r\n        },\r\n        {\r\n            slug: \"expert\", // Expert Longevity\r\n            uuid: expertUUID,\r\n        },\r\n    ],\r\n    label: (actor, items) => items.trained.name,\r\n    rows: (actor, items) => {\r\n        const skillList = utils.getSkills();\r\n        const actorSkills = actor.skills;\r\n\r\n        return [\r\n            {\r\n                slug: \"trained\",\r\n                type: \"combo\",\r\n                label: \"PF2E.ProficiencyLevel1\",\r\n                unique: \"skill-1\",\r\n                options: skillList.filter(({ value }) => actorSkills[value].rank === 0),\r\n            },\r\n            {\r\n                slug: \"expert\",\r\n                type: \"combo\",\r\n                label: \"PF2E.ProficiencyLevel2\",\r\n                unique: \"skill-2\",\r\n                options: skillList.filter(({ value }) => actorSkills[value].rank === 1),\r\n                condition: !!items.expert,\r\n            },\r\n        ];\r\n    },\r\n    process: ({ items, rows, messages, addItem, addRule, removeRule }) => {\r\n        const data = [\r\n            [\"trained\", 1, ancestralUUID],\r\n            [\"expert\", 2, expertUUID],\r\n        ] as const;\r\n\r\n        for (const [slug, rank, uuid] of data) {\r\n            const row: DailyRowComboData | undefined = rows[slug];\r\n            const item = items[slug];\r\n\r\n            if (!row || !item) continue;\r\n\r\n            removeRule(item, () => true);\r\n\r\n            let selected = row.selected;\r\n\r\n            if (row.input) {\r\n                const source = utils.createLoreSource({ name: selected, rank });\r\n                addItem(source);\r\n            } else {\r\n                const skill = selected as SkillLongForm;\r\n                const source = utils.createSkillRuleElement({\r\n                    skill,\r\n                    value: rank,\r\n                });\r\n\r\n                selected = utils.getSkillLabel(skill);\r\n                addRule(item, source);\r\n            }\r\n\r\n            messages.add(\"skills\", { uuid, selected });\r\n        }\r\n    },\r\n});\r\n\r\nexport { ancestralLongevity };\r\n", "import { R, localizePath } from \"pf2e-api\";\r\nimport { createDaily } from \"../daily\";\r\nimport { utils } from \"../utils\";\r\n\r\nconst bladeUUID = \"Compendium.pf2e.classfeatures.Item.EtltLdiy9kNfHU0c\";\r\n\r\nconst bladeAlly = createDaily({\r\n    key: \"blade-ally\",\r\n    items: [\r\n        {\r\n            slug: \"blade\", // Blade Ally\r\n            uuid: bladeUUID,\r\n            required: true,\r\n        },\r\n        {\r\n            slug: \"good\", // The Tenets of Good\r\n            uuid: \"Compendium.pf2e.classfeatures.Item.nxZYP3KGfTSkaW6J\",\r\n        },\r\n        {\r\n            slug: \"evil\", // The Tenets of Evil\r\n            uuid: \"Compendium.pf2e.classfeatures.Item.JiY2ZB4FkK8RJm4T\",\r\n        },\r\n        {\r\n            slug: \"spirit\", // Radiant Blade Spirit\r\n            uuid: \"Compendium.pf2e.feats-srd.Item.h5ksUZlrVGBjq6p4\",\r\n        },\r\n        {\r\n            slug: \"master\", // Radiant Blade Master\r\n            uuid: \"Compendium.pf2e.feats-srd.Item.jYEMVfrXJLpXS6aC\",\r\n        },\r\n    ],\r\n    label: (actor, items) => items.blade.name,\r\n    rows: (actor, items) => {\r\n        const weapons = actor.itemTypes.weapon.filter((weapon) => !weapon.isAlchemical);\r\n        if (!weapons.length) return [];\r\n\r\n        const isHoly = actor.traits.has(\"holy\");\r\n        const isUnholy = actor.traits.has(\"unholy\");\r\n        const runes: WeaponPropertyRuneType[] = [];\r\n\r\n        runes.push(\"returning\", \"shifting\");\r\n\r\n        if (items.spirit) {\r\n            runes.push(\"flaming\");\r\n            if (isHoly) runes.push(\"holy\");\r\n            if (isUnholy) runes.push(\"unholy\");\r\n        }\r\n\r\n        if (items.master) {\r\n            // greaterDisrupting = greaterVitalizing\r\n            runes.push(\"dancing\", \"greaterDisrupting\", \"keen\");\r\n        }\r\n\r\n        if (items.good) {\r\n            // disrupting = vitalizing\r\n            runes.push(\"ghostTouch\", \"disrupting\");\r\n        }\r\n\r\n        if (items.evil) {\r\n            runes.push(\"fearsome\");\r\n        }\r\n\r\n        return [\r\n            {\r\n                type: \"select\",\r\n                slug: \"weapon\",\r\n                label: \"TYPES.Item.weapon\",\r\n                options: weapons.map((weapon) => ({ value: weapon.id, label: weapon.name })),\r\n            },\r\n            {\r\n                type: \"select\",\r\n                slug: \"rune\",\r\n                label: localizePath(\"label.rune\"),\r\n                options: R.pipe(\r\n                    runes,\r\n                    R.map((rune) => ({\r\n                        value: rune,\r\n                        label: utils.getWeaponPropertyRuneLabel(rune),\r\n                    })),\r\n                    R.sortBy([R.prop(\"label\"), \"asc\"])\r\n                ),\r\n            },\r\n        ];\r\n    },\r\n    process: ({ actor, rows, messages, addRule }) => {\r\n        const weaponId = rows.weapon;\r\n        const rune = rows.rune as WeaponPropertyRuneType;\r\n\r\n        const weapon = actor.items.get<WeaponPF2e<CharacterPF2e>>(weaponId);\r\n        if (!weapon) return;\r\n\r\n        const itemPredicate = [\r\n            {\r\n                or: [\"item:category:{item|_id}\", \"item:id:{item|_id}\"],\r\n            },\r\n        ];\r\n\r\n        addRule(weapon, {\r\n            key: \"AdjustStrike\",\r\n            definition: itemPredicate,\r\n            mode: \"add\",\r\n            property: \"property-runes\",\r\n            value: rune,\r\n        });\r\n\r\n        addRule(weapon, {\r\n            key: \"CriticalSpecialization\",\r\n            predicate: itemPredicate,\r\n        });\r\n\r\n        const label =\r\n            weapon.name !== weapon._source.name ? `... ${weapon._source.name}` : weapon.name;\r\n\r\n        messages.add(\"blade\", {\r\n            uuid: weapon.uuid,\r\n            label,\r\n            selected: utils.getWeaponPropertyRuneLabel(rune),\r\n        });\r\n    },\r\n});\r\n\r\nexport { bladeAlly };\r\n", "import { createDaily } from \"../daily\";\r\nimport { utils } from \"../utils\";\r\n\r\nconst ICON = \"systems/pf2e/icons/equipment/weapons/wish-knife.webp\";\r\nconst featUUID = \"Compendium.pf2e.feats-srd.Item.78pkCdFaY8hI07Lj\";\r\n\r\nconst ceremonialKnife = createDaily({\r\n    key: \"ceremonial-knife\",\r\n    condition: (actor) => actor.itemTypes.weapon.some((weapon) => weapon.group === \"knife\"),\r\n    items: [\r\n        {\r\n            slug: \"ceremonial\", // Ceremonial Knife\r\n            uuid: featUUID,\r\n            required: true,\r\n        },\r\n    ],\r\n    label: (actor, items) => items.ceremonial.name,\r\n    prepare: (actor) => {\r\n        const rank = Math.ceil((actor.level - 5) / 2);\r\n        return {\r\n            rank: Math.max(rank, 1) as OneToTen,\r\n        };\r\n    },\r\n    rows: (actor, items, custom) => {\r\n        return [\r\n            {\r\n                type: \"drop\",\r\n                slug: \"spell\",\r\n                filter: {\r\n                    type: \"spell\",\r\n                    search: {\r\n                        category: [\"spell\"],\r\n                        rank: custom.rank,\r\n                    },\r\n                },\r\n            },\r\n        ];\r\n    },\r\n    process: async ({ items, rows, custom, messages, addItem }) => {\r\n        const uuid = rows.spell.uuid;\r\n        const rank = custom.rank;\r\n        const label = utils.getSpellWithRankLabel(uuid, rank);\r\n        const source = await utils.createWandSource({\r\n            uuid,\r\n            level: rank,\r\n            itemImg: ICON,\r\n            itemName: items.ceremonial.name,\r\n        });\r\n\r\n        addItem(source);\r\n        messages.add(\"ceremonial\", { uuid, label });\r\n    },\r\n});\r\n\r\nexport { ceremonialKnife };\r\n", "import { createDaily } from \"../daily\";\r\nimport { utils } from \"../utils\";\r\n\r\nconst combatUUID = \"Compendium.pf2e.classfeatures.Item.8g6HzARbhfcgilP8\";\r\nconst improvedUUID = \"Compendium.pf2e.classfeatures.Item.W2rwudMNcAxs8VoX\";\r\n\r\nconst combatFlexibility = createDaily({\r\n    key: \"combat-flexibility\",\r\n    items: [\r\n        {\r\n            slug: \"combat\", // Combat Flexibility\r\n            uuid: combatUUID,\r\n            required: true,\r\n        },\r\n        {\r\n            slug: \"improved\", // Improved Flexibility\r\n            uuid: improvedUUID,\r\n        },\r\n    ],\r\n    label: (actor, items) => items.combat.name,\r\n    rows: (actor, items) => {\r\n        return [\r\n            {\r\n                type: \"drop\",\r\n                slug: \"combat\",\r\n                label: `PF2E.Level8`,\r\n                filter: {\r\n                    type: \"feat\",\r\n                    search: {\r\n                        category: [\"class\"],\r\n                        traits: [\"fighter\"],\r\n                        level: 8,\r\n                    },\r\n                },\r\n            },\r\n            {\r\n                type: \"drop\",\r\n                slug: \"improved\",\r\n                label: `PF2E.Level14`,\r\n                filter: {\r\n                    type: \"feat\",\r\n                    search: {\r\n                        category: [\"class\"],\r\n                        traits: [\"fighter\"],\r\n                        level: 14,\r\n                    },\r\n                },\r\n                condition: !!items.improved,\r\n            },\r\n        ];\r\n    },\r\n    process: async ({ items, rows, messages, addFeat }) => {\r\n        const source = await utils.createFeatSource(rows.combat.uuid);\r\n        addFeat(source, items.combat);\r\n        messages.add(\"feats\", { uuid: rows.combat.uuid });\r\n\r\n        if (rows.improved) {\r\n            const source = await utils.createFeatSource(rows.improved.uuid);\r\n            addFeat(source, items.improved);\r\n            messages.add(\"feats\", { uuid: rows.improved.uuid });\r\n        }\r\n    },\r\n});\r\n\r\nexport { combatFlexibility };\r\n", "import { createDaily } from \"../daily\";\r\nimport { utils } from \"../utils\";\r\n\r\nconst experimentalSpellshaping = createDaily({\r\n    key: \"experimental-spellshaping\",\r\n    items: [\r\n        {\r\n            slug: \"experimental\", // Experimental Spellshaping\r\n            uuid: \"Compendium.pf2e.classfeatures.Item.89zWKD2CN7nRu2xp\",\r\n            required: true,\r\n            condition: (actor) => actor.level >= 4,\r\n        },\r\n    ],\r\n    label: (actor, items) => items.experimental.name,\r\n    rows: () => {\r\n        return [\r\n            {\r\n                slug: \"feat\",\r\n                type: \"drop\",\r\n                filter: {\r\n                    type: \"feat\",\r\n                    search: {\r\n                        category: [\"class\"],\r\n                        traits: [\"spellshape\", \"wizard\"],\r\n                        level: \"half\",\r\n                    },\r\n                },\r\n            },\r\n        ];\r\n    },\r\n    process: async ({ rows, items, messages, addFeat }) => {\r\n        const uuid = rows.feat.uuid;\r\n        const source = await utils.createFeatSource(uuid);\r\n\r\n        addFeat(source, items.experimental);\r\n        messages.add(\"feats\", { uuid });\r\n    },\r\n});\r\n\r\nexport { experimentalSpellshaping };\r\n", "import { R, getFlag, getSetting, localeCompare, localize, setFlagProperty } from \"pf2e-api\";\r\nimport { isTemporary } from \"../api\";\r\nimport { createDaily } from \"../daily\";\r\nimport { DailyMessageOptions } from \"../types\";\r\n\r\nfunction getPack(): CompendiumCollection<AbilityItemPF2e> {\r\n    return game.packs.get(\"pf2e.familiar-abilities\")!;\r\n}\r\n\r\nfunction getFamiliarAbilityCount(actor: CharacterPF2e) {\r\n    const max = actor.attributes.familiarAbilities.value;\r\n    const flag = getFlag<ValueAndMax>(actor, \"familiar\");\r\n\r\n    if (!flag) return max;\r\n    if (flag.max === max) return flag.value;\r\n\r\n    const newValue = flag.value - (flag.max - max);\r\n    return Math.clamped(newValue, 0, max);\r\n}\r\n\r\nconst familiar = createDaily({\r\n    key: \"familiar\",\r\n    condition: (actor) => !!actor.familiar,\r\n    rows: async (actor) => {\r\n        const nbAbilities = getFamiliarAbilityCount(actor);\r\n        if (!nbAbilities) return [];\r\n\r\n        const pack = getPack();\r\n        const uniqueId = randomID();\r\n        const options = pack.index.map(({ _id, name }) => ({\r\n            value: _id,\r\n            label: name,\r\n        }));\r\n        const customUUIDS = getSetting<String>(\"familiarAbilities\").split(\",\");\r\n\r\n        for (let uuid of customUUIDS) {\r\n            uuid = uuid.trim();\r\n            const item = await fromUuid<ItemPF2e>(uuid);\r\n\r\n            if (item?.isOfType(\"action\")) {\r\n                options.push({ value: uuid, label: item.name });\r\n            }\r\n        }\r\n\r\n        options.sort((a, b) => localeCompare(a.label, b.label));\r\n\r\n        return R.range(1, nbAbilities + 1).map((i) => ({\r\n            type: \"select\",\r\n            slug: `ability${i}`,\r\n            label: localize(\"label.ability\", { nb: i }),\r\n            unique: uniqueId,\r\n            order: 100,\r\n            options: options,\r\n        }));\r\n    },\r\n    process: async ({ actor, rows, messages }) => {\r\n        const familiar = actor.familiar;\r\n\r\n        if (!familiar) return;\r\n\r\n        const pack = getPack();\r\n        const abilities: AbilitySource[] = [];\r\n        const messageList: DailyMessageOptions[] = [];\r\n\r\n        await Promise.all(\r\n            Object.values(rows).map(async (value) => {\r\n                const isCustom = value.includes(\".\");\r\n                const item = await (isCustom ? fromUuid<ItemPF2e>(value) : pack.getDocument(value));\r\n\r\n                if (!item?.isOfType(\"action\")) return;\r\n\r\n                const source = item.toObject();\r\n                setFlagProperty(source, \"temporary\", true);\r\n\r\n                abilities.push(source);\r\n                messageList.push({ uuid: item });\r\n            })\r\n        );\r\n\r\n        if (abilities.length) {\r\n            await familiar.createEmbeddedDocuments(\"Item\", abilities);\r\n\r\n            for (const message of messageList) {\r\n                messages.add(\"familiar\", message);\r\n            }\r\n        }\r\n    },\r\n    rest: async ({ actor }) => {\r\n        const familiar = actor.familiar;\r\n\r\n        if (!familiar) return;\r\n\r\n        const ids = familiar.itemTypes.action\r\n            .filter((item) => isTemporary(item))\r\n            .map((item) => item.id);\r\n\r\n        if (ids.length) {\r\n            await familiar.deleteEmbeddedDocuments(\"Item\", ids);\r\n        }\r\n    },\r\n});\r\n\r\nexport { familiar, getFamiliarAbilityCount };\r\n", "import { createDaily } from \"../daily\";\r\nimport { utils } from \"../utils\";\r\n\r\nfunction createLanguageDaily(key: string, uuid: string) {\r\n    return createDaily({\r\n        key,\r\n        items: [\r\n            {\r\n                slug: \"item\",\r\n                uuid,\r\n                required: true,\r\n            },\r\n        ],\r\n        label: (actor, items) => items.item.name,\r\n        rows: (actor) => {\r\n            const languageList = utils.getLanguages();\r\n            const actorLanguages = actor.system.details.languages.value;\r\n            const options = languageList.filter(({ value }) => !actorLanguages.includes(value));\r\n\r\n            return [\r\n                {\r\n                    type: \"select\",\r\n                    slug: \"language\",\r\n                    options,\r\n                },\r\n            ];\r\n        },\r\n        process: ({ rows, items, messages, addRule }) => {\r\n            const language = rows.language;\r\n            const source = utils.createLanguageRuleElement({ language });\r\n\r\n            addRule(items.item, source);\r\n            messages.add(\"languages\", { uuid, selected: utils.getLanguageLabel(language) });\r\n        },\r\n    });\r\n}\r\n\r\nexport { createLanguageDaily };\r\n", "import { R, htmlElement, localize, localizePath, querySelector, subLocalize } from \"pf2e-api\";\r\nimport { createDaily } from \"../daily\";\r\nimport { DailyRowSelectOption } from \"../types\";\r\nimport { utils } from \"../utils\";\r\n\r\nconst mindUUID = \"Compendium.pf2e.feats-srd.Item.juikoiIA0Jy8PboY\";\r\nconst mentalUUID = \"Compendium.pf2e.feats-srd.Item.PccekOihIbRWdDky\";\r\nconst metallicUUID = \"Compendium.pf2e.feats-srd.Item.8KUvJuAWCoxWg5FH\";\r\nconst runicUUID = \"Compendium.pf2e.feats-srd.Item.2uQbQgz1AbjzcFSp\";\r\nconst advancedUUID = \"Compendium.pf2e.feats-srd.Item.fgnfXwFcn9jZlXGD\";\r\n\r\nconst weaponSlug = \"mind-weapon\";\r\n\r\nconst weaponBases: { die: DamageDieSize; traits: string[]; usage: WeaponUsage }[] = [\r\n    { die: \"d4\", traits: [\"finesse\", \"agile\"], usage: \"held-in-one-hand\" },\r\n    { die: \"d6\", traits: [\"finesse\"], usage: \"held-in-one-hand\" },\r\n    { die: \"d8\", traits: [], usage: \"held-in-one-hand\" },\r\n    { die: \"d10\", traits: [\"reach\"], usage: \"held-in-two-hands\" },\r\n];\r\n\r\nconst weaponDamages = {\r\n    slashing: \"sword\",\r\n    bludgeoning: \"club\",\r\n    piercing: \"spear\",\r\n} as const;\r\n\r\nconst mentalForgeTraits = [\"grapple\", \"modular\", \"nonlethal\", \"shove\", \"trip\"] as const;\r\n\r\nconst metallicMaterials = [\"cold-iron\", \"silver\"] as const;\r\n\r\n// disrupting = vitalizing\r\nconst runicRunes = [\"corrosive\", \"disrupting\", \"flaming\", \"frost\", \"shock\", \"thundering\"] as const;\r\n\r\n// greaterDisrupting = greaterVitalizing\r\nconst advancedRunes = [\r\n    \"greaterCorrosive\",\r\n    \"greaterDisrupting\",\r\n    \"greaterFlaming\",\r\n    \"greaterFrost\",\r\n    \"greaterShock\",\r\n    \"greaterThundering\",\r\n    \"holy\",\r\n    \"unholy\",\r\n] as const;\r\n\r\nasync function createMindWeapon(actor: CharacterPF2e) {\r\n    const weaponLocalize = subLocalize(\"dialog.mind-weapon\");\r\n\r\n    const weaponRows = weaponBases.map(({ die, traits, usage }, i) => {\r\n        const checked = i === 1 ? \"checked\" : \"\";\r\n        const label = weaponLocalize(\"label\", {\r\n            die,\r\n            hand: weaponLocalize(usage),\r\n            hasTrait: traits.length\r\n                ? weaponLocalize(traits.length === 1 ? \"oneTrait\" : \"twoTraits\", {\r\n                      trait1: utils.getWeaponTraitLabel(traits[0]),\r\n                      trait2: traits[1] ? utils.getWeaponTraitLabel(traits[1]) : \"\",\r\n                  })\r\n                : \"\",\r\n        });\r\n\r\n        return `<label>\r\n            <input type=\"radio\" name=\"type\" value=\"${i}\" ${checked}>\r\n            ${label}\r\n        </label>`;\r\n    });\r\n\r\n    const flavor = `<div class=\"flavor\">${weaponLocalize(\"flavor\")}</div>`;\r\n\r\n    const potencyRunes = R.pipe(\r\n        R.range(0, 5) as ZeroToFour[],\r\n        R.map((i) => {\r\n            const label = i ? utils.getWeaponPotencyRuneLabel(i) : \"\";\r\n            return `<option value=\"${i}\">${label}</option>`;\r\n        })\r\n    );\r\n\r\n    const runeSelect = `<label class=\"runes\">\r\n        ${game.i18n.localize(\"PF2E.PotencyRuneLabel\")}\r\n        <select name=\"rune\">\r\n            ${potencyRunes.join(\"\")}\r\n        </select>\r\n    </label>`;\r\n\r\n    const selection = await Dialog.wait(\r\n        {\r\n            title: weaponLocalize(\"title\"),\r\n            content: flavor + weaponRows.join(\"\") + runeSelect,\r\n            buttons: {\r\n                yes: {\r\n                    icon: '<i class=\"fas fa-save\"></i>',\r\n                    label: weaponLocalize(\"yes\"),\r\n                    callback: ($html) => {\r\n                        const html = htmlElement($html);\r\n                        const input = querySelector<HTMLInputElement>(\r\n                            html,\r\n                            \"input[name='type']:checked\"\r\n                        );\r\n                        const select = querySelector<HTMLSelectElement>(\r\n                            html,\r\n                            \"select[name='rune']\"\r\n                        );\r\n\r\n                        return {\r\n                            type: Number(input!.value),\r\n                            rune: Number(select!.value) as ZeroToFour,\r\n                        };\r\n                    },\r\n                },\r\n                no: {\r\n                    icon: '<i class=\"fas fa-times\"></i>',\r\n                    label: weaponLocalize(\"no\"),\r\n                    callback: () => null,\r\n                },\r\n            },\r\n            close: () => null,\r\n        },\r\n        { id: \"pf2e-dailies-weapon\", width: 600 }\r\n    );\r\n\r\n    if (selection === null) return false;\r\n\r\n    const { die, traits, usage } = weaponBases[selection.type];\r\n\r\n    const source: PreCreate<WeaponSource> = {\r\n        type: \"weapon\",\r\n        name: localize(\"mindsmith.weapon.name\"),\r\n        img: \"systems/pf2e/icons/spells/disrupting-weapons.webp\",\r\n        system: {\r\n            slug: weaponSlug,\r\n            level: { value: actor.level },\r\n            category: \"martial\",\r\n            damage: {\r\n                damageType: \"slashing\",\r\n                die: die,\r\n                dice: 1,\r\n            },\r\n            traits: {\r\n                value: traits,\r\n            },\r\n            usage: {\r\n                value: usage,\r\n            },\r\n            runes: {\r\n                potency: selection.rune,\r\n            },\r\n        },\r\n    };\r\n\r\n    await actor.createEmbeddedDocuments(\"Item\", [source]);\r\n\r\n    return true;\r\n}\r\n\r\nfunction damageLabel(damage: keyof typeof weaponDamages) {\r\n    const damageLabel = utils.getWeaponDamageLabel(damage);\r\n    const groupLabel = utils.getWeaponGroupLabel(weaponDamages[damage]);\r\n    return `${groupLabel} (${damageLabel})`;\r\n}\r\n\r\nconst mindSmith = createDaily({\r\n    key: \"mind-smith\",\r\n    items: [\r\n        {\r\n            slug: \"mind\", // Mind Smith Dedication\r\n            uuid: mindUUID,\r\n            required: true,\r\n        },\r\n        {\r\n            slug: \"mental\", // Malleable Mental Forge\r\n            uuid: mentalUUID,\r\n        },\r\n        {\r\n            slug: \"metallic\", // Metallic Envisionment\r\n            uuid: metallicUUID,\r\n        },\r\n        {\r\n            slug: \"runic\", // Runic Mind Smithing\r\n            uuid: runicUUID,\r\n        },\r\n        {\r\n            slug: \"advanced\", // Advanced Runic Mind Smithing\r\n            uuid: advancedUUID,\r\n        },\r\n    ],\r\n    label: (actor, items) => items.mind.name,\r\n    rows: (actor, items) => {\r\n        const weapon = actor.itemTypes.weapon.find((weapon) => weapon.slug === weaponSlug);\r\n\r\n        if (!weapon) {\r\n            return [\r\n                {\r\n                    type: \"alert\",\r\n                    slug: \"alert\",\r\n                    message: localize(\"interface.mindsmith.missing\"),\r\n                    resolve: () => createMindWeapon(actor),\r\n                },\r\n            ];\r\n        }\r\n\r\n        const selectThat = (that: string) => {\r\n            return localize(\"label.select\", {\r\n                that: game.i18n.localize(that),\r\n            });\r\n        };\r\n\r\n        const arrayToOptions = <T extends string>(\r\n            truthy: boolean,\r\n            arr: ReadonlyArray<T>,\r\n            labelizer: (value: T) => string\r\n        ): DailyRowSelectOption[] => {\r\n            return truthy\r\n                ? R.pipe(\r\n                      arr,\r\n                      R.map.strict((value) => ({\r\n                          value,\r\n                          label: labelizer(value),\r\n                      })),\r\n                      R.sortBy([R.prop(\"label\"), \"asc\"])\r\n                  )\r\n                : [];\r\n        };\r\n\r\n        const mentalUniqueId = randomID();\r\n        const mentalOptions = arrayToOptions(\r\n            !!items.mental,\r\n            mentalForgeTraits,\r\n            utils.getWeaponTraitLabel\r\n        );\r\n\r\n        const canHaveRune =\r\n            (!!items.runic || !!items.advanced) && utils.hasFreePropertySlot(weapon);\r\n\r\n        return [\r\n            {\r\n                type: \"select\",\r\n                slug: \"damage\",\r\n                label: selectThat(\"PF2E.WeaponGroupLabel\"),\r\n                options: R.pipe(\r\n                    R.keys.strict(weaponDamages),\r\n                    R.map((damage) => ({\r\n                        value: damage,\r\n                        label: damageLabel(damage),\r\n                    })),\r\n                    R.sortBy([R.prop(\"label\"), \"asc\"])\r\n                ),\r\n            },\r\n            {\r\n                type: \"select\",\r\n                slug: `trait1`,\r\n                label: \"PF2E.NPC.AddTrait\",\r\n                options: mentalOptions,\r\n                unique: mentalUniqueId,\r\n                condition: !!items.mental,\r\n            },\r\n            {\r\n                type: \"select\",\r\n                slug: `trait2`,\r\n                label: \"PF2E.NPC.AddTrait\",\r\n                options: mentalOptions,\r\n                unique: mentalUniqueId,\r\n                condition: !!items.mental,\r\n            },\r\n            {\r\n                type: \"select\",\r\n                slug: \"material\",\r\n                label: \"PF2E.PreciousMaterialLabel\",\r\n                options: arrayToOptions(\r\n                    !!items.metallic,\r\n                    metallicMaterials,\r\n                    utils.getPreciousMaterialLabel\r\n                ),\r\n                condition: !!items.metallic,\r\n            },\r\n            {\r\n                type: \"select\",\r\n                slug: \"rune\",\r\n                label: localizePath(\"label.rune\"),\r\n                options: arrayToOptions(\r\n                    canHaveRune,\r\n                    items.advanced ? advancedRunes : runicRunes,\r\n                    utils.getWeaponPropertyRuneLabel\r\n                ),\r\n                condition: canHaveRune,\r\n            },\r\n        ];\r\n    },\r\n    process: ({ actor, items, rows, messages, updateItem, addRule }) => {\r\n        const weapon = actor.itemTypes.weapon.find((weapon) => weapon.slug === weaponSlug);\r\n        if (!weapon) return;\r\n\r\n        const damage = rows.damage as keyof typeof weaponDamages;\r\n\r\n        updateItem({\r\n            _id: weapon.id,\r\n            \"system.damage.damageType\": damage,\r\n            \"system.group\": weaponDamages[damage],\r\n        });\r\n\r\n        messages.add(\"mindsmith\", {\r\n            uuid: mindUUID,\r\n            label: localize(\"label.mind-smith\"),\r\n            selected: damageLabel(damage),\r\n        });\r\n\r\n        const itemPredicate = [\r\n            {\r\n                or: [\"item:category:{item|_id}\", \"item:id:{item|_id}\"],\r\n            },\r\n        ];\r\n\r\n        const traits = R.pipe(\r\n            [1, 2] as const,\r\n            R.map((i) => rows[`trait${i}`]),\r\n            R.compact\r\n        );\r\n\r\n        for (const trait of traits) {\r\n            addRule(weapon, {\r\n                key: \"ItemAlteration\",\r\n                itemType: \"weapon\",\r\n                mode: \"add\",\r\n                property: \"traits\",\r\n                predicate: itemPredicate,\r\n                value: trait,\r\n            });\r\n        }\r\n\r\n        if (traits.length) {\r\n            messages.add(\"mindsmith\", {\r\n                uuid: mentalUUID,\r\n                label: localize(\"label.mind-mental\"),\r\n                selected: traits.map(utils.getWeaponTraitLabel).join(\" & \"),\r\n            });\r\n        }\r\n\r\n        if (rows.material) {\r\n            const material = rows.material as PreciousMaterialType;\r\n\r\n            addRule(weapon, {\r\n                key: \"ItemAlteration\",\r\n                itemType: \"weapon\",\r\n                mode: \"override\",\r\n                property: \"material-type\",\r\n                predicate: itemPredicate,\r\n                value: material,\r\n            });\r\n\r\n            messages.add(\"mindsmith\", {\r\n                uuid: metallicUUID,\r\n                selected: utils.getPreciousMaterialLabel(material),\r\n            });\r\n        }\r\n\r\n        if (rows.rune && utils.hasFreePropertySlot(weapon)) {\r\n            const rune = rows.rune as WeaponPropertyRuneType;\r\n\r\n            addRule(weapon, {\r\n                key: \"AdjustStrike\",\r\n                definition: itemPredicate,\r\n                mode: \"add\",\r\n                property: \"property-runes\",\r\n                value: rows.rune,\r\n            });\r\n\r\n            messages.add(\"mindsmith\", {\r\n                uuid: items.advanced ? advancedUUID : runicUUID,\r\n                label: localize(\"label.mind-runic\"),\r\n                selected: utils.getWeaponPropertyRuneLabel(rune),\r\n            });\r\n        }\r\n    },\r\n});\r\n\r\nexport { mindSmith };\r\n", "import { localize } from \"pf2e-api\";\r\nimport { createDaily } from \"../daily\";\r\nimport { utils } from \"../utils\";\r\n\r\nconst rationsUUID = \"Compendium.pf2e.equipment-srd.Item.L9ZV076913otGtiB\";\r\n\r\nconst rations = createDaily({\r\n    key: \"rations\",\r\n    items: [\r\n        {\r\n            slug: \"rations\",\r\n            uuid: rationsUUID, // Rations\r\n            required: true,\r\n        },\r\n    ],\r\n    label: (actor, items) => items.rations.name,\r\n    rows: (actor, items) => {\r\n        const rations = items.rations as ConsumablePF2e;\r\n        const { value, max } = rations.uses;\r\n        const remaining = (rations.quantity - 1) * max + value;\r\n        const last = remaining <= 1;\r\n\r\n        return [\r\n            {\r\n                slug: \"rations\",\r\n                type: \"select\",\r\n                order: 200,\r\n                save: false,\r\n                options: [\r\n                    {\r\n                        value: \"false\",\r\n                        label: localize(\"interface.rations.no\"),\r\n                    },\r\n                    {\r\n                        value: \"true\",\r\n                        label: last\r\n                            ? localize(\"interface.rations.last\")\r\n                            : localize(\"interface.rations.yes\", { nb: remaining }),\r\n                    },\r\n                ],\r\n            },\r\n        ];\r\n    },\r\n    process: ({ rows, items, messages, updateItem, deleteItem }) => {\r\n        if (rows.rations !== \"true\") return;\r\n\r\n        const rations = items.rations as ConsumablePF2e;\r\n        let { value, max } = rations.uses;\r\n        let quantity = rations.quantity;\r\n\r\n        if (value > 1) {\r\n            updateItem({\r\n                _id: rations.id,\r\n                \"system.uses.value\": --value,\r\n            });\r\n        } else if (quantity > 1) {\r\n            updateItem({\r\n                _id: rations.id,\r\n                \"system.quantity\": --quantity,\r\n                \"system.uses.value\": (value = max),\r\n            });\r\n        } else {\r\n            deleteItem(rations);\r\n            quantity = 0;\r\n            value = 0;\r\n        }\r\n\r\n        const remaining = (quantity - 1) * max + value;\r\n        const name = utils.createChatLink(rationsUUID, rations.name);\r\n        const message =\r\n            remaining < 1\r\n                ? localize(\"message.rations.last\", { name })\r\n                : remaining < 3\r\n                ? localize(\"message.rations.almost\", { name, nb: remaining })\r\n                : localize(\"message.rations.used\", { name, nb: remaining });\r\n\r\n        messages.addRaw(message, 200);\r\n    },\r\n});\r\n\r\nexport { rations };\r\n", "import { createDaily } from \"../daily\";\r\nimport { utils, type SimplifiableRuleValue } from \"../utils\";\r\n\r\nfunction createResistanceDaily(\r\n    key: string,\r\n    uuid: string,\r\n    resistances: string[],\r\n    resistance: SimplifiableRuleValue,\r\n    isRandom = false\r\n) {\r\n    return createDaily({\r\n        key,\r\n        items: [\r\n            {\r\n                slug: \"item\",\r\n                uuid,\r\n                required: true,\r\n            },\r\n        ],\r\n        label: (actor, items) => items.item.name,\r\n        rows: () => {\r\n            const options = resistances.map((value) => ({\r\n                value,\r\n                label: utils.getResistanceLabel(value, true),\r\n            }));\r\n\r\n            return [\r\n                {\r\n                    type: isRandom ? \"random\" : \"select\",\r\n                    slug: \"resistance\",\r\n                    options,\r\n                },\r\n            ];\r\n        },\r\n        process: ({ rows, items, messages, addRule }) => {\r\n            const source = utils.createResistanceRuleElement({\r\n                type: rows.resistance,\r\n                value: resistance,\r\n            });\r\n\r\n            addRule(items.item, source);\r\n            messages.add(\"resistances\", {\r\n                uuid,\r\n                selected: utils.getResistanceLabel(rows.resistance),\r\n                random: isRandom,\r\n            });\r\n        },\r\n    });\r\n}\r\n\r\nexport { createResistanceDaily };\r\n", "import { createDaily } from \"../daily\";\r\nimport { utils } from \"../utils\";\r\n\r\nconst featUUID = \"Compendium.pf2e.feats-srd.Item.22P7IFyhrF7Fbw8B\";\r\nconst effectUUID = \"Compendium.pf2e.feat-effects.Item.jO7wMhnjT7yoAtQg\";\r\n\r\nconst rootMagic = createDaily({\r\n    key: \"root-magic\",\r\n    items: [\r\n        {\r\n            slug: \"root\", // Root Magic\r\n            uuid: featUUID,\r\n            required: true,\r\n        },\r\n    ],\r\n    label: (actor, items) => items.root.name,\r\n    rows: (actor) => {\r\n        return [\r\n            {\r\n                type: \"select\",\r\n                slug: \"target\",\r\n                options: utils.getActors(actor).map((a) => ({ value: a.id, label: a.name })),\r\n            },\r\n        ];\r\n    },\r\n    process: ({ rows, messages }) => {\r\n        const actor = game.actors.get(rows.target);\r\n        if (actor) {\r\n            messages.add(\"root\", { uuid: effectUUID, selected: actor.name });\r\n        }\r\n    },\r\n});\r\n\r\nexport { rootMagic };\r\n", "import { R } from \"pf2e-api\";\r\nimport { createDaily } from \"../daily\";\r\nimport { DailyRowDropSpell } from \"../types\";\r\nimport { utils } from \"../utils\";\r\n\r\nconst adeptUUID = \"Compendium.pf2e.feats-srd.Item.u5DBg0LrBUKP0JsJ\";\r\n\r\nconst scrollAdept = createDaily({\r\n    key: \"scroll-adept\",\r\n    items: [\r\n        {\r\n            slug: \"adept\", // Scroll Adept\r\n            uuid: adeptUUID,\r\n            required: true,\r\n        },\r\n    ],\r\n    label: (actor, items) => items.adept.name,\r\n    prepare: (actor) => {\r\n        const maxRank = utils.getSpellcastingMaxRank(actor, { tradition: \"arcane\" });\r\n        const proficiency = actor.system.proficiencies.spellcasting.rank;\r\n\r\n        const ranks = R.pipe(\r\n            R.range(2, Math.clamped(proficiency, 2, 4) + 2),\r\n            R.map((r): { rank: OneToTen; row: `rank${OneToTen}` } => {\r\n                const rank = (maxRank - r) as OneToTen;\r\n                return {\r\n                    rank,\r\n                    row: `rank${rank}`,\r\n                };\r\n            }),\r\n            R.filter(({ rank }) => rank > 0)\r\n        );\r\n\r\n        return { ranks };\r\n    },\r\n    rows: (actor, items, custom) => {\r\n        return custom.ranks.map(\r\n            ({ rank, row }): DailyRowDropSpell => ({\r\n                slug: row,\r\n                type: \"drop\",\r\n                label: utils.getSpellRankLabel(rank),\r\n                filter: {\r\n                    type: \"spell\",\r\n                    search: {\r\n                        category: [\"spell\"],\r\n                        traditions: [\"arcane\"],\r\n                        rank,\r\n                    },\r\n                },\r\n            })\r\n        );\r\n    },\r\n    process: async ({ rows, custom, messages, addItem }) => {\r\n        for (const data of custom.ranks) {\r\n            const { uuid } = rows[data.row];\r\n            if (!uuid) continue;\r\n\r\n            const label = utils.getSpellWithRankLabel(uuid, data.rank);\r\n            const source = await utils.createSpellScrollSource({\r\n                uuid,\r\n                level: data.rank,\r\n            });\r\n\r\n            addItem(source);\r\n            messages.add(\"scrolls\", { uuid, label });\r\n        }\r\n    },\r\n});\r\n\r\nexport { scrollAdept };\r\n", "import { R } from \"pf2e-api\";\r\nimport { createDaily } from \"../daily\";\r\nimport { DailyRowDropSpell } from \"../types\";\r\nimport { utils } from \"../utils\";\r\n\r\ntype OneToSeven = OneToSix | 7;\r\n\r\nfunction createScrollChainDaily(key: string, uuids: [string, string, string]) {\r\n    return createDaily({\r\n        key,\r\n        items: [\r\n            {\r\n                slug: \"trained\",\r\n                uuid: uuids[0],\r\n                required: true,\r\n            },\r\n            {\r\n                slug: \"expert\",\r\n                uuid: uuids[1],\r\n            },\r\n            {\r\n                slug: \"master\",\r\n                uuid: uuids[2],\r\n            },\r\n        ],\r\n        label: (actor, items) => items.trained.name,\r\n        rows: (actor, items) => {\r\n            const level = actor.level;\r\n            const ranks: OneToSeven[] = [1];\r\n\r\n            if (level >= 8) ranks.push(2);\r\n\r\n            if (items.expert) {\r\n                ranks.push(3);\r\n                if (level >= 14) ranks.push(4);\r\n                if (level >= 16) ranks.push(5);\r\n            }\r\n\r\n            if (items.master) {\r\n                ranks.push(6);\r\n                if (level >= 20) ranks.push(7);\r\n            }\r\n\r\n            return ranks.map(\r\n                (rank): DailyRowDropSpell => ({\r\n                    type: \"drop\",\r\n                    slug: `rank${rank}`,\r\n                    label: utils.getSpellRankLabel(rank),\r\n                    filter: {\r\n                        type: \"spell\",\r\n                        search: {\r\n                            category: [\"spell\"],\r\n                            rank,\r\n                            rarity: [\"common\"],\r\n                        },\r\n                    },\r\n                })\r\n            );\r\n        },\r\n        process: async ({ rows, messages, addItem }) => {\r\n            for (const rank of R.range(1, 8) as OneToSeven[]) {\r\n                const { uuid } = rows[`rank${rank}`] ?? {};\r\n                if (!uuid) continue;\r\n\r\n                const label = utils.getSpellWithRankLabel(uuid, rank);\r\n                const source = await utils.createSpellScrollSource({\r\n                    uuid,\r\n                    level: rank,\r\n                });\r\n\r\n                addItem(source);\r\n                messages.add(\"scrolls\", { uuid, label });\r\n            }\r\n        },\r\n    });\r\n}\r\n\r\nexport { createScrollChainDaily };\r\n", "import { createDaily } from \"../daily\";\r\nimport { utils } from \"../utils\";\r\n\r\nfunction createComboSkillDaily(\r\n    key: string,\r\n    uuid: string,\r\n    { rank = 1, removeRules = true }: { rank?: OneToFour; removeRules?: boolean } = {}\r\n) {\r\n    return createDaily({\r\n        key,\r\n        items: [\r\n            {\r\n                slug: \"item\",\r\n                uuid,\r\n                required: true,\r\n            },\r\n        ],\r\n        label: (actor, items) => items.item.name,\r\n        rows: (actor) => {\r\n            const skillList = utils.getSkills();\r\n            const actorSkills = actor.skills;\r\n            const options = skillList.filter(({ value }) => actorSkills[value].rank === rank - 1);\r\n\r\n            return [\r\n                {\r\n                    slug: \"skill\",\r\n                    type: \"combo\",\r\n                    label: \"PF2E.ProficiencyLevel1\",\r\n                    unique: `skill-${rank}`,\r\n                    options,\r\n                },\r\n            ];\r\n        },\r\n        process: ({ rows, items, messages, addItem, addRule, removeRule }) => {\r\n            let selected = rows.skill.selected;\r\n\r\n            if (removeRules) {\r\n                removeRule(items.item, () => true);\r\n            }\r\n\r\n            if (rows.skill.input) {\r\n                const source = utils.createLoreSource({ name: selected, rank });\r\n                addItem(source);\r\n            } else {\r\n                const skill = selected as SkillLongForm;\r\n                const source = utils.createSkillRuleElement({\r\n                    skill,\r\n                    value: rank,\r\n                });\r\n\r\n                selected = utils.getSkillLabel(skill);\r\n                addRule(items.item, source);\r\n            }\r\n\r\n            messages.add(\"skills\", { uuid, selected });\r\n        },\r\n    });\r\n}\r\n\r\nfunction createLoreSkillDaily(key: string, uuid: string) {\r\n    return createDaily({\r\n        key,\r\n        items: [\r\n            {\r\n                slug: \"item\",\r\n                uuid,\r\n                required: true,\r\n            },\r\n        ],\r\n        label: (actor, items) => items.item.name,\r\n        rows: () => {\r\n            return [\r\n                {\r\n                    type: \"input\",\r\n                    slug: \"lore\",\r\n                },\r\n            ];\r\n        },\r\n        process: ({ rows, messages, addItem }) => {\r\n            const source = utils.createLoreSource({ name: rows.lore, rank: 1 });\r\n            addItem(source);\r\n            messages.add(\"skills\", { uuid, selected: rows.lore });\r\n        },\r\n    });\r\n}\r\n\r\nexport { createComboSkillDaily, createLoreSkillDaily };\r\n", "import {\r\n    ErrorPF2e,\r\n    R,\r\n    createCounteractStatistic,\r\n    createHTMLFromString,\r\n    elementData,\r\n    error,\r\n    getActorMaxRank,\r\n    getRankLabel,\r\n    hasItemWithSourceId,\r\n    htmlElement,\r\n    localize,\r\n    querySelector,\r\n    querySelectorArray,\r\n    subLocalize,\r\n    waitDialog,\r\n    warn,\r\n} from \"pf2e-api\";\r\nimport { canCastRank, getStaffFlags, setStaffChargesValue } from \"../api\";\r\nimport { createDaily } from \"../daily\";\r\nimport {\r\n    ChargesSpellcastingSheetData,\r\n    DailyRowSelectOption,\r\n    DailyRowSelectOptionValue,\r\n} from \"../types\";\r\nimport { utils } from \"../utils\";\r\n\r\ntype FlexiblePreparedEntryGroup = {\r\n    id: string;\r\n    name: string;\r\n    slots: {\r\n        rank: ZeroToTen;\r\n        value: number;\r\n        max: number;\r\n    }[];\r\n};\r\n\r\ntype PreparedEntryGroup = {\r\n    id: string;\r\n    name: string;\r\n    spells: {\r\n        name?: string;\r\n        rank: ZeroToTen;\r\n        index: number;\r\n    }[];\r\n};\r\n\r\nconst KINETIC_ACTIVATION = \"Compendium.pf2e.feats-srd.Item.NV9H39kbkbjhAK6X\";\r\nconst STAFF_NEXUS = \"Compendium.pf2e.classfeatures.Item.Klb35AwlkNrq1gpB\";\r\n\r\nconst UUID_REGEX = /@(uuid|compendium)\\[([a-z0-9\\._-]+)\\]/gi;\r\nconst LABEL_REGEX = /\\d+/;\r\n\r\nfunction isStaff(item: ItemPF2e) {\r\n    const trait = item.isOfType(\"weapon\") ? \"magical\" : \"coda\";\r\n    const traits = item.system.traits?.value;\r\n    return traits?.includes(\"staff\") && traits.includes(trait);\r\n}\r\n\r\nfunction getStaves(actor: CharacterPF2e) {\r\n    return [\r\n        ...actor.itemTypes.weapon.filter(isStaff),\r\n        ...actor.itemTypes.equipment.filter(isStaff),\r\n    ];\r\n}\r\n\r\nfunction hasStaves(actor: CharacterPF2e) {\r\n    return actor.itemTypes.weapon.some(isStaff) || actor.itemTypes.equipment.some(isStaff);\r\n}\r\n\r\nconst staves = createDaily({\r\n    key: \"staves\",\r\n    condition: (actor) => hasStaves(actor),\r\n    prepare: (actor) => {\r\n        const entries = actor.spellcasting.spellcastingFeatures;\r\n\r\n        let maxCharges = 0;\r\n        const actorCharges = utils.getActorMaxRank(actor);\r\n        const activationType =\r\n            actor.getStatistic(\"kineticist\") &&\r\n            hasItemWithSourceId(actor, KINETIC_ACTIVATION, \"feat\")\r\n                ? \"kineticist\"\r\n                : undefined;\r\n\r\n        if (activationType) {\r\n            maxCharges = Math.max(maxCharges, actorCharges);\r\n        } else {\r\n            maxCharges =\r\n                R.pipe(\r\n                    entries,\r\n                    R.map((entry) => entry.highestRank),\r\n                    R.firstBy([R.identity, \"desc\"])\r\n                ) ?? 0;\r\n        }\r\n\r\n        if (maxCharges > actorCharges) {\r\n            maxCharges = actorCharges;\r\n        }\r\n\r\n        if (!maxCharges) {\r\n            return {};\r\n        }\r\n\r\n        const preparedEntries: Record<string, FlexiblePreparedEntryGroup | PreparedEntryGroup> = {};\r\n\r\n        for (const entry of entries.filter((entry) => entry.isPrepared)) {\r\n            const entryId = entry.id;\r\n            const isFlexible = entry.isFlexible;\r\n\r\n            for (let rank = 1; rank <= 10; rank++) {\r\n                const slotKey = `slot${rank}` as SlotKey;\r\n                const data = entry.system.slots[slotKey];\r\n\r\n                if (data.max < 1) continue;\r\n\r\n                if (isFlexible) {\r\n                    if (data.value < 1) continue;\r\n\r\n                    preparedEntries[entryId] ??= {\r\n                        id: entryId,\r\n                        name: entry.name,\r\n                        slots: [],\r\n                    };\r\n\r\n                    (preparedEntries[entryId] as FlexiblePreparedEntryGroup).slots.push({\r\n                        rank: rank as ZeroToTen,\r\n                        value: data.value,\r\n                        max: data.max,\r\n                    });\r\n                } else {\r\n                    for (const [index, { id, expended }] of Object.entries(data.prepared)) {\r\n                        if (expended) continue;\r\n\r\n                        const spell = entry.spells?.get(id);\r\n\r\n                        preparedEntries[entryId] ??= {\r\n                            id: entryId,\r\n                            name: entry.name,\r\n                            spells: [],\r\n                        };\r\n\r\n                        (preparedEntries[entryId] as PreparedEntryGroup).spells.push({\r\n                            name: spell?.name,\r\n                            rank: rank as ZeroToTen,\r\n                            index: Number(index),\r\n                        });\r\n                    }\r\n                }\r\n            }\r\n\r\n            (preparedEntries[entryId] as PreparedEntryGroup | undefined)?.spells?.sort(\r\n                (a, b) => a.rank - b.rank\r\n            );\r\n        }\r\n\r\n        return { entries, maxCharges, preparedEntries, activationType };\r\n    },\r\n    rows: (actor, items, custom) => {\r\n        if (!custom.entries) {\r\n            return [];\r\n        }\r\n\r\n        const staves = getStaves(actor).map((staff) => ({\r\n            value: staff.id,\r\n            label: staff.name,\r\n        }));\r\n\r\n        const staffRow = {\r\n            type: \"select\",\r\n            slug: \"staff\",\r\n            label: \"PF2E.Weapon.Base.staff\",\r\n            options: staves,\r\n        } as const;\r\n\r\n        const preparedEntries = Object.values(custom.preparedEntries);\r\n\r\n        if (!preparedEntries.length) {\r\n            return [staffRow];\r\n        }\r\n\r\n        const level = actor.level;\r\n        const hasStaffNexus = level >= 8 && hasItemWithSourceId(actor, STAFF_NEXUS, \"feat\");\r\n        const options: DailyRowSelectOption[] = [{ value: \"\", label: \"\" }];\r\n        const flexibleLabel = localize(\"interface.staves.flexible\");\r\n        const emptyLabel = localize(\"interface.staves.empty\");\r\n        const nbExpends = hasStaffNexus ? (level >= 16 ? 3 : 2) : 1;\r\n\r\n        for (const entry of Object.values(preparedEntries)) {\r\n            options.push({ group: entry.name });\r\n\r\n            if (\"slots\" in entry) {\r\n                for (let index = 0; index < entry.slots.length; index++) {\r\n                    const slot = entry.slots[index];\r\n                    const rankLabel = utils.getSpellRankLabel(slot.rank);\r\n                    const uniqueKey = `${entry.id}.slots.${index}`;\r\n                    const option: DailyRowSelectOptionValue = {\r\n                        value: uniqueKey,\r\n                        label: `${flexibleLabel} ${slot.value}/${slot.max} (${rankLabel})`,\r\n                    };\r\n\r\n                    if (slot.value >= nbExpends) {\r\n                        option.skipUnique = true;\r\n                    } else {\r\n                        option.unique = uniqueKey;\r\n                    }\r\n\r\n                    options.push(option);\r\n                }\r\n            } else {\r\n                for (let index = 0; index < entry.spells.length; index++) {\r\n                    const spell = entry.spells[index];\r\n                    const name = spell.name ?? emptyLabel;\r\n                    const uniqueKey = `${entry.id}.spells.${index}`;\r\n                    const rankLabel = utils.getSpellRankLabel(spell.rank);\r\n\r\n                    options.push({\r\n                        value: uniqueKey,\r\n                        label: `${name} (${rankLabel})`,\r\n                        unique: uniqueKey,\r\n                    });\r\n                }\r\n            }\r\n        }\r\n\r\n        const uniqueId = randomID();\r\n        const rows = R.range(1, nbExpends + 1).map((i) => {\r\n            return {\r\n                type: \"select\",\r\n                slug: `expend${i}`,\r\n                save: false,\r\n                empty: true,\r\n                label: localize(\"label.expend\", { nb: i }),\r\n                unique: uniqueId,\r\n                options,\r\n            } as const;\r\n        });\r\n\r\n        // @ts-ignore\r\n        rows.unshift(staffRow);\r\n\r\n        return rows;\r\n    },\r\n    process: async ({ actor, rows, custom, messages, updateItem, setExtraFlags }) => {\r\n        const staff = actor.inventory.get(rows.staff);\r\n        if (!custom.entries || !staff) return;\r\n\r\n        const descriptionEl = createHTMLFromString(staff.description);\r\n        const spellList = descriptionEl.querySelectorAll(\"ul\");\r\n        if (!spellList.length) return;\r\n\r\n        const spellRanksList = querySelectorArray(spellList[spellList.length - 1], \"li\");\r\n        const staffSpellData = R.pipe(\r\n            spellRanksList,\r\n            R.flatMap((SpellRankEL) => {\r\n                const label = SpellRankEL.firstChild as HTMLElement;\r\n                const rank = Number(label.textContent?.match(LABEL_REGEX)?.[0] || \"0\") as ZeroToTen;\r\n                const uuids = Array.from(SpellRankEL.textContent!.matchAll(UUID_REGEX)).map(\r\n                    (match) => (match[1] === \"Compendium\" ? `Compendium.${match[2]}` : match[2])\r\n                );\r\n                return uuids.map((uuid) => ({ rank, uuid }));\r\n            }),\r\n            R.filter(({ rank }) => rank <= custom.maxCharges)\r\n        );\r\n\r\n        const staffSpells = R.compact(\r\n            await Promise.all(\r\n                staffSpellData.map(async ({ rank, uuid }) => {\r\n                    const spell = await fromUuid<SpellPF2e>(uuid);\r\n                    if (!spell?.isOfType(\"spell\")) return;\r\n\r\n                    return mergeObject(\r\n                        spell._source,\r\n                        {\r\n                            _id: randomID(),\r\n                            system: { location: { value: null, heightenedLevel: rank } },\r\n                        },\r\n                        { inplace: false }\r\n                    );\r\n                })\r\n            )\r\n        );\r\n\r\n        if (!staffSpells.length) return;\r\n\r\n        let overcharge = 0;\r\n        const spellcasting = actor.spellcasting!;\r\n        const preparedEntries = custom.preparedEntries;\r\n        const flexibleLabel = localize(\"interface.staves.flexible\");\r\n        const emptyLabel = localize(\"interface.staves.empty\");\r\n        const expendedSpells: { name: string; rank: ZeroToTen; uuid?: string }[] = [];\r\n        const slotsUpdates: Record<string, Record<string, number>> = {};\r\n        const expendedRows = R.pipe(rows, R.omit([\"staff\"]), R.values, R.compact);\r\n\r\n        for (const preparedPath of expendedRows) {\r\n            const entryId = preparedPath?.split(\".\")[0];\r\n            const entry = spellcasting.get<SpellcastingEntryPF2e<CharacterPF2e>>(entryId);\r\n            const preparedData = getProperty<\r\n                FlexiblePreparedEntryGroup[\"slots\"][number] | PreparedEntryGroup[\"spells\"][number]\r\n            >(preparedEntries, preparedPath);\r\n\r\n            if (!entry || !preparedData) continue;\r\n\r\n            const rank = preparedData.rank;\r\n            const slot = entry._source.system.slots[`slot${rank}`];\r\n\r\n            if (\"max\" in preparedData) {\r\n                if (slot.max < 1 || slot.value < 1) continue;\r\n\r\n                slotsUpdates[entryId] ??= {};\r\n                slotsUpdates[entryId][rank] ??= slot.value;\r\n\r\n                const currentValue = slotsUpdates[entryId][rank];\r\n\r\n                if (currentValue < 1) continue;\r\n\r\n                overcharge += rank;\r\n                slotsUpdates[entryId][rank] -= 1;\r\n\r\n                updateItem({\r\n                    _id: entryId,\r\n                    [`system.slots.slot${rank}.value`]: currentValue - 1,\r\n                });\r\n\r\n                expendedSpells.push({\r\n                    name: flexibleLabel,\r\n                    rank,\r\n                });\r\n            } else {\r\n                const prepared = deepClone(slot.prepared);\r\n                const preparedSlot = prepared[preparedData.index];\r\n\r\n                if (slot.max < 1 || preparedSlot.expended) continue;\r\n\r\n                overcharge += rank;\r\n                preparedSlot.expended = true;\r\n\r\n                updateItem({\r\n                    _id: entryId,\r\n                    [`system.slots.slot${rank}.prepared`]: prepared,\r\n                });\r\n\r\n                const spell = actor.items.get(preparedSlot.id);\r\n\r\n                expendedSpells.push({\r\n                    uuid: spell?.uuid,\r\n                    name: spell?.name ?? emptyLabel,\r\n                    rank,\r\n                });\r\n            }\r\n        }\r\n\r\n        const staffData: dailies.StaffFlags = {\r\n            staffId: staff.id,\r\n            charges: {\r\n                value: custom.maxCharges + overcharge,\r\n                max: custom.maxCharges + overcharge,\r\n            },\r\n            expended: expendedSpells.length > 0,\r\n            spells: staffSpells,\r\n        };\r\n\r\n        if (custom.activationType) {\r\n            const statistic =\r\n                // we only handle kineticist activation for now\r\n                actor.synthetics.statistics.get(\"impulse\") ??\r\n                actor.synthetics.statistics.get(\"kinetic-activation\");\r\n\r\n            if (statistic) {\r\n                staffData.statistic = { slug: statistic.slug, tradition: \"primal\" };\r\n            }\r\n        }\r\n\r\n        setExtraFlags({ staffData });\r\n\r\n        messages.addGroup(\"staff\", undefined, 45);\r\n        messages.add(\"staff\", { uuid: staff.uuid });\r\n\r\n        for (const { name, rank, uuid } of expendedSpells) {\r\n            const rankLabel = utils.getSpellRankLabel(rank);\r\n            const label = `${name} (${rankLabel})`;\r\n\r\n            messages.add(\"staff\", {\r\n                uuid,\r\n                label: uuid\r\n                    ? label\r\n                    : `<span class=\"fake-link\">\r\n                    <i class='fa-solid fa-sparkles'></i>\r\n                    ${label}\r\n                </span>`,\r\n            });\r\n        }\r\n    },\r\n});\r\n\r\ninterface StaffSpellcastingConstructorParams<TActor extends CreaturePF2e> {\r\n    id: string;\r\n    name: string;\r\n    actor: TActor;\r\n    statistic: Statistic;\r\n    tradition?: Maybe<MagicTradition>;\r\n    castPredicate: PredicateStatement[];\r\n}\r\n\r\nclass StaffSpellcasting implements SpellcastingEntry<CharacterPF2e> {\r\n    id: string;\r\n    name: string;\r\n    actor: CharacterPF2e;\r\n    statistic: Statistic;\r\n    tradition: MagicTradition | null;\r\n    castPredicate: Predicate;\r\n    staff: dailies.StaffPF2e;\r\n\r\n    constructor(\r\n        {\r\n            id,\r\n            name,\r\n            actor,\r\n            statistic,\r\n            tradition,\r\n            castPredicate,\r\n        }: StaffSpellcastingConstructorParams<CharacterPF2e>,\r\n        staff: dailies.StaffPF2e\r\n    ) {\r\n        this.id = id;\r\n        this.name = name;\r\n        this.actor = actor;\r\n        this.statistic = statistic;\r\n        this.tradition = tradition ?? null;\r\n        this.castPredicate = new game.pf2e.Predicate(castPredicate);\r\n        this.staff = staff;\r\n    }\r\n\r\n    get counteraction(): Statistic {\r\n        return createCounteractStatistic(this);\r\n    }\r\n\r\n    get attribute(): AttributeString {\r\n        return this.statistic.attribute ?? \"cha\";\r\n    }\r\n\r\n    get category(): \"charges\" {\r\n        return \"charges\";\r\n    }\r\n\r\n    get sort(): number {\r\n        return Math.max(0, ...this.actor.itemTypes.spellcastingEntry.map((e) => e.sort)) + 10;\r\n    }\r\n\r\n    get spells(): null {\r\n        return null;\r\n    }\r\n\r\n    get isFlexible(): false {\r\n        return false;\r\n    }\r\n\r\n    get isFocusPool(): false {\r\n        return false;\r\n    }\r\n\r\n    get isInnate(): false {\r\n        return false;\r\n    }\r\n\r\n    get isPrepared(): false {\r\n        return false;\r\n    }\r\n\r\n    get isSpontaneous(): false {\r\n        return false;\r\n    }\r\n\r\n    get isRitual(): false {\r\n        return false;\r\n    }\r\n\r\n    get isEphemeral(): true {\r\n        return true;\r\n    }\r\n\r\n    canCast(spell: SpellPF2e): boolean {\r\n        if (this.actor !== spell.actor) {\r\n            return false;\r\n        }\r\n\r\n        const rollOptions = new Set([\r\n            ...this.staff.getRollOptions(\"item\"),\r\n            ...spell.getRollOptions(\"spell\", { includeVariants: true }),\r\n        ]);\r\n\r\n        return this.castPredicate.test(rollOptions);\r\n    }\r\n\r\n    async cast(\r\n        spell: SpellPF2e,\r\n        options: CastOptions & { spontaneous?: { entryId: string; rank?: OneToFour } } = {}\r\n    ): Promise<void> {\r\n        const actor = this.actor;\r\n        const castRank = spell.rank;\r\n        const canCast = spell.isCantrip || canCastRank(actor, castRank);\r\n        const staffFlags = getStaffFlags(this.actor);\r\n\r\n        if (!staffFlags || canCast === null) {\r\n            error(\"staves.error.missing\");\r\n            return;\r\n        }\r\n\r\n        const staff = actor.inventory.get(staffFlags.staffId)!;\r\n\r\n        if (!staff.isEquipped) {\r\n            warn(\"staves.error.notEquipped\", { staff: staff.name });\r\n            return;\r\n        }\r\n\r\n        if (!canCast) {\r\n            warn(\"charges.error.notEnough\", {\r\n                spell: spell.name,\r\n                rank: getRankLabel(castRank),\r\n            });\r\n            return;\r\n        }\r\n\r\n        if (!staffFlags || options.message === false || !this.canCast(spell)) {\r\n            return;\r\n        }\r\n\r\n        if (spell.isCantrip) {\r\n            spell.toMessage(null, {\r\n                rollMode: options.rollMode,\r\n                data: { castRank: spell.rank },\r\n            });\r\n            return;\r\n        }\r\n\r\n        let charges = staffFlags.charges.value;\r\n        let mustUseSpontaneous = charges < castRank;\r\n        let useSpontaneous: null | false | { entry: string; slot: SlotKey } = false;\r\n\r\n        if (!staffFlags.expended) {\r\n            const minRank = Math.min(options.spontaneous?.rank ?? castRank, castRank);\r\n            const maxRank = getActorMaxRank(actor);\r\n            const range = R.range(minRank, maxRank + 1) as OneToTen[];\r\n            const entries = R.pipe(\r\n                actor.spellcasting.filter(\r\n                    (entry): entry is SpellcastingEntryPF2e<CharacterPF2e> =>\r\n                        entry.isSpontaneous &&\r\n                        (!options.spontaneous || options.spontaneous.entryId === entry.id)\r\n                ),\r\n                R.map((e) => ({\r\n                    id: e.id,\r\n                    name: e.name,\r\n                    slots: R.pipe(\r\n                        range,\r\n                        R.filter((r) => {\r\n                            const slot = e.system.slots[`slot${r}`];\r\n                            return slot.max > 0 && slot.value > 0;\r\n                        }),\r\n                        R.map((r) => {\r\n                            const key = `slot${r}` as SlotKey;\r\n                            return {\r\n                                key,\r\n                                rank: getRankLabel(r),\r\n                                value: e.system.slots[key].value,\r\n                            };\r\n                        })\r\n                    ),\r\n                })),\r\n                R.filter((e) => e.slots.length > 0)\r\n            );\r\n\r\n            if (entries.length && options.spontaneous) {\r\n                useSpontaneous = {\r\n                    entry: entries[0].id,\r\n                    slot: entries[0].slots[0].key,\r\n                };\r\n            } else if (entries.length) {\r\n                const localize = subLocalize(\"staves.spontaneous\");\r\n                const multiEntries = entries.length > 1;\r\n                const hint = localize(mustUseSpontaneous ? \"must\" : \"would\", {\r\n                    rank: getRankLabel(castRank),\r\n                    higher: entries.some((e) => e.slots.length > 1) ? localize(\"higher\") : \"\",\r\n                    from: localize(multiEntries ? \"multi\" : \"one\", {\r\n                        entry: entries[0].name,\r\n                    }),\r\n                });\r\n\r\n                const callback = (html: JQuery) => {\r\n                    const el = querySelector<HTMLInputElement>(\r\n                        htmlElement(html),\r\n                        \"[name=entry]:checked\"\r\n                    );\r\n                    return elementData(el!) as { entry: string; slot: SlotKey };\r\n                };\r\n\r\n                useSpontaneous = await waitDialog({\r\n                    title: localize(\"title\"),\r\n                    template: \"spontaneous\",\r\n                    default: \"no\",\r\n                    yes: {\r\n                        label: game.i18n.localize(\"Yes\"),\r\n                        callback,\r\n                    },\r\n                    no: {\r\n                        label: game.i18n.localize(mustUseSpontaneous ? \"Cancel\" : \"No\"),\r\n                        callback: () => false,\r\n                    },\r\n                    data: {\r\n                        hint,\r\n                        entries,\r\n                        multiEntries,\r\n                        i18n: localize.i18n,\r\n                    },\r\n                });\r\n\r\n                if (useSpontaneous === null) return;\r\n            }\r\n\r\n            if (useSpontaneous) {\r\n                charges = getStaffFlags(actor)?.charges.value ?? 0;\r\n                mustUseSpontaneous = charges < castRank;\r\n            }\r\n        }\r\n\r\n        const spontaneousValue = useSpontaneous\r\n            ? actor.spellcasting.get<SpellcastingEntryPF2e<CharacterPF2e>>(useSpontaneous.entry)\r\n                  ?.system.slots[useSpontaneous.slot].value\r\n            : undefined;\r\n\r\n        if (charges < 1 || (mustUseSpontaneous && !spontaneousValue)) {\r\n            return;\r\n        }\r\n\r\n        if (spontaneousValue && useSpontaneous) {\r\n            await actor.updateEmbeddedDocuments(\"Item\", [\r\n                {\r\n                    _id: useSpontaneous.entry,\r\n                    [`system.slots.${useSpontaneous.slot}.value`]: spontaneousValue - 1,\r\n                },\r\n            ]);\r\n        }\r\n\r\n        await setStaffChargesValue(actor, spontaneousValue ? charges - 1 : charges - castRank);\r\n\r\n        spell.toMessage(null, {\r\n            rollMode: options.rollMode,\r\n            data: { castRank: spell.rank },\r\n        });\r\n    }\r\n\r\n    async getSheetData({\r\n        spells,\r\n    }: { spells?: SpellCollection<CharacterPF2e> } = {}): Promise<ChargesSpellcastingSheetData> {\r\n        const actor = this.actor;\r\n\r\n        if (!actor?.isOfType(\"character\", \"npc\")) {\r\n            throw ErrorPF2e(\"Spellcasting entries can only exist on characters and npcs\");\r\n        }\r\n\r\n        const maxCantripRank = Math.max(1, Math.ceil(actor.level / 2)) as OneToTen;\r\n        const groups = R.pipe(\r\n            Array.from(spells?.values() ?? []),\r\n            R.groupBy.strict((s) => (s.isCantrip ? 0 : s.rank)),\r\n            R.toPairs.strict,\r\n            R.sortBy((x) => x[0]),\r\n            R.map(([rank, spells]): SpellcastingSlotGroup => {\r\n                rank = Number(rank) as ZeroToTen;\r\n                return {\r\n                    id: rank === 0 ? \"cantrips\" : rank,\r\n                    label:\r\n                        rank === 0\r\n                            ? \"PF2E.Actor.Creature.Spellcasting.Cantrips\"\r\n                            : getRankLabel(rank),\r\n                    maxRank: rank === 0 ? maxCantripRank : rank,\r\n                    number: rank,\r\n                    active: spells.map((spell) => ({\r\n                        spell,\r\n                        expended: !canCastRank(actor, rank),\r\n                    })),\r\n                };\r\n            })\r\n        );\r\n\r\n        return {\r\n            ...R.pick(this, [\r\n                \"category\",\r\n                \"tradition\",\r\n                \"sort\",\r\n                \"isFlexible\",\r\n                \"isFocusPool\",\r\n                \"isInnate\",\r\n                \"isPrepared\",\r\n                \"isRitual\",\r\n                \"isSpontaneous\",\r\n                \"isEphemeral\",\r\n            ]),\r\n            groups,\r\n            prepList: null,\r\n            id: spells?.id ?? this.id,\r\n            name: spells?.name ?? this.name,\r\n            statistic: this.statistic.getChatData(),\r\n            attribute: this.statistic.attribute,\r\n            hasCollection: !!spells?.size,\r\n            usesSpellProficiency: false,\r\n            isCharges: true,\r\n            isStaff: true,\r\n            uses: getStaffFlags(actor)?.charges ?? { value: 0, max: 0 },\r\n        };\r\n    }\r\n}\r\n\r\ninterface StaffSpellcasting {\r\n    system: SpellcastingEntrySystemData;\r\n}\r\n\r\nexport { StaffSpellcasting, hasStaves, staves };\r\n", "import { createDaily } from \"../daily\";\r\nimport { utils } from \"../utils\";\r\n\r\ntype CustomRow = {\r\n    rank: OneToFour;\r\n    label: string;\r\n    options: {\r\n        value: SkillLongForm;\r\n        label: string;\r\n    }[];\r\n};\r\n\r\nconst tomeUUID = \"Compendium.pf2e.classfeatures.Item.MyN1cQgE0HsLF20e\";\r\n\r\nfunction itemCondition(actor: CharacterPF2e, item: ItemPF2e): Promisable<boolean> {\r\n    const selected = utils.getChoiSetRuleSelection<string>(item);\r\n    return actor.items.get(selected)?.sourceId === tomeUUID;\r\n}\r\n\r\nconst thaumaturgeTome = createDaily({\r\n    key: \"thaumaturge-tome\",\r\n    items: [\r\n        {\r\n            slug: \"tome\", // Tome\r\n            uuid: tomeUUID,\r\n            required: true,\r\n        },\r\n        {\r\n            slug: \"adept\", // Implement Adept\r\n            uuid: \"Compendium.pf2e.classfeatures.Item.Obm4ItMIIr0whYeO\",\r\n            condition: itemCondition,\r\n        },\r\n        {\r\n            slug: \"second\", // Second Adept\r\n            uuid: \"Compendium.pf2e.classfeatures.Item.ZEUxZ4Ta1kDPHiq5\",\r\n            condition: itemCondition,\r\n        },\r\n        {\r\n            slug: \"intense\", // Intense Implement\r\n            uuid: \"Compendium.pf2e.feats-srd.Item.yRRM1dsY6jakEMaC\",\r\n        },\r\n        {\r\n            slug: \"paragon\", // Implement Paragon\r\n            uuid: \"Compendium.pf2e.classfeatures.Item.QEtgbY8N2V4wTbsI\",\r\n            condition: itemCondition,\r\n        },\r\n    ],\r\n    prepare: (actor, items) => {\r\n        const actorLevel = actor.level;\r\n        const actorSkills = actor.skills;\r\n        const skillList = utils.getSkills();\r\n\r\n        const custom: { first: CustomRow; second: CustomRow } = {\r\n            first: { options: [], label: \"\", rank: 1 },\r\n            second: { options: [], label: \"\", rank: 1 },\r\n        } as const;\r\n\r\n        const setCustom = (firstRank: OneToFour, secondRank: OneToFour) => {\r\n            const options = skillList.filter(({ value }) => actorSkills[value].rank < firstRank);\r\n\r\n            custom.first = {\r\n                rank: firstRank,\r\n                label: utils.getProficiencyLabel(firstRank),\r\n                options: options,\r\n            };\r\n\r\n            custom.second = {\r\n                rank: secondRank,\r\n                label: utils.getProficiencyLabel(secondRank),\r\n                options:\r\n                    firstRank === secondRank\r\n                        ? options\r\n                        : skillList.filter(({ value }) => actorSkills[value].rank < secondRank),\r\n            };\r\n        };\r\n\r\n        // Implement Paragon\r\n        if (items.paragon) {\r\n            setCustom(4, 4);\r\n        }\r\n        // Intense Implement or Second Adept or Implement Adept\r\n        else if (items.intense || items.adept || items.second) {\r\n            if (actorLevel >= 9) {\r\n                setCustom(3, 3);\r\n            } else {\r\n                setCustom(2, 3);\r\n            }\r\n        }\r\n        // Tome\r\n        else {\r\n            if (actorLevel >= 5) {\r\n                setCustom(2, 2);\r\n            } else if (actorLevel >= 3) {\r\n                setCustom(1, 2);\r\n            } else {\r\n                setCustom(1, 1);\r\n            }\r\n        }\r\n\r\n        return custom;\r\n    },\r\n    rows: (actor, items, custom) => {\r\n        return [\r\n            {\r\n                type: \"combo\",\r\n                slug: \"first\",\r\n                label: utils.getProficiencyLabel(custom.first.rank),\r\n                unique: `skill-${custom.first.rank}`,\r\n                options: custom.first.options,\r\n            },\r\n            {\r\n                type: \"combo\",\r\n                slug: \"second\",\r\n                label: utils.getProficiencyLabel(custom.second.rank),\r\n                unique: `skill-${custom.second.rank}`,\r\n                options: custom.second.options,\r\n            },\r\n        ];\r\n    },\r\n    process: ({ items, rows, custom, messages, addItem, addRule }) => {\r\n        messages.addGroup(\"tome\", undefined, 65);\r\n\r\n        for (const slug of [\"first\", \"second\"] as const) {\r\n            const rank = custom[slug].rank;\r\n            let selected = rows[slug].selected;\r\n\r\n            if (rows[slug].input) {\r\n                const source = utils.createLoreSource({ name: selected, rank });\r\n                addItem(source);\r\n            } else {\r\n                const skill = selected as SkillLongForm;\r\n                const source = utils.createSkillRuleElement({\r\n                    skill,\r\n                    value: rank,\r\n                });\r\n\r\n                selected = utils.getSkillLabel(skill);\r\n                addRule(items.tome, source);\r\n            }\r\n\r\n            messages.add(\"tome\", {\r\n                label: custom[slug].label,\r\n                selected,\r\n            });\r\n        }\r\n    },\r\n});\r\n\r\nexport { thaumaturgeTome };\r\n", "import { localize } from \"pf2e-api\";\r\nimport { createDaily } from \"../daily\";\r\nimport { utils } from \"../utils\";\r\n\r\nconst tricksterAce = createDaily({\r\n    key: \"trickster-ace\",\r\n    items: [\r\n        {\r\n            slug: \"ace\", // Trickster Ace\r\n            uuid: \"Compendium.pf2e.feats-srd.Item.POrE3ZgBRdBL9MsW\",\r\n            required: true,\r\n        },\r\n    ],\r\n    label: (actor, items) => items.ace.name,\r\n    rows: () => {\r\n        return [\r\n            {\r\n                type: \"drop\",\r\n                slug: \"spell\",\r\n                note: localize(\"interface.drop.notes.ace\"),\r\n                onDrop: (item: SpellPF2e) => {\r\n                    return true;\r\n                },\r\n                filter: {\r\n                    type: \"spell\",\r\n                    search: {\r\n                        rank: 4,\r\n                    },\r\n                },\r\n            },\r\n        ];\r\n    },\r\n    process: async ({ actor, items, rows, messages, addItem }) => {\r\n        const identifier = randomID();\r\n        const uuid = rows.spell.uuid;\r\n        const statistic = actor.classDC;\r\n        const spellSource = await utils.createSpellSource(uuid, { identifier });\r\n        const entrySource = utils.createSpellcastingEntrySource({\r\n            category: \"innate\",\r\n            identifier,\r\n            name: items.ace.name,\r\n            tradition: spellSource.system.traits.traditions[0],\r\n            proficiencyRank: statistic?.rank,\r\n            attribute: statistic?.attribute,\r\n            proficiencySlug: statistic?.slug,\r\n        });\r\n\r\n        addItem(entrySource);\r\n        addItem(spellSource);\r\n        messages.add(\"spells\", { uuid });\r\n    },\r\n});\r\n\r\nexport { tricksterAce };\r\n", "import { AsyncFunction, R, error, getSetting } from \"pf2e-api\";\r\nimport { createDaily } from \"./daily\";\r\nimport { ancestralLongevity } from \"./data/ancestral-longevity\";\r\nimport { bladeAlly } from \"./data/blade-ally\";\r\nimport { ceremonialKnife } from \"./data/ceremonial-knife\";\r\nimport { combatFlexibility } from \"./data/combat-flexibility\";\r\nimport { experimentalSpellshaping } from \"./data/experimental-spellshaping\";\r\nimport { familiar } from \"./data/familiar\";\r\nimport { createLanguageDaily } from \"./data/languages\";\r\nimport { mindSmith } from \"./data/mind-smith\";\r\nimport { rations } from \"./data/rations\";\r\nimport { createResistanceDaily } from \"./data/resistances\";\r\nimport { rootMagic } from \"./data/root-magic\";\r\nimport { scrollAdept } from \"./data/scroll-adept\";\r\nimport { createScrollChainDaily } from \"./data/scrolls\";\r\nimport { createComboSkillDaily, createLoreSkillDaily } from \"./data/skills\";\r\nimport { staves } from \"./data/staves\";\r\nimport { thaumaturgeTome } from \"./data/thaumaturge-tome\";\r\nimport { tricksterAce } from \"./data/trickster-ace\";\r\nimport type { CustomDaily, Daily, DailyItem, PreparedDailies, PreparedDaily } from \"./types\";\r\nimport { utils } from \"./utils\";\r\n\r\ntype PreConditionDaily = {\r\n    daily: Daily;\r\n    condition?: DailyItem[\"condition\"];\r\n    index: number;\r\n};\r\n\r\nconst DAILY_SCHEMA = \"3.0.0\";\r\n\r\nlet BUILTINS_DAILIES: Daily[] = [\r\n    rations, // Rations\r\n    familiar, // Familiar\r\n    staves, // Staves\r\n    experimentalSpellshaping, // Experimental Spellshaping\r\n    ancestralLongevity, // Ancestral Longevity\r\n    combatFlexibility, // Combat Flexibility\r\n    scrollAdept, // Scroll Adept\r\n    rootMagic, // Root Magic\r\n    ceremonialKnife, // Ceremonial Knife\r\n    tricksterAce, // Trickster Ace\r\n    thaumaturgeTome, //Thaumaturge Tome\r\n    bladeAlly, // Blade Ally\r\n    mindSmith, // Mind Smith\r\n    createLoreSkillDaily(\r\n        \"quick-study\", // Quick Study\r\n        \"Compendium.pf2e.feats-srd.Item.aLJsBBZzlUK3G8MW\"\r\n    ),\r\n    createComboSkillDaily(\r\n        \"ageless-spirit\", // Ageless Spirit\r\n        \"Compendium.pf2e.feats-srd.Item.wylnETwIz32Au46y\"\r\n    ),\r\n    createComboSkillDaily(\r\n        \"ancient-memories\", // Ancient Memories\r\n        \"Compendium.pf2e.feats-srd.Item.ptEOt3lqjxUnAW62\"\r\n    ),\r\n    createComboSkillDaily(\r\n        \"flexible-studies\", // Flexible Studies\r\n        \"Compendium.pf2e.feats-srd.Item.9bgl6qYWKHzqWZj0\"\r\n    ),\r\n    createLanguageDaily(\r\n        \"ancestral-linguistics\", // Ancestral Linguistics\r\n        \"Compendium.pf2e.feats-srd.Item.eCWQU16hRLfN1KaX\"\r\n    ),\r\n    createLanguageDaily(\r\n        \"borts-blesing\", // Bort's Blessing\r\n        \"Compendium.pf2e.equipment-srd.Item.iS7hAQMAaThHYE8g\"\r\n    ),\r\n    createResistanceDaily(\r\n        \"elementalist\", // Elementalist Dedication\r\n        \"Compendium.pf2e.feats-srd.Item.tx9pkrpmtqe4FnvS\",\r\n        [\"air\", \"earth\", \"fire\", \"water\"],\r\n        \"half\"\r\n    ),\r\n    createResistanceDaily(\r\n        \"ganzi\", // Ganzi\r\n        \"Compendium.pf2e.heritages.Item.3reGfXH0S82hM7Gp\",\r\n        [\"acid\", \"electricity\", \"sonic\"],\r\n        \"half\",\r\n        true\r\n    ),\r\n    createScrollChainDaily(\"esoterica\", [\r\n        \"Compendium.pf2e.feats-srd.Item.OqObuRB8oVSAEKFR\", // Scroll Esoterica\r\n        \"Compendium.pf2e.feats-srd.Item.nWd7m0yRcIEVUy7O\", // Elaborate Scroll Esoterica\r\n        \"Compendium.pf2e.feats-srd.Item.LHjPTV5vP3MOsPPJ\", // Grand Scroll Esoterica\r\n    ]),\r\n    createScrollChainDaily(\"trickster\", [\r\n        \"Compendium.pf2e.feats-srd.Item.ROAUR1GhC19Pjk9C\", // Basic Scroll Cache\r\n        \"Compendium.pf2e.feats-srd.Item.UrOj9TROtn8nuxPf\", // Expert Scroll Cache\r\n        \"Compendium.pf2e.feats-srd.Item.lIg5Gzz7W70jfbk1\", // Master Scroll Cache\r\n    ]),\r\n];\r\n\r\ntype AlwaysDaily = Omit<PreparedDaily, \"condition\"> & Required<Pick<PreparedDaily, \"condition\">>;\r\n\r\nlet BUILTINS_UUIDS: Map<string, PreConditionDaily> = new Map();\r\nlet BUILTINS_ALWAYS: AlwaysDaily[] = [];\r\n\r\nconst UUIDS: Map<string, PreConditionDaily> = new Map();\r\nlet ALWAYS: AlwaysDaily[] = [];\r\n\r\nfunction prepareDailies(dailies: Daily[], prefix: \"custom\" | \"dailies\") {\r\n    const uuids = new Map<string, PreConditionDaily>();\r\n    const always: AlwaysDaily[] = [];\r\n\r\n    for (const original of dailies) {\r\n        const originalKey = original.key;\r\n\r\n        try {\r\n            const keyWithPrefix = `${prefix}.${originalKey}`;\r\n            const daily = deepClone(original) as PreparedDaily;\r\n\r\n            daily.key = keyWithPrefix;\r\n            daily.items ??= [];\r\n\r\n            if (daily.condition && (!daily.items.length || !daily.items.some((x) => x.required))) {\r\n                always.push(daily as AlwaysDaily);\r\n            }\r\n\r\n            for (let i = 0; i < daily.items.length; i++) {\r\n                const { uuid, condition } = daily.items[i];\r\n                uuids.set(uuid, { daily, index: i, condition });\r\n            }\r\n        } catch (err) {\r\n            error(\"error.unexpected\");\r\n            console.error(err);\r\n            console.error(`The error occured during data gathering of ${prefix}.${originalKey}`);\r\n        }\r\n    }\r\n\r\n    return { uuids, always };\r\n}\r\n\r\nasync function parseCustomDaily(custom: CustomDaily) {\r\n    try {\r\n        const fn = new AsyncFunction<Daily>(\r\n            \"utils\",\r\n            \"createDaily\",\r\n            \"createComboSkillDaily\",\r\n            \"createLoreSkillDaily\",\r\n            \"createLanguageDaily\",\r\n            \"createResistanceDaily\",\r\n            \"createScrollChainDaily\",\r\n            custom.code\r\n        );\r\n        const daily = await fn(\r\n            utils,\r\n            createDaily,\r\n            createComboSkillDaily,\r\n            createLoreSkillDaily,\r\n            createLanguageDaily,\r\n            createResistanceDaily,\r\n            createScrollChainDaily\r\n        );\r\n\r\n        if (\r\n            typeof daily.key === \"string\" &&\r\n            daily.key.trim() &&\r\n            typeof daily.rows === \"function\" &&\r\n            typeof daily.process === \"function\" &&\r\n            (typeof daily.condition === \"function\" || Array.isArray(daily.items))\r\n        ) {\r\n            return daily;\r\n        }\r\n    } catch (err) {\r\n        error(\"error.unexpected\");\r\n        console.error(err);\r\n        console.error(`The error occured during creation of custom daily for ${custom.key}`);\r\n    }\r\n}\r\n\r\nasync function parseDailies() {\r\n    UUIDS.clear();\r\n\r\n    const customDailies = [];\r\n    const customs = getSetting<CustomDaily[]>(\"customDailies\");\r\n\r\n    for (const custom of customs) {\r\n        if (isNewerVersion(DAILY_SCHEMA, custom.schema ?? \"\")) {\r\n            continue;\r\n        }\r\n\r\n        const daily = await parseCustomDaily(custom);\r\n\r\n        if (daily) {\r\n            customDailies.push(daily);\r\n        }\r\n    }\r\n\r\n    for (const [uuid, daily] of BUILTINS_UUIDS) {\r\n        UUIDS.set(uuid, daily);\r\n    }\r\n\r\n    const { always, uuids } = prepareDailies(customDailies, \"custom\");\r\n\r\n    for (const [uuid, daily] of uuids) {\r\n        UUIDS.set(uuid, daily);\r\n    }\r\n\r\n    ALWAYS = [...BUILTINS_ALWAYS, ...always];\r\n}\r\n\r\nasync function initDailies() {\r\n    const { uuids, always } = prepareDailies(BUILTINS_DAILIES, \"dailies\");\r\n\r\n    BUILTINS_UUIDS = uuids;\r\n    BUILTINS_ALWAYS = always;\r\n\r\n    parseDailies();\r\n}\r\n\r\nfunction getDailyFromSourceId(sourceId: string) {\r\n    return UUIDS.get(sourceId)?.daily;\r\n}\r\n\r\nasync function getDailies(actor: CharacterPF2e) {\r\n    const dailies: PreparedDailies = {};\r\n\r\n    const getDaily = async (\r\n        daily: Daily,\r\n        precondition?: { index: number; item: ItemPF2e; condition: DailyItem[\"condition\"] }\r\n    ) => {\r\n        if (dailies[daily.key] === null) return;\r\n\r\n        try {\r\n            if (precondition) {\r\n                const { condition, item } = precondition;\r\n                if (condition && !(await condition(actor, item))) {\r\n                    return;\r\n                }\r\n            }\r\n\r\n            if (daily.condition && !(await daily.condition(actor))) {\r\n                dailies[daily.key] = null;\r\n                return;\r\n            }\r\n\r\n            if (!(daily.key in dailies)) {\r\n                dailies[daily.key] = deepClone(daily) as PreparedDaily;\r\n            }\r\n\r\n            const tmpDaily = dailies[daily.key]!;\r\n            tmpDaily.prepared ??= { items: {}, custom: {}, rows: {} };\r\n\r\n            if (precondition) {\r\n                const { index, item } = precondition;\r\n                const itemSlug = daily.items![index].slug;\r\n                tmpDaily.prepared.items[itemSlug] = item;\r\n            }\r\n        } catch (err) {\r\n            error(\"error.unexpected\");\r\n            console.error(err);\r\n            console.error(`The error occured during data gathering of ${daily.key}`);\r\n        }\r\n    };\r\n\r\n    await Promise.all(ALWAYS.map((daily) => getDaily(daily)));\r\n\r\n    await Promise.all(\r\n        actor.items.map((item) => {\r\n            const sourceId = item.sourceId;\r\n\r\n            if (!sourceId || (item.isOfType(\"physical\") && item.isInvested === false)) {\r\n                return;\r\n            }\r\n\r\n            const entry = UUIDS.get(sourceId);\r\n            if (!entry) return;\r\n\r\n            const { daily, index, condition } = entry;\r\n            return getDaily(daily, { condition, index, item });\r\n        })\r\n    );\r\n\r\n    return dailies;\r\n}\r\n\r\nfunction filterDailies(dailies: PreparedDailies) {\r\n    return Object.values(dailies).filter(\r\n        (daily): daily is PreparedDaily =>\r\n            R.isNonNull(daily) &&\r\n            Array.isArray(daily.items) &&\r\n            !daily.items.some((item) => item.required === true && !daily.prepared.items[item.slug])\r\n    );\r\n}\r\n\r\nasync function getAlwaysDailies(actor: CharacterPF2e): Promise<Omit<Daily, \"item\">[]> {\r\n    return Promise.all(ALWAYS.filter((daily) => daily.condition!(actor)));\r\n}\r\n\r\nexport {\r\n    DAILY_SCHEMA,\r\n    filterDailies,\r\n    getAlwaysDailies,\r\n    getDailies,\r\n    getDailyFromSourceId,\r\n    initDailies,\r\n    parseCustomDaily,\r\n    parseDailies,\r\n};\r\n", "import {\r\n    addListener,\r\n    addListenerAll,\r\n    elementData,\r\n    htmlElement,\r\n    queryInParent,\r\n    setFlag,\r\n    templateLocalize,\r\n    templatePath,\r\n    unsetFlag,\r\n    withEventManager,\r\n    type WithEventManager,\r\n} from \"pf2e-api\";\r\nimport { getDisabledDailies } from \"../api\";\r\nimport { getFamiliarAbilityCount } from \"../data/familiar\";\r\nimport type { PreparedDaily } from \"../types\";\r\n\r\ninterface DailyConfig extends WithEventManager {}\r\n\r\n@withEventManager\r\nclass DailyConfig extends Application {\r\n    #actor: CharacterPF2e;\r\n    #dailies: PreparedDaily[];\r\n\r\n    constructor(actor: CharacterPF2e, dailies: PreparedDaily[], options?: ApplicationOptions) {\r\n        super(options);\r\n\r\n        this.#actor = actor;\r\n        this.#dailies = dailies;\r\n    }\r\n\r\n    get template() {\r\n        return templatePath(\"config\");\r\n    }\r\n\r\n    get title() {\r\n        return this.actor.name;\r\n    }\r\n\r\n    get actor() {\r\n        return this.#actor;\r\n    }\r\n\r\n    close(options?: { force?: boolean; noEmit?: boolean }) {\r\n        if (!options?.noEmit) {\r\n            this.emitEvent(\"close\");\r\n        }\r\n\r\n        this.purgeListeners();\r\n\r\n        return super.close(options);\r\n    }\r\n\r\n    getData(options?: any) {\r\n        const actor = this.actor;\r\n        const disabled = getDisabledDailies(actor);\r\n        const familiar = actor.familiar\r\n            ? {\r\n                  value: getFamiliarAbilityCount(actor),\r\n                  max: actor.attributes.familiarAbilities.value,\r\n              }\r\n            : undefined;\r\n\r\n        return {\r\n            familiar,\r\n            dailies: this.#dailies.map((daily) => ({\r\n                key: daily.key,\r\n                label: daily.label,\r\n                enabled: disabled[daily.key] !== true,\r\n            })),\r\n            i18n: templateLocalize(\"config\"),\r\n        };\r\n    }\r\n\r\n    activateListeners($html: JQuery<HTMLElement>): Promisable<void> {\r\n        const html = htmlElement($html);\r\n\r\n        addListenerAll(\r\n            html,\r\n            \"[name='daily-enabled']\",\r\n            \"change\",\r\n            this.#onDailyEnabledChange.bind(this)\r\n        );\r\n\r\n        addListener(\r\n            html,\r\n            \"[name='familiar-range']\",\r\n            \"input\",\r\n            this.#onFamiliarRangeInput.bind(this)\r\n        );\r\n\r\n        addListener(\r\n            html,\r\n            \"[name='familiar-range']\",\r\n            \"change\",\r\n            this.#onFamiliarRangeChange.bind(this)\r\n        );\r\n    }\r\n\r\n    async #onFamiliarRangeChange(event: Event, el: HTMLInputElement) {\r\n        const actor = this.actor;\r\n\r\n        await setFlag(actor, \"familiar\", {\r\n            value: el.valueAsNumber,\r\n            max: actor.attributes.familiarAbilities.value,\r\n        });\r\n\r\n        this.emitEvent(\"update\");\r\n    }\r\n\r\n    #onFamiliarRangeInput(event: Event, el: HTMLInputElement) {\r\n        const valueInput = queryInParent<HTMLInputElement>(el, \"[name='familiar-value']\");\r\n        if (valueInput) valueInput.value = el.value;\r\n    }\r\n\r\n    async #onDailyEnabledChange(event: Event, el: HTMLInputElement) {\r\n        const { dailyKey } = elementData(el);\r\n\r\n        if (el.checked) {\r\n            await unsetFlag(this.actor, \"disabled\", dailyKey);\r\n        } else {\r\n            await setFlag(this.actor, \"disabled\", dailyKey, true);\r\n        }\r\n\r\n        this.emitEvent(\"update\");\r\n    }\r\n}\r\n\r\nexport { DailyConfig };\r\n", "import {\r\n    MODULE,\r\n    R,\r\n    addListener,\r\n    addListenerAll,\r\n    closest,\r\n    createChatLink,\r\n    dataToDatasetString,\r\n    elementData,\r\n    error,\r\n    getFlag,\r\n    getFlagProperty,\r\n    getHighestSpellcastingStatistic,\r\n    getHighestSyntheticStatistic,\r\n    getTranslatedSkills,\r\n    hasModuleFlag,\r\n    htmlElement,\r\n    localize,\r\n    localizeIfExist,\r\n    localizePath,\r\n    queryInClosest,\r\n    queryInParent,\r\n    querySelectorArray,\r\n    setFlag,\r\n    setFlagProperty,\r\n    stringBoolean,\r\n    stringNumber,\r\n    subLocalize,\r\n    templateLocalize,\r\n    templatePath,\r\n    unsetMofuleFlag,\r\n    updateFlag,\r\n    warn,\r\n} from \"pf2e-api\";\r\nimport {\r\n    createUpdateCollection,\r\n    getActorFlag,\r\n    getDisabledDailies,\r\n    isSimplifiableValue,\r\n    simplifyValue,\r\n} from \"../api\";\r\nimport { filterDailies } from \"../dailies\";\r\nimport { filterIsOfType, rowIsOfType } from \"../daily\";\r\nimport { hasStaves } from \"../data/staves\";\r\nimport type {\r\n    DailyActorFlags,\r\n    DailyMessageGroup,\r\n    DailyRow,\r\n    DailyRowAlert,\r\n    DailyRowComboData,\r\n    DailyRowData,\r\n    DailyRowDrop,\r\n    DailyRowDropData,\r\n    DailyRowDropFeatFilter,\r\n    DailyRowDropFilters,\r\n    DailyRowDropType,\r\n    DailyRowSelectOption,\r\n    DailyRowSelectOptionValue,\r\n    DailyRowType,\r\n    DailyRuleElement,\r\n    PreparedDailies,\r\n    PreparedDaily,\r\n} from \"../types\";\r\nimport { DailyConfig } from \"./config\";\r\nimport { utils } from \"../utils\";\r\n\r\ntype DailyTemplate = {\r\n    label: string;\r\n    rows: RowTemplate[];\r\n};\r\n\r\ntype RowTemplate = {\r\n    type: DailyRowType;\r\n    label: string;\r\n    daily: string;\r\n    row: string;\r\n    value?: string;\r\n    note?: string;\r\n    selected?: string;\r\n    unique?: string;\r\n    order: number;\r\n    data: string;\r\n    options?: (DailyRowSelectOption | { groupEnd: true })[];\r\n};\r\n\r\ntype RowElementDatasetBase = {\r\n    daily: string;\r\n    row: string;\r\n    save: `${boolean}`;\r\n};\r\n\r\ntype RowElementTypes = {\r\n    select: HTMLSelectElement & { dataset: RowElementDatasetBase };\r\n    random: HTMLSelectElement & { dataset: RowElementDatasetBase };\r\n    combo: HTMLInputElement & { dataset: RowElementDatasetBase & { input: StringBoolean } };\r\n    alert: HTMLInputElement & { dataset: RowElementDatasetBase };\r\n    input: HTMLInputElement & { dataset: RowElementDatasetBase };\r\n    notify: HTMLInputElement & { dataset: RowElementDatasetBase };\r\n    drop: HTMLInputElement & { dataset: RowElementDatasetBase & { uuid: string } };\r\n};\r\n\r\ntype RowElementDataset = RowElementDatasetBase & {\r\n    type: DailyRowType;\r\n    dailykey: string;\r\n    droptype: DailyRowDropType;\r\n    unique: string;\r\n    input: StringBoolean;\r\n    uuid: string;\r\n    empty: StringBoolean;\r\n};\r\n\r\nconst ACTOR_DAILY_SCHEMA = \"3.0.0\";\r\n\r\nconst TEMPLATE_ORDER = {\r\n    select: 100,\r\n    combo: 80,\r\n    random: 60,\r\n    alert: 40,\r\n    input: 20,\r\n    notify: 20,\r\n    drop: 0,\r\n};\r\n\r\nfunction rowElementIsOFType<T extends DailyRowType>(\r\n    el: HTMLSelectElement | HTMLInputElement,\r\n    ...types: T[]\r\n): el is RowElementTypes[T] {\r\n    return types.some((type) => el.dataset.type === type);\r\n}\r\n\r\nconst MIGRATIONS: {\r\n    schema: string;\r\n    reset?: boolean;\r\n    messages: (\r\n        | string\r\n        | string[]\r\n        | {\r\n              condition?: (actor: CharacterPF2e) => Promisable<boolean>;\r\n              messages: string | string[];\r\n          }\r\n    )[];\r\n}[] = [\r\n    {\r\n        schema: \"3.0.0\",\r\n        reset: true,\r\n        messages: [\r\n            \"filter\",\r\n            {\r\n                condition: (actor) => !!actor.familiar,\r\n                messages: [\"familiar.now-remove\", \"familiar.cant-remove\"],\r\n            },\r\n            {\r\n                condition: (actor) => hasStaves(actor),\r\n                messages: \"staves.moved\",\r\n            },\r\n        ],\r\n    },\r\n];\r\n\r\nasync function migration(actor: CharacterPF2e) {\r\n    if (!hasModuleFlag(actor)) return;\r\n\r\n    let reset = false;\r\n    const messages: string[] = [];\r\n    const schema = getActorFlag(actor, \"schema\") ?? \"\";\r\n\r\n    if (!isNewerVersion(ACTOR_DAILY_SCHEMA, schema)) return;\r\n\r\n    for (const migration of MIGRATIONS) {\r\n        if (!isNewerVersion(migration.schema, schema)) continue;\r\n\r\n        reset ||= migration.reset === true;\r\n\r\n        const migrationMessages: string[] = [];\r\n\r\n        for (let messageList of migration.messages) {\r\n            if (R.isPlainObject(messageList)) {\r\n                if (R.isFunction(messageList.condition) && !(await messageList.condition(actor))) {\r\n                    continue;\r\n                }\r\n                messageList = messageList.messages;\r\n            }\r\n\r\n            messageList = R.isArray(messageList) ? messageList : [messageList];\r\n\r\n            const formated = messageList\r\n                .map((x) => {\r\n                    const str = localize(\"interface.migration\", x);\r\n                    return `<p>${str}</p>`;\r\n                })\r\n                .join(\"\");\r\n\r\n            migrationMessages.push(formated);\r\n        }\r\n\r\n        if (migrationMessages.length) {\r\n            messages.push(`<h3>${migration.schema}</h3>`, migrationMessages.join(\"<hr />\"));\r\n        }\r\n    }\r\n\r\n    if (reset) {\r\n        messages.unshift(localize(\"interface.migration.reset\"), \"<br>\");\r\n        await unsetMofuleFlag(actor);\r\n    } else {\r\n        await setFlag(actor, \"schema\", ACTOR_DAILY_SCHEMA);\r\n    }\r\n\r\n    if (!messages.length) {\r\n        return;\r\n    }\r\n\r\n    messages.push(\"<br>\");\r\n\r\n    setTimeout(() => {\r\n        Dialog.prompt({\r\n            content: messages.join(\"\"),\r\n            title: localize(\"interface.migration.title\"),\r\n            label: localize(\"interface.migration.label\"),\r\n            rejectClose: false,\r\n        });\r\n    }, 200);\r\n}\r\n\r\nclass DailyInterface extends Application {\r\n    #actor: CharacterPF2e;\r\n    #dailies: PreparedDailies;\r\n    #dailiesArray: PreparedDaily[];\r\n    #settingsApp: DailyConfig | null = null;\r\n    #randomInterval?: number;\r\n    #featUuids!: string[];\r\n    #dropFilters: Record<\r\n        string,\r\n        {\r\n            daily: string;\r\n            row: string;\r\n            type: DailyRowDropType;\r\n            filter: FeatFilters | SpellFilters;\r\n        }\r\n    > = {};\r\n\r\n    constructor(actor: CharacterPF2e, dailies: PreparedDailies, options: ApplicationOptions = {}) {\r\n        options.dragDrop = [\r\n            {\r\n                dropSelector: '[data-droppable=\"true\"]',\r\n            },\r\n        ];\r\n\r\n        super(options);\r\n\r\n        this.#actor = actor;\r\n        this.#dailies = dailies;\r\n        this.#dailiesArray = filterDailies(dailies);\r\n    }\r\n\r\n    get template() {\r\n        return templatePath(\"interface\");\r\n    }\r\n\r\n    get title() {\r\n        return this.actor.name;\r\n    }\r\n\r\n    get actor() {\r\n        return this.#actor;\r\n    }\r\n\r\n    _canDragDrop(selector: string) {\r\n        return true;\r\n    }\r\n\r\n    async _onDrop(event: DragEvent) {\r\n        const localize = subLocalize(\"interface.drop.error\");\r\n        const target =\r\n            event.target instanceof HTMLInputElement\r\n                ? event.target\r\n                : event.target instanceof HTMLLabelElement\r\n                ? queryInClosest<HTMLInputElement>(\r\n                      event.target,\r\n                      \".group\",\r\n                      `input[data-row=\"${event.target.dataset.row}\"]`\r\n                  )\r\n                : null;\r\n\r\n        if (!target) return;\r\n\r\n        const data = TextEditor.getDragEventData(event);\r\n\r\n        if (data?.type !== \"Item\" || typeof data.uuid !== \"string\") {\r\n            return localize.warn(\"wrongDataType\");\r\n        }\r\n\r\n        const item = await fromUuid<SpellPF2e | FeatPF2e>(data.uuid);\r\n        const compendium = await this.#compendiumFilterFromElement(target);\r\n\r\n        if (!item || !compendium) {\r\n            return localize.warn(\"wrongDataType\");\r\n        }\r\n\r\n        if (item.type !== compendium.type) {\r\n            return this.#dropDataWarning(\r\n                \"type\",\r\n                game.i18n.localize(`TYPES.Item.${compendium.type}`),\r\n                game.i18n.localize(`TYPES.Item.${item.type}`)\r\n            );\r\n        }\r\n\r\n        const dailyRow = this.#getDailyRow<DailyRowDrop>(compendium.daily, compendium.row);\r\n        if (typeof dailyRow.onDrop === \"function\") {\r\n            // @ts-ignore\r\n            const result = await dailyRow.onDrop(item, this.actor);\r\n\r\n            if (result === false) {\r\n                return localize.warn(\"exclude\", { item: item.name });\r\n            }\r\n            if (typeof result === \"string\") {\r\n                return ui.notifications.warn(result);\r\n            }\r\n        }\r\n\r\n        const isFeat = item.isOfType(\"feat\");\r\n        const isValid = isFeat\r\n            ? this.#validateFeat(item, compendium.filter as FeatFilters)\r\n            : this.#validateSpell(item, compendium.filter as SpellFilters);\r\n\r\n        if (!isValid) return;\r\n\r\n        target.value = item.name;\r\n        target.dataset.uuid = item.uuid;\r\n        queryInClosest(target, \".drop\", \".clear\")!.classList.remove(\"disabled\");\r\n\r\n        if (isFeat) {\r\n            const exists = !!this.actor.itemTypes.feat.find((feat) => feat.sourceId === data.uuid);\r\n            target.classList.toggle(\"exists\", exists);\r\n            target.dataset.tooltip = exists ? target.dataset.cacheTooltip : \"\";\r\n        }\r\n    }\r\n\r\n    _getHeaderButtons() {\r\n        const buttons = super._getHeaderButtons();\r\n\r\n        buttons.splice(-1, 0, {\r\n            class: \"pf2e-dailies-config\",\r\n            label: localizePath(\"interface.config\"),\r\n            icon: \"fa-solid fa-user-gear\",\r\n            onclick: (event) => {\r\n                if (this.#settingsApp) {\r\n                    this.#settingsApp.bringToTop();\r\n                    return;\r\n                }\r\n\r\n                const actor = this.actor;\r\n                const id = `pf2e-dailies-settings-${actor.uuid}`;\r\n\r\n                this.#settingsApp = new DailyConfig(actor, this.#dailiesArray!, { id });\r\n                this.#settingsApp.registerListener(\"update\", () =>\r\n                    this.render(false, { height: \"auto\" })\r\n                );\r\n                this.#settingsApp.registerListener(\"close\", () => (this.#settingsApp = null), true);\r\n                this.#settingsApp.render(true);\r\n            },\r\n        });\r\n\r\n        return buttons;\r\n    }\r\n\r\n    close(options?: { force?: boolean | undefined } | undefined): Promisable<void> {\r\n        this.#settingsApp?.close({ noEmit: true });\r\n        clearInterval(this.#randomInterval);\r\n        return super.close(options);\r\n    }\r\n\r\n    async getData() {\r\n        const actor = this.actor;\r\n        await migration(actor);\r\n\r\n        let hasAlert = false;\r\n        const dailies = this.#dailiesArray;\r\n        const templates: DailyTemplate[] = [];\r\n        const disabled = getDisabledDailies(actor);\r\n\r\n        await Promise.all(\r\n            dailies.map(async (daily) => {\r\n                const items = daily.prepared.items;\r\n\r\n                daily.label =\r\n                    typeof daily.label === \"function\"\r\n                        ? await daily.label(actor, items)\r\n                        : typeof daily.label === \"string\"\r\n                        ? game.i18n.localize(daily.label)\r\n                        : localizeIfExist(\"builtin\", daily.key) ?? daily.key;\r\n\r\n                if (disabled[daily.key]) return;\r\n\r\n                const custom =\r\n                    typeof daily.prepare === \"function\" ? await daily.prepare(actor, items) : {};\r\n                const rows = await daily.rows(actor, items, custom);\r\n\r\n                const dailyTemplate: DailyTemplate = {\r\n                    label: daily.label,\r\n                    rows: [],\r\n                };\r\n\r\n                daily.prepared.custom = custom;\r\n                daily.prepared.rows = R.mapToObj(rows, (row) => [row.slug, row]);\r\n\r\n                for (const row of rows) {\r\n                    if (typeof row.condition === \"boolean\" && !row.condition) {\r\n                        continue;\r\n                    }\r\n\r\n                    const rowLabel =\r\n                        typeof row.label === \"string\" ? game.i18n.localize(row.label) : row.slug;\r\n\r\n                    const rowTemplate: RowTemplate = {\r\n                        type: row.type,\r\n                        row: row.slug,\r\n                        daily: daily.key,\r\n                        label: rowLabel,\r\n                        order: row.order ?? TEMPLATE_ORDER[row.type],\r\n                        data: \"\",\r\n                    };\r\n\r\n                    const isSavedRow = row.save !== false;\r\n\r\n                    const getSavedFlag = <T extends DailyRowData>() => {\r\n                        return isSavedRow ? getFlag<T>(actor, daily.key, row.slug) : undefined;\r\n                    };\r\n\r\n                    const rowData: Partial<RowElementDataset> = {\r\n                        daily: daily.key,\r\n                        type: row.type,\r\n                        row: row.slug,\r\n                        save: stringBoolean(isSavedRow),\r\n                        empty: stringBoolean(row.empty ?? false),\r\n                    };\r\n\r\n                    if (rowIsOfType(row, \"select\", \"combo\", \"random\")) {\r\n                        const openedGroups: string[] = [];\r\n\r\n                        rowTemplate.options = [];\r\n\r\n                        for (const option of row.options) {\r\n                            if (\"group\" in option) {\r\n                                if (openedGroups.pop()) {\r\n                                    rowTemplate.options.push({ groupEnd: true });\r\n                                }\r\n\r\n                                openedGroups.push(option.group);\r\n                                option.group = game.i18n.localize(option.group);\r\n                            } else {\r\n                                option.label = game.i18n.localize(option.label);\r\n                            }\r\n\r\n                            rowTemplate.options.push(option);\r\n                        }\r\n\r\n                        for (const _ of openedGroups) {\r\n                            rowTemplate.options.push({ groupEnd: true });\r\n                        }\r\n\r\n                        if (\r\n                            rowIsOfType(row, \"combo\", \"select\") &&\r\n                            row.unique &&\r\n                            rowTemplate.options.length > 1\r\n                        ) {\r\n                            rowTemplate.unique = row.unique;\r\n                        }\r\n\r\n                        if (rowIsOfType(row, \"combo\")) {\r\n                            const { input, selected } = getSavedFlag<DailyRowComboData>() ?? {};\r\n                            const isInput = input ?? true;\r\n                            const option = isInput\r\n                                ? undefined\r\n                                : rowTemplate.options.find(\r\n                                      (option): option is DailyRowSelectOptionValue =>\r\n                                          \"value\" in option && option.value === selected\r\n                                  );\r\n\r\n                            rowTemplate.value = (isInput ? selected : option?.label) ?? \"\";\r\n                            rowTemplate.selected = (!isInput && option?.value) || \"\";\r\n\r\n                            rowData.input = stringBoolean(isInput);\r\n                        } else if (!row.options.length) {\r\n                            continue;\r\n                        } else {\r\n                            rowTemplate.selected = getSavedFlag<string>() ?? \"\";\r\n                        }\r\n                    } else if (rowIsOfType(row, \"drop\")) {\r\n                        const { name, uuid } = getSavedFlag<DailyRowDropData>() ?? {};\r\n\r\n                        if (row.filter.type === \"feat\") {\r\n                            this.#featUuids ??= R.pipe(\r\n                                this.actor.itemTypes.feat,\r\n                                R.map((feat) => feat.sourceId),\r\n                                R.compact\r\n                            );\r\n                        }\r\n\r\n                        rowTemplate.note = row.note;\r\n                        rowTemplate.value = name ?? \"\";\r\n\r\n                        rowData.uuid = uuid ?? \"\";\r\n                        rowData.droptype = row.filter.type;\r\n                    } else if (rowIsOfType(row, \"alert\")) {\r\n                        hasAlert = true;\r\n\r\n                        rowData.save = stringBoolean(false);\r\n                        rowData.empty = stringBoolean(false);\r\n\r\n                        delete rowTemplate.unique;\r\n                        rowTemplate.value = row.message;\r\n                    } else if (rowIsOfType(row, \"input\")) {\r\n                        rowTemplate.value = getSavedFlag<string>() ?? \"\";\r\n                    }\r\n\r\n                    rowTemplate.data = dataToDatasetString(rowData);\r\n\r\n                    dailyTemplate.rows.push(rowTemplate);\r\n                }\r\n\r\n                if (dailyTemplate.rows.length) {\r\n                    templates.push(dailyTemplate);\r\n                }\r\n            })\r\n        );\r\n\r\n        const rows: RowTemplate[] = [];\r\n        const groups: DailyTemplate[] = [];\r\n\r\n        for (const template of templates) {\r\n            if (template.rows.length === 1 && template.rows[0].type !== \"alert\") {\r\n                const row = template.rows[0];\r\n                row.label = template.label;\r\n                rows.push(row);\r\n            } else if (template.rows.length) {\r\n                groups.push(template);\r\n            }\r\n        }\r\n\r\n        rows.sort((a, b) => b.order - a.order);\r\n        groups.sort((a, b) => a.rows.length - b.rows.length);\r\n\r\n        const hasDailies = !!rows.length || !!groups.length;\r\n\r\n        return {\r\n            rows,\r\n            groups,\r\n            i18n: templateLocalize(\"interface\"),\r\n            hasDailies,\r\n            hasAlert,\r\n            canAccept: hasDailies && !hasAlert,\r\n        };\r\n    }\r\n\r\n    activateListeners($html: JQuery<HTMLElement>): void {\r\n        const html = htmlElement($html);\r\n\r\n        addListener(html, \"[data-action='accept']\", () => this.#onAccept(html));\r\n        addListener(html, \"[data-action='cancel']\", () => this.close());\r\n\r\n        addListenerAll(\r\n            html,\r\n            \"input[type='text']\",\r\n            \"keyup\",\r\n            (event, el) => event.key === \"Enter\" && el.blur()\r\n        );\r\n\r\n        addListenerAll(html, \"[data-action='resolve-alert']\", this.#onResolveAlert.bind(this));\r\n        addListenerAll(html, \"[data-action='clear-field']\", this.#onClearField.bind(this));\r\n        addListenerAll(html, \"[data-action='open-browser']\", this.#onOpenBrowser.bind(this));\r\n        addListenerAll(html, \".combo input\", \"change\", this.#onComboInputChange.bind(this));\r\n        addListenerAll(html, \".combo select\", \"change\", this.#onComboSelectChange.bind(this));\r\n        addListenerAll(html, \"[data-unique]\", \"change\", this.#onUniqueChange.bind(this));\r\n        addListenerAll(html, \".input input[type='text']\", \"change\", this.#onInputChange.bind(this));\r\n\r\n        const processedUniques: string[] = [];\r\n        const uniqueSelects = html.querySelectorAll<HTMLSelectElement>(\"[data-unique]\");\r\n\r\n        for (const selectEl of uniqueSelects) {\r\n            const { unique, dailykey } = elementData<RowElementDataset>(selectEl);\r\n            const uniqueTag = `${dailykey}.${unique}`;\r\n\r\n            if (processedUniques.includes(uniqueTag)) continue;\r\n\r\n            this.#onUniqueChange(null, selectEl);\r\n            processedUniques.push(uniqueTag);\r\n        }\r\n\r\n        const randomElements = html.querySelectorAll<HTMLSelectElement>(\"select.random\");\r\n        if (randomElements.length) {\r\n            this.#randomInterval = setInterval(() => {\r\n                for (const randomElement of randomElements) {\r\n                    randomElement.selectedIndex =\r\n                        (randomElement.selectedIndex + 1) % randomElement.options.length;\r\n                }\r\n            }, 1000);\r\n        }\r\n\r\n        const dropFeatInputs = html.querySelectorAll<HTMLInputElement>(\r\n            \"input[data-droptype='feat']\"\r\n        );\r\n\r\n        for (const dropFeatInput of dropFeatInputs) {\r\n            const uuid = dropFeatInput.dataset.uuid;\r\n            if (uuid && this.#featUuids.includes(uuid)) {\r\n                dropFeatInput.classList.add(\"exists\");\r\n                dropFeatInput.dataset.tooltip = dropFeatInput.dataset.cacheTooltip;\r\n            }\r\n        }\r\n    }\r\n\r\n    async #onResolveAlert(event: Event, el: HTMLInputElement) {\r\n        const data = elementData<RowElementDataset>(el);\r\n        const row = this.#getDailyRow<DailyRowAlert>(data.daily, data.row);\r\n        const resolved = await row.resolve();\r\n        if (resolved) this.render(false, { height: \"auto\" });\r\n    }\r\n\r\n    #onInputChange(event: Event, el: HTMLInputElement) {\r\n        queryInClosest(el, \".input\", \".clear\")!.classList.toggle(\"disabled\", !el.value.trim());\r\n    }\r\n\r\n    #onUniqueChange(event: Event | null, el: HTMLSelectElement) {\r\n        const uniqueTag = elementData(el).unique;\r\n        const uniqueOptions = new Set<string>();\r\n        const selectElements = closest(el, \".dailies\")!.querySelectorAll<HTMLSelectElement>(\r\n            `select[data-unique=\"${uniqueTag}\"]`\r\n        );\r\n\r\n        for (const selectEl of selectElements) {\r\n            let index = selectEl.selectedIndex;\r\n            const selectOptions = selectEl.options;\r\n            const maxIndex = selectEl.options.length - 1;\r\n\r\n            const optionUniqueValue = () => {\r\n                const option = selectOptions[index];\r\n                return option.dataset.skipUnique === \"true\"\r\n                    ? undefined\r\n                    : option.dataset.unique ?? option.value;\r\n            };\r\n\r\n            const optionExists = () => {\r\n                const value = optionUniqueValue();\r\n                return value && uniqueOptions.has(value);\r\n            };\r\n\r\n            while (optionExists() && index > 0) {\r\n                index -= 1;\r\n            }\r\n\r\n            while (optionExists() && index < maxIndex) {\r\n                index += 1;\r\n            }\r\n\r\n            if (optionExists()) continue;\r\n\r\n            const finalValue = optionUniqueValue();\r\n\r\n            if (finalValue) {\r\n                uniqueOptions.add(finalValue);\r\n            }\r\n\r\n            if (selectEl.selectedIndex !== index) {\r\n                selectEl.selectedIndex = index;\r\n            }\r\n        }\r\n\r\n        for (const selectEl of selectElements) {\r\n            const index = selectEl.selectedIndex;\r\n            const selectOptions = selectEl.options;\r\n\r\n            for (let i = 0; i < selectOptions.length; i++) {\r\n                if (i === index) continue;\r\n\r\n                const option = selectOptions[i];\r\n\r\n                option.disabled = uniqueOptions.has(option.dataset.unique ?? option.value);\r\n            }\r\n        }\r\n    }\r\n\r\n    #onComboInputChange(event: Event, inputEl: HTMLInputElement) {\r\n        const value = inputEl.value.trim().toLowerCase();\r\n        const selectEl = queryInClosest<HTMLSelectElement>(inputEl, \".combo\", \"select\")!;\r\n        const option = value\r\n            ? Array.from(selectEl.options).find(\r\n                  (option) => option.value === value || option.text.toLowerCase() === value\r\n              )\r\n            : undefined;\r\n\r\n        if (option) {\r\n            selectEl.value = option.value;\r\n            inputEl.value = option.text;\r\n            inputEl.dataset.input = \"false\";\r\n        } else {\r\n            selectEl.value = \"\";\r\n            inputEl.dataset.input = \"true\";\r\n        }\r\n    }\r\n\r\n    #onComboSelectChange(event: Event, selectEl: HTMLSelectElement) {\r\n        const inputEl = queryInClosest<HTMLInputElement>(selectEl, \".combo\", \"input\")!;\r\n        inputEl.dataset.input = \"false\";\r\n        inputEl.value = selectEl.options[selectEl.selectedIndex].text;\r\n    }\r\n\r\n    async #onOpenBrowser(event: Event, el: HTMLElement) {\r\n        const inputEl = queryInClosest(el, \".drop\", \"input\")!;\r\n        const compendium = await this.#compendiumFilterFromElement(inputEl, true);\r\n\r\n        if (compendium) {\r\n            game.pf2e.compendiumBrowser.openTab(compendium.type, compendium.filter);\r\n        }\r\n    }\r\n\r\n    #onClearField(event: Event, btnEl: HTMLElement) {\r\n        const inputEl = queryInParent<HTMLInputElement>(btnEl, \"input\")!;\r\n\r\n        inputEl.dataset.tooltip = \"\";\r\n        inputEl.classList.remove(\"exists\");\r\n        inputEl.value = \"\";\r\n        inputEl.dataset.uuid = \"\";\r\n\r\n        btnEl.classList.add(\"disabled\");\r\n    }\r\n\r\n    async #onAccept(html: HTMLElement) {\r\n        const labelElements = html.querySelectorAll(\"label.empty\");\r\n\r\n        for (const labelEl of labelElements) {\r\n            labelEl.classList.remove(\"empty\");\r\n        }\r\n\r\n        const emptyRows = querySelectorArray<HTMLInputElement | HTMLSelectElement>(\r\n            html,\r\n            \"[data-empty='false']\"\r\n        ).filter((el) => el.value.trim() === \"\");\r\n\r\n        if (emptyRows.length) {\r\n            warn(\"interface.error.empty\");\r\n\r\n            for (const inputEl of emptyRows) {\r\n                const { row } = elementData<RowElementDataset>(inputEl);\r\n                const labelEl = queryInClosest(inputEl, \".group\", `label[data-row=\"${row}\"]`)!;\r\n                labelEl.classList.add(\"empty\");\r\n            }\r\n\r\n            return;\r\n        }\r\n\r\n        this.#lock();\r\n        await this.#processDailies(html);\r\n        this.close();\r\n    }\r\n\r\n    async #processDailies(html: HTMLElement) {\r\n        const rowElements = html.querySelectorAll<HTMLInputElement | HTMLSelectElement>(\r\n            \"[data-daily]\"\r\n        );\r\n\r\n        const flags: Record<string, Record<string, DailyRowData>> = {};\r\n        const extraFlags: Record<string, any> = {};\r\n        const dailies: Record<\r\n            string,\r\n            {\r\n                daily: PreparedDaily;\r\n                rows: Record<string, DailyRowData>;\r\n            }\r\n        > = {};\r\n\r\n        for (const rowElement of rowElements) {\r\n            let row: DailyRowData;\r\n\r\n            if (rowElementIsOFType(rowElement, \"drop\")) {\r\n                row = {\r\n                    uuid: rowElement.dataset.uuid,\r\n                    name: rowElement.value,\r\n                };\r\n            } else if (rowElementIsOFType(rowElement, \"combo\")) {\r\n                const isInput = rowElement.dataset.input === \"true\";\r\n                const selected = isInput\r\n                    ? rowElement.value.trim()\r\n                    : queryInClosest<HTMLSelectElement>(rowElement, \".combo\", \"select\")!.value;\r\n\r\n                row = {\r\n                    selected,\r\n                    input: isInput,\r\n                };\r\n            } else if (rowElementIsOFType(rowElement, \"select\", \"input\")) {\r\n                row = rowElement.value.trim();\r\n            } else if (rowElementIsOFType(rowElement, \"random\")) {\r\n                row = utils.selectRandomOption(rowElement);\r\n            } else {\r\n                continue;\r\n            }\r\n\r\n            const data = rowElement.dataset as RowElementDatasetBase;\r\n\r\n            dailies[data.daily] ??= {\r\n                daily: this.#dailies[data.daily]!,\r\n                rows: {},\r\n            };\r\n\r\n            dailies[data.daily].rows[data.row] = row;\r\n\r\n            if (data.save === \"true\") {\r\n                flags[data.daily] ??= {};\r\n                flags[data.daily][data.row] = row;\r\n            }\r\n        }\r\n\r\n        const actor = this.actor;\r\n        const deletedItems: string[] = [];\r\n        const addedItems: (PreCreate<ItemSourcePF2e> | ItemSourcePF2e)[] = [];\r\n        const itemsRules = new Map<string, DailyRuleElement[]>();\r\n        const [updatedItems, updateItem] = createUpdateCollection();\r\n        const rawMessages: { message: string; order: number }[] = [];\r\n        const addedItemIds: string[] = [];\r\n\r\n        const messageGroups: Record<string, DailyMessageGroup> = {\r\n            languages: { order: 80, messages: [] },\r\n            skills: { order: 70, messages: [] },\r\n            resistances: { order: 60, messages: [] },\r\n            feats: { order: 50, messages: [] },\r\n            spells: { order: 40, messages: [] },\r\n            scrolls: { order: 30, messages: [] },\r\n        };\r\n\r\n        const getRules = (item: ItemPF2e) => {\r\n            const id = item.id;\r\n            const existing = itemsRules.get(id);\r\n\r\n            if (existing) {\r\n                return existing;\r\n            }\r\n\r\n            const rules = deepClone(item._source.system.rules);\r\n\r\n            for (let i = rules.length - 1; i >= 0; i--) {\r\n                if (MODULE.id in rules[i]) {\r\n                    rules.splice(i, 1);\r\n                }\r\n            }\r\n\r\n            itemsRules.set(id, rules);\r\n            return rules;\r\n        };\r\n\r\n        await Promise.all(\r\n            Object.values(dailies).map(({ daily, rows }) => {\r\n                try {\r\n                    const items = daily.prepared.items;\r\n                    const custom = daily.prepared.custom;\r\n\r\n                    return daily.process({\r\n                        actor,\r\n                        items,\r\n                        custom,\r\n                        // @ts-ignore\r\n                        rows,\r\n                        messages: {\r\n                            add: (group, message) => {\r\n                                messageGroups[group] ??= { order: 0, messages: [] };\r\n                                messageGroups[group].messages.push(message);\r\n                            },\r\n                            addGroup: (name, label, order = 0) => {\r\n                                if (name in messageGroups) {\r\n                                    messageGroups[name].label ??= label;\r\n                                    messageGroups[name].order ??= order;\r\n                                } else {\r\n                                    messageGroups[name] = {\r\n                                        label,\r\n                                        order,\r\n                                        messages: [],\r\n                                    };\r\n                                }\r\n                            },\r\n                            addRaw: (message, order: number = 1) => {\r\n                                rawMessages.push({ message, order });\r\n                            },\r\n                        },\r\n                        updateItem,\r\n                        addItem: (source) => addedItems.push(source),\r\n                        addFeat: (source, parent) => {\r\n                            if (parent?.isOfType(\"feat\")) {\r\n                                const parentId = parent.id;\r\n                                setProperty(source, \"flags.pf2e.grantedBy\", {\r\n                                    id: parentId,\r\n                                    onDelete: \"cascade\",\r\n                                });\r\n                                setFlagProperty(source, \"grantedBy\", parentId);\r\n                            }\r\n                            addedItems.push(source);\r\n                        },\r\n                        deleteItem: (item) => deletedItems.push(item.id),\r\n                        removeRule: (\r\n                            item: ItemPF2e,\r\n                            signature: (rule: DailyRuleElement) => boolean\r\n                        ) => {\r\n                            const rules = getRules(item);\r\n\r\n                            for (let i = rules.length - 1; i >= 0; i--) {\r\n                                const rule = rules[i];\r\n\r\n                                if (signature(rule)) {\r\n                                    rules.splice(i, 1);\r\n                                }\r\n                            }\r\n                        },\r\n                        addRule: (item: ItemPF2e, source: DailyRuleElement) => {\r\n                            source[MODULE.id] = true;\r\n                            getRules(item).push(source);\r\n                        },\r\n                        setExtraFlags: (data: Record<string, any>) => {\r\n                            mergeObject(extraFlags, data);\r\n                        },\r\n                    });\r\n                } catch (err) {\r\n                    error(\"error.unexpected\");\r\n                    console.error(err);\r\n                    console.error(`The error occured during processing of ${daily.key}`);\r\n                }\r\n            })\r\n        );\r\n\r\n        let hasOrphanSpells = false;\r\n        const entryIdentifier = randomID();\r\n\r\n        for (const source of addedItems) {\r\n            if (!getProperty(source, \"system.temporary\")) {\r\n                setFlagProperty(source, \"temporary\", true);\r\n            }\r\n\r\n            if (\r\n                source.type === \"spell\" &&\r\n                !getProperty(source, \"system.location.value\") &&\r\n                !getFlagProperty(source, \"identifier\")\r\n            ) {\r\n                hasOrphanSpells = true;\r\n                setFlagProperty(source, \"identifier\", entryIdentifier);\r\n            }\r\n        }\r\n\r\n        if (hasOrphanSpells) {\r\n            const highestEntry = getHighestSpellcastingStatistic(actor);\r\n            const highestSynthetic = getHighestSyntheticStatistic(actor);\r\n\r\n            const [tradition, statistic] =\r\n                highestEntry &&\r\n                (!highestSynthetic || highestEntry.statistic.mod >= highestSynthetic.mod)\r\n                    ? [highestEntry.tradition, highestEntry.statistic]\r\n                    : highestSynthetic\r\n                    ? [null, highestSynthetic]\r\n                    : [null, null];\r\n\r\n            if (statistic) {\r\n                const source = utils.createSpellcastingEntrySource({\r\n                    name: localize(\"spellEntry.name\"),\r\n                    identifier: entryIdentifier,\r\n                    category: \"innate\",\r\n                    tradition: tradition ?? \"arcane\",\r\n                    attribute: statistic.attribute,\r\n                    showSlotlessRanks: false,\r\n                    proficiencyRank: statistic.rank ?? 1,\r\n                    proficiencySlug: statistic === highestSynthetic ? statistic.slug : undefined,\r\n                });\r\n\r\n                setFlagProperty(source, \"temporary\", true);\r\n                addedItems.push(source);\r\n            }\r\n        }\r\n\r\n        if (addedItems.length) {\r\n            const items = await actor.createEmbeddedDocuments(\"Item\", addedItems);\r\n\r\n            for (const item of items) {\r\n                addedItemIds.push(item.id);\r\n            }\r\n\r\n            for (const item of items) {\r\n                if (item.isOfType(\"feat\")) {\r\n                    const parentId = getFlag<string>(item, \"grantedBy\");\r\n\r\n                    if (parentId) {\r\n                        const slug = game.pf2e.system.sluggify(item.name, { camel: \"dromedary\" });\r\n                        const path = `flags.pf2e.itemGrants.${slug}`;\r\n\r\n                        updateItem({\r\n                            _id: parentId,\r\n                            [path]: { id: item.id, onDelete: \"detach\" },\r\n                        });\r\n                    }\r\n                } else if (item.isOfType(\"spellcastingEntry\")) {\r\n                    const identifier = getFlag(item, \"identifier\");\r\n                    if (!identifier) continue;\r\n\r\n                    const spells = items.filter(\r\n                        (spell): spell is SpellPF2e<CharacterPF2e> =>\r\n                            spell.isOfType(\"spell\") && getFlag(spell, \"identifier\") === identifier\r\n                    );\r\n\r\n                    for (const spell of spells) {\r\n                        const rank = getFlag<OneToTen>(spell, \"rank\");\r\n                        const update: EmbeddedDocumentUpdateData<ItemSourcePF2e> = {\r\n                            _id: spell.id,\r\n                            \"system.location.value\": item.id,\r\n                            \"system.location.heightenedLevel\": rank,\r\n                        };\r\n                        updateItem(update);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        for (const [id, rules] of itemsRules) {\r\n            updateItem({ _id: id, \"system.rules\": rules });\r\n        }\r\n\r\n        if (updatedItems.size) {\r\n            await actor.updateEmbeddedDocuments(\"Item\", updatedItems.contents);\r\n        }\r\n\r\n        if (deletedItems.length) {\r\n            await actor.deleteEmbeddedDocuments(\"Item\", deletedItems);\r\n        }\r\n\r\n        await updateFlag<DailyActorFlags>(actor, {\r\n            ...flags,\r\n            extra: extraFlags,\r\n            rested: false,\r\n            schema: ACTOR_DAILY_SCHEMA,\r\n            addedItems: addedItemIds,\r\n        });\r\n\r\n        const messages = Object.entries(messageGroups);\r\n        const chatGroups = rawMessages.map(({ message, order }) => ({\r\n            message: `<p>${message}</p>`,\r\n            order,\r\n        }));\r\n\r\n        for (const [type, group] of messages) {\r\n            if (!group.messages.length) continue;\r\n\r\n            const groupLabel = group.label\r\n                ? game.i18n.localize(group.label)\r\n                : localizeIfExist(\"message.groups\", type) ?? localize(\"message.gained\", { type });\r\n\r\n            let message = `<p><strong>${groupLabel}</strong></p>`;\r\n\r\n            for (const messageOptions of group.messages) {\r\n                message += \"<p>\";\r\n\r\n                const label = messageOptions.label?.trim();\r\n\r\n                if (\"uuid\" in messageOptions && messageOptions.uuid) {\r\n                    message += createChatLink(messageOptions.uuid, { label });\r\n                } else if (label) {\r\n                    message += ` ${label}`;\r\n                }\r\n\r\n                if (messageOptions.selected) {\r\n                    message += `<i class=\"fa-solid fa-caret-right\"></i>${messageOptions.selected}`;\r\n                }\r\n\r\n                if (messageOptions.random) {\r\n                    message += '<i class=\"fa-solid fa-dice-d20\"></i>';\r\n                }\r\n\r\n                message += \"</p>\";\r\n            }\r\n\r\n            chatGroups.push({ message, order: group.order });\r\n        }\r\n\r\n        const preface = localize(chatGroups.length ? \"message.changes\" : \"message.noChanges\");\r\n\r\n        chatGroups.unshift({ message: preface, order: Infinity });\r\n        chatGroups.sort((a, b) => b.order - a.order);\r\n\r\n        const chatContent = chatGroups.map((group) => group.message).join(\"<hr />\");\r\n\r\n        ChatMessage.create({\r\n            content: `<div class=\"pf2e-dailies-summary\">${chatContent}</div>`,\r\n            speaker: ChatMessage.getSpeaker({ actor }),\r\n        });\r\n    }\r\n\r\n    #lock() {\r\n        this.element.addClass(\"disabled\");\r\n    }\r\n\r\n    #unlock() {\r\n        this.element.removeClass(\"disabled\");\r\n    }\r\n\r\n    #dropDataWarning(type: string, need?: string | string[], has?: string | string[]) {\r\n        const localizedType = localize(\"interface.drop.error.type\", type);\r\n        const formattedNeed = Array.isArray(need)\r\n            ? need.length === 1\r\n                ? need[0]\r\n                : `[${need.join(\", \")}]`\r\n            : need;\r\n        const formattedHas = Array.isArray(has)\r\n            ? has.length === 1\r\n                ? has[0]\r\n                : `[${has.join(\", \")}]`\r\n            : has;\r\n        const localizedHas = formattedHas || localize(\"interface.drop.error.none\");\r\n        const localizedRequire =\r\n            need && has\r\n                ? localize(\"interface.drop.error.require\", {\r\n                      need: formattedNeed,\r\n                      has: localizedHas,\r\n                  })\r\n                : need\r\n                ? localize(\"interface.drop.error.missing\", { need: formattedNeed })\r\n                : localize(\"interface.drop.error.invalid\", { has: localizedHas });\r\n\r\n        warn(\"interface.drop.error.wrongData\", {\r\n            type: localizedType,\r\n            require: localizedRequire,\r\n        });\r\n    }\r\n\r\n    #validateDefault(item: FeatPF2e | SpellPF2e, filter: FeatFilters | SpellFilters) {\r\n        const { multiselects, checkboxes } = filter;\r\n        const tab = game.pf2e.compendiumBrowser.tabs[item.type as BrowserTabName];\r\n        const itemTraits = item.system.traits.value.map((t: string) => t.replace(/^hb_/, \"\"));\r\n\r\n        if (\r\n            !tab.filterTraits(\r\n                itemTraits,\r\n                multiselects.traits.selected,\r\n                multiselects.traits.conjunction\r\n            )\r\n        ) {\r\n            warn(\"interface.drop.error.wrongTraits\");\r\n            return false;\r\n        }\r\n\r\n        const rarities = checkboxes.rarity.selected;\r\n        if (rarities.length && !rarities.includes(item.rarity)) {\r\n            this.#dropDataWarning(\r\n                \"rarity\",\r\n                rarities.map((x) => game.i18n.localize(CONFIG.PF2E.rarityTraits[x])),\r\n                game.i18n.localize(CONFIG.PF2E.rarityTraits[item.rarity])\r\n            );\r\n            return false;\r\n        }\r\n\r\n        const sources = checkboxes.source.selected;\r\n        if (sources.length) {\r\n            const { system } = item._source;\r\n            const pubSource = String(\r\n                system.publication?.title ?? system.source?.value ?? \"\"\r\n            ).trim();\r\n            const sourceSlug = game.pf2e.system.sluggify(pubSource);\r\n\r\n            if (!sources.includes(sourceSlug)) {\r\n                this.#dropDataWarning(\"source\", \"\", pubSource);\r\n                return false;\r\n            }\r\n        }\r\n\r\n        return true;\r\n    }\r\n\r\n    #validateFeat(item: FeatPF2e, filter: FeatFilters) {\r\n        const { checkboxes, sliders } = filter;\r\n\r\n        const level = sliders.level.values;\r\n        if (!item.level.between(level.min, level.max)) {\r\n            this.#dropDataWarning(\"level\", `${level.min}-${level.max}`, String(item.level));\r\n            return false;\r\n        }\r\n\r\n        const categories = checkboxes.category.selected;\r\n        if (categories.length && !categories.includes(item.category)) {\r\n            this.#dropDataWarning(\r\n                \"category\",\r\n                categories.map((x) => game.i18n.localize(CONFIG.PF2E.featCategories[x])),\r\n                game.i18n.localize(CONFIG.PF2E.featCategories[item.category])\r\n            );\r\n            return false;\r\n        }\r\n\r\n        const filterSkills = checkboxes.skills.selected;\r\n        if (filterSkills.length) {\r\n            const prereqs: { value: string }[] = item.system.prerequisites.value;\r\n            const prerequisitesArr = prereqs.map((prerequisite) =>\r\n                prerequisite?.value ? prerequisite.value.toLowerCase() : \"\"\r\n            );\r\n            const translatedSkills = getTranslatedSkills();\r\n            const skillList = Object.entries(translatedSkills);\r\n            const skills: Set<SkillLongForm> = new Set();\r\n\r\n            for (const prereq of prerequisitesArr) {\r\n                for (const [key, value] of skillList) {\r\n                    if (prereq.includes(key) || prereq.includes(value)) {\r\n                        skills.add(key as SkillLongForm);\r\n                    }\r\n                }\r\n            }\r\n\r\n            const itemSkills = [...skills];\r\n            const missingSkills = R.difference(filterSkills, itemSkills);\r\n\r\n            if (missingSkills.length) {\r\n                this.#dropDataWarning(\r\n                    \"skills\",\r\n                    missingSkills.map((x) => translatedSkills[x])\r\n                );\r\n                return false;\r\n            }\r\n        }\r\n\r\n        if (!this.#validateDefault(item, filter)) {\r\n            return false;\r\n        }\r\n\r\n        return true;\r\n    }\r\n\r\n    #validateSpell(item: SpellPF2e, filter: SpellFilters) {\r\n        const { checkboxes, selects } = filter;\r\n\r\n        const itemRank = String(item.rank);\r\n        const filterRanks = checkboxes.rank.selected;\r\n        if (filterRanks.length && !filterRanks.includes(itemRank)) {\r\n            this.#dropDataWarning(\"rank\", filterRanks, itemRank);\r\n            return false;\r\n        }\r\n\r\n        const filterCategories = checkboxes.category.selected;\r\n        if (filterCategories.length) {\r\n            const isCantrip = item.isCantrip;\r\n            const isFocusSpell = item.isFocusSpell;\r\n            const isRitual = item.isRitual;\r\n            const isSpell = !isCantrip && !isFocusSpell && !isRitual;\r\n            const categories = R.compact([\r\n                isSpell ? \"spell\" : null,\r\n                isCantrip ? \"cantrip\" : null,\r\n                isFocusSpell ? \"focus\" : null,\r\n                isRitual ? \"ritual\" : null,\r\n            ]);\r\n\r\n            const sortedFilterCategories = filterCategories.sort();\r\n            const sortedItemCategories = categories.sort();\r\n\r\n            if (!R.equals(sortedFilterCategories, sortedItemCategories)) {\r\n                this.#dropDataWarning(\r\n                    \"categories\",\r\n                    sortedFilterCategories.map((x) =>\r\n                        game.i18n.localize(CONFIG.PF2E.spellTraits[x])\r\n                    ),\r\n                    sortedItemCategories.map((x) =>\r\n                        game.i18n.localize(CONFIG.PF2E.spellTraits[x] ?? \"TYPES.Item.spell\")\r\n                    )\r\n                );\r\n                return false;\r\n            }\r\n        }\r\n\r\n        const filterTraditions = checkboxes.traditions.selected;\r\n        const itemTraditions = item.system.traits.traditions;\r\n        if (filterTraditions.length && !R.intersection(filterTraditions, itemTraditions).length) {\r\n            this.#dropDataWarning(\r\n                \"traditions\",\r\n                filterTraditions.map((x) => game.i18n.localize(CONFIG.PF2E.magicTraditions[x])),\r\n                itemTraditions.map((x) => game.i18n.localize(CONFIG.PF2E.magicTraditions[x]))\r\n            );\r\n            return false;\r\n        }\r\n\r\n        if (!this.#validateDefault(item, filter)) {\r\n            return false;\r\n        }\r\n\r\n        return true;\r\n    }\r\n\r\n    #getDailyRow<T extends DailyRow>(daily: string, row: string) {\r\n        return this.#dailies[daily]?.prepared.rows[row] as T;\r\n    }\r\n\r\n    async #compendiumFilterFromElement(el: HTMLElement, init?: boolean) {\r\n        try {\r\n            const data = elementData<RowElementDataset>(el);\r\n            const dailyRow = this.#getDailyRow<DailyRowDrop>(data.daily, data.row);\r\n            const filterKey = `${data.daily}.${data.row}`;\r\n\r\n            this.#dropFilters[filterKey] ??= await (async () => {\r\n                const filter = deepClone(dailyRow.filter);\r\n                return {\r\n                    daily: data.daily,\r\n                    row: data.row,\r\n                    type: filter.type,\r\n                    filter: await this.#convertToCompendiumFilter(filter, init),\r\n                };\r\n            })();\r\n\r\n            return deepClone(this.#dropFilters[filterKey]);\r\n        } catch (err) {\r\n            error(\"error.unexpected\");\r\n            console.error(err);\r\n            console.error(`The error occured when trying to open a drop filter.`);\r\n        }\r\n    }\r\n\r\n    async #convertToCompendiumFilter<T extends DailyRowDropType>(\r\n        dropFilter: DailyRowDropFilters[T],\r\n        init?: boolean\r\n    ) {\r\n        const type = dropFilter.type;\r\n        const compendiumTab = game.pf2e.compendiumBrowser.tabs[type];\r\n        const compendiumFilter = init\r\n            ? await compendiumTab.getFilterData()\r\n            : compendiumTab.isInitialized\r\n            ? deepClone(compendiumTab.defaultFilterData)\r\n            : deepClone(compendiumTab.filterData);\r\n\r\n        if (filterIsOfType(dropFilter, \"spell\")) {\r\n            const rank = Array.isArray(dropFilter.search.rank)\r\n                ? dropFilter.search.rank.map(stringNumber)\r\n                : typeof dropFilter.search.rank === \"string\"\r\n                ? simplifyValue(this.actor, dropFilter.search.rank)\r\n                : dropFilter.search.rank;\r\n\r\n            dropFilter.search.rank = Array.isArray(rank)\r\n                ? rank\r\n                : typeof rank === \"number\"\r\n                ? R.range(1, rank + 1).map(stringNumber)\r\n                : undefined;\r\n        }\r\n\r\n        if (filterIsOfType(dropFilter, \"feat\") && isSimplifiableValue(dropFilter.search.level)) {\r\n            const level = simplifyValue(this.actor, dropFilter.search.level) ?? 20;\r\n            dropFilter.search.level = {\r\n                min: 0,\r\n                max: level,\r\n            };\r\n        }\r\n\r\n        for (const checkboxEntry of Object.entries(compendiumFilter.checkboxes)) {\r\n            const [checkboxName, filterCheckbox] = checkboxEntry as [\r\n                keyof typeof compendiumFilter.checkboxes,\r\n                CheckboxData\r\n            ];\r\n            const searchCheckbox = dropFilter.search[checkboxName];\r\n\r\n            if (!searchCheckbox) continue;\r\n\r\n            filterCheckbox.selected = searchCheckbox;\r\n            filterCheckbox.isExpanded = true;\r\n\r\n            for (const x of searchCheckbox) {\r\n                const filterCheckboxOption = filterCheckbox.options[x];\r\n\r\n                if (filterCheckboxOption) {\r\n                    filterCheckboxOption.selected = true;\r\n                }\r\n            }\r\n        }\r\n\r\n        for (const multiselectEntry of Object.entries(compendiumFilter.multiselects)) {\r\n            const [multiselectName, filterMultiselect] = multiselectEntry as [\r\n                keyof typeof compendiumFilter.multiselects,\r\n                MultiselectData\r\n            ];\r\n            const searchMultiselect = dropFilter.search[multiselectName];\r\n\r\n            if (!searchMultiselect) continue;\r\n\r\n            const multiselect = Array.isArray(searchMultiselect)\r\n                ? { selected: searchMultiselect }\r\n                : searchMultiselect;\r\n\r\n            filterMultiselect.conjunction = multiselect.conjunction ?? \"and\";\r\n\r\n            for (const select of multiselect.selected) {\r\n                const selection =\r\n                    typeof select === \"string\" ? { value: select, not: undefined } : select;\r\n                filterMultiselect.selected.push(selection);\r\n            }\r\n        }\r\n\r\n        if (\"sliders\" in compendiumFilter) {\r\n            for (const sliderEntry of Object.entries(compendiumFilter.sliders)) {\r\n                const [sliderName, filterSlider] = sliderEntry as [\r\n                    keyof typeof compendiumFilter.sliders,\r\n                    SliderData\r\n                ];\r\n                const searchSlider = (dropFilter as DailyRowDropFeatFilter).search[sliderName] as {\r\n                    min: number;\r\n                    max: number;\r\n                };\r\n\r\n                if (!searchSlider) continue;\r\n\r\n                filterSlider.values.min = searchSlider.min;\r\n                filterSlider.values.max = searchSlider.max;\r\n                filterSlider.isExpanded = true;\r\n            }\r\n        }\r\n\r\n        return compendiumFilter;\r\n    }\r\n}\r\n\r\nexport { DailyInterface };\r\n", "import { R, getActorMaxRank, getFlag, openApplication, setFlag } from \"pf2e-api\";\r\nimport { DailyInterface } from \"./apps/interface\";\r\nimport { getDailies } from \"./dailies\";\r\nimport type { DailyActorFlags, SimplifiableValue } from \"./types\";\r\n\r\nfunction isValidActor(actor: CharacterPF2e) {\r\n    return actor instanceof Actor && actor.isOfType(\"character\");\r\n}\r\n\r\nfunction canPrepareDailies(actor: CharacterPF2e) {\r\n    return isValidActor(actor) && getActorFlag(actor, \"rested\") !== false;\r\n}\r\n\r\nasync function openDailiesInterface(actor: CharacterPF2e) {\r\n    if (!isValidActor(actor) || !actor.isOwner || !canPrepareDailies(actor)) {\r\n        return;\r\n    }\r\n\r\n    const id = `pf2e-dailies-interface-${actor.uuid}`;\r\n    const dailies = await getDailies(actor);\r\n    openApplication(DailyInterface, actor, dailies, { id });\r\n}\r\n\r\nfunction getDisabledDailies(actor: CharacterPF2e) {\r\n    const flag = getActorFlag(actor, \"disabled\") ?? {};\r\n    return flattenObject(flag) as Record<string, boolean>;\r\n}\r\n\r\nfunction simplifyValue(actor: ActorPF2e, value: SimplifiableValue) {\r\n    if (typeof value === \"number\") return value;\r\n\r\n    if (value === \"level\") return actor.level;\r\n\r\n    if (value === \"half\") {\r\n        return Math.max(1, Math.floor(actor.level / 2));\r\n    }\r\n\r\n    const numbered = Number(value) || 0;\r\n    return Number.isNaN(numbered) ? undefined : numbered;\r\n}\r\n\r\nfunction isSimplifiableValue(value: any): value is SimplifiableValue {\r\n    return (\r\n        typeof value === \"number\" ||\r\n        value === \"level\" ||\r\n        value === \"half\" ||\r\n        (typeof value === \"string\" && !Number.isNaN(Number(value)))\r\n    );\r\n}\r\n\r\nfunction createUpdateCollection<T extends EmbeddedDocumentUpdateData<ItemSourcePF2e>>(): [\r\n    Collection<T>,\r\n    (data: T) => void\r\n] {\r\n    const collection = new Collection<T>();\r\n\r\n    return [\r\n        collection,\r\n        (data: T) => {\r\n            if (data._id) {\r\n                const update = collection.get(data._id) ?? {};\r\n                collection.set(data._id, mergeObject(update, data));\r\n            }\r\n        },\r\n    ];\r\n}\r\n\r\nfunction getActorFlag<K extends keyof DailyActorFlags>(actor: CharacterPF2e, key: K) {\r\n    return getFlag<DailyActorFlags[K]>(actor, key);\r\n}\r\n\r\nfunction isTemporary(item: ItemPF2e) {\r\n    return !!getFlag<boolean>(item, \"temporary\");\r\n}\r\n\r\nfunction getStaffFlags(actor: CharacterPF2e) {\r\n    return getFlag<dailies.StaffFlags>(actor, \"extra.staffData\");\r\n}\r\n\r\nfunction setStaffChargesValue(actor: CharacterPF2e, value?: number) {\r\n    const charges = getStaffFlags(actor)?.charges;\r\n    if (!charges || (value != null && charges.value === value)) return;\r\n\r\n    return setFlag(\r\n        actor,\r\n        \"extra.staffData.charges.value\",\r\n        Math.clamped(value ?? charges.max, 0, charges.max)\r\n    );\r\n}\r\n\r\nfunction canCastRank<TPArent extends CharacterPF2e>(actor: TPArent, rank: number) {\r\n    const staffFlags = getStaffFlags(actor);\r\n    if (!staffFlags) return null;\r\n\r\n    const staff = actor.inventory.get(staffFlags.staffId);\r\n    if (!staff) return null;\r\n\r\n    if (rank === 0) return true;\r\n\r\n    const maxRank = getActorMaxRank(actor);\r\n    if (rank > maxRank) return false;\r\n\r\n    const charges = staffFlags.charges.value;\r\n\r\n    if (charges < 1) return false;\r\n    if (charges >= rank) return true;\r\n\r\n    if (staffFlags.expended && charges < rank) return false;\r\n\r\n    const range = R.range(rank, maxRank + 1) as OneToTen[];\r\n    const entries = actor.spellcasting.filter(\r\n        (entry): entry is SpellcastingEntryPF2e<TPArent> => entry.isSpontaneous\r\n    );\r\n\r\n    const nbSlots = R.pipe(\r\n        entries,\r\n        R.flatMap((e) => range.map((r) => e.system.slots[`slot${r}`])),\r\n        R.filter((d) => d.max > 0),\r\n        R.sumBy(R.prop(\"value\"))\r\n    );\r\n\r\n    return nbSlots >= 1;\r\n}\r\n\r\nexport {\r\n    canCastRank,\r\n    canPrepareDailies,\r\n    createUpdateCollection,\r\n    getActorFlag,\r\n    getDisabledDailies,\r\n    getStaffFlags,\r\n    isSimplifiableValue,\r\n    isTemporary,\r\n    openDailiesInterface,\r\n    setStaffChargesValue,\r\n    simplifyValue,\r\n};\r\n", "import {\r\n    MODULE,\r\n    addListener,\r\n    appendHTMLFromString,\r\n    changeCarryType,\r\n    createHTMLFromString,\r\n    elementData,\r\n    getHighestSpellcastingStatistic,\r\n    getSetting,\r\n    getSpellClass,\r\n    getSpellCollectionClass,\r\n    htmlElement,\r\n    libWrapper,\r\n    localize,\r\n    querySelector,\r\n    render,\r\n    templateLocalize,\r\n} from \"pf2e-api\";\r\nimport {\r\n    canPrepareDailies,\r\n    getActorFlag,\r\n    getStaffFlags,\r\n    isTemporary,\r\n    openDailiesInterface,\r\n    setStaffChargesValue,\r\n} from \"./api\";\r\nimport { StaffSpellcasting } from \"./data/staves\";\r\n\r\nasync function performDailyCrafting(this: CharacterPF2e) {\r\n    const entries = (await this.getCraftingEntries()).filter((e) => e.isDailyPrep);\r\n    const alchemicalEntries = entries.filter((e) => e.isAlchemical);\r\n    const reagentCost = alchemicalEntries.reduce((sum, entry) => sum + entry.reagentCost, 0);\r\n    const reagentValue = (this.system.resources.crafting.infusedReagents.value || 0) - reagentCost;\r\n    if (reagentValue < 0) {\r\n        ui.notifications.warn(game.i18n.localize(\"PF2E.CraftingTab.Alerts.MissingReagents\"));\r\n        return;\r\n    } else {\r\n        await this.update({ \"system.resources.crafting.infusedReagents.value\": reagentValue });\r\n        const key =\r\n            reagentCost === 0 ? \"ZeroConsumed\" : reagentCost === 1 ? \"OneConsumed\" : \"NConsumed\";\r\n        ui.notifications.info(\r\n            game.i18n.format(`PF2E.Actor.Character.Crafting.Daily.Complete.${key}`, {\r\n                quantity: reagentCost,\r\n            })\r\n        );\r\n    }\r\n\r\n    // Remove infused/temp items\r\n    // for (const item of this.inventory) {\r\n    //     if (item.system.temporary) await item.delete();\r\n    // }\r\n\r\n    for (const entry of entries) {\r\n        for (const formula of entry.preparedCraftingFormulas) {\r\n            const itemSource: PhysicalItemSource = formula.item.toObject();\r\n            itemSource.system.quantity = formula.quantity;\r\n            itemSource.system.temporary = true;\r\n            itemSource.system.size = this.ancestry?.size === \"tiny\" ? \"tiny\" : \"med\";\r\n\r\n            if (\r\n                entry.isAlchemical &&\r\n                [\"consumable\", \"equipment\", \"weapon\"].includes(itemSource.type)\r\n            ) {\r\n                itemSource.system.traits.value.push(\"infused\");\r\n            }\r\n            await this.addToInventory(itemSource);\r\n        }\r\n    }\r\n}\r\n\r\nasync function renderChargesEntries(\r\n    actor: CharacterPF2e | NPCPF2e,\r\n    parentElement: HTMLElement,\r\n    callback?: (\r\n        entryContainer: HTMLElement,\r\n        chargesElement: HTMLElement,\r\n        toggleElement: HTMLElement\r\n    ) => void\r\n) {\r\n    const chargesEntries = actor.spellcasting.regular.filter(\r\n        (entry) => entry.system.prepared.value === \"charges\"\r\n    );\r\n\r\n    for (const entry of chargesEntries) {\r\n        const entryContainer = parentElement.querySelector<HTMLElement>(\r\n            `[data-container-id=\"${entry.id}\"]`\r\n        );\r\n\r\n        if (!entryContainer) continue;\r\n\r\n        const charges = entry.system.slots.slot1;\r\n        const chargesElement = await createChargesElement(actor, charges, true);\r\n\r\n        addListener(\r\n            chargesElement,\r\n            \"[data-action='change-charges']\",\r\n            \"change\",\r\n            (event, el: HTMLInputElement) => {\r\n                const value = Math.clamped(el.valueAsNumber, 0, charges.max);\r\n                entry.update({ \"system.slots.slot1.value\": value });\r\n            }\r\n        );\r\n\r\n        addListener(\r\n            chargesElement,\r\n            \"[data-action='change-max-charges']\",\r\n            \"change\",\r\n            (event, el: HTMLInputElement) => {\r\n                const value = Math.clamped(el.valueAsNumber, 0, 50);\r\n                entry.update({\r\n                    \"system.slots.slot1.max\": value,\r\n                    \"system.slots.slot1.value\": Math.min(value, charges.value),\r\n                });\r\n            }\r\n        );\r\n\r\n        addListener(chargesElement, \"[data-action='reset-charges']\", async () => {\r\n            entry.update({ \"system.slots.slot1.value\": charges.max });\r\n        });\r\n\r\n        const classStr = entry.showSlotlessRanks ? \"fa-solid\" : \"fa-regular\";\r\n        const toggleStr = `<a data-action=\"toggle-show-slotless-ranks\" data-tooltip=\"PF2E.ToggleSlotlessSpellLevelsTitle\">\r\n<i class=\"${classStr} fa-fw fa-list-alt\"></i>\r\n</a>`;\r\n        const toggleElement = createHTMLFromString(toggleStr);\r\n\r\n        callback?.(entryContainer, chargesElement, toggleElement);\r\n    }\r\n}\r\n\r\nfunction onRenderNPCSheetPF2e(sheet: NPCSheetPF2e, $html: JQuery) {\r\n    const actor = sheet.actor;\r\n    const html = htmlElement($html);\r\n    const spellsTab = querySelector(html, \".tab[data-tab='spells']\");\r\n    if (!spellsTab) return;\r\n\r\n    renderChargesEntries(actor, spellsTab, (container, charges, toggle) => {\r\n        querySelector(container, \":scope > .header\")?.after(charges);\r\n        if (actor.isOwner) {\r\n            querySelector(container, \":scope > .header > .item-controls\")?.prepend(toggle);\r\n        }\r\n    });\r\n}\r\n\r\nasync function onRenderCharacterSheetPF2e(sheet: CharacterSheetPF2e, $html: JQuery) {\r\n    const actor = sheet.actor;\r\n    const html = htmlElement($html);\r\n    const contentElement = querySelector(html, \".sheet-content\");\r\n    if (!contentElement) return;\r\n\r\n    const spellsTab = querySelector(contentElement, \".tab[data-tab='spellcasting']\");\r\n    const highlightItems = getSetting(\"addedHighlight\");\r\n\r\n    if (actor.isOwner) {\r\n        const canPrep = canPrepareDailies(actor);\r\n        const tooltip = localize(canPrep ? \"sheet.title\" : \"sheet.unrested\");\r\n        const disabledClass = canPrep ? \"\" : \" disabled\";\r\n        const targetEl = querySelector(html, \"aside .sidebar .hitpoints .hp-small\");\r\n\r\n        if (targetEl) {\r\n            appendHTMLFromString(\r\n                targetEl,\r\n                `<a class=\"roll-icon dailies${disabledClass}\" data-action=\"prepare-dailies\" data-tooltip=\"${tooltip}\">\r\n            <i class=\"fas fa-mug-saucer\"></i>\r\n            </a>`\r\n            );\r\n\r\n            if (canPrep) {\r\n                addListener(targetEl, \"[data-action='prepare-dailies']\", () =>\r\n                    openDailiesInterface(actor)\r\n                );\r\n            }\r\n        }\r\n    }\r\n\r\n    if (spellsTab) {\r\n        renderChargesEntries(actor, spellsTab, (container, charges, toggle) => {\r\n            querySelector(container, \".spell-ability-data .statistic-values\")?.after(charges);\r\n            if (actor.isOwner) {\r\n                querySelector(container, \".action-header .item-controls\")?.prepend(toggle);\r\n            }\r\n        });\r\n    }\r\n\r\n    {\r\n        const staffData = getStaffFlags(actor);\r\n        const staff = staffData ? actor.inventory.get(staffData.staffId) : undefined;\r\n        const staffId = staffData?.staffId;\r\n        const staffContainer = staffId\r\n            ? contentElement.querySelector<HTMLLIElement>(\r\n                  `[data-container-id=\"${staffId}-casting\"]`\r\n              )\r\n            : undefined;\r\n\r\n        if (staffContainer && staffData && staff) {\r\n            const rowControls = staffContainer.querySelectorAll(\".item-controls\");\r\n            const handles = staffContainer.querySelectorAll<HTMLElement>(\".item-name\");\r\n\r\n            if (highlightItems) {\r\n                staffContainer.classList.add(\"temporary\");\r\n            }\r\n\r\n            for (const controls of rowControls ?? []) {\r\n                controls.innerHTML = \"\";\r\n            }\r\n\r\n            for (const handle of handles ?? []) {\r\n                handle.classList.remove(\"drag-handle\");\r\n                handle.draggable = false;\r\n                delete handle.dataset.dragHandle;\r\n            }\r\n\r\n            const charges = staffData.charges;\r\n            const isEquipped = staff.isEquipped;\r\n            const annotation = isEquipped\r\n                ? \"sheathe\"\r\n                : staff.carryType === \"dropped\"\r\n                ? \"pick-up\"\r\n                : staff.isStowed\r\n                ? \"retrieve\"\r\n                : \"draw\";\r\n            const action = isEquipped\r\n                ? undefined\r\n                : {\r\n                      cost: annotation === \"retrieve\" ? 2 : 1,\r\n                      id: staff.id,\r\n                      label: localize(\"staves.action\", annotation),\r\n                  };\r\n            const chargesElement = await createChargesElement(actor, charges, false, action);\r\n\r\n            addListener(\r\n                chargesElement,\r\n                \"[data-action='change-charges']\",\r\n                \"change\",\r\n                (event, el: HTMLInputElement) => {\r\n                    const value = Math.clamped(el.valueAsNumber, 0, charges.max);\r\n                    setStaffChargesValue(actor, value);\r\n                }\r\n            );\r\n\r\n            addListener(chargesElement, \"[data-action='reset-charges']\", async () => {\r\n                setStaffChargesValue(actor, charges.max);\r\n            });\r\n\r\n            if (!isEquipped) {\r\n                addListener(chargesElement, \"button\", () => {\r\n                    changeCarryType(actor, staff, annotation === \"sheathe\" ? 0 : 1, annotation);\r\n                });\r\n            }\r\n\r\n            querySelector(staffContainer, \".spell-ability-data .statistic-values\")?.after(\r\n                chargesElement\r\n            );\r\n        }\r\n    }\r\n\r\n    {\r\n        const addedItems = getActorFlag(actor, \"addedItems\");\r\n\r\n        if (highlightItems) {\r\n            for (const id of addedItems ?? []) {\r\n                const itemElements = contentElement.querySelectorAll(`[data-item-id=\"${id}\"]`);\r\n\r\n                for (const itemElement of itemElements) {\r\n                    itemElement.classList.add(`temporary`);\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nasync function createChargesElement(\r\n    actor: ActorPF2e,\r\n    charges: { value: number; max: number },\r\n    withMax: boolean,\r\n    action?: { label: string; cost: number; id: string }\r\n) {\r\n    const isOwner = actor.isOwner;\r\n    const chargesTemplate = await render(\"charges\", {\r\n        isOwner,\r\n        charges,\r\n        withMax,\r\n        action,\r\n        i18n: templateLocalize(\"sheet.charges\"),\r\n    });\r\n    return createHTMLFromString<HTMLElement>(chargesTemplate);\r\n}\r\n\r\nfunction onRenderFamiliarSheetPF2e(sheet: FamiliarSheetPF2e, $html: JQuery) {\r\n    const actor = sheet.actor;\r\n    const html = htmlElement($html);\r\n    const itemElements = html.querySelectorAll<HTMLElement>(\r\n        \".section-container:not(.familiar-section) .actions-list [data-item-id]\"\r\n    );\r\n\r\n    for (const itemElement of itemElements) {\r\n        const { itemId } = elementData(itemElement);\r\n        const item = actor.items.get(itemId);\r\n\r\n        if (item && isTemporary(item)) {\r\n            itemElement.classList.add(\"temporary\");\r\n        }\r\n    }\r\n}\r\n\r\nasync function onCharacterSheetGetData(\r\n    this: CharacterSheetPF2e,\r\n    wrapped: libWrapper.RegisterCallback<Promise<CharacterSheetData>>,\r\n    options?: ActorSheetOptions\r\n) {\r\n    const data = await wrapped(options);\r\n\r\n    try {\r\n        const actor = this.actor;\r\n        const staffId = getStaffFlags(actor)?.staffId;\r\n        if (!staffId) return data;\r\n\r\n        const staff = actor.inventory.get(staffId);\r\n        if (!staff) return data;\r\n\r\n        const collectionId = `${staff.id}-casting`;\r\n        const knownCollections = data.spellCollectionGroups[\"known-spells\"];\r\n\r\n        const collectionIndex = knownCollections.findIndex((group) => group.id === collectionId);\r\n        if (collectionIndex === -1) return data;\r\n\r\n        const collectionGroup = knownCollections.splice(collectionIndex, 1)[0];\r\n        data.spellCollectionGroups.activations.unshift(collectionGroup);\r\n    } catch (error) {\r\n        MODULE.error(\"CharacterSheetPF2e#getData\", error);\r\n    }\r\n\r\n    return data;\r\n}\r\n\r\nfunction onCharacterPrepareData(this: CharacterPF2e, wrapped: libWrapper.RegisterCallback): void {\r\n    wrapped();\r\n\r\n    try {\r\n        const staffFlags = getStaffFlags(this);\r\n        if (!staffFlags) return;\r\n\r\n        const staff = this.items.get<dailies.StaffPF2e>(staffFlags.staffId);\r\n        if (!staff) return;\r\n\r\n        const staffStatistic = (() => {\r\n            if (staffFlags.statistic) {\r\n                const statistic = this.getStatistic(staffFlags.statistic.slug);\r\n                return statistic\r\n                    ? {\r\n                          statistic,\r\n                          tradition: staffFlags.statistic.tradition,\r\n                      }\r\n                    : undefined;\r\n            }\r\n            return getHighestSpellcastingStatistic(this);\r\n        })();\r\n\r\n        if (!staffStatistic) return;\r\n\r\n        const collectionId = `${staff.id}-casting`;\r\n        const staffEntry = new StaffSpellcasting(\r\n            {\r\n                ...staffStatistic,\r\n                id: collectionId,\r\n                name: staff.name,\r\n                actor: this,\r\n                castPredicate: [\r\n                    `item:id:${staff.id}`,\r\n                    { or: staffFlags.spells.map((s) => `spell:id:${s._id}`) },\r\n                ],\r\n            },\r\n            staff\r\n        );\r\n\r\n        class StaffSpell extends getSpellClass()<CharacterPF2e> {\r\n            override async toMessage(\r\n                event?: Maybe<MouseEvent | JQuery.TriggeredEvent>,\r\n                { create = true, data, rollMode }: SpellToMessageOptions = {}\r\n            ): Promise<ChatMessagePF2e | undefined> {\r\n                const message = await super.toMessage(event, { rollMode, data, create: false });\r\n                if (!message) return undefined;\r\n\r\n                const messageSource = message.toObject();\r\n                const flags = messageSource.flags.pf2e;\r\n\r\n                flags.casting.embeddedSpell = this.toObject();\r\n\r\n                if (!create) {\r\n                    message.updateSource(messageSource);\r\n                    return message;\r\n                }\r\n\r\n                return ChatMessage.implementation.create(messageSource, {\r\n                    renderSheet: false,\r\n                }) as Promise<ChatMessagePF2e>;\r\n            }\r\n        }\r\n\r\n        const SpellCollection = getSpellCollectionClass(this);\r\n        const collection = new SpellCollection(staffEntry);\r\n\r\n        for (const spellSource of staffFlags.spells) {\r\n            const source: SpellSource = mergeObject(\r\n                spellSource,\r\n                { \"system.location.value\": collectionId },\r\n                { inplace: false }\r\n            );\r\n\r\n            const spell = new StaffSpell(source, { parent: this });\r\n            collection.set(spell.id, spell);\r\n        }\r\n\r\n        this.spellcasting.set(staffEntry.id, staffEntry);\r\n        this.spellcasting.collections.set(collectionId, collection);\r\n    } catch (error) {\r\n        MODULE.error(\"CharacterPF2e#prepareData\", error);\r\n    }\r\n}\r\n\r\nexport {\r\n    onCharacterPrepareData,\r\n    onCharacterSheetGetData,\r\n    onRenderCharacterSheetPF2e,\r\n    onRenderFamiliarSheetPF2e,\r\n    onRenderNPCSheetPF2e,\r\n    performDailyCrafting,\r\n};\r\n", "import {\r\n    addListener,\r\n    addListenerAll,\r\n    closest,\r\n    getSetting,\r\n    htmlElement,\r\n    querySelector,\r\n    setSetting,\r\n    subLocalize,\r\n    templatePath,\r\n} from \"pf2e-api\";\r\nimport { DAILY_SCHEMA, parseCustomDaily } from \"../dailies\";\r\nimport type { CustomDaily } from \"../types\";\r\n\r\nconst localize = subLocalize(\"customs\");\r\n\r\nconst tabKey = \"    \";\r\n\r\nconst keymap: Record<string, string> = {\r\n    \"(\": \"()\",\r\n    \"{\": \"{}\",\r\n    \"[\": \"[]\",\r\n    \"'\": \"''\",\r\n    '\"': '\"',\r\n    \"`\": \"``\",\r\n};\r\n\r\nfunction generateDefaultCode(key: string) {\r\n    return `return {\r\n    key: \"${key}\",\r\n    items: [],\r\n    label: \"\",\r\n    rows: (actor, items) => {\r\n        return []\r\n    },\r\n    process: ({actor, rows, messages}) => {\r\n\r\n    }\r\n}`;\r\n}\r\n\r\nclass CustomDailies extends FormApplication {\r\n    #selected: string | null = null;\r\n\r\n    static get defaultOptions() {\r\n        return mergeObject(super.defaultOptions, {\r\n            id: \"pf2e-dailies-customs\",\r\n            title: localize(\"title\"),\r\n            template: templatePath(\"customs\"),\r\n            submitOnChange: false,\r\n            submitOnClose: false,\r\n            closeOnSubmit: false,\r\n            scrollY: [\".left .list\"],\r\n        });\r\n    }\r\n\r\n    get dailies() {\r\n        return getSetting<CustomDaily[]>(\"customDailies\");\r\n    }\r\n\r\n    getData(options?: object | undefined) {\r\n        const selected = this.#selected;\r\n        const dailies = this.dailies;\r\n        const daily = dailies.find(({ key }) => key === selected);\r\n\r\n        return {\r\n            i18n: localize.i18n,\r\n            list: dailies.map(({ key, schema }) => ({\r\n                key,\r\n                readonly: isNewerVersion(DAILY_SCHEMA, schema ?? \"\"),\r\n                selected: key === selected,\r\n            })),\r\n            code: daily?.code ?? \"\",\r\n            readonly: (daily && isNewerVersion(DAILY_SCHEMA, daily?.schema ?? \"\")) || false,\r\n            disabled: !daily,\r\n        };\r\n    }\r\n\r\n    activateListeners($html: JQuery<HTMLElement>) {\r\n        const html = htmlElement($html);\r\n\r\n        addListener(html, \".editor\", \"keydown\", this.#onEditorKeyup.bind(this));\r\n        addListener(html, \"[data-action='create-daily']\", this.#onCreateDaily.bind(this));\r\n        addListener(html, \"[data-action='save-daily']\", this.#onSaveDaily.bind(this));\r\n        addListener(html, \".right .readonly a\", this.#onUnlockDaily.bind(this));\r\n\r\n        addListenerAll(html, \"[data-action='select-daily']\", this.#onSelectDaily.bind(this));\r\n        addListenerAll(html, \"[data-action='delete-daily']\", this.#onDeleteDaily.bind(this));\r\n    }\r\n\r\n    _updateObject(event: SubmitEvent, formData: Record<string, unknown>): Promise<void> {\r\n        throw new Error(\"Method not implemented.\");\r\n    }\r\n\r\n    async #onSaveDaily() {\r\n        if (!this.#selected) return;\r\n\r\n        const html = htmlElement(this.element);\r\n        const code = querySelector<HTMLTextAreaElement>(html, \".editor\")!.value;\r\n        const daily = await parseCustomDaily({ code, key: this.#selected });\r\n\r\n        if (!daily) {\r\n            localize.error(\"code.error\");\r\n            return;\r\n        }\r\n\r\n        const dailies = this.dailies.slice();\r\n        const dailyIndex = dailies.findIndex((daily) => daily.key === this.#selected);\r\n\r\n        const custom = {\r\n            key: daily.key,\r\n            code,\r\n            schema: DAILY_SCHEMA,\r\n        };\r\n\r\n        if (dailyIndex !== -1) {\r\n            dailies.splice(dailyIndex, 1, custom);\r\n        } else {\r\n            dailies.push(custom);\r\n        }\r\n\r\n        await setSetting(\"customDailies\", dailies);\r\n\r\n        localize.info(\"code.saved\");\r\n\r\n        this.#selected = daily.key;\r\n        this.render();\r\n    }\r\n\r\n    #onUnlockDaily() {\r\n        const html = htmlElement(this.element);\r\n        const readonlyEl = html.querySelector<HTMLElement>(\".right .readonly\");\r\n        if (!readonlyEl) return;\r\n\r\n        readonlyEl.remove();\r\n        querySelector<HTMLTextAreaElement>(html, \".editor\")!.disabled = false;\r\n        querySelector<HTMLButtonElement>(html, \"[data-action='save-daily']\")!.disabled = false;\r\n    }\r\n\r\n    #onEditorKeyup(event: KeyboardEvent, editor: HTMLTextAreaElement) {\r\n        const pos = editor.selectionStart;\r\n\r\n        if (event.key === \"Tab\") {\r\n            event.preventDefault();\r\n\r\n            editor.value =\r\n                editor.value.slice(0, pos) + tabKey + editor.value.slice(editor.selectionEnd);\r\n\r\n            editor.selectionStart = pos + tabKey.length;\r\n            editor.selectionEnd = pos + tabKey.length;\r\n        } else if (keymap[event.key]) {\r\n            event.preventDefault();\r\n\r\n            editor.value =\r\n                editor.value.slice(0, pos) +\r\n                keymap[event.key] +\r\n                editor.value.slice(editor.selectionEnd);\r\n\r\n            editor.selectionStart = pos + 1;\r\n            editor.selectionEnd = pos + 1;\r\n        }\r\n    }\r\n\r\n    #onSelectDaily(event: MouseEvent, el: HTMLElement) {\r\n        const key = closest(el, \".row\")!.dataset.key!;\r\n        this.#selected = key;\r\n        this.render();\r\n    }\r\n\r\n    async #onCreateDaily() {\r\n        const key = randomID();\r\n        const dailies = this.dailies.slice();\r\n\r\n        dailies.push({\r\n            key,\r\n            code: generateDefaultCode(key),\r\n            schema: DAILY_SCHEMA,\r\n        });\r\n\r\n        await setSetting(\"customDailies\", dailies);\r\n\r\n        this.#selected = key;\r\n        this.render();\r\n    }\r\n\r\n    async #onDeleteDaily(event: MouseEvent, el: HTMLElement) {\r\n        const key = closest(el, \".row\")!.dataset.key!;\r\n        const dailies = this.dailies.slice();\r\n        const index = dailies.findIndex((daily) => daily.key === key);\r\n        if (index === -1) return false;\r\n\r\n        const accept = await Dialog.confirm({\r\n            title: localize(\"delete.title\"),\r\n            content: localize(\"delete.content\"),\r\n        });\r\n\r\n        if (!accept) return;\r\n\r\n        dailies.splice(index, 1);\r\n\r\n        await setSetting(\"customDailies\", dailies);\r\n\r\n        this.#selected = null;\r\n        this.render();\r\n    }\r\n}\r\n\r\nexport { CustomDailies };\r\n", "import { MODULE, getFlag, updateFlag, type libWrapper } from \"pf2e-api\";\r\nimport { createUpdateCollection, isTemporary } from \"./api\";\r\nimport { filterDailies, getDailies } from \"./dailies\";\r\nimport { DailyActorFlags } from \"./types\";\r\n\r\ninterface RestForTheNightOptions extends ActionDefaultOptions {\r\n    skipDialog?: boolean;\r\n}\r\n\r\nasync function restForTheNight(\r\n    wrapped: libWrapper.RegisterCallback,\r\n    options: RestForTheNightOptions\r\n) {\r\n    const result = await wrapped(options);\r\n\r\n    try {\r\n        if (!result?.length) {\r\n            return result;\r\n        }\r\n\r\n        const actors = Array.isArray(options.actors) ? options.actors : [options.actors];\r\n        const characters = actors.filter(\r\n            (actor): actor is CharacterPF2e => !!actor?.isOfType(\"character\")\r\n        );\r\n\r\n        await Promise.all(characters.map(cleanup));\r\n    } catch (error) {\r\n        MODULE.error(\"game.pf2e.actions.restForTheNight\", error);\r\n    }\r\n\r\n    return result;\r\n}\r\n\r\nasync function cleanup(actor: CharacterPF2e) {\r\n    const removedItems: string[] = [];\r\n    const [updatedItems, updateItem] = createUpdateCollection();\r\n    const dailies = filterDailies(await getDailies(actor));\r\n\r\n    await Promise.all(\r\n        dailies.map((daily) => {\r\n            return daily.rest?.({\r\n                actor,\r\n                updateItem,\r\n                removeItem: (id) => {\r\n                    removedItems.push(id);\r\n                },\r\n            });\r\n        })\r\n    );\r\n\r\n    await Promise.all(\r\n        actor.items.map(async (item) => {\r\n            if (isTemporary(item)) {\r\n                removedItems.push(item.id);\r\n\r\n                if (item.isOfType(\"feat\")) {\r\n                    const parentId = getFlag<string>(item, \"grantedBy\");\r\n                    if (parentId) {\r\n                        const slug = game.pf2e.system.sluggify(item.name, { camel: \"dromedary\" });\r\n                        updateItem({\r\n                            _id: parentId,\r\n                            [`flags.pf2e.itemGrants.-=${slug}`]: true,\r\n                        });\r\n                    }\r\n                }\r\n\r\n                return;\r\n            }\r\n\r\n            const rules = deepClone(item._source.system.rules);\r\n            let modifiedRules = false;\r\n\r\n            for (let i = rules.length - 1; i >= 0; i--) {\r\n                if (MODULE.id in rules[i]) {\r\n                    rules.splice(i, 1);\r\n                    modifiedRules = true;\r\n                }\r\n            }\r\n\r\n            if (modifiedRules) {\r\n                updateItem({\r\n                    _id: item.id,\r\n                    \"system.rules\": rules,\r\n                });\r\n            }\r\n        })\r\n    );\r\n\r\n    if (updatedItems.size) {\r\n        await actor.updateEmbeddedDocuments(\"Item\", updatedItems.contents);\r\n    }\r\n\r\n    if (removedItems.length) {\r\n        await actor.deleteEmbeddedDocuments(\"Item\", removedItems);\r\n    }\r\n\r\n    await updateFlag<DailyActorFlags>(actor, {\r\n        rested: true,\r\n        addedItems: [],\r\n        \"-=extra\": true,\r\n    });\r\n}\r\n\r\nexport { restForTheNight };\r\n", "import {\r\n    MODULE,\r\n    getRankLabel,\r\n    getSpellCollectionClass,\r\n    isInstanceOf,\r\n    libWrapper,\r\n    spellSlotGroupIdToNumber,\r\n    warn,\r\n    warnInvalidDrop,\r\n} from \"pf2e-api\";\r\nimport { ChargesSpellcastingSheetData } from \"./types\";\r\n\r\nfunction spellcastingEntryPrepareSiblingData(\r\n    this: SpellcastingEntryPF2e<CreaturePF2e>,\r\n    wrapped: libWrapper.RegisterCallback\r\n): void {\r\n    const actor = this.actor;\r\n\r\n    if (\r\n        !actor.isOfType(\"creature\") ||\r\n        !actor.spellcasting ||\r\n        this.system.prepared.value !== \"charges\"\r\n    ) {\r\n        wrapped();\r\n        return;\r\n    }\r\n\r\n    try {\r\n        const SpellCollection = getSpellCollectionClass(actor);\r\n\r\n        class ChargesSpellCollection extends SpellCollection {\r\n            async addSpell(\r\n                spell: SpellPF2e<ActorPF2e>,\r\n                options?: { groupId?: Maybe<SpellSlotGroupId> } | undefined\r\n            ): Promise<SpellPF2e<CreaturePF2e> | null> {\r\n                const actor = this.actor;\r\n                const groupId = options?.groupId;\r\n                const heightenedRank = spellSlotGroupIdToNumber(groupId) ?? spell.rank;\r\n\r\n                const spellcastingEntryId = spell.system.location.value;\r\n                if (spellcastingEntryId === this.id && spell.rank === heightenedRank) {\r\n                    return null;\r\n                }\r\n\r\n                if (spell.isFocusSpell) {\r\n                    warnInvalidDrop(\"invalid-spell\", { spell });\r\n                    return null;\r\n                }\r\n\r\n                if (spell.baseRank > heightenedRank && this.id === spell.system.location?.value) {\r\n                    warnInvalidDrop(\"invalid-rank\", { spell, groupId });\r\n                    return null;\r\n                }\r\n\r\n                const heightenedUpdate =\r\n                    heightenedRank >= spell.baseRank\r\n                        ? { \"system.location.heightenedLevel\": heightenedRank }\r\n                        : {};\r\n\r\n                if (spell.actor === actor) {\r\n                    return spell.update({\r\n                        \"system.location.value\": this.id,\r\n                        ...heightenedUpdate,\r\n                    }) as Promise<SpellPF2e<CreaturePF2e> | null>;\r\n                } else {\r\n                    const source = spell\r\n                        .clone({ sort: 0, \"system.location.value\": this.id, ...heightenedUpdate })\r\n                        .toObject();\r\n                    const created = (await actor.createEmbeddedDocuments(\"Item\", [source])).shift();\r\n\r\n                    return isInstanceOf<SpellPF2e<CreaturePF2e>>(created, \"SpellPF2e\")\r\n                        ? created\r\n                        : null;\r\n                }\r\n            }\r\n\r\n            async getSpellData(options?: { prepList?: boolean }) {\r\n                const spellData = await super.getSpellData(options);\r\n                const charges = this.entry.system?.slots.slot1.value || 0;\r\n\r\n                for (const group of spellData.groups) {\r\n                    if (group.id === \"cantrips\" || charges >= group.id) continue;\r\n\r\n                    for (const active of group.active) {\r\n                        if (!active) continue;\r\n                        active.expended = true;\r\n                    }\r\n                }\r\n\r\n                return spellData;\r\n            }\r\n        }\r\n\r\n        this.spells = new ChargesSpellCollection(this);\r\n\r\n        const spells = actor.itemTypes.spell.filter(\r\n            (spell) => spell.system.location.value === this.id\r\n        );\r\n\r\n        for (const spell of spells) {\r\n            this.spells.set(spell.id, spell);\r\n        }\r\n\r\n        actor.spellcasting.collections.set(this.spells.id, this.spells);\r\n    } catch (error) {\r\n        MODULE.error(\"SpPellcastingEntryPF2e#prepareSiblingData\", error);\r\n    }\r\n}\r\n\r\nasync function spellcastingEntryConsume(\r\n    this: SpellcastingEntryPF2e<NonNullable<CreaturePF2e>>,\r\n    wrapped: libWrapper.RegisterCallback,\r\n    spell: SpellPF2e<ActorPF2e>,\r\n    rank: ZeroToTen,\r\n    slotIndex?: number\r\n): Promise<boolean> {\r\n    const actor = this.actor;\r\n\r\n    if (\r\n        !actor.isOfType(\"npc\", \"character\") ||\r\n        !actor.spellcasting ||\r\n        this.system.prepared.value !== \"charges\"\r\n    ) {\r\n        return wrapped(spell, rank, slotIndex);\r\n    }\r\n\r\n    try {\r\n        const charges = this.system.slots.slot1.value;\r\n\r\n        if (charges < rank) {\r\n            warn(\"charges.error.notEnough\", { spell: spell.name, rank: getRankLabel(rank) });\r\n            return false;\r\n        }\r\n\r\n        await this.update({ \"system.slots.slot1.value\": charges - rank });\r\n        return true;\r\n    } catch (error) {\r\n        MODULE.error(\"SpPellcastingEntryPF2e#consume\", error);\r\n        return false;\r\n    }\r\n}\r\n\r\nasync function spellcastingEntryGetSheetData(\r\n    this: SpellcastingEntryPF2e<NonNullable<CreaturePF2e>>,\r\n    wrapped: libWrapper.RegisterCallback,\r\n    options: { spells?: SpellCollection<CharacterPF2e> } = {}\r\n): Promise<ChargesSpellcastingSheetData> {\r\n    const actor = this.actor;\r\n    const data: ChargesSpellcastingSheetData = await wrapped(options);\r\n\r\n    if (\r\n        !actor.isOfType(\"npc\", \"character\") ||\r\n        !actor.spellcasting ||\r\n        this.system.prepared.value !== \"charges\"\r\n    ) {\r\n        return data;\r\n    }\r\n\r\n    data.isCharges = true;\r\n    data.isStaff = false;\r\n    data.uses = {\r\n        value: this.system.slots.slot1.value,\r\n        max: this.system.slots.slot1.max,\r\n    };\r\n\r\n    return data;\r\n}\r\n\r\nexport {\r\n    spellcastingEntryConsume,\r\n    spellcastingEntryGetSheetData,\r\n    spellcastingEntryPrepareSiblingData,\r\n};\r\n", "import {\r\n    MODULE,\r\n    getSetting,\r\n    registerSetting,\r\n    registerSettingMenu,\r\n    registerWrapper,\r\n    renderCharacterSheets,\r\n    warn,\r\n} from \"pf2e-api\";\r\nimport {\r\n    onCharacterPrepareData,\r\n    onCharacterSheetGetData,\r\n    onRenderCharacterSheetPF2e,\r\n    onRenderFamiliarSheetPF2e,\r\n    onRenderNPCSheetPF2e,\r\n    performDailyCrafting,\r\n} from \"./actor\";\r\nimport { CustomDailies } from \"./apps/customs\";\r\nimport { DAILY_SCHEMA, initDailies, parseDailies } from \"./dailies\";\r\nimport { restForTheNight } from \"./rest\";\r\nimport {\r\n    spellcastingEntryConsume,\r\n    spellcastingEntryGetSheetData,\r\n    spellcastingEntryPrepareSiblingData,\r\n} from \"./spellcasting\";\r\nimport { CustomDaily } from \"./types\";\r\nimport { canCastRank, openDailiesInterface, setStaffChargesValue } from \"./api\";\r\n\r\nMODULE.register(\"pf2e-dailies\", \"PF2e Dailies\");\r\n\r\nHooks.once(\"init\", () => {\r\n    registerSetting({\r\n        key: \"customDailies\",\r\n        type: Array,\r\n        default: [],\r\n        config: false,\r\n        onChange: parseDailies,\r\n    });\r\n\r\n    registerSettingMenu({\r\n        key: \"customs\",\r\n        type: CustomDailies,\r\n    });\r\n\r\n    registerSetting({\r\n        key: \"familiarAbilities\",\r\n        type: String,\r\n        default: \"\",\r\n    });\r\n\r\n    registerSetting({\r\n        key: \"partyMembers\",\r\n        type: Boolean,\r\n        default: true,\r\n    });\r\n\r\n    registerSetting({\r\n        key: \"addedHighlight\",\r\n        type: Boolean,\r\n        default: true,\r\n        scope: \"client\",\r\n        onChange: renderCharacterSheets,\r\n    });\r\n\r\n    registerWrapper(\r\n        \"CONFIG.PF2E.Actor.documentClasses.character.prototype.prepareData\",\r\n        onCharacterPrepareData,\r\n        \"WRAPPER\"\r\n    );\r\n\r\n    MODULE.current.api = {\r\n        canCastRank,\r\n        setStaffChargesValue,\r\n        openDailiesInterface,\r\n    };\r\n\r\n    CONFIG.PF2E.preparationType.charges = \"Charges\";\r\n\r\n    registerWrapper(\r\n        \"CONFIG.PF2E.Item.documentClasses.spellcastingEntry.prototype.prepareSiblingData\",\r\n        spellcastingEntryPrepareSiblingData,\r\n        \"MIXED\"\r\n    );\r\n\r\n    registerWrapper(\r\n        \"CONFIG.PF2E.Item.documentClasses.spellcastingEntry.prototype.consume\",\r\n        spellcastingEntryConsume,\r\n        \"MIXED\"\r\n    );\r\n\r\n    registerWrapper(\r\n        \"CONFIG.PF2E.Item.documentClasses.spellcastingEntry.prototype.getSheetData\",\r\n        spellcastingEntryGetSheetData,\r\n        \"WRAPPER\"\r\n    );\r\n});\r\n\r\nHooks.once(\"ready\", () => {\r\n    initDailies();\r\n\r\n    registerWrapper(\"game.pf2e.actions.restForTheNight\", restForTheNight, \"WRAPPER\");\r\n\r\n    registerWrapper(\r\n        \"CONFIG.PF2E.Actor.documentClasses.character.prototype.performDailyCrafting\",\r\n        performDailyCrafting,\r\n        \"OVERRIDE\"\r\n    );\r\n\r\n    registerWrapper(\r\n        \"CONFIG.Actor.sheetClasses.character['pf2e.CharacterSheetPF2e'].cls.prototype.getData\",\r\n        onCharacterSheetGetData,\r\n        \"WRAPPER\"\r\n    );\r\n\r\n    if (game.user.isGM) {\r\n        const hasIncompatibleDailies = getSetting<CustomDaily[]>(\"customDailies\").some((custom) =>\r\n            isNewerVersion(DAILY_SCHEMA, custom.schema ?? \"\")\r\n        );\r\n        if (hasIncompatibleDailies) {\r\n            warn(\"error.incompatible\", true);\r\n        }\r\n    }\r\n});\r\n\r\nHooks.on(\"renderCharacterSheetPF2e\", onRenderCharacterSheetPF2e);\r\nHooks.on(\"renderFamiliarSheetPF2e\", onRenderFamiliarSheetPF2e);\r\nHooks.on(\"renderNPCSheetPF2e\", onRenderNPCSheetPF2e);\r\n"],
  "mappings": "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",
  "names": ["require_purry", "__commonJSMin", "exports", "__spreadArray", "to", "from", "pack", "i", "l", "ar", "purry", "fn", "args", "lazy", "diff", "arrayArgs", "ret", "__name", "data", "require_add", "__commonJSMin", "exports", "purry_1", "add", "_add", "__name", "value", "addend", "require_addProp", "__commonJSMin", "exports", "__assign", "t", "s", "i", "p", "purry_1", "addProp", "_addProp", "__name", "obj", "prop", "value", "_a", "require_allPass", "__commonJSMin", "exports", "purry_1", "allPass", "_allPass", "__name", "data", "fns", "fn", "require_anyPass", "__commonJSMin", "exports", "purry_1", "anyPass", "_anyPass", "__name", "data", "fns", "fn", "require_withPrecision", "__commonJSMin", "exports", "MAX_PRECISION", "_withPrecision", "roundingFn", "value", "precision", "multiplier", "__name", "require_ceil", "__commonJSMin", "exports", "_withPrecision_1", "purry_1", "ceil", "__name", "require_chunk", "__commonJSMin", "exports", "purry_1", "chunk", "_chunk", "__name", "array", "size", "ret", "index", "require_clamp", "__commonJSMin", "exports", "purry_1", "clamp", "_clamp", "__name", "value", "limits", "require_type", "__commonJSMin", "exports", "type", "val", "__name", "require_clone", "__commonJSMin", "exports", "type_1", "_cloneRegExp", "pattern", "__name", "_clone", "value", "refFrom", "refTo", "deep", "copy", "copiedValue", "len", "idx", "key", "clone", "require_isTruthy", "__commonJSMin", "exports", "isTruthy", "data", "__name", "require_compact", "__commonJSMin", "exports", "isTruthy_1", "compact", "items", "__name", "require_concat", "__commonJSMin", "exports", "purry_1", "concat", "_concat", "__name", "arr1", "arr2", "require_purryOn", "__commonJSMin", "exports", "__spreadArray", "to", "from", "pack", "i", "l", "ar", "purryOn", "isArg", "implementation", "args", "callArgs", "dataOrArg", "rest", "data", "__name", "require_conditional", "__commonJSMin", "exports", "_purryOn_1", "conditional", "isCase", "conditionalImplementation", "__name", "data", "cases", "_i", "_a", "cases_1", "_b", "when", "then", "maybeCase", "rest", "trivialDefaultCase", "require_countBy", "__commonJSMin", "exports", "purry_1", "_countBy", "__name", "indexed", "array", "fn", "ret", "item", "index", "value", "countBy", "require_pipe", "__commonJSMin", "exports", "pipe", "value", "operations", "_i", "ret", "lazyOps", "op", "_a", "lazy", "lazyArgs", "fn", "opIdx", "lazyOp", "lazySeq", "j", "acc", "ret_1", "item", "_processItem", "lastLazySeq", "__name", "lazyResult", "isDone", "i", "lazyFn", "indexed", "index", "items", "nextValues", "nextValues_1", "subItem", "subResult", "require_createPipe", "__commonJSMin", "exports", "__spreadArray", "to", "from", "pack", "i", "l", "ar", "pipe_1", "createPipe", "operations", "_i", "value", "__name", "require_debounce", "__commonJSMin", "exports", "debounce", "func", "_a", "waitMs", "_b", "timing", "maxWaitMs", "coolDownTimeoutId", "maxWaitTimeoutId", "latestCallArgs", "result", "handleInvoke", "__name", "timeoutId", "args", "handleCoolDownEnd", "handleDebouncedCall", "_i", "require_reduceLazy", "__commonJSMin", "exports", "_reduceLazy", "array", "lazy", "indexed", "newArray", "index", "item", "result", "__name", "require_difference", "__commonJSMin", "exports", "purry_1", "_reduceLazy_1", "difference", "_difference", "__name", "array", "other", "lazy", "set", "value", "require_differenceWith", "__commonJSMin", "exports", "purry_1", "_reduceLazy_1", "differenceWith", "_differenceWith", "__name", "array", "other", "isEquals", "lazy", "value", "otherValue", "require_divide", "__commonJSMin", "exports", "purry_1", "divide", "_divide", "__name", "value", "divisor", "require_drop", "__commonJSMin", "exports", "purry_1", "_reduceLazy_1", "drop", "_drop", "__name", "array", "n", "lazy", "left", "value", "require_swapInPlace", "__commonJSMin", "exports", "swapInPlace", "data", "i", "j", "_a", "__name", "require_heap", "__commonJSMin", "exports", "_swapInPlace_1", "heapify", "heap", "compareFn", "i", "heapSiftDown", "__name", "heapMaybeInsert", "item", "head", "index", "currentIndex", "firstChildIndex", "swapIndex", "secondChildIndex", "require_purryOrderRules", "__commonJSMin", "exports", "__spreadArray", "to", "from", "pack", "i", "l", "ar", "COMPARATORS", "x", "y", "purryOrderRules", "func", "inputArgs", "_a", "dataOrRule", "rules", "isOrderRule", "compareFn_1", "orderRuleComparer", "compareFn", "data", "__name", "purryOrderRulesWithArgument", "first", "second", "rest", "arg", "argRemoved", "args", "_i", "primaryRule", "secondaryRule", "otherRules", "projector", "direction", "comparator", "nextComparer", "a", "b", "projectedA", "projectedB", "isProjection", "maybeProjection", "maybeDirection", "require_dropFirstBy", "__commonJSMin", "exports", "__spreadArray", "to", "from", "pack", "i", "l", "ar", "_heap_1", "_purryOrderRules_1", "dropFirstBy", "dropFirstByImplementation", "__name", "data", "compareFn", "n", "heap", "out", "rest", "_i", "rest_1", "item", "previousHead", "require_dropLast", "__commonJSMin", "exports", "__spreadArray", "to", "from", "pack", "i", "l", "ar", "purry_1", "dropLast", "_dropLast", "__name", "array", "n", "copy", "require_dropLastWhile", "__commonJSMin", "exports", "purry_1", "dropLastWhile", "_dropLastWhile", "__name", "data", "predicate", "i", "require_dropWhile", "__commonJSMin", "exports", "purry_1", "dropWhile", "_dropWhile", "__name", "data", "predicate", "i", "require_equals", "__commonJSMin", "exports", "purry_1", "isArray", "keyList", "equals", "_equals", "__name", "a", "b", "arrA", "arrB", "i", "length_1", "key", "dateA", "dateB", "regexpA", "regexpB", "keys", "require_toPairs", "__commonJSMin", "exports", "toPairs", "object", "__name", "strict", "require_evolve", "__commonJSMin", "exports", "__assign", "t", "s", "i", "p", "purry_1", "toPairs_1", "evolve", "_evolve", "__name", "data", "evolver", "result", "_a", "key", "value", "require_toLazyIndexed", "__commonJSMin", "exports", "_toLazyIndexed", "__name", "fn", "require_filter", "__commonJSMin", "exports", "purry_1", "_reduceLazy_1", "_toLazyIndexed_1", "filter", "_filter", "__name", "indexed", "array", "fn", "_lazy", "value", "index", "valid", "require_toSingle", "__commonJSMin", "exports", "_toSingle", "__name", "fn", "require_find", "__commonJSMin", "exports", "purry_1", "_toLazyIndexed_1", "_toSingle_1", "find", "_find", "__name", "indexed", "array", "fn", "x", "_lazy", "value", "index", "valid", "require_findIndex", "__commonJSMin", "exports", "purry_1", "_toLazyIndexed_1", "_toSingle_1", "findIndex", "_findIndex", "__name", "indexed", "array", "fn", "x", "_lazy", "i", "value", "index", "valid", "require_findLast", "__commonJSMin", "exports", "purry_1", "findLast", "_findLast", "__name", "indexed", "array", "fn", "i", "require_findLastIndex", "__commonJSMin", "exports", "purry_1", "findLastIndex", "_findLastIndex", "__name", "indexed", "array", "fn", "i", "require_first", "__commonJSMin", "exports", "purry_1", "first", "_first", "__name", "_a", "lazy", "value", "require_hasAtLeast", "__commonJSMin", "exports", "purry_1", "hasAtLeast", "args", "_i", "hasAtLeastImplementation", "__name", "data", "minimum", "require_firstBy", "__commonJSMin", "exports", "_purryOrderRules_1", "hasAtLeast_1", "firstBy", "firstByImplementation", "__name", "data", "compareFn", "currentFirst", "rest", "_i", "rest_1", "item", "require_flatten", "__commonJSMin", "exports", "_reduceLazy_1", "purry_1", "flatten", "_flatten", "__name", "items", "lazy", "next", "require_flatMap", "__commonJSMin", "exports", "flatten_1", "purry_1", "flatMap", "_flatMap", "__name", "array", "fn", "item", "lazy", "value", "next", "require_flatMapToObj", "__commonJSMin", "exports", "purry_1", "flatMapToObj", "_flatMapToObj", "__name", "indexed", "array", "fn", "result", "element", "index", "items", "_a", "key", "value", "require_flattenDeep", "__commonJSMin", "exports", "_reduceLazy_1", "purry_1", "flattenDeep", "_flattenDeep", "__name", "items", "_flattenDeepValue", "value", "ret", "item", "lazy", "next", "require_floor", "__commonJSMin", "exports", "_withPrecision_1", "purry_1", "floor", "__name", "require_forEach", "__commonJSMin", "exports", "purry_1", "_reduceLazy_1", "_toLazyIndexed_1", "forEach", "_forEach", "__name", "indexed", "array", "fn", "_lazy", "value", "index", "require_forEachObj", "__commonJSMin", "exports", "purry_1", "forEachObj", "_forEachObj", "__name", "indexed", "object", "fn", "key", "val", "require_fromPairs", "__commonJSMin", "exports", "fromPairs", "entries", "out", "_i", "entries_1", "_a", "key", "value", "__name", "require_groupBy", "__commonJSMin", "exports", "purry_1", "groupBy", "_groupBy", "__name", "indexed", "array", "fn", "ret", "item", "index", "key", "actualKey", "require_identity", "__commonJSMin", "exports", "identity", "value", "__name", "require_indexBy", "__commonJSMin", "exports", "purry_1", "indexBy", "_indexBy", "__name", "indexed", "array", "fn", "ret", "item", "index", "value", "key", "indexByStrict", "_indexByStrict", "require_intersection", "__commonJSMin", "exports", "purry_1", "_reduceLazy_1", "intersection", "_intersection", "__name", "array", "other", "lazy", "value", "set", "require_intersectionWith", "__commonJSMin", "exports", "_reduceLazy_1", "purry_1", "intersectionWith", "_intersectionWith", "__name", "array", "other", "comparator", "lazy", "value", "otherValue", "require_invert", "__commonJSMin", "exports", "purry_1", "invert", "_invert", "__name", "object", "result", "key", "require_isArray", "__commonJSMin", "exports", "isArray", "data", "__name", "require_isBoolean", "__commonJSMin", "exports", "isBoolean", "data", "__name", "require_isDate", "__commonJSMin", "exports", "isDate", "data", "__name", "require_isDefined", "__commonJSMin", "exports", "isDefined", "data", "__name", "strict", "require_isObject", "__commonJSMin", "exports", "isObject", "data", "__name", "require_isString", "__commonJSMin", "exports", "isString", "data", "__name", "require_isEmpty", "__commonJSMin", "exports", "isArray_1", "isObject_1", "isString_1", "isEmpty", "data", "__name", "require_isError", "__commonJSMin", "exports", "isError", "data", "__name", "require_isFunction", "__commonJSMin", "exports", "isFunction", "data", "__name", "require_isNil", "__commonJSMin", "exports", "isNil", "data", "__name", "require_isNonNull", "__commonJSMin", "exports", "isNonNull", "data", "__name", "require_isNot", "__commonJSMin", "exports", "isNot", "predicate", "data", "__name", "require_isNumber", "__commonJSMin", "exports", "isNumber", "data", "__name", "require_isObjectType", "__commonJSMin", "exports", "isObjectType", "__name", "data", "require_isPlainObject", "__commonJSMin", "exports", "isPlainObject", "data", "proto", "__name", "require_isPromise", "__commonJSMin", "exports", "isPromise", "data", "__name", "require_isSymbol", "__commonJSMin", "exports", "isSymbol", "data", "__name", "require_join", "__commonJSMin", "exports", "purry_1", "join", "joinImplementation", "__name", "data", "glue", "require_keys", "__commonJSMin", "exports", "keys", "source", "__name", "require_last", "__commonJSMin", "exports", "purry_1", "last", "_last", "__name", "array", "require_length", "__commonJSMin", "exports", "purry_1", "length", "_length", "__name", "items", "require_map", "__commonJSMin", "exports", "purry_1", "_reduceLazy_1", "_toLazyIndexed_1", "map", "_map", "__name", "indexed", "array", "fn", "_lazy", "value", "index", "require_mapKeys", "__commonJSMin", "exports", "mapKeys", "arg1", "arg2", "data", "_mapKeys", "__name", "obj", "fn", "acc", "key", "require_mapToObj", "__commonJSMin", "exports", "purry_1", "mapToObj", "_mapToObj", "__name", "indexed", "array", "fn", "result", "element", "index", "_a", "key", "value", "require_mapValues", "__commonJSMin", "exports", "mapValues", "arg1", "arg2", "data", "_mapValues", "__name", "obj", "fn", "acc", "key", "require_maxBy", "__commonJSMin", "exports", "purry_1", "_maxBy", "__name", "indexed", "array", "fn", "ret", "retMax", "item", "i", "max", "maxBy", "require_meanBy", "__commonJSMin", "exports", "purry_1", "_meanBy", "__name", "indexed", "array", "fn", "sum", "item", "i", "meanBy", "require_merge", "__commonJSMin", "exports", "purry_1", "merge", "_merge", "__name", "a", "b", "require_mergeAll", "__commonJSMin", "exports", "__assign", "t", "s", "i", "p", "mergeAll", "items", "acc", "x", "__name", "require_mergeDeep", "__commonJSMin", "exports", "__assign", "t", "s", "i", "p", "purry_1", "mergeDeep", "mergeDeepImplementation", "__name", "destination", "source", "output", "key", "destinationValue", "isRecord", "sourceValue", "object", "require_minBy", "__commonJSMin", "exports", "purry_1", "_minBy", "__name", "indexed", "array", "fn", "ret", "retMin", "item", "i", "min", "minBy", "require_multiply", "__commonJSMin", "exports", "purry_1", "multiply", "_multiply", "__name", "value", "multiplicand", "require_noop", "__commonJSMin", "exports", "noop", "__name", "require_quickSelect", "__commonJSMin", "exports", "__spreadArray", "to", "from", "pack", "i", "l", "ar", "_swapInPlace_1", "quickSelect", "__name", "data", "index", "compareFn", "quickSelectImplementation", "left", "right", "pivotIndex", "partition", "pivot", "j", "require_nthBy", "__commonJSMin", "exports", "_purryOrderRules_1", "_quickSelect_1", "nthBy", "nthByImplementation", "__name", "data", "compareFn", "index", "require_objOf", "__commonJSMin", "exports", "purry_1", "objOf", "_objOf", "__name", "value", "key", "_a", "require_omit", "__commonJSMin", "exports", "__assign", "t", "s", "i", "p", "__rest", "e", "fromPairs_1", "purry_1", "omit", "_omit", "__name", "data", "propNames", "propName", "_a", "_b", "omitted", "remaining", "asSet", "key", "require_omitBy", "__commonJSMin", "exports", "purry_1", "omitBy", "_omitBy", "__name", "object", "fn", "acc", "key", "require_once", "__commonJSMin", "exports", "once", "fn", "called", "ret", "__name", "require_only", "__commonJSMin", "exports", "purry_1", "only", "_only", "__name", "array", "require_partition", "__commonJSMin", "exports", "purry_1", "partition", "_partition", "__name", "indexed", "array", "fn", "ret", "item", "index", "matches", "require_pathOr", "__commonJSMin", "exports", "purry_1", "pathOr", "_pathOr", "__name", "object", "path", "defaultValue", "current", "_i", "path_1", "prop", "require_pick", "__commonJSMin", "exports", "purry_1", "pick", "_pick", "__name", "object", "names", "acc", "name", "require_pickBy", "__commonJSMin", "exports", "purry_1", "pickBy", "_pickBy", "__name", "object", "fn", "acc", "key", "require_prop", "__commonJSMin", "exports", "prop", "__name", "propName", "_a", "_b", "value", "require_range", "__commonJSMin", "exports", "purry_1", "range", "_range", "__name", "start", "end", "ret", "i", "require_randomString", "__commonJSMin", "exports", "range_1", "randomString", "length", "characterSet", "randomChar", "__name", "text", "require_rankBy", "__commonJSMin", "exports", "_purryOrderRules_1", "rankBy", "rankByImplementation", "__name", "data", "compareFn", "targetItem", "rank", "_i", "data_1", "item", "require_reduce", "__commonJSMin", "exports", "purry_1", "reduce", "_reduce", "__name", "indexed", "items", "fn", "initialValue", "acc", "item", "index", "require_reject", "__commonJSMin", "exports", "purry_1", "_reduceLazy_1", "_toLazyIndexed_1", "reject", "_reject", "__name", "indexed", "array", "fn", "_lazy", "value", "index", "valid", "require_reverse", "__commonJSMin", "exports", "purry_1", "reverse", "_reverse", "__name", "array", "require_round", "__commonJSMin", "exports", "_withPrecision_1", "purry_1", "round", "__name", "require_sample", "__commonJSMin", "exports", "purry_1", "sample", "args", "_i", "sampleImplementation", "__name", "data", "sampleSize", "actualSampleSize", "sampleIndices", "randomIndex", "a", "b", "index", "_", "require_set", "__commonJSMin", "exports", "__assign", "t", "s", "i", "p", "purry_1", "set", "_set", "__name", "obj", "prop", "value", "_a", "require_setPath", "__commonJSMin", "exports", "__assign", "t", "s", "i", "p", "purry_1", "setPath", "_setPath", "__name", "object", "path", "value", "_a", "item", "index", "require_shuffle", "__commonJSMin", "exports", "purry_1", "shuffle", "_shuffle", "__name", "items", "result", "index", "rand", "value", "require_sliceString", "__commonJSMin", "exports", "sliceString", "__name", "indexStart", "indexEnd", "data", "require_sort", "__commonJSMin", "exports", "__spreadArray", "to", "from", "pack", "i", "l", "ar", "purry_1", "sort", "_sort", "__name", "items", "cmp", "ret", "require_sortBy", "__commonJSMin", "exports", "__spreadArray", "to", "from", "pack", "i", "l", "ar", "_purryOrderRules_1", "sortBy", "_sortBy", "__name", "data", "compareFn", "require_binarySearchCutoffIndex", "__commonJSMin", "exports", "_binarySearchCutoffIndex", "array", "predicate", "lowIndex", "highIndex", "pivotIndex", "pivot", "__name", "require_sortedIndex", "__commonJSMin", "exports", "purry_1", "_binarySearchCutoffIndex_1", "sortedIndex", "sortedIndexImplementation", "__name", "array", "item", "pivot", "require_sortedIndexBy", "__commonJSMin", "exports", "purry_1", "_binarySearchCutoffIndex_1", "sortedIndexBy", "sortedIndexByImplementation", "__name", "indexed", "array", "item", "valueFunction", "value", "pivot", "index", "require_sortedIndexWith", "__commonJSMin", "exports", "purry_1", "_binarySearchCutoffIndex_1", "sortedIndexWith", "__name", "indexed", "require_sortedLastIndex", "__commonJSMin", "exports", "purry_1", "_binarySearchCutoffIndex_1", "sortedLastIndex", "sortedLastIndexImplementation", "__name", "array", "item", "pivot", "require_sortedLastIndexBy", "__commonJSMin", "exports", "purry_1", "_binarySearchCutoffIndex_1", "sortedLastIndexBy", "sortedLastIndexByImplementation", "__name", "indexed", "array", "item", "valueFunction", "value", "pivot", "index", "require_splice", "__commonJSMin", "exports", "__spreadArray", "to", "from", "pack", "i", "l", "ar", "purry_1", "splice", "_splice", "__name", "items", "start", "deleteCount", "replacement", "result", "require_splitAt", "__commonJSMin", "exports", "__spreadArray", "to", "from", "pack", "i", "l", "ar", "purry_1", "splitAt", "_splitAt", "__name", "array", "index", "copy", "tail", "require_splitWhen", "__commonJSMin", "exports", "splitAt_1", "purry_1", "splitWhen", "_splitWhen", "__name", "array", "fn", "i", "require_stringToPath", "__commonJSMin", "exports", "__spreadArray", "to", "from", "pack", "i", "l", "ar", "stringToPath", "path", "_stringToPath", "__name", "_a", "match", "key", "rest", "require_subtract", "__commonJSMin", "exports", "purry_1", "subtract", "_subtract", "__name", "value", "subtrahend", "require_sumBy", "__commonJSMin", "exports", "purry_1", "_sumBy", "__name", "indexed", "array", "fn", "sum", "item", "i", "summand", "sumBy", "require_swapIndices", "__commonJSMin", "exports", "purry_1", "swapIndices", "_swapIndices", "__name", "item", "index1", "index2", "_swapString", "_swapArray", "result", "positiveIndexA", "positiveIndexB", "require_swapProps", "__commonJSMin", "exports", "__assign", "t", "s", "i", "p", "purry_1", "swapProps", "_swapProps", "__name", "obj", "key1", "key2", "_a", "_b", "_c", "value1", "_d", "value2", "require_take", "__commonJSMin", "exports", "purry_1", "_reduceLazy_1", "take", "_take", "__name", "array", "n", "lazy", "value", "require_takeFirstBy", "__commonJSMin", "exports", "__spreadArray", "to", "from", "pack", "i", "l", "ar", "_heap_1", "_purryOrderRules_1", "takeFirstBy", "takeFirstByImplementation", "__name", "data", "compareFn", "n", "heap", "rest", "_i", "rest_1", "item", "require_takeLastWhile", "__commonJSMin", "exports", "purry_1", "takeLastWhile", "_takeLastWhile", "__name", "data", "predicate", "i", "require_takeWhile", "__commonJSMin", "exports", "purry_1", "takeWhile", "_takeWhile", "__name", "array", "fn", "ret", "_i", "array_1", "item", "require_tap", "__commonJSMin", "exports", "purry_1", "tap", "_tap", "__name", "value", "fn", "require_times", "__commonJSMin", "exports", "purry_1", "times", "_times", "__name", "count", "fn", "res", "i", "require_uniq", "__commonJSMin", "exports", "purry_1", "_reduceLazy_1", "uniq", "_uniq", "__name", "array", "lazy", "set", "value", "require_uniqBy", "__commonJSMin", "exports", "purry_1", "_reduceLazy_1", "uniqBy", "_uniqBy", "lazyUniqBy", "__name", "array", "transformer", "set", "value", "appliedItem", "require_uniqWith", "__commonJSMin", "exports", "purry_1", "_reduceLazy_1", "_toLazyIndexed_1", "uniqWith", "_uniqWith", "__name", "array", "isEquals", "lazy", "_lazy", "value", "index", "otherValue", "require_values", "__commonJSMin", "exports", "values", "source", "__name", "require_zip", "__commonJSMin", "exports", "purry_1", "zip", "_zip", "__name", "first", "second", "resultLength", "result", "i", "require_zipObj", "__commonJSMin", "exports", "purry_1", "zipObj", "_zipObj", "__name", "first", "second", "resultLength", "result", "i", "require_zipWith", "__commonJSMin", "exports", "zipWith", "args", "f", "s", "_zipWith", "__name", "first", "second", "fn", "resultLength", "result", "i", "require_commonjs", "__commonJSMin", "exports", "__createBinding", "o", "m", "k", "k2", "desc", "__exportStar", "p", "require_actor", "__commonJSMin", "exports", "isPlayedActor", "actor", "__name", "getHighestName", "getOwner", "isValidUser", "user", "owners", "a", "b", "isOwner", "require_application", "__commonJSMin", "exports", "openApplication", "constructor", "args", "id", "app", "__name", "refreshApplication", "canRender", "force", "renderApplication", "require_array", "__commonJSMin", "exports", "__createBinding", "o", "m", "k", "k2", "desc", "__setModuleDefault", "v", "__importStar", "mod", "result", "R", "arrayIncludesOne", "array", "other", "value", "__name", "compareArrays", "arr1", "arr2", "unique", "value1", "index", "value2", "getOnly", "collection", "condition", "isArray", "require_canvas", "__commonJSMin", "exports", "getDropTarget", "canvas", "data", "filter", "a", "b", "token", "maximumX", "maximumY", "__name", "require_chat", "__commonJSMin", "exports", "createChatLink", "docOrUuid", "label", "html", "isDocument", "link", "__name", "latestChatMessages", "nb", "fromMessage", "chat", "messages", "start", "m", "i", "message", "li", "refreshLatestMessages", "require_delay", "__commonJSMin", "exports", "createTimeout", "callback", "delay", "timeoutId", "cancel", "__name", "fn", "args", "require_dialog", "__commonJSMin", "exports", "_1", "waitDialog", "options", "yesIcon", "noIcon", "buttons", "content", "__name", "require_document", "__commonJSMin", "exports", "getSourceId", "doc", "__name", "includesSourceId", "list", "sourceId", "getSourceIdCondition", "item", "getSortBounds", "collection", "min", "max", "entry", "require_event_manager", "__commonJSMin", "exports", "withEventManager", "constructor", "_id", "_listeners", "event", "listener", "options", "id", "findFn", "x", "index", "args", "listeners", "once", "context", "__name", "require_flags", "__commonJSMin", "exports", "__createBinding", "o", "m", "k", "k2", "desc", "__setModuleDefault", "v", "__importStar", "mod", "result", "R", "_1", "getFlag", "doc", "path", "__name", "setFlag", "args", "value", "unsetFlag", "flagPath", "updateFlag", "updates", "pathed", "key", "updateSourceFlag", "getFlagProperty", "obj", "setFlagProperty", "getModuleFlag", "hasModuleFlag", "unsetMofuleFlag", "require_handlebars", "__commonJSMin", "exports", "_1", "templatePath", "path", "__name", "render", "args", "data", "require_hooks", "__commonJSMin", "exports", "registerUpstreamHook", "event", "listener", "id", "index", "x", "hooked", "__name", "createHook", "hook", "hookId", "enabled", "require_html", "__commonJSMin", "exports", "htmlElement", "el", "__name", "isCheckboxElement", "createHTMLFromString", "content", "wrap", "tmp", "children", "applyHtmlMethod", "fn", "context", "fnc", "insertHTMLFromString", "parent", "prepend", "html", "appendHTMLFromString", "prependHTMLFromString", "beforeHTMLFromString", "element", "afterHTMLFromString", "addListener", "selector", "arg1", "arg2", "arg3", "event", "listener", "useCapture", "e", "addListenerAll", "elements", "querySelector", "querySelectorArray", "queryInClosest", "parentSelector", "childSelector", "closest", "queryInParent", "parentElement", "elementData", "dataToDatasetString", "data", "key", "value", "stringified", "require_item", "__commonJSMin", "exports", "_1", "getItems", "actor", "itemTypes", "types", "type", "__name", "hasItemWithSourceId", "sourceId", "getItemWithSourceId", "require_localize", "__commonJSMin", "exports", "_1", "localize", "args", "data", "path", "__name", "localizeIfExist", "hasLocalization", "localizePath", "templateLocalize", "subKey", "fn", "key", "hash", "joinedKey", "subLocalize", "str", "arg1", "arg2", "localeCompare", "a", "b", "require_module", "__commonJSMin", "exports", "_1", "MODULE_ID", "MODULE_NAME", "MODULE", "str", "error", "message", "path", "id", "name", "getActiveModule", "module", "__name", "require_keybindings", "__commonJSMin", "exports", "localize_1", "module_1", "registerKeybind", "name", "data", "__name", "require_libwrapper", "__commonJSMin", "exports", "_1", "registerWrapper", "path", "fn", "type", "ids", "paths", "key", "id", "__name", "unregisterWrapper", "createWrapper", "callback", "options", "wrapperId", "enabled", "require_notifications", "__commonJSMin", "exports", "_1", "notify", "str", "arg1", "arg2", "arg3", "type", "data", "permanent", "__name", "warn", "info", "error", "require_object", "__commonJSMin", "exports", "module_1", "AsyncFunction", "isInstanceOf", "obj", "name", "cursor", "__name", "getInMemory", "path", "setInMemory", "args", "value", "getInMemoryAndSetIfNot", "current", "result", "deleteInMemory", "split", "x", "last", "key", "require_settings", "__commonJSMin", "exports", "__createBinding", "o", "m", "k", "k2", "desc", "__setModuleDefault", "v", "__importStar", "mod", "result", "R", "_1", "registerSetting", "options", "choice", "settingPath", "__name", "registerSettingMenu", "path", "getSetting", "key", "setSetting", "value", "isClientSetting", "setting", "isWorldSetting", "isMenuSetting", "require_socket", "__commonJSMin", "exports", "module_1", "socketOn", "callback", "__name", "socketOff", "socketEmit", "packet", "require_string", "__commonJSMin", "exports", "__createBinding", "o", "m", "k", "k2", "desc", "__setModuleDefault", "v", "__importStar", "mod", "result", "R", "joinStr", "separator", "path", "x", "__name", "safeSplit", "str", "selector", "s", "beautity", "_", "c", "stringBoolean", "b", "stringNumber", "n", "require_user", "__commonJSMin", "exports", "getCurrentUser", "x", "__name", "isActiveGM", "userIsGM", "user", "hasGMOnline", "require_dist", "__commonJSMin", "exports", "__createBinding", "o", "m", "k", "k2", "desc", "__exportStar", "p", "isOfType", "variable", "types", "type", "__name", "foundry_api_exports", "__export", "R", "init_foundry_api", "__esmMin", "__reExport", "require_utils", "__commonJSMin", "exports", "foundry_api_1", "ErrorPF2e", "message", "__name", "objectHasKey", "obj", "key", "tupleHasValue", "array", "value", "setHasElement", "set", "ordinalString", "pluralRules", "suffix", "htmlClosest", "child", "selectors", "htmlQuery", "parent", "localizer", "prefix", "formatArgs", "traitSlugToObject", "trait", "dictionary", "traitObject", "actionGlyphMap", "getActionGlyph", "action", "sanitized", "extractNotes", "rollNotes", "s", "createHTMLElement", "nodeName", "classes", "dataset", "children", "innerHTML", "element", "v", "childElement", "require_actor", "__commonJSMin", "exports", "foundry_api_1", "utils_1", "transferItemToActor", "targetActor", "item", "quantity", "containerId", "newStack", "container", "newQuantity", "newItemData", "__name", "resetActors", "actors", "options", "s", "t", "actor", "scenes", "scene", "token", "require_application", "__commonJSMin", "exports", "foundry_api_1", "renderApplication", "type", "types", "apps", "app", "x", "__name", "renderActorSheets", "renderCharacterSheets", "renderItemSheets", "require_browser", "__commonJSMin", "exports", "getTabFilterData", "tabName", "tab", "__name", "filterTraits", "traits", "selected", "condition", "selectedTraits", "notTraits", "t", "require_rules", "__commonJSMin", "exports", "extractEphemeralEffects", "affects", "origin", "target", "item", "domains", "options", "effectsFrom", "effectsTo", "fullOptions", "resolvables", "s", "e", "__name", "require_chat", "__commonJSMin", "exports", "foundry_api_1", "utils_1", "rules_1", "createTradeContent", "message", "img", "__name", "createTradeMessage", "subtitle", "actor", "item", "senderId", "content", "createManipulationMessage", "createManipulateFlavor", "applyDamageFromMessage", "multiplier", "addend", "promptModifier", "rollIndex", "tokens", "onDamageApplied", "shiftAdjustDamage", "html", "shieldBlockRequest", "roll", "damage", "messageRollOptions", "originRollOptions", "o", "messageItem", "effectRollOptions", "token", "domain", "ephemeralEffects", "contextClone", "rollOptions", "toggleOffShieldBlock", "AdjustmentDialog", "$html", "isHealing", "$dialog", "adjustment", "messageId", "app", "selector", "button", "onClickShieldBlock", "shieldButton", "messageEl", "getTokens", "getNonBrokenShields", "t", "s", "nonBrokenShields", "hasMultipleShields", "shieldActivated", "instance", "_helper", "contentEl", "multipleShields", "listEl", "shieldList", "shield", "input", "shieldName", "hardness", "hardnessLabel", "itemLi", "selfApplyEffectFromMessage", "target", "effect", "traits", "effectSource", "parsedMessageContent", "container", "buttons", "span", "anchor", "statement", "require_classes", "__commonJSMin", "exports", "getStatisticClass", "statistic", "__name", "getSpellCollectionClass", "actor", "getSpellClass", "getDamageRollClass", "Roll", "require_data", "__commonJSMin", "exports", "saveTypes", "require_effect", "__commonJSMin", "exports", "DURATION_UNITS", "calculateRemainingDuration", "effect", "durationData", "fightyActor", "isExpired", "start", "combatant", "unit", "expiry", "duration", "addend", "remaining", "result", "startInitiative", "currentInitiative", "atTurnStart", "__name", "require_item", "__commonJSMin", "exports", "foundry_api_1", "classes_1", "utils_1", "HANDWRAPS_SLUG", "BANDS_OF_FORCE_SLUGS", "getAnnotationLabel", "annotation", "hands", "fullAnnotation", "__name", "getCarryTypeActionData", "item", "action", "container", "usage", "changeCarryType", "actor", "handsHeld", "actionCost", "carryType", "templates", "sluggify", "actionKey", "annotationKey", "fullAnnotationKey", "flavorAction", "traits", "message", "flavor", "content", "token", "hasFreePropertySlot", "potency", "getEquippedHandwraps", "weapon", "category", "slug", "equipped", "identification", "invested", "inSlot", "calculateItemPrice", "quantity", "ratio", "coins", "consumeItem", "event", "uses", "multiUse", "key", "flags", "speaker", "template", "contentHTML", "DamageRoll", "formula", "type", "kind", "quantityRemaining", "isPreservedAmmo", "MoveLootPopup", "object", "options", "callback", "prompt", "buttonLabel", "_event", "formData", "require_notes", "__commonJSMin", "exports", "utils_1", "RollNotePF2e", "_RollNotePF2e", "__name", "params", "notes", "n", "element", "strong", "require_spell", "__commonJSMin", "exports", "foundry_api_1", "_1", "EFFECT_AREA_SHAPES", "MAGIC_TRADITIONS", "getStatisticData", "statistic", "data", "modifier", "__name", "createStatisticFromRawData", "actor", "Statistic", "statisticData", "upgradeStatisticRank", "rank", "createCounteractStatistic", "ability", "baseModifier", "m", "getHighestSyntheticStatistic", "withClassDcs", "synthetics", "statistics", "classStatistic", "groupedStatistics", "highestMod", "getHighestSpellcastingStatistic", "entries", "classAttribute", "groupedEntries", "entry", "x", "highestResults", "getActorMaxRank", "getRankLabel", "coerceToSpellGroupId", "value", "numericValue", "spellSlotGroupIdToNumber", "groupId", "warnInvalidDrop", "warning", "spell", "localize", "spellRank", "targetRank", "locKey", "type", "getSummarizedSpellsDataForRender", "sortByType", "spells", "focusPool", "pf2eDailies", "labels", "hasFocusCantrip", "entryId", "entryDc", "entryTooltip", "isFocus", "isRitual", "isCharges", "isStaff", "isInnate", "isPrepared", "isSpontaneous", "isFlexible", "consumable", "group", "groupNumber", "slotSpells", "isCantrip", "isBroken", "groupUses", "slotId", "active", "spellId", "uses", "sort", "a", "b", "i", "require_spell_consumables", "__commonJSMin", "exports", "foundry_api_1", "_1", "CANTRIP_DECK_ID", "scrollCompendiumIds", "wandCompendiumIds", "SPELL_CONSUMABLE_NAME_TEMPLATES", "getIdForSpellConsumable", "type", "heightenedLevel", "__name", "getNameForSpellConsumable", "spellName", "templateId", "createConsumableFromSpell", "spell", "mystified", "temp", "itemName", "itemImg", "pack", "p", "itemId", "consumable", "consumableSource", "traits", "t", "description", "paragraphElement", "containerElement", "hrElement", "require_skills", "__commonJSMin", "exports", "SKILL_ABBREVIATIONS", "SKILL_DICTIONARY", "SKILL_EXPANDED", "ATTRIBUTE_ABBREVIATIONS", "SKILL_LONG_FORMS", "TRANSLATED_SKILL", "getTranslatedSkills", "key", "value", "__name", "require_template", "__commonJSMin", "exports", "getTemplateTokens", "measuredTemplate", "collisionOrigin", "collisionType", "grid", "dimensions", "template", "gridHighlight", "origin", "tokens", "gridSize", "containedTokens", "token", "tokenDoc", "tokenPositions", "tokenX", "y", "w", "position", "gx", "gy", "s", "destination", "__name", "require_dist", "__commonJSMin", "exports", "__createBinding", "o", "m", "k", "k2", "desc", "__exportStar", "p", "pf2e_api_exports", "__export", "R", "init_foundry_api", "__reExport", "foundry_api_exports", "createDaily", "config", "__name", "filterIsOfType", "filter", "type", "rowIsOfType", "row", "types", "utils", "item", "option", "rule", "resistance", "localize", "label", "configToOptions", "value", "language", "skill", "x", "rank", "actor", "categories", "traits", "R", "feat", "category", "trait", "tradition", "entry", "party", "a", "rune", "potency", "damage", "group", "material", "uuid", "source", "options", "createSpellConsumableSource", "mode", "predicate", "name", "type", "simplifyRuleValue", "itemOrUuid", "roll", "result", "identifier", "sort", "attribute", "proficiencySlug", "showSlotlessRanks", "proficiencyRank", "flags", "capitalize", "__name", "level", "itemName", "itemImg", "spell", "ancestralUUID", "expertUUID", "ancestralLongevity", "actor", "items", "skillList", "utils", "actorSkills", "value", "rows", "messages", "addItem", "addRule", "removeRule", "data", "slug", "rank", "uuid", "row", "item", "selected", "source", "skill", "bladeUUID", "bladeAlly", "actor", "items", "weapons", "weapon", "isHoly", "isUnholy", "runes", "R", "rune", "utils", "rows", "messages", "addRule", "weaponId", "itemPredicate", "label", "ICON", "featUUID", "ceremonialKnife", "actor", "weapon", "items", "rank", "custom", "rows", "messages", "addItem", "uuid", "label", "utils", "source", "combatUUID", "improvedUUID", "combatFlexibility", "actor", "items", "rows", "messages", "addFeat", "source", "utils", "experimentalSpellshaping", "actor", "items", "rows", "messages", "addFeat", "uuid", "source", "utils", "getPack", "__name", "getFamiliarAbilityCount", "actor", "max", "flag", "newValue", "familiar", "nbAbilities", "pack", "uniqueId", "options", "_id", "name", "customUUIDS", "uuid", "item", "a", "b", "R", "i", "rows", "messages", "abilities", "messageList", "value", "source", "message", "ids", "isTemporary", "createLanguageDaily", "key", "uuid", "actor", "items", "languageList", "utils", "actorLanguages", "value", "rows", "messages", "addRule", "language", "source", "__name", "mindUUID", "mentalUUID", "metallicUUID", "runicUUID", "advancedUUID", "weaponSlug", "weaponBases", "weaponDamages", "mentalForgeTraits", "metallicMaterials", "runicRunes", "advancedRunes", "createMindWeapon", "actor", "weaponLocalize", "weaponRows", "die", "traits", "usage", "i", "checked", "label", "utils", "flavor", "potencyRunes", "R", "runeSelect", "selection", "$html", "html", "input", "select", "source", "__name", "damageLabel", "damage", "mindSmith", "items", "weapon", "selectThat", "that", "arrayToOptions", "truthy", "arr", "labelizer", "value", "mentalUniqueId", "mentalOptions", "canHaveRune", "rows", "messages", "updateItem", "addRule", "itemPredicate", "trait", "material", "rune", "rationsUUID", "rations", "actor", "items", "value", "max", "remaining", "last", "rows", "messages", "updateItem", "deleteItem", "quantity", "name", "utils", "message", "createResistanceDaily", "key", "uuid", "resistances", "resistance", "isRandom", "actor", "items", "options", "value", "utils", "rows", "messages", "addRule", "source", "__name", "featUUID", "effectUUID", "rootMagic", "actor", "items", "utils", "a", "rows", "messages", "adeptUUID", "scrollAdept", "actor", "items", "maxRank", "utils", "proficiency", "R", "r", "rank", "custom", "row", "rows", "messages", "addItem", "data", "uuid", "label", "source", "createScrollChainDaily", "key", "uuids", "actor", "items", "level", "ranks", "rank", "utils", "rows", "messages", "addItem", "R", "uuid", "label", "source", "__name", "createComboSkillDaily", "key", "uuid", "rank", "removeRules", "actor", "items", "skillList", "utils", "actorSkills", "options", "value", "rows", "messages", "addItem", "addRule", "removeRule", "selected", "source", "skill", "__name", "createLoreSkillDaily", "KINETIC_ACTIVATION", "STAFF_NEXUS", "UUID_REGEX", "LABEL_REGEX", "isStaff", "item", "trait", "traits", "__name", "getStaves", "actor", "hasStaves", "staves", "entries", "maxCharges", "actorCharges", "utils", "activationType", "R", "entry", "preparedEntries", "entryId", "isFlexible", "rank", "slotKey", "data", "index", "id", "expended", "spell", "a", "b", "items", "custom", "staffRow", "staff", "level", "hasStaffNexus", "options", "flexibleLabel", "emptyLabel", "nbExpends", "slot", "rankLabel", "uniqueKey", "option", "name", "uniqueId", "rows", "i", "messages", "updateItem", "setExtraFlags", "spellList", "spellRanksList", "staffSpellData", "SpellRankEL", "label", "match", "uuid", "staffSpells", "overcharge", "spellcasting", "expendedSpells", "slotsUpdates", "expendedRows", "preparedPath", "preparedData", "currentValue", "prepared", "preparedSlot", "staffData", "statistic", "StaffSpellcasting", "tradition", "castPredicate", "e", "rollOptions", "castRank", "canCast", "canCastRank", "staffFlags", "getStaffFlags", "charges", "mustUseSpontaneous", "useSpontaneous", "minRank", "maxRank", "range", "r", "key", "localize", "multiEntries", "hint", "callback", "html", "el", "spontaneousValue", "setStaffChargesValue", "spells", "maxCantripRank", "groups", "x", "tomeUUID", "itemCondition", "actor", "item", "selected", "utils", "__name", "thaumaturgeTome", "items", "actorLevel", "actorSkills", "skillList", "custom", "setCustom", "firstRank", "secondRank", "options", "value", "rows", "messages", "addItem", "addRule", "slug", "rank", "source", "skill", "tricksterAce", "actor", "items", "item", "rows", "messages", "addItem", "identifier", "uuid", "statistic", "spellSource", "utils", "entrySource", "DAILY_SCHEMA", "BUILTINS_DAILIES", "rations", "familiar", "staves", "experimentalSpellshaping", "ancestralLongevity", "combatFlexibility", "scrollAdept", "rootMagic", "ceremonialKnife", "tricksterAce", "thaumaturgeTome", "bladeAlly", "mindSmith", "createLoreSkillDaily", "createComboSkillDaily", "createLanguageDaily", "createResistanceDaily", "createScrollChainDaily", "BUILTINS_UUIDS", "BUILTINS_ALWAYS", "UUIDS", "ALWAYS", "prepareDailies", "dailies", "prefix", "uuids", "always", "original", "originalKey", "keyWithPrefix", "daily", "x", "i", "uuid", "condition", "err", "__name", "parseCustomDaily", "custom", "utils", "createDaily", "parseDailies", "customDailies", "customs", "initDailies", "getDailies", "actor", "dailies", "getDaily", "__name", "daily", "precondition", "condition", "item", "tmpDaily", "index", "itemSlug", "err", "ALWAYS", "sourceId", "entry", "UUIDS", "filterDailies", "R", "_actor", "_dailies", "_onFamiliarRangeChange", "onFamiliarRangeChange_fn", "_onFamiliarRangeInput", "onFamiliarRangeInput_fn", "_onDailyEnabledChange", "onDailyEnabledChange_fn", "DailyConfig", "actor", "dailies", "options", "__privateAdd", "__privateSet", "__privateGet", "disabled", "getDisabledDailies", "getFamiliarAbilityCount", "daily", "$html", "html", "__privateMethod", "__name", "event", "el", "valueInput", "dailyKey", "__decorateClass", "ACTOR_DAILY_SCHEMA", "TEMPLATE_ORDER", "rowElementIsOFType", "el", "types", "type", "__name", "MIGRATIONS", "actor", "hasStaves", "migration", "reset", "messages", "schema", "getActorFlag", "migrationMessages", "messageList", "R", "formated", "x", "DailyInterface", "#actor", "#dailies", "#dailiesArray", "#settingsApp", "#randomInterval", "#featUuids", "#dropFilters", "dailies", "options", "filterDailies", "selector", "event", "localize", "target", "data", "item", "compendium", "#compendiumFilterFromElement", "#dropDataWarning", "dailyRow", "#getDailyRow", "result", "isFeat", "#validateFeat", "#validateSpell", "exists", "feat", "buttons", "id", "DailyConfig", "hasAlert", "templates", "disabled", "getDisabledDailies", "daily", "items", "custom", "rows", "dailyTemplate", "row", "rowLabel", "rowTemplate", "isSavedRow", "getSavedFlag", "rowData", "rowIsOfType", "openedGroups", "option", "_", "input", "selected", "isInput", "name", "uuid", "groups", "template", "a", "b", "hasDailies", "$html", "html", "#onAccept", "#onResolveAlert", "#onClearField", "#onOpenBrowser", "#onComboInputChange", "#onComboSelectChange", "#onUniqueChange", "#onInputChange", "processedUniques", "uniqueSelects", "selectEl", "unique", "dailykey", "uniqueTag", "randomElements", "randomElement", "dropFeatInputs", "dropFeatInput", "uniqueOptions", "selectElements", "index", "selectOptions", "maxIndex", "optionUniqueValue", "optionExists", "value", "finalValue", "i", "inputEl", "btnEl", "labelElements", "labelEl", "emptyRows", "#lock", "#processDailies", "rowElements", "flags", "extraFlags", "rowElement", "utils", "deletedItems", "addedItems", "itemsRules", "updatedItems", "updateItem", "createUpdateCollection", "rawMessages", "addedItemIds", "messageGroups", "getRules", "existing", "rules", "group", "message", "label", "order", "source", "parent", "parentId", "signature", "rule", "err", "hasOrphanSpells", "entryIdentifier", "highestEntry", "highestSynthetic", "tradition", "statistic", "path", "identifier", "spells", "spell", "rank", "update", "chatGroups", "messageOptions", "preface", "chatContent", "#unlock", "need", "has", "localizedType", "formattedNeed", "localizedHas", "localizedRequire", "#validateDefault", "filter", "multiselects", "checkboxes", "tab", "itemTraits", "t", "rarities", "sources", "system", "pubSource", "sourceSlug", "sliders", "level", "categories", "filterSkills", "prerequisitesArr", "prerequisite", "translatedSkills", "skillList", "skills", "prereq", "key", "itemSkills", "missingSkills", "selects", "itemRank", "filterRanks", "filterCategories", "isCantrip", "isFocusSpell", "isRitual", "isSpell", "sortedFilterCategories", "sortedItemCategories", "filterTraditions", "itemTraditions", "init", "filterKey", "#convertToCompendiumFilter", "dropFilter", "compendiumTab", "compendiumFilter", "filterIsOfType", "simplifyValue", "isSimplifiableValue", "checkboxEntry", "checkboxName", "filterCheckbox", "searchCheckbox", "filterCheckboxOption", "multiselectEntry", "multiselectName", "filterMultiselect", "searchMultiselect", "multiselect", "select", "selection", "sliderEntry", "sliderName", "filterSlider", "searchSlider", "isValidActor", "actor", "__name", "canPrepareDailies", "getActorFlag", "openDailiesInterface", "id", "dailies", "getDailies", "DailyInterface", "getDisabledDailies", "flag", "simplifyValue", "value", "numbered", "isSimplifiableValue", "createUpdateCollection", "collection", "data", "update", "key", "isTemporary", "item", "getStaffFlags", "setStaffChargesValue", "charges", "canCastRank", "rank", "staffFlags", "maxRank", "range", "R", "entries", "entry", "e", "r", "d", "performDailyCrafting", "entries", "e", "reagentCost", "sum", "entry", "reagentValue", "key", "formula", "itemSource", "__name", "renderChargesEntries", "actor", "parentElement", "callback", "chargesEntries", "entryContainer", "charges", "chargesElement", "createChargesElement", "event", "el", "value", "toggleStr", "toggleElement", "onRenderNPCSheetPF2e", "sheet", "$html", "html", "spellsTab", "container", "toggle", "onRenderCharacterSheetPF2e", "contentElement", "highlightItems", "canPrep", "canPrepareDailies", "tooltip", "disabledClass", "targetEl", "openDailiesInterface", "staffData", "getStaffFlags", "staff", "staffId", "staffContainer", "rowControls", "handles", "controls", "handle", "isEquipped", "annotation", "action", "setStaffChargesValue", "addedItems", "getActorFlag", "id", "itemElements", "itemElement", "withMax", "isOwner", "chargesTemplate", "onRenderFamiliarSheetPF2e", "itemId", "item", "isTemporary", "onCharacterSheetGetData", "wrapped", "options", "data", "collectionId", "knownCollections", "collectionIndex", "group", "collectionGroup", "error", "onCharacterPrepareData", "staffFlags", "staffStatistic", "statistic", "staffEntry", "StaffSpellcasting", "s", "StaffSpell", "create", "rollMode", "message", "messageSource", "flags", "SpellCollection", "collection", "spellSource", "source", "spell", "localize", "tabKey", "keymap", "generateDefaultCode", "key", "__name", "CustomDailies", "#selected", "options", "selected", "dailies", "daily", "schema", "DAILY_SCHEMA", "$html", "html", "#onEditorKeyup", "#onCreateDaily", "#onSaveDaily", "#onUnlockDaily", "#onSelectDaily", "#onDeleteDaily", "event", "formData", "code", "parseCustomDaily", "dailyIndex", "custom", "readonlyEl", "editor", "pos", "el", "index", "restForTheNight", "wrapped", "options", "result", "characters", "actor", "cleanup", "error", "__name", "removedItems", "updatedItems", "updateItem", "createUpdateCollection", "dailies", "filterDailies", "getDailies", "daily", "id", "item", "isTemporary", "parentId", "slug", "rules", "modifiedRules", "i", "spellcastingEntryPrepareSiblingData", "wrapped", "actor", "SpellCollection", "ChargesSpellCollection", "__name", "spell", "options", "groupId", "heightenedRank", "heightenedUpdate", "source", "created", "spellData", "charges", "group", "active", "spells", "error", "spellcastingEntryConsume", "rank", "slotIndex", "spellcastingEntryGetSheetData", "data", "parseDailies", "CustomDailies", "onCharacterPrepareData", "canCastRank", "setStaffChargesValue", "openDailiesInterface", "spellcastingEntryPrepareSiblingData", "spellcastingEntryConsume", "spellcastingEntryGetSheetData", "initDailies", "restForTheNight", "performDailyCrafting", "onCharacterSheetGetData", "custom", "DAILY_SCHEMA", "onRenderCharacterSheetPF2e", "onRenderFamiliarSheetPF2e", "onRenderNPCSheetPF2e"]
}
