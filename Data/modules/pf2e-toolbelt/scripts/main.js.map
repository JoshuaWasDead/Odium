{
  "version": 3,
  "sources": ["../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/purry.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/add.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/addProp.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/allPass.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/anyPass.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/_withPrecision.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/ceil.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/chunk.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/clamp.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/type.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/clone.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/isTruthy.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/compact.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/concat.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/_purryOn.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/conditional.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/countBy.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/pipe.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/createPipe.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/debounce.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/_reduceLazy.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/difference.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/differenceWith.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/divide.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/drop.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/_swapInPlace.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/_heap.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/_purryOrderRules.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/dropFirstBy.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/dropLast.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/dropLastWhile.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/dropWhile.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/equals.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/toPairs.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/evolve.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/_toLazyIndexed.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/filter.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/_toSingle.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/find.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/findIndex.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/findLast.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/findLastIndex.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/first.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/hasAtLeast.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/firstBy.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/flatten.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/flatMap.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/flatMapToObj.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/flattenDeep.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/floor.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/forEach.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/forEachObj.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/fromPairs.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/groupBy.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/identity.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/indexBy.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/intersection.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/intersectionWith.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/invert.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/isArray.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/isBoolean.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/isDate.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/isDefined.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/isObject.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/isString.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/isEmpty.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/isError.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/isFunction.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/isNil.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/isNonNull.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/isNot.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/isNumber.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/isObjectType.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/isPlainObject.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/isPromise.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/isSymbol.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/join.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/keys.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/last.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/length.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/map.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/mapKeys.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/mapToObj.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/mapValues.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/maxBy.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/meanBy.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/merge.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/mergeAll.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/mergeDeep.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/minBy.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/multiply.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/noop.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/_quickSelect.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/nthBy.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/objOf.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/omit.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/omitBy.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/once.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/only.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/partition.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/pathOr.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/pick.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/pickBy.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/prop.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/range.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/randomString.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/rankBy.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/reduce.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/reject.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/reverse.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/round.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/sample.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/set.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/setPath.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/shuffle.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/sliceString.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/sort.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/sortBy.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/_binarySearchCutoffIndex.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/sortedIndex.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/sortedIndexBy.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/sortedIndexWith.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/sortedLastIndex.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/sortedLastIndexBy.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/splice.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/splitAt.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/splitWhen.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/stringToPath.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/subtract.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/sumBy.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/swapIndices.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/swapProps.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/take.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/takeFirstBy.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/takeLastWhile.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/takeWhile.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/tap.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/times.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/uniq.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/uniqBy.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/uniqWith.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/values.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/zip.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/zipObj.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/zipWith.js", "../../../../../dev/foundry-api/node_modules/remeda/dist/commonjs/index.js", "../../../../../dev/foundry-api/dist/actor.js", "../../../../../dev/foundry-api/dist/application.js", "../../../../../dev/foundry-api/dist/array.js", "../../../../../dev/foundry-api/dist/canvas.js", "../../../../../dev/foundry-api/dist/chat.js", "../../../../../dev/foundry-api/dist/delay.js", "../../../../../dev/foundry-api/dist/dialog.js", "../../../../../dev/foundry-api/dist/document.js", "../../../../../dev/foundry-api/dist/event-manager.js", "../../../../../dev/foundry-api/dist/flags.js", "../../../../../dev/foundry-api/dist/handlebars.js", "../../../../../dev/foundry-api/dist/hooks.js", "../../../../../dev/foundry-api/dist/html.js", "../../../../../dev/foundry-api/dist/item.js", "../../../../../dev/foundry-api/dist/localize.js", "../../../../../dev/foundry-api/dist/module.js", "../../../../../dev/foundry-api/dist/keybindings.js", "../../../../../dev/foundry-api/dist/libwrapper.js", "../../../../../dev/foundry-api/dist/notifications.js", "../../../../../dev/foundry-api/dist/object.js", "../../../../../dev/foundry-api/dist/settings.js", "../../../../../dev/foundry-api/dist/socket.js", "../../../../../dev/foundry-api/dist/string.js", "../../../../../dev/foundry-api/dist/user.js", "../../../../../dev/foundry-api/dist/index.js", "../../../../../dev/foundry-api/index.js", "../../../../../dev/pf2e-api/dist/utils.js", "../../../../../dev/pf2e-api/dist/actor.js", "../../../../../dev/pf2e-api/dist/application.js", "../../../../../dev/pf2e-api/dist/browser.js", "../../../../../dev/pf2e-api/dist/rules.js", "../../../../../dev/pf2e-api/dist/chat.js", "../../../../../dev/pf2e-api/dist/classes.js", "../../../../../dev/pf2e-api/dist/data.js", "../../../../../dev/pf2e-api/dist/effect.js", "../../../../../dev/pf2e-api/dist/item.js", "../../../../../dev/pf2e-api/dist/notes.js", "../../../../../dev/pf2e-api/dist/spell.js", "../../../../../dev/pf2e-api/dist/spell-consumables.js", "../../../../../dev/pf2e-api/dist/skills.js", "../../../../../dev/pf2e-api/dist/template.js", "../../../../../dev/pf2e-api/dist/index.js", "../../../../../dev/pf2e-api/index.js", "../src/settings.ts", "../src/tools/shared/sharedWrapper.ts", "../src/tools/shared/characterSheet.ts", "../src/tools/shared/prepareDocument.ts", "../src/tools/shared/textEditor.ts", "../src/tools/shared/chatMessage.ts", "../src/tool.ts", "../src/tools/arp.ts", "../src/tools/debug.ts", "../src/tools/effectsPanel.ts", "../src/tools/giveth.ts", "../src/tools/heroActions.ts", "../src/tools/noBulk.ts", "../src/tools/unided.ts", "../src/tools/untarget.ts", "../src/tools/templateHelper.ts", "../src/tools/spellsSummary.ts", "../src/tools/stances.ts", "../src/tools/share.ts", "../../../../../dev/pf2e-api/src/success.ts", "../src/tools/targetHelper.ts", "../src/tools/mergeDamage.ts", "../src/tools/hideDamage.ts", "../src/tools/actionable.ts", "../src/tools/useButton.ts", "../src/tools/betterMerchant.ts", "../src/main.ts"],
  "sourcesContent": ["\"use strict\";\nvar __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n        if (ar || !(i in from)) {\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n            ar[i] = from[i];\n        }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.purry = void 0;\nfunction purry(fn, args, lazy) {\n    var diff = fn.length - args.length;\n    var arrayArgs = Array.from(args);\n    if (diff === 0) {\n        return fn.apply(void 0, arrayArgs);\n    }\n    if (diff === 1) {\n        var ret = function (data) { return fn.apply(void 0, __spreadArray([data], arrayArgs, false)); };\n        if (lazy || fn.lazy) {\n            ret.lazy = lazy || fn.lazy;\n            ret.lazyArgs = args;\n        }\n        return ret;\n    }\n    throw new Error('Wrong number of arguments');\n}\nexports.purry = purry;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.add = void 0;\nvar purry_1 = require(\"./purry\");\nfunction add() {\n    return (0, purry_1.purry)(_add, arguments);\n}\nexports.add = add;\nfunction _add(value, addend) {\n    return value + addend;\n}\n", "\"use strict\";\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.addProp = void 0;\nvar purry_1 = require(\"./purry\");\nfunction addProp() {\n    return (0, purry_1.purry)(_addProp, arguments);\n}\nexports.addProp = addProp;\nfunction _addProp(obj, prop, value) {\n    var _a;\n    return __assign(__assign({}, obj), (_a = {}, _a[prop] = value, _a));\n}\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.allPass = void 0;\nvar purry_1 = require(\"./purry\");\nfunction allPass() {\n    return (0, purry_1.purry)(_allPass, arguments);\n}\nexports.allPass = allPass;\nfunction _allPass(data, fns) {\n    return fns.every(function (fn) { return fn(data); });\n}\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.anyPass = void 0;\nvar purry_1 = require(\"./purry\");\nfunction anyPass() {\n    return (0, purry_1.purry)(_anyPass, arguments);\n}\nexports.anyPass = anyPass;\nfunction _anyPass(data, fns) {\n    return fns.some(function (fn) { return fn(data); });\n}\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports._withPrecision = void 0;\nvar MAX_PRECISION = 15;\nfunction _withPrecision(roundingFn) {\n    return function (value, precision) {\n        if (precision === 0) {\n            return roundingFn(value);\n        }\n        if (!Number.isInteger(precision)) {\n            throw new TypeError(\"precision must be an integer: \".concat(precision));\n        }\n        if (precision > MAX_PRECISION || precision < -MAX_PRECISION) {\n            throw new RangeError(\"precision must be between -15 and 15\");\n        }\n        if (Number.isNaN(value) || !Number.isFinite(value)) {\n            return roundingFn(value);\n        }\n        var multiplier = Math.pow(10, precision);\n        return roundingFn(value * multiplier) / multiplier;\n    };\n}\nexports._withPrecision = _withPrecision;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.ceil = void 0;\nvar _withPrecision_1 = require(\"./_withPrecision\");\nvar purry_1 = require(\"./purry\");\nfunction ceil() {\n    return (0, purry_1.purry)((0, _withPrecision_1._withPrecision)(Math.ceil), arguments);\n}\nexports.ceil = ceil;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.chunk = void 0;\nvar purry_1 = require(\"./purry\");\nfunction chunk() {\n    return (0, purry_1.purry)(_chunk, arguments);\n}\nexports.chunk = chunk;\nfunction _chunk(array, size) {\n    var ret = Array.from({\n        length: Math.ceil(array.length / size),\n    });\n    for (var index = 0; index < ret.length; index += 1) {\n        ret[index] = array.slice(index * size, (index + 1) * size);\n    }\n    return ret;\n}\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.clamp = void 0;\nvar purry_1 = require(\"./purry\");\nfunction clamp() {\n    return (0, purry_1.purry)(_clamp, arguments);\n}\nexports.clamp = clamp;\nfunction _clamp(value, limits) {\n    if (limits.min != null) {\n        if (limits.min > value) {\n            return limits.min;\n        }\n    }\n    if (limits.max != null) {\n        if (limits.max < value) {\n            return limits.max;\n        }\n    }\n    return value;\n}\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.type = void 0;\nfunction type(val) {\n    return val === null\n        ? 'Null'\n        : val === undefined\n            ? 'Undefined'\n            : Object.prototype.toString.call(val).slice(8, -1);\n}\nexports.type = type;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.clone = void 0;\nvar type_1 = require(\"./type\");\nfunction _cloneRegExp(pattern) {\n    return new RegExp(pattern.source, (pattern.global ? 'g' : '') +\n        (pattern.ignoreCase ? 'i' : '') +\n        (pattern.multiline ? 'm' : '') +\n        (pattern.sticky ? 'y' : '') +\n        (pattern.unicode ? 'u' : ''));\n}\nfunction _clone(value, refFrom, refTo, deep) {\n    function copy(copiedValue) {\n        var len = refFrom.length;\n        var idx = 0;\n        while (idx < len) {\n            if (value === refFrom[idx]) {\n                return refTo[idx];\n            }\n            idx += 1;\n        }\n        refFrom[idx + 1] = value;\n        refTo[idx + 1] = copiedValue;\n        for (var key in value) {\n            copiedValue[key] = deep\n                ? _clone(value[key], refFrom, refTo, true)\n                : value[key];\n        }\n        return copiedValue;\n    }\n    switch ((0, type_1.type)(value)) {\n        case 'Object':\n            return copy({});\n        case 'Array':\n            return copy([]);\n        case 'Date':\n            return new Date(value.valueOf());\n        case 'RegExp':\n            return _cloneRegExp(value);\n        default:\n            return value;\n    }\n}\nfunction clone(value) {\n    return value != null && typeof value.clone === 'function'\n        ? value.clone()\n        : _clone(value, [], [], true);\n}\nexports.clone = clone;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.isTruthy = void 0;\nfunction isTruthy(data) {\n    return !!data;\n}\nexports.isTruthy = isTruthy;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.compact = void 0;\nvar isTruthy_1 = require(\"./isTruthy\");\nfunction compact(items) {\n    return items.filter(isTruthy_1.isTruthy);\n}\nexports.compact = compact;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.concat = void 0;\nvar purry_1 = require(\"./purry\");\nfunction concat() {\n    return (0, purry_1.purry)(_concat, arguments);\n}\nexports.concat = concat;\nfunction _concat(arr1, arr2) {\n    return arr1.concat(arr2);\n}\n", "\"use strict\";\nvar __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n        if (ar || !(i in from)) {\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n            ar[i] = from[i];\n        }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.purryOn = void 0;\nfunction purryOn(isArg, implementation, args) {\n    var callArgs = Array.from(args);\n    var dataOrArg = callArgs[0], rest = callArgs.slice(1);\n    return isArg(dataOrArg)\n        ? function (data) { return implementation.apply(void 0, __spreadArray([data], callArgs, false)); }\n        : implementation.apply(void 0, __spreadArray([dataOrArg], rest, false));\n}\nexports.purryOn = purryOn;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.conditional = void 0;\nvar _purryOn_1 = require(\"./_purryOn\");\nfunction conditional() {\n    return (0, _purryOn_1.purryOn)(isCase, conditionalImplementation, arguments);\n}\nexports.conditional = conditional;\nfunction conditionalImplementation(data) {\n    var cases = [];\n    for (var _i = 1; _i < arguments.length; _i++) {\n        cases[_i - 1] = arguments[_i];\n    }\n    for (var _a = 0, cases_1 = cases; _a < cases_1.length; _a++) {\n        var _b = cases_1[_a], when = _b[0], then = _b[1];\n        if (when(data)) {\n            return then(data);\n        }\n    }\n    throw new Error('conditional: data failed for all cases');\n}\nfunction isCase(maybeCase) {\n    if (!Array.isArray(maybeCase)) {\n        return false;\n    }\n    var when = maybeCase[0], then = maybeCase[1], rest = maybeCase.slice(2);\n    return (typeof when === 'function' &&\n        when.length <= 1 &&\n        typeof then === 'function' &&\n        then.length <= 1 &&\n        rest.length === 0);\n}\n(function (conditional) {\n    conditional.defaultCase = function (then) {\n        if (then === void 0) { then = trivialDefaultCase; }\n        return [function () { return true; }, then];\n    };\n})(conditional || (exports.conditional = conditional = {}));\nvar trivialDefaultCase = function () { return undefined; };\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.countBy = void 0;\nvar purry_1 = require(\"./purry\");\nvar _countBy = function (indexed) {\n    return function (array, fn) {\n        return array.reduce(function (ret, item, index) {\n            var value = indexed ? fn(item, index, array) : fn(item);\n            return ret + (value ? 1 : 0);\n        }, 0);\n    };\n};\nfunction countBy() {\n    return (0, purry_1.purry)(_countBy(false), arguments);\n}\nexports.countBy = countBy;\n(function (countBy) {\n    function indexed() {\n        return (0, purry_1.purry)(_countBy(true), arguments);\n    }\n    countBy.indexed = indexed;\n})(countBy || (exports.countBy = countBy = {}));\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.pipe = void 0;\nfunction pipe(value) {\n    var operations = [];\n    for (var _i = 1; _i < arguments.length; _i++) {\n        operations[_i - 1] = arguments[_i];\n    }\n    var ret = value;\n    var lazyOps = operations.map(function (op) {\n        var _a = op, lazy = _a.lazy, lazyArgs = _a.lazyArgs;\n        if (lazy) {\n            var fn = lazy.apply(void 0, (lazyArgs || []));\n            fn.indexed = lazy.indexed;\n            fn.single = lazy.single;\n            fn.index = 0;\n            fn.items = [];\n            return fn;\n        }\n        return null;\n    });\n    var opIdx = 0;\n    while (opIdx < operations.length) {\n        var op = operations[opIdx];\n        var lazyOp = lazyOps[opIdx];\n        if (!lazyOp) {\n            ret = op(ret);\n            opIdx++;\n            continue;\n        }\n        var lazySeq = [];\n        for (var j = opIdx; j < operations.length; j++) {\n            if (lazyOps[j]) {\n                lazySeq.push(lazyOps[j]);\n                if (lazyOps[j].single) {\n                    break;\n                }\n            }\n            else {\n                break;\n            }\n        }\n        var acc = [];\n        for (var _a = 0, ret_1 = ret; _a < ret_1.length; _a++) {\n            var item = ret_1[_a];\n            if (_processItem({ item: item, acc: acc, lazySeq: lazySeq })) {\n                break;\n            }\n        }\n        var lastLazySeq = lazySeq[lazySeq.length - 1];\n        if (lastLazySeq.single) {\n            ret = acc[0];\n        }\n        else {\n            ret = acc;\n        }\n        opIdx += lazySeq.length;\n    }\n    return ret;\n}\nexports.pipe = pipe;\nfunction _processItem(_a) {\n    var item = _a.item, lazySeq = _a.lazySeq, acc = _a.acc;\n    if (lazySeq.length === 0) {\n        acc.push(item);\n        return false;\n    }\n    var lazyResult = { done: false, hasNext: false };\n    var isDone = false;\n    for (var i = 0; i < lazySeq.length; i++) {\n        var lazyFn = lazySeq[i];\n        var indexed = lazyFn.indexed;\n        var index = lazyFn.index;\n        var items = lazyFn.items;\n        items.push(item);\n        lazyResult = indexed ? lazyFn(item, index, items) : lazyFn(item);\n        lazyFn.index++;\n        if (lazyResult.hasNext) {\n            if (lazyResult.hasMany) {\n                var nextValues = lazyResult.next;\n                for (var _i = 0, nextValues_1 = nextValues; _i < nextValues_1.length; _i++) {\n                    var subItem = nextValues_1[_i];\n                    var subResult = _processItem({\n                        item: subItem,\n                        acc: acc,\n                        lazySeq: lazySeq.slice(i + 1),\n                    });\n                    if (subResult) {\n                        return true;\n                    }\n                }\n                return false;\n            }\n            else {\n                item = lazyResult.next;\n            }\n        }\n        if (!lazyResult.hasNext) {\n            break;\n        }\n        if (lazyResult.done) {\n            isDone = true;\n        }\n    }\n    if (lazyResult.hasNext) {\n        acc.push(item);\n    }\n    if (isDone) {\n        return true;\n    }\n    return false;\n}\n", "\"use strict\";\nvar __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n        if (ar || !(i in from)) {\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n            ar[i] = from[i];\n        }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.createPipe = void 0;\nvar pipe_1 = require(\"./pipe\");\nfunction createPipe() {\n    var operations = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        operations[_i] = arguments[_i];\n    }\n    return function (value) { return pipe_1.pipe.apply(void 0, __spreadArray([value], operations, false)); };\n}\nexports.createPipe = createPipe;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.debounce = void 0;\nfunction debounce(func, _a) {\n    var waitMs = _a.waitMs, _b = _a.timing, timing = _b === void 0 ? 'trailing' : _b, maxWaitMs = _a.maxWaitMs;\n    if (maxWaitMs !== undefined && waitMs !== undefined && maxWaitMs < waitMs) {\n        throw new Error(\"debounce: maxWaitMs (\".concat(maxWaitMs, \") cannot be less than waitMs (\").concat(waitMs, \")\"));\n    }\n    var coolDownTimeoutId;\n    var maxWaitTimeoutId;\n    var latestCallArgs;\n    var result;\n    var handleInvoke = function () {\n        if (latestCallArgs === undefined) {\n            return;\n        }\n        if (maxWaitTimeoutId !== undefined) {\n            var timeoutId = maxWaitTimeoutId;\n            maxWaitTimeoutId = undefined;\n            clearTimeout(timeoutId);\n        }\n        var args = latestCallArgs;\n        latestCallArgs = undefined;\n        result = func.apply(void 0, args);\n    };\n    var handleCoolDownEnd = function () {\n        if (coolDownTimeoutId === undefined) {\n            return;\n        }\n        var timeoutId = coolDownTimeoutId;\n        coolDownTimeoutId = undefined;\n        clearTimeout(timeoutId);\n        if (latestCallArgs !== undefined) {\n            handleInvoke();\n        }\n    };\n    var handleDebouncedCall = function (args) {\n        latestCallArgs = args;\n        if (maxWaitMs !== undefined && maxWaitTimeoutId === undefined) {\n            maxWaitTimeoutId = setTimeout(handleInvoke, maxWaitMs);\n        }\n    };\n    return {\n        call: function () {\n            var _a;\n            var args = [];\n            for (var _i = 0; _i < arguments.length; _i++) {\n                args[_i] = arguments[_i];\n            }\n            if (coolDownTimeoutId === undefined) {\n                if (timing === 'trailing') {\n                    handleDebouncedCall(args);\n                }\n                else {\n                    result = func.apply(void 0, args);\n                }\n            }\n            else {\n                if (timing !== 'leading') {\n                    handleDebouncedCall(args);\n                }\n                var timeoutId = coolDownTimeoutId;\n                coolDownTimeoutId = undefined;\n                clearTimeout(timeoutId);\n            }\n            coolDownTimeoutId = setTimeout(handleCoolDownEnd, (_a = waitMs !== null && waitMs !== void 0 ? waitMs : maxWaitMs) !== null && _a !== void 0 ? _a : 0);\n            return result;\n        },\n        cancel: function () {\n            if (coolDownTimeoutId !== undefined) {\n                var timeoutId = coolDownTimeoutId;\n                coolDownTimeoutId = undefined;\n                clearTimeout(timeoutId);\n            }\n            if (maxWaitTimeoutId !== undefined) {\n                var timeoutId = maxWaitTimeoutId;\n                maxWaitTimeoutId = undefined;\n                clearTimeout(timeoutId);\n            }\n            latestCallArgs = undefined;\n        },\n        flush: function () {\n            handleCoolDownEnd();\n            return result;\n        },\n        get isPending() {\n            return coolDownTimeoutId !== undefined;\n        },\n        get cachedValue() {\n            return result;\n        },\n    };\n}\nexports.debounce = debounce;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports._reduceLazy = void 0;\nfunction _reduceLazy(array, lazy, indexed) {\n    var newArray = [];\n    for (var index = 0; index < array.length; index++) {\n        var item = array[index];\n        var result = indexed ? lazy(item, index, array) : lazy(item);\n        if (result.hasMany === true) {\n            newArray.push.apply(newArray, result.next);\n        }\n        else if (result.hasNext) {\n            newArray.push(result.next);\n        }\n    }\n    return newArray;\n}\nexports._reduceLazy = _reduceLazy;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.difference = void 0;\nvar purry_1 = require(\"./purry\");\nvar _reduceLazy_1 = require(\"./_reduceLazy\");\nfunction difference() {\n    return (0, purry_1.purry)(_difference, arguments, difference.lazy);\n}\nexports.difference = difference;\nfunction _difference(array, other) {\n    var lazy = difference.lazy(other);\n    return (0, _reduceLazy_1._reduceLazy)(array, lazy);\n}\n(function (difference) {\n    function lazy(other) {\n        var set = new Set(other);\n        return function (value) {\n            if (!set.has(value)) {\n                return {\n                    done: false,\n                    hasNext: true,\n                    next: value,\n                };\n            }\n            return {\n                done: false,\n                hasNext: false,\n            };\n        };\n    }\n    difference.lazy = lazy;\n})(difference || (exports.difference = difference = {}));\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.differenceWith = void 0;\nvar purry_1 = require(\"./purry\");\nvar _reduceLazy_1 = require(\"./_reduceLazy\");\nfunction differenceWith() {\n    return (0, purry_1.purry)(_differenceWith, arguments, differenceWith.lazy);\n}\nexports.differenceWith = differenceWith;\nfunction _differenceWith(array, other, isEquals) {\n    var lazy = differenceWith.lazy(other, isEquals);\n    return (0, _reduceLazy_1._reduceLazy)(array, lazy);\n}\n(function (differenceWith) {\n    function lazy(other, isEquals) {\n        return function (value) {\n            if (other.every(function (otherValue) { return !isEquals(value, otherValue); })) {\n                return {\n                    done: false,\n                    hasNext: true,\n                    next: value,\n                };\n            }\n            return {\n                done: false,\n                hasNext: false,\n            };\n        };\n    }\n    differenceWith.lazy = lazy;\n})(differenceWith || (exports.differenceWith = differenceWith = {}));\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.divide = void 0;\nvar purry_1 = require(\"./purry\");\nfunction divide() {\n    return (0, purry_1.purry)(_divide, arguments);\n}\nexports.divide = divide;\nfunction _divide(value, divisor) {\n    return value / divisor;\n}\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.drop = void 0;\nvar purry_1 = require(\"./purry\");\nvar _reduceLazy_1 = require(\"./_reduceLazy\");\nfunction drop() {\n    return (0, purry_1.purry)(_drop, arguments, drop.lazy);\n}\nexports.drop = drop;\nfunction _drop(array, n) {\n    return (0, _reduceLazy_1._reduceLazy)(array, drop.lazy(n));\n}\n(function (drop) {\n    function lazy(n) {\n        var left = n;\n        return function (value) {\n            if (left > 0) {\n                left--;\n                return {\n                    done: false,\n                    hasNext: false,\n                };\n            }\n            return {\n                done: false,\n                hasNext: true,\n                next: value,\n            };\n        };\n    }\n    drop.lazy = lazy;\n})(drop || (exports.drop = drop = {}));\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.swapInPlace = void 0;\nfunction swapInPlace(data, i, j) {\n    var _a;\n    _a = [data[j], data[i]], data[i] = _a[0], data[j] = _a[1];\n}\nexports.swapInPlace = swapInPlace;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.heapMaybeInsert = exports.heapify = void 0;\nvar _swapInPlace_1 = require(\"./_swapInPlace\");\nfunction heapify(heap, compareFn) {\n    for (var i = Math.floor(heap.length / 2) - 1; i >= 0; i--) {\n        heapSiftDown(heap, i, compareFn);\n    }\n}\nexports.heapify = heapify;\nfunction heapMaybeInsert(heap, compareFn, item) {\n    var head = heap[0];\n    if (compareFn(item, head) >= 0) {\n        return;\n    }\n    heap[0] = item;\n    heapSiftDown(heap, 0, compareFn);\n    return head;\n}\nexports.heapMaybeInsert = heapMaybeInsert;\nfunction heapSiftDown(heap, index, compareFn) {\n    var currentIndex = index;\n    while (currentIndex * 2 + 1 < heap.length) {\n        var firstChildIndex = currentIndex * 2 + 1;\n        var swapIndex = compareFn(heap[currentIndex], heap[firstChildIndex]) < 0\n            ?\n                firstChildIndex\n            : currentIndex;\n        var secondChildIndex = firstChildIndex + 1;\n        if (secondChildIndex < heap.length &&\n            compareFn(heap[swapIndex], heap[secondChildIndex]) < 0) {\n            swapIndex = secondChildIndex;\n        }\n        if (swapIndex === currentIndex) {\n            return;\n        }\n        (0, _swapInPlace_1.swapInPlace)(heap, currentIndex, swapIndex);\n        currentIndex = swapIndex;\n    }\n}\n", "\"use strict\";\nvar __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n        if (ar || !(i in from)) {\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n            ar[i] = from[i];\n        }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.purryOrderRulesWithArgument = exports.purryOrderRules = void 0;\nvar COMPARATORS = {\n    asc: function (x, y) { return x > y; },\n    desc: function (x, y) { return x < y; },\n};\nfunction purryOrderRules(func, inputArgs) {\n    var _a = (Array.isArray(inputArgs) ? inputArgs : Array.from(inputArgs)), dataOrRule = _a[0], rules = _a.slice(1);\n    if (!isOrderRule(dataOrRule)) {\n        var compareFn_1 = orderRuleComparer.apply(void 0, rules);\n        return func(dataOrRule, compareFn_1);\n    }\n    var compareFn = orderRuleComparer.apply(void 0, __spreadArray([dataOrRule], rules, false));\n    return function (data) { return func(data, compareFn); };\n}\nexports.purryOrderRules = purryOrderRules;\nfunction purryOrderRulesWithArgument(func, inputArgs) {\n    var _a = Array.from(inputArgs), first = _a[0], second = _a[1], rest = _a.slice(2);\n    var arg;\n    var argRemoved;\n    if (isOrderRule(second)) {\n        arg = first;\n        argRemoved = __spreadArray([second], rest, true);\n    }\n    else {\n        arg = second;\n        argRemoved = __spreadArray([first], rest, true);\n    }\n    return purryOrderRules(function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        return func.apply(void 0, __spreadArray(__spreadArray([], args, false), [arg], false));\n    }, argRemoved);\n}\nexports.purryOrderRulesWithArgument = purryOrderRulesWithArgument;\nfunction orderRuleComparer(primaryRule, secondaryRule) {\n    var otherRules = [];\n    for (var _i = 2; _i < arguments.length; _i++) {\n        otherRules[_i - 2] = arguments[_i];\n    }\n    var projector = typeof primaryRule === 'function' ? primaryRule : primaryRule[0];\n    var direction = typeof primaryRule === 'function' ? 'asc' : primaryRule[1];\n    var comparator = COMPARATORS[direction];\n    var nextComparer = secondaryRule === undefined\n        ? undefined\n        : orderRuleComparer.apply(void 0, __spreadArray([secondaryRule], otherRules, false));\n    return function (a, b) {\n        var _a;\n        var projectedA = projector(a);\n        var projectedB = projector(b);\n        if (comparator(projectedA, projectedB)) {\n            return 1;\n        }\n        if (comparator(projectedB, projectedA)) {\n            return -1;\n        }\n        return (_a = nextComparer === null || nextComparer === void 0 ? void 0 : nextComparer(a, b)) !== null && _a !== void 0 ? _a : 0;\n    };\n}\nfunction isOrderRule(x) {\n    if (isProjection(x)) {\n        return true;\n    }\n    if (typeof x !== 'object' || !Array.isArray(x)) {\n        return false;\n    }\n    var maybeProjection = x[0], maybeDirection = x[1], rest = x.slice(2);\n    return (isProjection(maybeProjection) &&\n        maybeDirection in COMPARATORS &&\n        rest.length === 0);\n}\nvar isProjection = function (x) {\n    return typeof x === 'function' && x.length === 1;\n};\n", "\"use strict\";\nvar __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n        if (ar || !(i in from)) {\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n            ar[i] = from[i];\n        }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.dropFirstBy = void 0;\nvar _heap_1 = require(\"./_heap\");\nvar _purryOrderRules_1 = require(\"./_purryOrderRules\");\nfunction dropFirstBy() {\n    return (0, _purryOrderRules_1.purryOrderRulesWithArgument)(dropFirstByImplementation, arguments);\n}\nexports.dropFirstBy = dropFirstBy;\nfunction dropFirstByImplementation(data, compareFn, n) {\n    if (n >= data.length) {\n        return [];\n    }\n    if (n <= 0) {\n        return __spreadArray([], data, true);\n    }\n    var heap = data.slice(0, n);\n    (0, _heap_1.heapify)(heap, compareFn);\n    var out = [];\n    var rest = data.slice(n);\n    for (var _i = 0, rest_1 = rest; _i < rest_1.length; _i++) {\n        var item = rest_1[_i];\n        var previousHead = (0, _heap_1.heapMaybeInsert)(heap, compareFn, item);\n        out.push(previousHead !== null && previousHead !== void 0 ? previousHead : item);\n    }\n    return out;\n}\n", "\"use strict\";\nvar __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n        if (ar || !(i in from)) {\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n            ar[i] = from[i];\n        }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.dropLast = void 0;\nvar purry_1 = require(\"./purry\");\nfunction dropLast() {\n    return (0, purry_1.purry)(_dropLast, arguments);\n}\nexports.dropLast = dropLast;\nfunction _dropLast(array, n) {\n    var copy = __spreadArray([], array, true);\n    if (n > 0) {\n        copy.splice(-n);\n    }\n    return copy;\n}\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.dropLastWhile = void 0;\nvar purry_1 = require(\"./purry\");\nfunction dropLastWhile() {\n    return (0, purry_1.purry)(_dropLastWhile, arguments);\n}\nexports.dropLastWhile = dropLastWhile;\nfunction _dropLastWhile(data, predicate) {\n    for (var i = data.length - 1; i >= 0; i--) {\n        if (!predicate(data[i])) {\n            return data.slice(0, i + 1);\n        }\n    }\n    return [];\n}\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.dropWhile = void 0;\nvar purry_1 = require(\"./purry\");\nfunction dropWhile() {\n    return (0, purry_1.purry)(_dropWhile, arguments);\n}\nexports.dropWhile = dropWhile;\nfunction _dropWhile(data, predicate) {\n    for (var i = 0; i < data.length; i++) {\n        if (!predicate(data[i])) {\n            return data.slice(i);\n        }\n    }\n    return [];\n}\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.equals = void 0;\nvar purry_1 = require(\"./purry\");\nvar isArray = Array.isArray;\nvar keyList = Object.keys;\nfunction equals() {\n    return (0, purry_1.purry)(_equals, arguments);\n}\nexports.equals = equals;\nfunction _equals(a, b) {\n    if (a === b) {\n        return true;\n    }\n    if (a && b && typeof a === 'object' && typeof b === 'object') {\n        var arrA = isArray(a);\n        var arrB = isArray(b);\n        var i = void 0;\n        var length_1;\n        var key = void 0;\n        if (arrA && arrB) {\n            length_1 = a.length;\n            if (length_1 !== b.length) {\n                return false;\n            }\n            for (i = length_1; i-- !== 0;) {\n                if (!equals(a[i], b[i])) {\n                    return false;\n                }\n            }\n            return true;\n        }\n        if (arrA !== arrB) {\n            return false;\n        }\n        var dateA = a instanceof Date;\n        var dateB = b instanceof Date;\n        if (dateA !== dateB) {\n            return false;\n        }\n        if (dateA && dateB) {\n            return a.getTime() === b.getTime();\n        }\n        var regexpA = a instanceof RegExp;\n        var regexpB = b instanceof RegExp;\n        if (regexpA !== regexpB) {\n            return false;\n        }\n        if (regexpA && regexpB) {\n            return a.toString() === b.toString();\n        }\n        var keys = keyList(a);\n        length_1 = keys.length;\n        if (length_1 !== keyList(b).length) {\n            return false;\n        }\n        for (i = length_1; i-- !== 0;) {\n            if (!Object.prototype.hasOwnProperty.call(b, keys[i])) {\n                return false;\n            }\n        }\n        for (i = length_1; i-- !== 0;) {\n            key = keys[i];\n            if (!equals(a[key], b[key])) {\n                return false;\n            }\n        }\n        return true;\n    }\n    return a !== a && b !== b;\n}\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.toPairs = void 0;\nfunction toPairs(object) {\n    return Object.entries(object);\n}\nexports.toPairs = toPairs;\n(function (toPairs) {\n    function strict(object) {\n        return Object.entries(object);\n    }\n    toPairs.strict = strict;\n})(toPairs || (exports.toPairs = toPairs = {}));\n", "\"use strict\";\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.evolve = void 0;\nvar purry_1 = require(\"./purry\");\nvar toPairs_1 = require(\"./toPairs\");\nfunction evolve() {\n    return (0, purry_1.purry)(_evolve, arguments);\n}\nexports.evolve = evolve;\nfunction _evolve(data, evolver) {\n    if (typeof data !== 'object' || data === null) {\n        return data;\n    }\n    return toPairs_1.toPairs.strict(evolver).reduce(function (result, _a) {\n        var key = _a[0], value = _a[1];\n        if (key in result) {\n            result[key] =\n                typeof value === 'function'\n                    ? value(result[key])\n                    : _evolve(result[key], value);\n        }\n        return result;\n    }, __assign({}, data));\n}\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports._toLazyIndexed = void 0;\nvar _toLazyIndexed = function (fn) {\n    fn.indexed = true;\n    return fn;\n};\nexports._toLazyIndexed = _toLazyIndexed;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.filter = void 0;\nvar purry_1 = require(\"./purry\");\nvar _reduceLazy_1 = require(\"./_reduceLazy\");\nvar _toLazyIndexed_1 = require(\"./_toLazyIndexed\");\nfunction filter() {\n    return (0, purry_1.purry)(_filter(false), arguments, filter.lazy);\n}\nexports.filter = filter;\nvar _filter = function (indexed) {\n    return function (array, fn) {\n        return (0, _reduceLazy_1._reduceLazy)(array, indexed ? filter.lazyIndexed(fn) : filter.lazy(fn), indexed);\n    };\n};\nvar _lazy = function (indexed) {\n    return function (fn) {\n        return function (value, index, array) {\n            var valid = indexed ? fn(value, index, array) : fn(value);\n            if (valid) {\n                return {\n                    done: false,\n                    hasNext: true,\n                    next: value,\n                };\n            }\n            return {\n                done: false,\n                hasNext: false,\n            };\n        };\n    };\n};\n(function (filter) {\n    function indexed() {\n        return (0, purry_1.purry)(_filter(true), arguments, filter.lazyIndexed);\n    }\n    filter.indexed = indexed;\n    filter.lazy = _lazy(false);\n    filter.lazyIndexed = (0, _toLazyIndexed_1._toLazyIndexed)(_lazy(true));\n})(filter || (exports.filter = filter = {}));\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports._toSingle = void 0;\nvar _toSingle = function (fn) {\n    fn.single = true;\n    return fn;\n};\nexports._toSingle = _toSingle;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.find = void 0;\nvar purry_1 = require(\"./purry\");\nvar _toLazyIndexed_1 = require(\"./_toLazyIndexed\");\nvar _toSingle_1 = require(\"./_toSingle\");\nfunction find() {\n    return (0, purry_1.purry)(_find(false), arguments, find.lazy);\n}\nexports.find = find;\nvar _find = function (indexed) {\n    return function (array, fn) {\n        if (indexed) {\n            return array.find(fn);\n        }\n        return array.find(function (x) { return fn(x); });\n    };\n};\nvar _lazy = function (indexed) {\n    return function (fn) {\n        return function (value, index, array) {\n            var valid = indexed ? fn(value, index, array) : fn(value);\n            return {\n                done: valid,\n                hasNext: valid,\n                next: value,\n            };\n        };\n    };\n};\n(function (find) {\n    function indexed() {\n        return (0, purry_1.purry)(_find(true), arguments, find.lazyIndexed);\n    }\n    find.indexed = indexed;\n    find.lazy = (0, _toSingle_1._toSingle)(_lazy(false));\n    find.lazyIndexed = (0, _toSingle_1._toSingle)((0, _toLazyIndexed_1._toLazyIndexed)(_lazy(true)));\n})(find || (exports.find = find = {}));\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.findIndex = void 0;\nvar purry_1 = require(\"./purry\");\nvar _toLazyIndexed_1 = require(\"./_toLazyIndexed\");\nvar _toSingle_1 = require(\"./_toSingle\");\nfunction findIndex() {\n    return (0, purry_1.purry)(_findIndex(false), arguments, findIndex.lazy);\n}\nexports.findIndex = findIndex;\nvar _findIndex = function (indexed) {\n    return function (array, fn) {\n        if (indexed) {\n            return array.findIndex(fn);\n        }\n        return array.findIndex(function (x) { return fn(x); });\n    };\n};\nvar _lazy = function (indexed) {\n    return function (fn) {\n        var i = 0;\n        return function (value, index, array) {\n            var valid = indexed ? fn(value, index, array) : fn(value);\n            if (valid) {\n                return {\n                    done: true,\n                    hasNext: true,\n                    next: i,\n                };\n            }\n            i++;\n            return {\n                done: false,\n                hasNext: false,\n            };\n        };\n    };\n};\n(function (findIndex) {\n    function indexed() {\n        return (0, purry_1.purry)(_findIndex(true), arguments, findIndex.lazyIndexed);\n    }\n    findIndex.indexed = indexed;\n    findIndex.lazy = (0, _toSingle_1._toSingle)(_lazy(false));\n    findIndex.lazyIndexed = (0, _toSingle_1._toSingle)((0, _toLazyIndexed_1._toLazyIndexed)(_lazy(true)));\n})(findIndex || (exports.findIndex = findIndex = {}));\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.findLast = void 0;\nvar purry_1 = require(\"./purry\");\nfunction findLast() {\n    return (0, purry_1.purry)(_findLast(false), arguments);\n}\nexports.findLast = findLast;\nvar _findLast = function (indexed) {\n    return function (array, fn) {\n        for (var i = array.length - 1; i >= 0; i--) {\n            if (indexed ? fn(array[i], i, array) : fn(array[i])) {\n                return array[i];\n            }\n        }\n    };\n};\n(function (findLast) {\n    function indexed() {\n        return (0, purry_1.purry)(_findLast(true), arguments);\n    }\n    findLast.indexed = indexed;\n})(findLast || (exports.findLast = findLast = {}));\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.findLastIndex = void 0;\nvar purry_1 = require(\"./purry\");\nfunction findLastIndex() {\n    return (0, purry_1.purry)(_findLastIndex(false), arguments);\n}\nexports.findLastIndex = findLastIndex;\nvar _findLastIndex = function (indexed) {\n    return function (array, fn) {\n        for (var i = array.length - 1; i >= 0; i--) {\n            if (indexed ? fn(array[i], i, array) : fn(array[i])) {\n                return i;\n            }\n        }\n        return -1;\n    };\n};\n(function (findLastIndex) {\n    function indexed() {\n        return (0, purry_1.purry)(_findLastIndex(true), arguments);\n    }\n    findLastIndex.indexed = indexed;\n})(findLastIndex || (exports.findLastIndex = findLastIndex = {}));\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.first = void 0;\nvar purry_1 = require(\"./purry\");\nfunction first() {\n    return (0, purry_1.purry)(_first, arguments, first.lazy);\n}\nexports.first = first;\nfunction _first(_a) {\n    var first = _a[0];\n    return first;\n}\n(function (first) {\n    function lazy() {\n        return function (value) {\n            return {\n                done: true,\n                hasNext: true,\n                next: value,\n            };\n        };\n    }\n    first.lazy = lazy;\n    (function (lazy) {\n        lazy.single = true;\n    })(lazy = first.lazy || (first.lazy = {}));\n})(first || (exports.first = first = {}));\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.hasAtLeast = void 0;\nvar purry_1 = require(\"./purry\");\nfunction hasAtLeast() {\n    var args = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n    }\n    return (0, purry_1.purry)(hasAtLeastImplementation, args);\n}\nexports.hasAtLeast = hasAtLeast;\nvar hasAtLeastImplementation = function (data, minimum) { return data.length >= minimum; };\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.firstBy = void 0;\nvar _purryOrderRules_1 = require(\"./_purryOrderRules\");\nvar hasAtLeast_1 = require(\"./hasAtLeast\");\nfunction firstBy() {\n    return (0, _purryOrderRules_1.purryOrderRules)(firstByImplementation, arguments);\n}\nexports.firstBy = firstBy;\nfunction firstByImplementation(data, compareFn) {\n    var currentFirst = data[0];\n    if (!(0, hasAtLeast_1.hasAtLeast)(data, 2)) {\n        return currentFirst;\n    }\n    var rest = data.slice(1);\n    for (var _i = 0, rest_1 = rest; _i < rest_1.length; _i++) {\n        var item = rest_1[_i];\n        if (compareFn(item, currentFirst) < 0) {\n            currentFirst = item;\n        }\n    }\n    return currentFirst;\n}\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.flatten = void 0;\nvar _reduceLazy_1 = require(\"./_reduceLazy\");\nvar purry_1 = require(\"./purry\");\nfunction flatten() {\n    return (0, purry_1.purry)(_flatten, arguments, flatten.lazy);\n}\nexports.flatten = flatten;\nfunction _flatten(items) {\n    return (0, _reduceLazy_1._reduceLazy)(items, flatten.lazy());\n}\n(function (flatten) {\n    function lazy() {\n        return function (next) {\n            if (Array.isArray(next)) {\n                return {\n                    done: false,\n                    hasNext: true,\n                    hasMany: true,\n                    next: next,\n                };\n            }\n            return {\n                done: false,\n                hasNext: true,\n                next: next,\n            };\n        };\n    }\n    flatten.lazy = lazy;\n})(flatten || (exports.flatten = flatten = {}));\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.flatMap = void 0;\nvar flatten_1 = require(\"./flatten\");\nvar purry_1 = require(\"./purry\");\nfunction flatMap() {\n    return (0, purry_1.purry)(_flatMap, arguments, flatMap.lazy);\n}\nexports.flatMap = flatMap;\nfunction _flatMap(array, fn) {\n    return (0, flatten_1.flatten)(array.map(function (item) { return fn(item); }));\n}\n(function (flatMap) {\n    function lazy(fn) {\n        return function (value) {\n            var next = fn(value);\n            if (Array.isArray(next)) {\n                return {\n                    done: false,\n                    hasNext: true,\n                    hasMany: true,\n                    next: next,\n                };\n            }\n            return {\n                done: false,\n                hasNext: true,\n                next: next,\n            };\n        };\n    }\n    flatMap.lazy = lazy;\n})(flatMap || (exports.flatMap = flatMap = {}));\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.flatMapToObj = void 0;\nvar purry_1 = require(\"./purry\");\nfunction flatMapToObj() {\n    return (0, purry_1.purry)(_flatMapToObj(false), arguments);\n}\nexports.flatMapToObj = flatMapToObj;\nvar _flatMapToObj = function (indexed) {\n    return function (array, fn) {\n        return array.reduce(function (result, element, index) {\n            var items = indexed ? fn(element, index, array) : fn(element);\n            items.forEach(function (_a) {\n                var key = _a[0], value = _a[1];\n                result[key] = value;\n            });\n            return result;\n        }, {});\n    };\n};\n(function (flatMapToObj) {\n    function indexed() {\n        return (0, purry_1.purry)(_flatMapToObj(true), arguments);\n    }\n    flatMapToObj.indexed = indexed;\n})(flatMapToObj || (exports.flatMapToObj = flatMapToObj = {}));\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.flattenDeep = void 0;\nvar _reduceLazy_1 = require(\"./_reduceLazy\");\nvar purry_1 = require(\"./purry\");\nfunction flattenDeep() {\n    return (0, purry_1.purry)(_flattenDeep, arguments, flattenDeep.lazy);\n}\nexports.flattenDeep = flattenDeep;\nfunction _flattenDeep(items) {\n    return (0, _reduceLazy_1._reduceLazy)(items, flattenDeep.lazy());\n}\nfunction _flattenDeepValue(value) {\n    if (!Array.isArray(value)) {\n        return value;\n    }\n    var ret = [];\n    value.forEach(function (item) {\n        if (Array.isArray(item)) {\n            ret.push.apply(ret, flattenDeep(item));\n        }\n        else {\n            ret.push(item);\n        }\n    });\n    return ret;\n}\n(function (flattenDeep) {\n    function lazy() {\n        return function (value) {\n            var next = _flattenDeepValue(value);\n            if (Array.isArray(next)) {\n                return {\n                    done: false,\n                    hasNext: true,\n                    hasMany: true,\n                    next: next,\n                };\n            }\n            return {\n                done: false,\n                hasNext: true,\n                next: next,\n            };\n        };\n    }\n    flattenDeep.lazy = lazy;\n})(flattenDeep || (exports.flattenDeep = flattenDeep = {}));\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.floor = void 0;\nvar _withPrecision_1 = require(\"./_withPrecision\");\nvar purry_1 = require(\"./purry\");\nfunction floor() {\n    return (0, purry_1.purry)((0, _withPrecision_1._withPrecision)(Math.floor), arguments);\n}\nexports.floor = floor;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.forEach = void 0;\nvar purry_1 = require(\"./purry\");\nvar _reduceLazy_1 = require(\"./_reduceLazy\");\nvar _toLazyIndexed_1 = require(\"./_toLazyIndexed\");\nfunction forEach() {\n    return (0, purry_1.purry)(_forEach(false), arguments, forEach.lazy);\n}\nexports.forEach = forEach;\nvar _forEach = function (indexed) {\n    return function (array, fn) {\n        return (0, _reduceLazy_1._reduceLazy)(array, indexed ? forEach.lazyIndexed(fn) : forEach.lazy(fn), indexed);\n    };\n};\nvar _lazy = function (indexed) {\n    return function (fn) {\n        return function (value, index, array) {\n            if (indexed) {\n                fn(value, index, array);\n            }\n            else {\n                fn(value);\n            }\n            return {\n                done: false,\n                hasNext: true,\n                next: value,\n            };\n        };\n    };\n};\n(function (forEach) {\n    function indexed() {\n        return (0, purry_1.purry)(_forEach(true), arguments, forEach.lazyIndexed);\n    }\n    forEach.indexed = indexed;\n    forEach.lazy = _lazy(false);\n    forEach.lazyIndexed = (0, _toLazyIndexed_1._toLazyIndexed)(_lazy(true));\n})(forEach || (exports.forEach = forEach = {}));\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.forEachObj = void 0;\nvar purry_1 = require(\"./purry\");\nfunction forEachObj() {\n    return (0, purry_1.purry)(_forEachObj(false), arguments);\n}\nexports.forEachObj = forEachObj;\nvar _forEachObj = function (indexed) {\n    return function (object, fn) {\n        for (var key in object) {\n            if (Object.prototype.hasOwnProperty.call(object, key)) {\n                var val = object[key];\n                if (indexed)\n                    fn(val, key, object);\n                else\n                    fn(val);\n            }\n        }\n        return object;\n    };\n};\n(function (forEachObj) {\n    function indexed() {\n        return (0, purry_1.purry)(_forEachObj(true), arguments);\n    }\n    forEachObj.indexed = indexed;\n})(forEachObj || (exports.forEachObj = forEachObj = {}));\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.fromPairs = void 0;\nfunction fromPairs(entries) {\n    var out = {};\n    for (var _i = 0, entries_1 = entries; _i < entries_1.length; _i++) {\n        var _a = entries_1[_i], key = _a[0], value = _a[1];\n        out[key] = value;\n    }\n    return out;\n}\nexports.fromPairs = fromPairs;\n(function (fromPairs) {\n    fromPairs.strict = fromPairs;\n})(fromPairs || (exports.fromPairs = fromPairs = {}));\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.groupBy = void 0;\nvar purry_1 = require(\"./purry\");\nfunction groupBy() {\n    return (0, purry_1.purry)(_groupBy(false), arguments);\n}\nexports.groupBy = groupBy;\nvar _groupBy = function (indexed) {\n    return function (array, fn) {\n        var ret = {};\n        array.forEach(function (item, index) {\n            var key = indexed ? fn(item, index, array) : fn(item);\n            if (key !== undefined) {\n                var actualKey = String(key);\n                if (!ret[actualKey]) {\n                    ret[actualKey] = [];\n                }\n                ret[actualKey].push(item);\n            }\n        });\n        return ret;\n    };\n};\n(function (groupBy) {\n    function indexed() {\n        return (0, purry_1.purry)(_groupBy(true), arguments);\n    }\n    groupBy.indexed = indexed;\n    groupBy.strict = groupBy;\n})(groupBy || (exports.groupBy = groupBy = {}));\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.identity = void 0;\nfunction identity(value) {\n    return value;\n}\nexports.identity = identity;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.indexBy = void 0;\nvar purry_1 = require(\"./purry\");\nfunction indexBy() {\n    return (0, purry_1.purry)(_indexBy(false), arguments);\n}\nexports.indexBy = indexBy;\nvar _indexBy = function (indexed) {\n    return function (array, fn) {\n        return array.reduce(function (ret, item, index) {\n            var value = indexed ? fn(item, index, array) : fn(item);\n            var key = String(value);\n            ret[key] = item;\n            return ret;\n        }, {});\n    };\n};\nfunction indexByStrict() {\n    return (0, purry_1.purry)(_indexByStrict, arguments);\n}\nvar _indexByStrict = function (array, fn) {\n    return array.reduce(function (ret, item) {\n        var key = fn(item);\n        ret[key] = item;\n        return ret;\n    }, {});\n};\n(function (indexBy) {\n    function indexed() {\n        return (0, purry_1.purry)(_indexBy(true), arguments);\n    }\n    indexBy.indexed = indexed;\n    indexBy.strict = indexByStrict;\n})(indexBy || (exports.indexBy = indexBy = {}));\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.intersection = void 0;\nvar purry_1 = require(\"./purry\");\nvar _reduceLazy_1 = require(\"./_reduceLazy\");\nfunction intersection() {\n    return (0, purry_1.purry)(_intersection, arguments, intersection.lazy);\n}\nexports.intersection = intersection;\nfunction _intersection(array, other) {\n    var lazy = intersection.lazy(other);\n    return (0, _reduceLazy_1._reduceLazy)(array, lazy);\n}\n(function (intersection) {\n    function lazy(other) {\n        return function (value) {\n            var set = new Set(other);\n            if (set.has(value)) {\n                return {\n                    done: false,\n                    hasNext: true,\n                    next: value,\n                };\n            }\n            return {\n                done: false,\n                hasNext: false,\n            };\n        };\n    }\n    intersection.lazy = lazy;\n})(intersection || (exports.intersection = intersection = {}));\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.intersectionWith = void 0;\nvar _reduceLazy_1 = require(\"./_reduceLazy\");\nvar purry_1 = require(\"./purry\");\nfunction intersectionWith() {\n    return (0, purry_1.purry)(_intersectionWith, arguments, intersectionWith.lazy);\n}\nexports.intersectionWith = intersectionWith;\nfunction _intersectionWith(array, other, comparator) {\n    var lazy = intersectionWith.lazy(other, comparator);\n    return (0, _reduceLazy_1._reduceLazy)(array, lazy);\n}\n(function (intersectionWith) {\n    function lazy(other, comparator) {\n        return function (value) {\n            if (other.some(function (otherValue) { return comparator(value, otherValue); })) {\n                return {\n                    done: false,\n                    hasNext: true,\n                    next: value,\n                };\n            }\n            return {\n                done: false,\n                hasNext: false,\n            };\n        };\n    }\n    intersectionWith.lazy = lazy;\n})(intersectionWith || (exports.intersectionWith = intersectionWith = {}));\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.invert = void 0;\nvar purry_1 = require(\"./purry\");\nfunction invert() {\n    return (0, purry_1.purry)(_invert, arguments);\n}\nexports.invert = invert;\nfunction _invert(object) {\n    var result = {};\n    for (var key in object) {\n        result[object[key]] = key;\n    }\n    return result;\n}\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.isArray = void 0;\nfunction isArray(data) {\n    return Array.isArray(data);\n}\nexports.isArray = isArray;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.isBoolean = void 0;\nfunction isBoolean(data) {\n    return typeof data === 'boolean';\n}\nexports.isBoolean = isBoolean;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.isDate = void 0;\nfunction isDate(data) {\n    return data instanceof Date;\n}\nexports.isDate = isDate;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.isDefined = void 0;\nfunction isDefined(data) {\n    return typeof data !== 'undefined' && data !== null;\n}\nexports.isDefined = isDefined;\n(function (isDefined) {\n    function strict(data) {\n        return data !== undefined;\n    }\n    isDefined.strict = strict;\n})(isDefined || (exports.isDefined = isDefined = {}));\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.isObject = void 0;\nfunction isObject(data) {\n    return !!data && !Array.isArray(data) && typeof data === 'object';\n}\nexports.isObject = isObject;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.isString = void 0;\nfunction isString(data) {\n    return typeof data === 'string';\n}\nexports.isString = isString;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.isEmpty = void 0;\nvar isArray_1 = require(\"./isArray\");\nvar isObject_1 = require(\"./isObject\");\nvar isString_1 = require(\"./isString\");\nfunction isEmpty(data) {\n    if (data === undefined) {\n        return true;\n    }\n    if ((0, isArray_1.isArray)(data) || (0, isString_1.isString)(data)) {\n        return data.length === 0;\n    }\n    if ((0, isObject_1.isObject)(data)) {\n        return Object.keys(data).length === 0;\n    }\n    return false;\n}\nexports.isEmpty = isEmpty;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.isError = void 0;\nfunction isError(data) {\n    return data instanceof Error;\n}\nexports.isError = isError;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.isFunction = void 0;\nfunction isFunction(data) {\n    return typeof data === 'function';\n}\nexports.isFunction = isFunction;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.isNil = void 0;\nfunction isNil(data) {\n    return data == null;\n}\nexports.isNil = isNil;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.isNonNull = void 0;\nfunction isNonNull(data) {\n    return data !== null;\n}\nexports.isNonNull = isNonNull;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.isNot = void 0;\nfunction isNot(predicate) {\n    return function (data) {\n        return !predicate(data);\n    };\n}\nexports.isNot = isNot;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.isNumber = void 0;\nfunction isNumber(data) {\n    return typeof data === 'number' && !isNaN(data);\n}\nexports.isNumber = isNumber;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.isObjectType = void 0;\nvar isObjectType = function (data) { return typeof data === 'object' && data !== null; };\nexports.isObjectType = isObjectType;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.isPlainObject = void 0;\nfunction isPlainObject(data) {\n    if (typeof data !== 'object' || data === null) {\n        return false;\n    }\n    var proto = Object.getPrototypeOf(data);\n    return proto === null || proto === Object.prototype;\n}\nexports.isPlainObject = isPlainObject;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.isPromise = void 0;\nfunction isPromise(data) {\n    return data instanceof Promise;\n}\nexports.isPromise = isPromise;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.isSymbol = void 0;\nfunction isSymbol(data) {\n    return typeof data === 'symbol';\n}\nexports.isSymbol = isSymbol;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.join = void 0;\nvar purry_1 = require(\"./purry\");\nfunction join() {\n    return (0, purry_1.purry)(joinImplementation, arguments);\n}\nexports.join = join;\nvar joinImplementation = function (data, glue) { return data.join(glue); };\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.keys = void 0;\nfunction keys(source) {\n    return Object.keys(source);\n}\nexports.keys = keys;\n(function (keys) {\n    keys.strict = keys;\n})(keys || (exports.keys = keys = {}));\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.last = void 0;\nvar purry_1 = require(\"./purry\");\nfunction last() {\n    return (0, purry_1.purry)(_last, arguments);\n}\nexports.last = last;\nfunction _last(array) {\n    return array[array.length - 1];\n}\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.length = void 0;\nvar purry_1 = require(\"./purry\");\nfunction length() {\n    return (0, purry_1.purry)(_length, arguments);\n}\nexports.length = length;\nfunction _length(items) {\n    return 'length' in items ? items.length : Array.from(items).length;\n}\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.map = void 0;\nvar purry_1 = require(\"./purry\");\nvar _reduceLazy_1 = require(\"./_reduceLazy\");\nvar _toLazyIndexed_1 = require(\"./_toLazyIndexed\");\nfunction map() {\n    return (0, purry_1.purry)(_map(false), arguments, map.lazy);\n}\nexports.map = map;\nvar _map = function (indexed) {\n    return function (array, fn) {\n        return (0, _reduceLazy_1._reduceLazy)(array, indexed ? map.lazyIndexed(fn) : map.lazy(fn), indexed);\n    };\n};\nvar _lazy = function (indexed) {\n    return function (fn) {\n        return function (value, index, array) {\n            return {\n                done: false,\n                hasNext: true,\n                next: indexed ? fn(value, index, array) : fn(value),\n            };\n        };\n    };\n};\n(function (map) {\n    function indexed() {\n        return (0, purry_1.purry)(_map(true), arguments, map.lazyIndexed);\n    }\n    map.indexed = indexed;\n    map.lazy = _lazy(false);\n    map.lazyIndexed = (0, _toLazyIndexed_1._toLazyIndexed)(_lazy(true));\n    map.strict = map;\n})(map || (exports.map = map = {}));\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.mapKeys = void 0;\nfunction mapKeys(arg1, arg2) {\n    if (arguments.length === 1) {\n        return function (data) { return _mapKeys(data, arg1); };\n    }\n    return _mapKeys(arg1, arg2);\n}\nexports.mapKeys = mapKeys;\nfunction _mapKeys(obj, fn) {\n    return Object.keys(obj).reduce(function (acc, key) {\n        acc[fn(key, obj[key])] = obj[key];\n        return acc;\n    }, {});\n}\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.mapToObj = void 0;\nvar purry_1 = require(\"./purry\");\nfunction mapToObj() {\n    return (0, purry_1.purry)(_mapToObj(false), arguments);\n}\nexports.mapToObj = mapToObj;\nvar _mapToObj = function (indexed) {\n    return function (array, fn) {\n        return array.reduce(function (result, element, index) {\n            var _a = indexed ? fn(element, index, array) : fn(element), key = _a[0], value = _a[1];\n            result[key] = value;\n            return result;\n        }, {});\n    };\n};\n(function (mapToObj) {\n    function indexed() {\n        return (0, purry_1.purry)(_mapToObj(true), arguments);\n    }\n    mapToObj.indexed = indexed;\n})(mapToObj || (exports.mapToObj = mapToObj = {}));\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.mapValues = void 0;\nfunction mapValues(arg1, arg2) {\n    if (arguments.length === 1) {\n        return function (data) { return _mapValues(data, arg1); };\n    }\n    return _mapValues(arg1, arg2);\n}\nexports.mapValues = mapValues;\nfunction _mapValues(obj, fn) {\n    return Object.keys(obj).reduce(function (acc, key) {\n        acc[key] = fn(obj[key], key);\n        return acc;\n    }, {});\n}\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.maxBy = void 0;\nvar purry_1 = require(\"./purry\");\nvar _maxBy = function (indexed) {\n    return function (array, fn) {\n        var ret = undefined;\n        var retMax = undefined;\n        array.forEach(function (item, i) {\n            var max = indexed ? fn(item, i, array) : fn(item);\n            if (retMax === undefined || max > retMax) {\n                ret = item;\n                retMax = max;\n            }\n        });\n        return ret;\n    };\n};\nfunction maxBy() {\n    return (0, purry_1.purry)(_maxBy(false), arguments);\n}\nexports.maxBy = maxBy;\n(function (maxBy) {\n    function indexed() {\n        return (0, purry_1.purry)(_maxBy(true), arguments);\n    }\n    maxBy.indexed = indexed;\n})(maxBy || (exports.maxBy = maxBy = {}));\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.meanBy = void 0;\nvar purry_1 = require(\"./purry\");\nvar _meanBy = function (indexed) {\n    return function (array, fn) {\n        if (array.length === 0) {\n            return NaN;\n        }\n        var sum = 0;\n        array.forEach(function (item, i) {\n            sum += indexed ? fn(item, i, array) : fn(item);\n        });\n        return sum / array.length;\n    };\n};\nfunction meanBy() {\n    return (0, purry_1.purry)(_meanBy(false), arguments);\n}\nexports.meanBy = meanBy;\n(function (meanBy) {\n    function indexed() {\n        return (0, purry_1.purry)(_meanBy(true), arguments);\n    }\n    meanBy.indexed = indexed;\n})(meanBy || (exports.meanBy = meanBy = {}));\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.merge = void 0;\nvar purry_1 = require(\"./purry\");\nfunction merge() {\n    return (0, purry_1.purry)(_merge, arguments);\n}\nexports.merge = merge;\nfunction _merge(a, b) {\n    return Object.assign({}, a, b);\n}\n", "\"use strict\";\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.mergeAll = void 0;\nfunction mergeAll(items) {\n    return items.reduce(function (acc, x) { return (__assign(__assign({}, acc), x)); }, {});\n}\nexports.mergeAll = mergeAll;\n", "\"use strict\";\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.mergeDeep = void 0;\nvar purry_1 = require(\"./purry\");\nfunction mergeDeep() {\n    return (0, purry_1.purry)(mergeDeepImplementation, arguments);\n}\nexports.mergeDeep = mergeDeep;\nfunction mergeDeepImplementation(destination, source) {\n    var output = __assign(__assign({}, destination), source);\n    for (var key in source) {\n        if (!(key in destination)) {\n            continue;\n        }\n        var destinationValue = destination[key];\n        if (!isRecord(destinationValue)) {\n            continue;\n        }\n        var sourceValue = source[key];\n        if (!isRecord(sourceValue)) {\n            continue;\n        }\n        output[key] = mergeDeepImplementation(destinationValue, sourceValue);\n    }\n    return output;\n}\nfunction isRecord(object) {\n    return (typeof object === 'object' &&\n        object !== null &&\n        Object.getPrototypeOf(object) === Object.prototype);\n}\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.minBy = void 0;\nvar purry_1 = require(\"./purry\");\nvar _minBy = function (indexed) {\n    return function (array, fn) {\n        var ret = undefined;\n        var retMin = undefined;\n        array.forEach(function (item, i) {\n            var min = indexed ? fn(item, i, array) : fn(item);\n            if (retMin === undefined || min < retMin) {\n                ret = item;\n                retMin = min;\n            }\n        });\n        return ret;\n    };\n};\nfunction minBy() {\n    return (0, purry_1.purry)(_minBy(false), arguments);\n}\nexports.minBy = minBy;\n(function (minBy) {\n    function indexed() {\n        return (0, purry_1.purry)(_minBy(true), arguments);\n    }\n    minBy.indexed = indexed;\n})(minBy || (exports.minBy = minBy = {}));\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.multiply = void 0;\nvar purry_1 = require(\"./purry\");\nfunction multiply() {\n    return (0, purry_1.purry)(_multiply, arguments);\n}\nexports.multiply = multiply;\nfunction _multiply(value, multiplicand) {\n    return value * multiplicand;\n}\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.noop = void 0;\nvar noop = function () { return undefined; };\nexports.noop = noop;\n", "\"use strict\";\nvar __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n        if (ar || !(i in from)) {\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n            ar[i] = from[i];\n        }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.quickSelect = void 0;\nvar _swapInPlace_1 = require(\"./_swapInPlace\");\nvar quickSelect = function (data, index, compareFn) {\n    return index < 0 || index >= data.length\n        ?\n            undefined\n        : quickSelectImplementation(__spreadArray([], data, true), 0, data.length - 1, index, compareFn);\n};\nexports.quickSelect = quickSelect;\nfunction quickSelectImplementation(data, left, right, index, compareFn) {\n    if (left === right) {\n        return data[left];\n    }\n    var pivotIndex = partition(data, left, right, compareFn);\n    return index === pivotIndex\n        ?\n            data[index]\n        : quickSelectImplementation(data, index < pivotIndex ? left : pivotIndex + 1, index < pivotIndex ? pivotIndex - 1 : right, index, compareFn);\n}\nfunction partition(data, left, right, compareFn) {\n    var pivot = data[right];\n    var i = left;\n    for (var j = left; j < right; j++) {\n        if (compareFn(data[j], pivot) < 0) {\n            (0, _swapInPlace_1.swapInPlace)(data, i, j);\n            i++;\n        }\n    }\n    (0, _swapInPlace_1.swapInPlace)(data, i, right);\n    return i;\n}\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.nthBy = void 0;\nvar _purryOrderRules_1 = require(\"./_purryOrderRules\");\nvar _quickSelect_1 = require(\"./_quickSelect\");\nfunction nthBy() {\n    return (0, _purryOrderRules_1.purryOrderRulesWithArgument)(nthByImplementation, arguments);\n}\nexports.nthBy = nthBy;\nvar nthByImplementation = function (data, compareFn, index) {\n    return (0, _quickSelect_1.quickSelect)(data, index >= 0 ? index : data.length + index, compareFn);\n};\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.objOf = void 0;\nvar purry_1 = require(\"./purry\");\nfunction objOf() {\n    return (0, purry_1.purry)(_objOf, arguments);\n}\nexports.objOf = objOf;\nfunction _objOf(value, key) {\n    var _a;\n    return _a = {}, _a[key] = value, _a;\n}\n", "\"use strict\";\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.omit = void 0;\nvar fromPairs_1 = require(\"./fromPairs\");\nvar purry_1 = require(\"./purry\");\nfunction omit() {\n    return (0, purry_1.purry)(_omit, arguments);\n}\nexports.omit = omit;\nfunction _omit(data, propNames) {\n    if (propNames.length === 0) {\n        return __assign({}, data);\n    }\n    if (propNames.length === 1) {\n        var propName = propNames[0];\n        var _a = data, _b = propName, omitted = _a[_b], remaining = __rest(_a, [typeof _b === \"symbol\" ? _b : _b + \"\"]);\n        return remaining;\n    }\n    if (!propNames.some(function (propName) { return propName in data; })) {\n        return __assign({}, data);\n    }\n    var asSet = new Set(propNames);\n    return (0, fromPairs_1.fromPairs)(Object.entries(data).filter(function (_a) {\n        var key = _a[0];\n        return !asSet.has(key);\n    }));\n}\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.omitBy = void 0;\nvar purry_1 = require(\"./purry\");\nfunction omitBy() {\n    return (0, purry_1.purry)(_omitBy, arguments);\n}\nexports.omitBy = omitBy;\nfunction _omitBy(object, fn) {\n    return Object.keys(object).reduce(function (acc, key) {\n        if (!fn(object[key], key)) {\n            acc[key] = object[key];\n        }\n        return acc;\n    }, {});\n}\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.once = void 0;\nfunction once(fn) {\n    var called = false;\n    var ret;\n    return function () {\n        if (!called) {\n            ret = fn();\n            called = true;\n        }\n        return ret;\n    };\n}\nexports.once = once;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.only = void 0;\nvar purry_1 = require(\"./purry\");\nfunction only() {\n    return (0, purry_1.purry)(_only, arguments);\n}\nexports.only = only;\nfunction _only(array) {\n    if (array.length === 1) {\n        return array[0];\n    }\n    return undefined;\n}\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.partition = void 0;\nvar purry_1 = require(\"./purry\");\nfunction partition() {\n    return (0, purry_1.purry)(_partition(false), arguments);\n}\nexports.partition = partition;\nvar _partition = function (indexed) {\n    return function (array, fn) {\n        var ret = [[], []];\n        array.forEach(function (item, index) {\n            var matches = indexed ? fn(item, index, array) : fn(item);\n            ret[matches ? 0 : 1].push(item);\n        });\n        return ret;\n    };\n};\n(function (partition) {\n    function indexed() {\n        return (0, purry_1.purry)(_partition(true), arguments);\n    }\n    partition.indexed = indexed;\n})(partition || (exports.partition = partition = {}));\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.pathOr = void 0;\nvar purry_1 = require(\"./purry\");\nfunction pathOr() {\n    return (0, purry_1.purry)(_pathOr, arguments);\n}\nexports.pathOr = pathOr;\nfunction _pathOr(object, path, defaultValue) {\n    var current = object;\n    for (var _i = 0, path_1 = path; _i < path_1.length; _i++) {\n        var prop = path_1[_i];\n        if (current == null || current[prop] == null) {\n            return defaultValue;\n        }\n        current = current[prop];\n    }\n    return current;\n}\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.pick = void 0;\nvar purry_1 = require(\"./purry\");\nfunction pick() {\n    return (0, purry_1.purry)(_pick, arguments);\n}\nexports.pick = pick;\nfunction _pick(object, names) {\n    if (object == null) {\n        return {};\n    }\n    return names.reduce(function (acc, name) {\n        if (name in object) {\n            acc[name] = object[name];\n        }\n        return acc;\n    }, {});\n}\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.pickBy = void 0;\nvar purry_1 = require(\"./purry\");\nfunction pickBy() {\n    return (0, purry_1.purry)(_pickBy, arguments);\n}\nexports.pickBy = pickBy;\nfunction _pickBy(object, fn) {\n    if (object == null) {\n        return {};\n    }\n    return Object.keys(object).reduce(function (acc, key) {\n        if (fn(object[key], key)) {\n            acc[key] = object[key];\n        }\n        return acc;\n    }, {});\n}\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.prop = void 0;\nvar prop = function (propName) {\n    return function (_a) {\n        var _b = propName, value = _a[_b];\n        return value;\n    };\n};\nexports.prop = prop;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.range = void 0;\nvar purry_1 = require(\"./purry\");\nfunction range() {\n    return (0, purry_1.purry)(_range, arguments);\n}\nexports.range = range;\nfunction _range(start, end) {\n    var ret = [];\n    for (var i = start; i < end; i++) {\n        ret.push(i);\n    }\n    return ret;\n}\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.randomString = void 0;\nvar range_1 = require(\"./range\");\nfunction randomString(length) {\n    var characterSet = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';\n    var randomChar = function () {\n        return characterSet[Math.floor(Math.random() * characterSet.length)];\n    };\n    return (0, range_1.range)(0, length).reduce(function (text) { return text + randomChar(); }, '');\n}\nexports.randomString = randomString;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.rankBy = void 0;\nvar _purryOrderRules_1 = require(\"./_purryOrderRules\");\nfunction rankBy() {\n    return (0, _purryOrderRules_1.purryOrderRulesWithArgument)(rankByImplementation, arguments);\n}\nexports.rankBy = rankBy;\nfunction rankByImplementation(data, compareFn, targetItem) {\n    var rank = 0;\n    for (var _i = 0, data_1 = data; _i < data_1.length; _i++) {\n        var item = data_1[_i];\n        if (compareFn(targetItem, item) > 0) {\n            rank++;\n        }\n    }\n    return rank;\n}\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.reduce = void 0;\nvar purry_1 = require(\"./purry\");\nfunction reduce() {\n    return (0, purry_1.purry)(_reduce(false), arguments);\n}\nexports.reduce = reduce;\nvar _reduce = function (indexed) {\n    return function (items, fn, initialValue) {\n        return items.reduce(function (acc, item, index) {\n            return indexed ? fn(acc, item, index, items) : fn(acc, item);\n        }, initialValue);\n    };\n};\n(function (reduce) {\n    function indexed() {\n        return (0, purry_1.purry)(_reduce(true), arguments);\n    }\n    reduce.indexed = indexed;\n})(reduce || (exports.reduce = reduce = {}));\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.reject = void 0;\nvar purry_1 = require(\"./purry\");\nvar _reduceLazy_1 = require(\"./_reduceLazy\");\nvar _toLazyIndexed_1 = require(\"./_toLazyIndexed\");\nfunction reject() {\n    return (0, purry_1.purry)(_reject(false), arguments, reject.lazy);\n}\nexports.reject = reject;\nvar _reject = function (indexed) {\n    return function (array, fn) {\n        return (0, _reduceLazy_1._reduceLazy)(array, indexed ? reject.lazyIndexed(fn) : reject.lazy(fn), indexed);\n    };\n};\nvar _lazy = function (indexed) {\n    return function (fn) {\n        return function (value, index, array) {\n            var valid = indexed ? fn(value, index, array) : fn(value);\n            if (!valid) {\n                return {\n                    done: false,\n                    hasNext: true,\n                    next: value,\n                };\n            }\n            return {\n                done: false,\n                hasNext: false,\n            };\n        };\n    };\n};\n(function (reject) {\n    function indexed() {\n        return (0, purry_1.purry)(_reject(true), arguments, reject.lazyIndexed);\n    }\n    reject.indexed = indexed;\n    reject.lazy = _lazy(false);\n    reject.lazyIndexed = (0, _toLazyIndexed_1._toLazyIndexed)(_lazy(true));\n})(reject || (exports.reject = reject = {}));\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.reverse = void 0;\nvar purry_1 = require(\"./purry\");\nfunction reverse() {\n    return (0, purry_1.purry)(_reverse, arguments);\n}\nexports.reverse = reverse;\nfunction _reverse(array) {\n    return array.slice().reverse();\n}\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.round = void 0;\nvar _withPrecision_1 = require(\"./_withPrecision\");\nvar purry_1 = require(\"./purry\");\nfunction round() {\n    return (0, purry_1.purry)((0, _withPrecision_1._withPrecision)(Math.round), arguments);\n}\nexports.round = round;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.sample = void 0;\nvar purry_1 = require(\"./purry\");\nfunction sample() {\n    var args = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n    }\n    return (0, purry_1.purry)(sampleImplementation, args);\n}\nexports.sample = sample;\nfunction sampleImplementation(data, sampleSize) {\n    if (sampleSize < 0) {\n        throw new RangeError(\"sampleSize must cannot be negative: \".concat(sampleSize));\n    }\n    if (!Number.isInteger(sampleSize)) {\n        throw new TypeError(\"sampleSize must be an integer: \".concat(sampleSize));\n    }\n    if (sampleSize >= data.length) {\n        return data;\n    }\n    if (sampleSize === 0) {\n        return [];\n    }\n    var actualSampleSize = Math.min(sampleSize, data.length - sampleSize);\n    var sampleIndices = new Set();\n    while (sampleIndices.size < actualSampleSize) {\n        var randomIndex = Math.floor(Math.random() * data.length);\n        sampleIndices.add(randomIndex);\n    }\n    if (sampleSize === actualSampleSize) {\n        return Array.from(sampleIndices)\n            .sort(function (a, b) { return a - b; })\n            .map(function (index) { return data[index]; });\n    }\n    return data.filter(function (_, index) { return !sampleIndices.has(index); });\n}\n", "\"use strict\";\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.set = void 0;\nvar purry_1 = require(\"./purry\");\nfunction set() {\n    return (0, purry_1.purry)(_set, arguments);\n}\nexports.set = set;\nfunction _set(obj, prop, value) {\n    var _a;\n    return __assign(__assign({}, obj), (_a = {}, _a[prop] = value, _a));\n}\n", "\"use strict\";\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports._setPath = exports.setPath = void 0;\nvar purry_1 = require(\"./purry\");\nfunction setPath() {\n    return (0, purry_1.purry)(_setPath, arguments);\n}\nexports.setPath = setPath;\nfunction _setPath(object, path, value) {\n    var _a;\n    if (path.length === 0)\n        return value;\n    if (Array.isArray(object)) {\n        return object.map(function (item, index) {\n            if (index === path[0]) {\n                return _setPath(item, path.slice(1), value);\n            }\n            return item;\n        });\n    }\n    return __assign(__assign({}, object), (_a = {}, _a[path[0]] = _setPath(object[path[0]], path.slice(1), value), _a));\n}\nexports._setPath = _setPath;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.shuffle = void 0;\nvar purry_1 = require(\"./purry\");\nfunction shuffle() {\n    return (0, purry_1.purry)(_shuffle, arguments);\n}\nexports.shuffle = shuffle;\nfunction _shuffle(items) {\n    var result = items.slice();\n    for (var index = 0; index < items.length; index += 1) {\n        var rand = index + Math.floor(Math.random() * (items.length - index));\n        var value = result[rand];\n        result[rand] = result[index];\n        result[index] = value;\n    }\n    return result;\n}\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.sliceString = void 0;\nvar sliceString = function (indexStart, indexEnd) {\n    return function (data) {\n        return data.slice(indexStart, indexEnd);\n    };\n};\nexports.sliceString = sliceString;\n", "\"use strict\";\nvar __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n        if (ar || !(i in from)) {\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n            ar[i] = from[i];\n        }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.sort = void 0;\nvar purry_1 = require(\"./purry\");\nfunction sort() {\n    return (0, purry_1.purry)(_sort, arguments);\n}\nexports.sort = sort;\nfunction _sort(items, cmp) {\n    var ret = __spreadArray([], items, true);\n    ret.sort(cmp);\n    return ret;\n}\n(function (sort) {\n    sort.strict = sort;\n})(sort || (exports.sort = sort = {}));\n", "\"use strict\";\nvar __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n        if (ar || !(i in from)) {\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n            ar[i] = from[i];\n        }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.sortBy = void 0;\nvar _purryOrderRules_1 = require(\"./_purryOrderRules\");\nfunction sortBy() {\n    return (0, _purryOrderRules_1.purryOrderRules)(_sortBy, arguments);\n}\nexports.sortBy = sortBy;\nvar _sortBy = function (data, compareFn) {\n    return __spreadArray([], data, true).sort(compareFn);\n};\n(function (sortBy) {\n    sortBy.strict = sortBy;\n})(sortBy || (exports.sortBy = sortBy = {}));\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports._binarySearchCutoffIndex = void 0;\nfunction _binarySearchCutoffIndex(array, predicate) {\n    var lowIndex = 0;\n    var highIndex = array.length;\n    while (lowIndex < highIndex) {\n        var pivotIndex = (lowIndex + highIndex) >>> 1;\n        var pivot = array[pivotIndex];\n        if (predicate(pivot, pivotIndex)) {\n            lowIndex = pivotIndex + 1;\n        }\n        else {\n            highIndex = pivotIndex;\n        }\n    }\n    return highIndex;\n}\nexports._binarySearchCutoffIndex = _binarySearchCutoffIndex;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.sortedIndex = void 0;\nvar purry_1 = require(\"./purry\");\nvar _binarySearchCutoffIndex_1 = require(\"./_binarySearchCutoffIndex\");\nfunction sortedIndex() {\n    return (0, purry_1.purry)(sortedIndexImplementation, arguments);\n}\nexports.sortedIndex = sortedIndex;\nvar sortedIndexImplementation = function (array, item) { return (0, _binarySearchCutoffIndex_1._binarySearchCutoffIndex)(array, function (pivot) { return pivot < item; }); };\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.sortedIndexBy = void 0;\nvar purry_1 = require(\"./purry\");\nvar _binarySearchCutoffIndex_1 = require(\"./_binarySearchCutoffIndex\");\nfunction sortedIndexBy() {\n    return (0, purry_1.purry)(sortedIndexByImplementation, arguments);\n}\nexports.sortedIndexBy = sortedIndexBy;\n(function (sortedIndexBy) {\n    function indexed() {\n        return (0, purry_1.purry)(sortedIndexByImplementation, arguments);\n    }\n    sortedIndexBy.indexed = indexed;\n})(sortedIndexBy || (exports.sortedIndexBy = sortedIndexBy = {}));\nfunction sortedIndexByImplementation(array, item, valueFunction) {\n    var value = valueFunction(item);\n    return (0, _binarySearchCutoffIndex_1._binarySearchCutoffIndex)(array, function (pivot, index) { return valueFunction(pivot, index) < value; });\n}\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.sortedIndexWith = void 0;\nvar purry_1 = require(\"./purry\");\nvar _binarySearchCutoffIndex_1 = require(\"./_binarySearchCutoffIndex\");\nfunction sortedIndexWith() {\n    return (0, purry_1.purry)(_binarySearchCutoffIndex_1._binarySearchCutoffIndex, arguments);\n}\nexports.sortedIndexWith = sortedIndexWith;\n(function (sortedIndexWith) {\n    function indexed() {\n        return (0, purry_1.purry)(_binarySearchCutoffIndex_1._binarySearchCutoffIndex, arguments);\n    }\n    sortedIndexWith.indexed = indexed;\n})(sortedIndexWith || (exports.sortedIndexWith = sortedIndexWith = {}));\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.sortedLastIndex = void 0;\nvar purry_1 = require(\"./purry\");\nvar _binarySearchCutoffIndex_1 = require(\"./_binarySearchCutoffIndex\");\nfunction sortedLastIndex() {\n    return (0, purry_1.purry)(sortedLastIndexImplementation, arguments);\n}\nexports.sortedLastIndex = sortedLastIndex;\nvar sortedLastIndexImplementation = function (array, item) {\n    return (0, _binarySearchCutoffIndex_1._binarySearchCutoffIndex)(array, function (pivot) { return pivot <= item; });\n};\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.sortedLastIndexBy = void 0;\nvar purry_1 = require(\"./purry\");\nvar _binarySearchCutoffIndex_1 = require(\"./_binarySearchCutoffIndex\");\nfunction sortedLastIndexBy() {\n    return (0, purry_1.purry)(sortedLastIndexByImplementation, arguments);\n}\nexports.sortedLastIndexBy = sortedLastIndexBy;\n(function (sortedLastIndexBy) {\n    function indexed() {\n        return (0, purry_1.purry)(sortedLastIndexByImplementation, arguments);\n    }\n    sortedLastIndexBy.indexed = indexed;\n})(sortedLastIndexBy || (exports.sortedLastIndexBy = sortedLastIndexBy = {}));\nfunction sortedLastIndexByImplementation(array, item, valueFunction) {\n    var value = valueFunction(item);\n    return (0, _binarySearchCutoffIndex_1._binarySearchCutoffIndex)(array, function (pivot, index) { return valueFunction(pivot, index) <= value; });\n}\n", "\"use strict\";\nvar __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n        if (ar || !(i in from)) {\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n            ar[i] = from[i];\n        }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.splice = void 0;\nvar purry_1 = require(\"./purry\");\nfunction splice() {\n    return (0, purry_1.purry)(_splice, arguments);\n}\nexports.splice = splice;\nfunction _splice(items, start, deleteCount, replacement) {\n    var result = __spreadArray([], items, true);\n    result.splice.apply(result, __spreadArray([start, deleteCount], replacement, false));\n    return result;\n}\n", "\"use strict\";\nvar __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n        if (ar || !(i in from)) {\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n            ar[i] = from[i];\n        }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.splitAt = void 0;\nvar purry_1 = require(\"./purry\");\nfunction splitAt() {\n    return (0, purry_1.purry)(_splitAt, arguments);\n}\nexports.splitAt = splitAt;\nfunction _splitAt(array, index) {\n    var copy = __spreadArray([], array, true);\n    var tail = copy.splice(index);\n    return [copy, tail];\n}\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.splitWhen = void 0;\nvar splitAt_1 = require(\"./splitAt\");\nvar purry_1 = require(\"./purry\");\nfunction splitWhen() {\n    return (0, purry_1.purry)(_splitWhen, arguments);\n}\nexports.splitWhen = splitWhen;\nfunction _splitWhen(array, fn) {\n    for (var i = 0; i < array.length; i++) {\n        if (fn(array[i])) {\n            return (0, splitAt_1.splitAt)(array, i);\n        }\n    }\n    return [array, []];\n}\n", "\"use strict\";\nvar __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n        if (ar || !(i in from)) {\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n            ar[i] = from[i];\n        }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.stringToPath = void 0;\nfunction stringToPath(path) {\n    return _stringToPath(path);\n}\nexports.stringToPath = stringToPath;\nfunction _stringToPath(path) {\n    var _a;\n    if (path.length === 0)\n        return [];\n    var match = (_a = path.match(/^\\[(.+?)\\](.*)$/)) !== null && _a !== void 0 ? _a : path.match(/^\\.?([^.[\\]]+)(.*)$/);\n    if (match) {\n        var key = match[1], rest = match[2];\n        return __spreadArray([key], _stringToPath(rest), true);\n    }\n    return [path];\n}\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.subtract = void 0;\nvar purry_1 = require(\"./purry\");\nfunction subtract() {\n    return (0, purry_1.purry)(_subtract, arguments);\n}\nexports.subtract = subtract;\nfunction _subtract(value, subtrahend) {\n    return value - subtrahend;\n}\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.sumBy = void 0;\nvar purry_1 = require(\"./purry\");\nvar _sumBy = function (indexed) {\n    return function (array, fn) {\n        var sum = 0;\n        array.forEach(function (item, i) {\n            var summand = indexed ? fn(item, i, array) : fn(item);\n            sum += summand;\n        });\n        return sum;\n    };\n};\nfunction sumBy() {\n    return (0, purry_1.purry)(_sumBy(false), arguments);\n}\nexports.sumBy = sumBy;\n(function (sumBy) {\n    function indexed() {\n        return (0, purry_1.purry)(_sumBy(true), arguments);\n    }\n    sumBy.indexed = indexed;\n})(sumBy || (exports.sumBy = sumBy = {}));\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.swapIndices = void 0;\nvar purry_1 = require(\"./purry\");\nfunction swapIndices() {\n    return (0, purry_1.purry)(_swapIndices, arguments);\n}\nexports.swapIndices = swapIndices;\nfunction _swapIndices(item, index1, index2) {\n    return typeof item === 'string'\n        ? _swapString(item, index1, index2)\n        : _swapArray(item, index1, index2);\n}\nfunction _swapArray(item, index1, index2) {\n    var result = item.slice();\n    if (isNaN(index1) || isNaN(index2)) {\n        return result;\n    }\n    var positiveIndexA = index1 < 0 ? item.length + index1 : index1;\n    var positiveIndexB = index2 < 0 ? item.length + index2 : index2;\n    if (positiveIndexA < 0 || positiveIndexA > item.length) {\n        return result;\n    }\n    if (positiveIndexB < 0 || positiveIndexB > item.length) {\n        return result;\n    }\n    result[positiveIndexA] = item[positiveIndexB];\n    result[positiveIndexB] = item[positiveIndexA];\n    return result;\n}\nfunction _swapString(item, index1, index2) {\n    var result = _swapArray(item.split(''), index1, index2);\n    return result.join('');\n}\n", "\"use strict\";\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.swapProps = void 0;\nvar purry_1 = require(\"./purry\");\nfunction swapProps() {\n    return (0, purry_1.purry)(_swapProps, arguments);\n}\nexports.swapProps = swapProps;\nfunction _swapProps(obj, key1, key2) {\n    var _a;\n    var _b = obj, _c = key1, value1 = _b[_c], _d = key2, value2 = _b[_d];\n    return __assign(__assign({}, obj), (_a = {}, _a[key1] = value2, _a[key2] = value1, _a));\n}\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.take = void 0;\nvar purry_1 = require(\"./purry\");\nvar _reduceLazy_1 = require(\"./_reduceLazy\");\nfunction take() {\n    return (0, purry_1.purry)(_take, arguments, take.lazy);\n}\nexports.take = take;\nfunction _take(array, n) {\n    return (0, _reduceLazy_1._reduceLazy)(array, take.lazy(n));\n}\n(function (take) {\n    function lazy(n) {\n        return function (value) {\n            if (n === 0) {\n                return {\n                    done: true,\n                    hasNext: false,\n                };\n            }\n            n--;\n            if (n === 0) {\n                return {\n                    done: true,\n                    hasNext: true,\n                    next: value,\n                };\n            }\n            return {\n                done: false,\n                hasNext: true,\n                next: value,\n            };\n        };\n    }\n    take.lazy = lazy;\n})(take || (exports.take = take = {}));\n", "\"use strict\";\nvar __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n        if (ar || !(i in from)) {\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n            ar[i] = from[i];\n        }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.takeFirstBy = void 0;\nvar _heap_1 = require(\"./_heap\");\nvar _purryOrderRules_1 = require(\"./_purryOrderRules\");\nfunction takeFirstBy() {\n    return (0, _purryOrderRules_1.purryOrderRulesWithArgument)(takeFirstByImplementation, arguments);\n}\nexports.takeFirstBy = takeFirstBy;\nfunction takeFirstByImplementation(data, compareFn, n) {\n    if (n <= 0) {\n        return [];\n    }\n    if (n >= data.length) {\n        return __spreadArray([], data, true);\n    }\n    var heap = data.slice(0, n);\n    (0, _heap_1.heapify)(heap, compareFn);\n    var rest = data.slice(n);\n    for (var _i = 0, rest_1 = rest; _i < rest_1.length; _i++) {\n        var item = rest_1[_i];\n        (0, _heap_1.heapMaybeInsert)(heap, compareFn, item);\n    }\n    return heap;\n}\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.takeLastWhile = void 0;\nvar purry_1 = require(\"./purry\");\nfunction takeLastWhile() {\n    return (0, purry_1.purry)(_takeLastWhile, arguments);\n}\nexports.takeLastWhile = takeLastWhile;\nfunction _takeLastWhile(data, predicate) {\n    for (var i = data.length - 1; i >= 0; i--) {\n        if (!predicate(data[i])) {\n            return data.slice(i + 1);\n        }\n    }\n    return data.slice();\n}\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.takeWhile = void 0;\nvar purry_1 = require(\"./purry\");\nfunction takeWhile() {\n    return (0, purry_1.purry)(_takeWhile, arguments);\n}\nexports.takeWhile = takeWhile;\nfunction _takeWhile(array, fn) {\n    var ret = [];\n    for (var _i = 0, array_1 = array; _i < array_1.length; _i++) {\n        var item = array_1[_i];\n        if (!fn(item)) {\n            break;\n        }\n        ret.push(item);\n    }\n    return ret;\n}\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.tap = void 0;\nvar purry_1 = require(\"./purry\");\nfunction tap() {\n    return (0, purry_1.purry)(_tap, arguments);\n}\nexports.tap = tap;\nfunction _tap(value, fn) {\n    fn(value);\n    return value;\n}\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.times = void 0;\nvar purry_1 = require(\"./purry\");\nfunction times() {\n    return (0, purry_1.purry)(_times, arguments);\n}\nexports.times = times;\nfunction _times(count, fn) {\n    if (count < 0) {\n        throw new RangeError('n must be a non-negative number');\n    }\n    var res = [];\n    for (var i = 0; i < count; i++) {\n        res.push(fn(i));\n    }\n    return res;\n}\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.uniq = void 0;\nvar purry_1 = require(\"./purry\");\nvar _reduceLazy_1 = require(\"./_reduceLazy\");\nfunction uniq() {\n    return (0, purry_1.purry)(_uniq, arguments, uniq.lazy);\n}\nexports.uniq = uniq;\nfunction _uniq(array) {\n    return (0, _reduceLazy_1._reduceLazy)(array, uniq.lazy());\n}\n(function (uniq) {\n    function lazy() {\n        var set = new Set();\n        return function (value) {\n            if (set.has(value)) {\n                return {\n                    done: false,\n                    hasNext: false,\n                };\n            }\n            set.add(value);\n            return {\n                done: false,\n                hasNext: true,\n                next: value,\n            };\n        };\n    }\n    uniq.lazy = lazy;\n})(uniq || (exports.uniq = uniq = {}));\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.uniqBy = void 0;\nvar purry_1 = require(\"./purry\");\nvar _reduceLazy_1 = require(\"./_reduceLazy\");\nfunction uniqBy() {\n    return (0, purry_1.purry)(_uniqBy, arguments, lazyUniqBy);\n}\nexports.uniqBy = uniqBy;\nfunction _uniqBy(array, transformer) {\n    return (0, _reduceLazy_1._reduceLazy)(array, lazyUniqBy(transformer));\n}\nfunction lazyUniqBy(transformer) {\n    var set = new Set();\n    return function (value) {\n        var appliedItem = transformer(value);\n        if (set.has(appliedItem)) {\n            return {\n                done: false,\n                hasNext: false,\n            };\n        }\n        set.add(appliedItem);\n        return {\n            done: false,\n            hasNext: true,\n            next: value,\n        };\n    };\n}\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.uniqWith = void 0;\nvar purry_1 = require(\"./purry\");\nvar _reduceLazy_1 = require(\"./_reduceLazy\");\nvar _toLazyIndexed_1 = require(\"./_toLazyIndexed\");\nfunction uniqWith() {\n    return (0, purry_1.purry)(_uniqWith, arguments, uniqWith.lazy);\n}\nexports.uniqWith = uniqWith;\nfunction _uniqWith(array, isEquals) {\n    var lazy = uniqWith.lazy(isEquals);\n    return (0, _reduceLazy_1._reduceLazy)(array, lazy, true);\n}\nfunction _lazy(isEquals) {\n    return function (value, index, array) {\n        if (array &&\n            array.findIndex(function (otherValue) { return isEquals(value, otherValue); }) === index) {\n            return {\n                done: false,\n                hasNext: true,\n                next: value,\n            };\n        }\n        return {\n            done: false,\n            hasNext: false,\n        };\n    };\n}\n(function (uniqWith) {\n    uniqWith.lazy = (0, _toLazyIndexed_1._toLazyIndexed)(_lazy);\n})(uniqWith || (exports.uniqWith = uniqWith = {}));\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.values = void 0;\nfunction values(source) {\n    return Object.values(source);\n}\nexports.values = values;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.zip = void 0;\nvar purry_1 = require(\"./purry\");\nfunction zip() {\n    return (0, purry_1.purry)(_zip, arguments);\n}\nexports.zip = zip;\nfunction _zip(first, second) {\n    var resultLength = first.length > second.length ? second.length : first.length;\n    var result = [];\n    for (var i = 0; i < resultLength; i++) {\n        result.push([first[i], second[i]]);\n    }\n    return result;\n}\n(function (zip) {\n    zip.strict = zip;\n})(zip || (exports.zip = zip = {}));\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.zipObj = void 0;\nvar purry_1 = require(\"./purry\");\nfunction zipObj() {\n    return (0, purry_1.purry)(_zipObj, arguments);\n}\nexports.zipObj = zipObj;\nfunction _zipObj(first, second) {\n    var resultLength = first.length > second.length ? second.length : first.length;\n    var result = {};\n    for (var i = 0; i < resultLength; i++) {\n        result[first[i]] = second[i];\n    }\n    return result;\n}\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.zipWith = void 0;\nfunction zipWith() {\n    var args = Array.from(arguments);\n    if (typeof args[0] === 'function' && args.length === 1) {\n        return function (f, s) {\n            return _zipWith(f, s, args[0]);\n        };\n    }\n    if (typeof args[0] === 'function' && args.length === 2) {\n        return function (f) {\n            return _zipWith(f, args[1], args[0]);\n        };\n    }\n    if (args.length === 3) {\n        return _zipWith(args[0], args[1], args[2]);\n    }\n}\nexports.zipWith = zipWith;\nfunction _zipWith(first, second, fn) {\n    var resultLength = first.length > second.length ? second.length : first.length;\n    var result = [];\n    for (var i = 0; i < resultLength; i++) {\n        result.push(fn(first[i], second[i]));\n    }\n    return result;\n}\n", "\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __exportStar = (this && this.__exportStar) || function(m, exports) {\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(exports, p)) __createBinding(exports, m, p);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\n__exportStar(require(\"./add\"), exports);\n__exportStar(require(\"./addProp\"), exports);\n__exportStar(require(\"./allPass\"), exports);\n__exportStar(require(\"./anyPass\"), exports);\n__exportStar(require(\"./ceil\"), exports);\n__exportStar(require(\"./chunk\"), exports);\n__exportStar(require(\"./clamp\"), exports);\n__exportStar(require(\"./clone\"), exports);\n__exportStar(require(\"./compact\"), exports);\n__exportStar(require(\"./concat\"), exports);\n__exportStar(require(\"./conditional\"), exports);\n__exportStar(require(\"./countBy\"), exports);\n__exportStar(require(\"./createPipe\"), exports);\n__exportStar(require(\"./debounce\"), exports);\n__exportStar(require(\"./difference\"), exports);\n__exportStar(require(\"./differenceWith\"), exports);\n__exportStar(require(\"./divide\"), exports);\n__exportStar(require(\"./drop\"), exports);\n__exportStar(require(\"./dropFirstBy\"), exports);\n__exportStar(require(\"./dropLast\"), exports);\n__exportStar(require(\"./dropLastWhile\"), exports);\n__exportStar(require(\"./dropWhile\"), exports);\n__exportStar(require(\"./equals\"), exports);\n__exportStar(require(\"./evolve\"), exports);\n__exportStar(require(\"./filter\"), exports);\n__exportStar(require(\"./find\"), exports);\n__exportStar(require(\"./findIndex\"), exports);\n__exportStar(require(\"./findLast\"), exports);\n__exportStar(require(\"./findLastIndex\"), exports);\n__exportStar(require(\"./first\"), exports);\n__exportStar(require(\"./firstBy\"), exports);\n__exportStar(require(\"./flatMap\"), exports);\n__exportStar(require(\"./flatMapToObj\"), exports);\n__exportStar(require(\"./flatten\"), exports);\n__exportStar(require(\"./flattenDeep\"), exports);\n__exportStar(require(\"./floor\"), exports);\n__exportStar(require(\"./forEach\"), exports);\n__exportStar(require(\"./forEachObj\"), exports);\n__exportStar(require(\"./fromPairs\"), exports);\n__exportStar(require(\"./groupBy\"), exports);\n__exportStar(require(\"./hasAtLeast\"), exports);\n__exportStar(require(\"./identity\"), exports);\n__exportStar(require(\"./indexBy\"), exports);\n__exportStar(require(\"./intersection\"), exports);\n__exportStar(require(\"./intersectionWith\"), exports);\n__exportStar(require(\"./invert\"), exports);\n__exportStar(require(\"./isArray\"), exports);\n__exportStar(require(\"./isBoolean\"), exports);\n__exportStar(require(\"./isDate\"), exports);\n__exportStar(require(\"./isDefined\"), exports);\n__exportStar(require(\"./isEmpty\"), exports);\n__exportStar(require(\"./isError\"), exports);\n__exportStar(require(\"./isFunction\"), exports);\n__exportStar(require(\"./isNil\"), exports);\n__exportStar(require(\"./isNonNull\"), exports);\n__exportStar(require(\"./isNot\"), exports);\n__exportStar(require(\"./isNumber\"), exports);\n__exportStar(require(\"./isObject\"), exports);\n__exportStar(require(\"./isObjectType\"), exports);\n__exportStar(require(\"./isPlainObject\"), exports);\n__exportStar(require(\"./isPromise\"), exports);\n__exportStar(require(\"./isString\"), exports);\n__exportStar(require(\"./isSymbol\"), exports);\n__exportStar(require(\"./isTruthy\"), exports);\n__exportStar(require(\"./join\"), exports);\n__exportStar(require(\"./keys\"), exports);\n__exportStar(require(\"./last\"), exports);\n__exportStar(require(\"./length\"), exports);\n__exportStar(require(\"./map\"), exports);\n__exportStar(require(\"./mapKeys\"), exports);\n__exportStar(require(\"./mapToObj\"), exports);\n__exportStar(require(\"./mapValues\"), exports);\n__exportStar(require(\"./maxBy\"), exports);\n__exportStar(require(\"./meanBy\"), exports);\n__exportStar(require(\"./merge\"), exports);\n__exportStar(require(\"./mergeAll\"), exports);\n__exportStar(require(\"./mergeDeep\"), exports);\n__exportStar(require(\"./minBy\"), exports);\n__exportStar(require(\"./multiply\"), exports);\n__exportStar(require(\"./noop\"), exports);\n__exportStar(require(\"./nthBy\"), exports);\n__exportStar(require(\"./objOf\"), exports);\n__exportStar(require(\"./omit\"), exports);\n__exportStar(require(\"./omitBy\"), exports);\n__exportStar(require(\"./once\"), exports);\n__exportStar(require(\"./only\"), exports);\n__exportStar(require(\"./partition\"), exports);\n__exportStar(require(\"./pathOr\"), exports);\n__exportStar(require(\"./pick\"), exports);\n__exportStar(require(\"./pickBy\"), exports);\n__exportStar(require(\"./pipe\"), exports);\n__exportStar(require(\"./prop\"), exports);\n__exportStar(require(\"./purry\"), exports);\n__exportStar(require(\"./randomString\"), exports);\n__exportStar(require(\"./range\"), exports);\n__exportStar(require(\"./rankBy\"), exports);\n__exportStar(require(\"./reduce\"), exports);\n__exportStar(require(\"./reject\"), exports);\n__exportStar(require(\"./reverse\"), exports);\n__exportStar(require(\"./round\"), exports);\n__exportStar(require(\"./sample\"), exports);\n__exportStar(require(\"./set\"), exports);\n__exportStar(require(\"./setPath\"), exports);\n__exportStar(require(\"./shuffle\"), exports);\n__exportStar(require(\"./sliceString\"), exports);\n__exportStar(require(\"./sort\"), exports);\n__exportStar(require(\"./sortBy\"), exports);\n__exportStar(require(\"./sortedIndex\"), exports);\n__exportStar(require(\"./sortedIndexBy\"), exports);\n__exportStar(require(\"./sortedIndexWith\"), exports);\n__exportStar(require(\"./sortedLastIndex\"), exports);\n__exportStar(require(\"./sortedLastIndexBy\"), exports);\n__exportStar(require(\"./splice\"), exports);\n__exportStar(require(\"./splitAt\"), exports);\n__exportStar(require(\"./splitWhen\"), exports);\n__exportStar(require(\"./stringToPath\"), exports);\n__exportStar(require(\"./subtract\"), exports);\n__exportStar(require(\"./sumBy\"), exports);\n__exportStar(require(\"./swapIndices\"), exports);\n__exportStar(require(\"./swapProps\"), exports);\n__exportStar(require(\"./take\"), exports);\n__exportStar(require(\"./takeFirstBy\"), exports);\n__exportStar(require(\"./takeLastWhile\"), exports);\n__exportStar(require(\"./takeWhile\"), exports);\n__exportStar(require(\"./tap\"), exports);\n__exportStar(require(\"./times\"), exports);\n__exportStar(require(\"./toPairs\"), exports);\n__exportStar(require(\"./type\"), exports);\n__exportStar(require(\"./uniq\"), exports);\n__exportStar(require(\"./uniqBy\"), exports);\n__exportStar(require(\"./uniqWith\"), exports);\n__exportStar(require(\"./values\"), exports);\n__exportStar(require(\"./zip\"), exports);\n__exportStar(require(\"./zipObj\"), exports);\n__exportStar(require(\"./zipWith\"), exports);\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.isPlayedActor = exports.isOwner = exports.getOwner = exports.getHighestName = void 0;\nfunction isPlayedActor(actor) {\n    return !!actor?.id && !actor.pack && game.actors.has(actor.id);\n}\nexports.isPlayedActor = isPlayedActor;\nfunction getHighestName(actor) {\n    return actor.token?.name ?? actor.prototypeToken?.name ?? actor.name;\n}\nexports.getHighestName = getHighestName;\nfunction getOwner(actor) {\n    const isValidUser = (user) => user.active && !user.isGM;\n    let owners = game.users.filter((user) => isValidUser(user) && user.character === actor);\n    if (!owners.length) {\n        owners = game.users.filter((user) => isValidUser(user) && actor.testUserPermission(user, \"OWNER\"));\n    }\n    owners.sort((a, b) => (a.id > b.id ? 1 : -1));\n    return owners[0] || null;\n}\nexports.getOwner = getOwner;\nfunction isOwner(actor) {\n    return getOwner(actor) === game.user;\n}\nexports.isOwner = isOwner;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.renderApplication = exports.canRender = exports.refreshApplication = exports.openApplication = void 0;\nfunction openApplication(constructor, ...args) {\n    const id = args.at(-1).id;\n    const app = Object.values(ui.windows).find((a) => a instanceof constructor && a.id === id);\n    if (app) {\n        app.bringToTop();\n        return app;\n    }\n    return new constructor(...args).render(true);\n}\nexports.openApplication = openApplication;\nfunction refreshApplication(app) {\n    app.setPosition({ height: \"auto\" });\n}\nexports.refreshApplication = refreshApplication;\nfunction canRender(app, force) {\n    return force || app._state <= Application.RENDER_STATES.NONE;\n}\nexports.canRender = canRender;\nfunction renderApplication(id) {\n    const app = Object.values(ui.windows).find((app) => app.id === id);\n    app?.render();\n}\nexports.renderApplication = renderApplication;\n", "\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.getOnly = exports.compareArrays = exports.arrayIncludesOne = void 0;\nconst R = __importStar(require(\"remeda\"));\nfunction arrayIncludesOne(array, other) {\n    return other.some((value) => array.includes(value));\n}\nexports.arrayIncludesOne = arrayIncludesOne;\nfunction compareArrays(arr1, arr2, unique = false) {\n    arr1 = unique ? R.compact(arr1) : arr1;\n    arr2 = unique ? R.compact(arr2) : arr2.slice();\n    if (arr1.length !== arr2.length)\n        return false;\n    for (const value1 of arr1) {\n        const index = arr2.findIndex((value2) => value1 === value2);\n        if (index === -1)\n            return false;\n        arr2.splice(index, 1);\n    }\n    return true;\n}\nexports.compareArrays = compareArrays;\nfunction getOnly(collection, condition) {\n    if (!collection)\n        return;\n    const isArray = Array.isArray(collection);\n    if ((isArray && collection.length !== 1) || (!isArray && collection.size !== 1))\n        return;\n    const value = isArray ? collection[0] : collection.first();\n    if (!value)\n        return;\n    return ((!condition || condition(value)) && value) || undefined;\n}\nexports.getOnly = getOnly;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.getDropTarget = void 0;\nfunction getDropTarget(canvas, data, filter) {\n    return [...canvas.tokens.placeables]\n        .sort((a, b) => b.document.sort - a.document.sort)\n        .find((token) => {\n        if (filter && !filter(token))\n            return false;\n        const maximumX = token.x + (token.hitArea?.right ?? 0);\n        const maximumY = token.y + (token.hitArea?.bottom ?? 0);\n        return (data.x >= token.x && data.y >= token.y && data.x <= maximumX && data.y <= maximumY);\n    });\n}\nexports.getDropTarget = getDropTarget;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.latestChatMessages = exports.refreshLatestMessages = exports.createChatLink = void 0;\nfunction createChatLink(docOrUuid, { label, html } = {}) {\n    const isDocument = docOrUuid instanceof foundry.abstract.Document;\n    if (!label && isDocument) {\n        label = docOrUuid.name;\n    }\n    let link = `@UUID[${isDocument ? docOrUuid.uuid : docOrUuid}]`;\n    if (label) {\n        link = `${link}{${label}}`;\n    }\n    return html ? TextEditor.enrichHTML(link) : link;\n}\nexports.createChatLink = createChatLink;\nfunction* latestChatMessages(nb, fromMessage) {\n    const chat = ui.chat?.element;\n    if (!chat)\n        return;\n    const messages = game.messages.contents;\n    const start = (fromMessage ? messages.findLastIndex((m) => m === fromMessage) : messages.length) - 1;\n    for (let i = start; i >= start - nb; i--) {\n        const message = messages[i];\n        if (!message)\n            return;\n        const li = chat.find(`[data-message-id=${message.id}]`);\n        if (!li.length)\n            continue;\n        yield { message, li };\n    }\n}\nexports.latestChatMessages = latestChatMessages;\nasync function refreshLatestMessages(nb) {\n    for (const { message, li } of latestChatMessages(20)) {\n        const html = await message.getHTML();\n        li.replaceWith(html);\n    }\n}\nexports.refreshLatestMessages = refreshLatestMessages;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.createTimeout = void 0;\nfunction createTimeout(callback, delay = 1) {\n    let timeoutId = null;\n    const cancel = () => {\n        if (timeoutId === null)\n            return;\n        clearTimeout(timeoutId);\n        timeoutId = null;\n    };\n    const fn = (...args) => {\n        if (timeoutId !== null) {\n            cancel();\n        }\n        if (delay < 1) {\n            callback(...args);\n        }\n        else {\n            timeoutId = setTimeout(callback, delay, ...args);\n        }\n    };\n    Object.defineProperty(fn, \"start\", {\n        value: (delay, ...args) => {\n            if (timeoutId !== null) {\n                cancel();\n            }\n            if (delay < 1) {\n                callback(...args);\n            }\n            else {\n                timeoutId = setTimeout(callback, delay, ...args);\n            }\n        },\n        enumerable: false,\n        configurable: false,\n    });\n    Object.defineProperty(fn, \"cancel\", {\n        value: cancel,\n        enumerable: false,\n        configurable: false,\n    });\n    return fn;\n}\nexports.createTimeout = createTimeout;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.waitDialog = void 0;\nconst _1 = require(\".\");\nasync function waitDialog(options) {\n    const yesIcon = options.yes.icon ?? \"fa-solid fa-check\";\n    const noIcon = options.no.icon ?? \"fa-solid fa-xmark\";\n    const buttons = {\n        yes: {\n            icon: `<i class='${yesIcon}'></i>`,\n            label: options.yes.label,\n            callback: options.yes.callback,\n        },\n        no: {\n            icon: `<i class='${noIcon}'></i>`,\n            label: options.no.label,\n            callback: options.no.callback ?? (() => null),\n        },\n    };\n    const content = await (0, _1.render)(options.template, options.data);\n    return Dialog.wait({\n        title: options.title,\n        content,\n        buttons,\n        default: options.default ?? \"yes\",\n        close: () => null,\n    }, {\n        id: options.id,\n    });\n}\nexports.waitDialog = waitDialog;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.getSortBounds = exports.getSourceIdCondition = exports.getSourceId = void 0;\nfunction getSourceId(doc) {\n    return doc.getFlag(\"core\", \"sourceId\");\n}\nexports.getSourceId = getSourceId;\nfunction includesSourceId(doc, list) {\n    const sourceId = getSourceId(doc);\n    return sourceId ? list.includes(sourceId) : false;\n}\nfunction getSourceIdCondition(sourceId) {\n    return Array.isArray(sourceId)\n        ? (item) => includesSourceId(item, sourceId)\n        : (item) => getSourceId(item) === sourceId;\n}\nexports.getSourceIdCondition = getSourceIdCondition;\nfunction getSortBounds(collection) {\n    let min = 0;\n    let max = 0;\n    for (const entry of collection) {\n        if (entry.sort > max)\n            max = entry.sort;\n        else if (entry.sort < min)\n            min = entry.sort;\n    }\n    return { min, max };\n}\nexports.getSortBounds = getSortBounds;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.withEventManager = void 0;\nfunction withEventManager(constructor) {\n    let _id = 1;\n    let _listeners = {};\n    return class extends constructor {\n        registerListener(event, listener, options) {\n            _listeners[event] ??= [];\n            const id = _id++;\n            _listeners[event].push({\n                id,\n                listener,\n                once: typeof options === \"boolean\" ? options : options?.once ?? false,\n                context: typeof options === \"object\" ? options.context : undefined,\n            });\n            return id;\n        }\n        removeListener(event, listener) {\n            const findFn = typeof listener === \"number\"\n                ? (x) => x.id === listener\n                : (x) => x.listener === listener;\n            const index = _listeners[event]?.findIndex(findFn) ?? -1;\n            if (index === -1)\n                return false;\n            _listeners[event].splice(index, 1);\n            return true;\n        }\n        emitEvent(event, ...args) {\n            const listeners = _listeners[event];\n            if (!listeners)\n                return;\n            for (const { listener, once, context, id } of listeners) {\n                if (context) {\n                    listener.apply(context, args);\n                }\n                else {\n                    listener(...args);\n                }\n                if (once) {\n                    this.removeListener(event, id);\n                }\n            }\n        }\n        purgeListeners() {\n            _listeners = {};\n        }\n    };\n}\nexports.withEventManager = withEventManager;\n", "\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.updateSourceFlag = exports.updateFlag = exports.unsetMofuleFlag = exports.unsetFlag = exports.setFlagProperty = exports.setFlag = exports.hasModuleFlag = exports.getFlagProperty = exports.getModuleFlag = exports.getFlag = exports.flagPath = void 0;\nconst R = __importStar(require(\"remeda\"));\nconst _1 = require(\".\");\nfunction getFlag(doc, ...path) {\n    return doc.getFlag(_1.MODULE.id, path.join(\".\"));\n}\nexports.getFlag = getFlag;\nfunction setFlag(doc, ...args) {\n    const value = args.pop();\n    return doc.setFlag(_1.MODULE.id, args.join(\".\"), value);\n}\nexports.setFlag = setFlag;\nfunction unsetFlag(doc, ...path) {\n    return doc.unsetFlag(_1.MODULE.id, path.join(\".\"));\n}\nexports.unsetFlag = unsetFlag;\nfunction flagPath(...path) {\n    return `flags.${_1.MODULE.path(path)}`;\n}\nexports.flagPath = flagPath;\nfunction updateFlag(doc, updates) {\n    const pathed = R.mapKeys(updates, (key) => flagPath(key));\n    return doc.update(pathed);\n}\nexports.updateFlag = updateFlag;\nfunction updateSourceFlag(doc, ...args) {\n    const value = args.pop();\n    return doc.updateSource({\n        [flagPath(...args)]: value,\n    });\n}\nexports.updateSourceFlag = updateSourceFlag;\nfunction getFlagProperty(obj, ...path) {\n    return getProperty(obj, flagPath(...path));\n}\nexports.getFlagProperty = getFlagProperty;\nfunction setFlagProperty(obj, ...args) {\n    const value = args.pop();\n    setProperty(obj, flagPath(...args), value);\n    return obj;\n}\nexports.setFlagProperty = setFlagProperty;\nfunction getModuleFlag(doc) {\n    return getProperty(doc, `flags.${_1.MODULE.id}`);\n}\nexports.getModuleFlag = getModuleFlag;\nfunction hasModuleFlag(doc) {\n    return getModuleFlag(doc) !== undefined;\n}\nexports.hasModuleFlag = hasModuleFlag;\nfunction unsetMofuleFlag(doc) {\n    return doc.update({\n        [`flags.-=${_1.MODULE.id}`]: true,\n    });\n}\nexports.unsetMofuleFlag = unsetMofuleFlag;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.render = exports.templatePath = void 0;\nconst _1 = require(\".\");\nfunction templatePath(...path) {\n    return `modules/${_1.MODULE.id}/templates/${(0, _1.joinStr)(\"/\", path)}.hbs`;\n}\nexports.templatePath = templatePath;\nfunction render(...args) {\n    const data = typeof args.at(-1) === \"object\" ? args.pop() : {};\n    const path = templatePath(...args);\n    return renderTemplate(path, data);\n}\nexports.render = render;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.registerUpstreamHook = exports.createHook = void 0;\nfunction registerUpstreamHook(event, listener) {\n    const id = Hooks.on(event, listener);\n    const index = Hooks.events[event].findIndex((x) => x.id === id);\n    if (index !== 0) {\n        const [hooked] = Hooks.events[event].splice(index, 1);\n        Hooks.events[event].unshift(hooked);\n    }\n    return id;\n}\nexports.registerUpstreamHook = registerUpstreamHook;\nfunction createHook(hook, listener) {\n    let hookId = null;\n    return {\n        activate() {\n            if (hookId !== null)\n                return;\n            hookId = Hooks.on(hook, listener);\n        },\n        disable() {\n            if (hookId === null)\n                return;\n            Hooks.off(hook, hookId);\n            hookId = null;\n        },\n        toggle(enabled) {\n            if (enabled)\n                this.activate();\n            else\n                this.disable();\n        },\n    };\n}\nexports.createHook = createHook;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.queryInParent = exports.queryInClosest = exports.querySelectorArray = exports.querySelector = exports.prependHTMLFromString = exports.parentElement = exports.isCheckboxElement = exports.htmlElement = exports.elementData = exports.dataToDatasetString = exports.createHTMLFromString = exports.closest = exports.beforeHTMLFromString = exports.appendHTMLFromString = exports.afterHTMLFromString = exports.addListenerAll = exports.addListener = void 0;\nfunction htmlElement(el) {\n    return el instanceof HTMLElement ? el : el[0];\n}\nexports.htmlElement = htmlElement;\nfunction isCheckboxElement(el) {\n    return el instanceof HTMLInputElement && el.type === \"checkbox\";\n}\nexports.isCheckboxElement = isCheckboxElement;\nfunction createHTMLFromString(content, wrap = true) {\n    const tmp = document.createElement(\"div\");\n    tmp.innerHTML = content;\n    const children = tmp.children;\n    return (children.length === 1 ? children[0] : wrap ? tmp : children);\n}\nexports.createHTMLFromString = createHTMLFromString;\nfunction applyHtmlMethod(fn, children, context) {\n    const fnc = context ? fn.bind(context) : fn;\n    if (children instanceof HTMLCollection) {\n        fnc(...children);\n    }\n    else {\n        fnc(children);\n    }\n}\nfunction insertHTMLFromString(parent, content, prepend = false) {\n    if (!parent)\n        return;\n    const html = createHTMLFromString(content, false);\n    applyHtmlMethod(prepend ? parent.prepend : parent.append, html, parent);\n    return html;\n}\nfunction appendHTMLFromString(parent, content) {\n    return insertHTMLFromString(parent, content, false);\n}\nexports.appendHTMLFromString = appendHTMLFromString;\nfunction prependHTMLFromString(parent, content) {\n    return insertHTMLFromString(parent, content, true);\n}\nexports.prependHTMLFromString = prependHTMLFromString;\nfunction beforeHTMLFromString(element, content) {\n    if (!element)\n        return;\n    const html = createHTMLFromString(content, false);\n    applyHtmlMethod(element.before, html, element);\n    return html;\n}\nexports.beforeHTMLFromString = beforeHTMLFromString;\nfunction afterHTMLFromString(element, content) {\n    if (!element)\n        return;\n    const html = createHTMLFromString(content, false);\n    applyHtmlMethod(element.after, html, element);\n    return html;\n}\nexports.afterHTMLFromString = afterHTMLFromString;\nfunction addListener(parent, selector, arg1, arg2, arg3) {\n    const element = parent.querySelector(selector);\n    if (!element)\n        return;\n    const event = typeof arg1 === \"string\" ? arg1 : \"click\";\n    const listener = typeof arg1 === \"function\" ? arg1 : arg2;\n    const useCapture = typeof arg2 === \"boolean\" ? arg2 : arg3;\n    element.addEventListener(event, (e) => listener(e, element), useCapture);\n    return element;\n}\nexports.addListener = addListener;\nfunction addListenerAll(parent, selector, arg1, arg2) {\n    const elements = parent.querySelectorAll(selector);\n    const event = typeof arg1 === \"string\" ? arg1 : \"click\";\n    const listener = typeof arg1 === \"function\" ? arg1 : arg2;\n    for (const element of elements) {\n        element.addEventListener(event, (e) => listener(e, element));\n    }\n    return elements;\n}\nexports.addListenerAll = addListenerAll;\nfunction querySelector(parent, selector) {\n    if (!parent)\n        return null;\n    return parent.querySelector(selector);\n}\nexports.querySelector = querySelector;\nfunction querySelectorArray(parent, selector) {\n    if (!parent)\n        return [];\n    return Array.from(parent.querySelectorAll(selector));\n}\nexports.querySelectorArray = querySelectorArray;\nfunction queryInClosest(el, parentSelector, childSelector) {\n    const parent = closest(el, parentSelector);\n    return querySelector(parent, childSelector);\n}\nexports.queryInClosest = queryInClosest;\nfunction queryInParent(el, childSelector) {\n    return querySelector(el.parentElement, childSelector);\n}\nexports.queryInParent = queryInParent;\nfunction closest(el, selector) {\n    if (!el)\n        return null;\n    return el.closest(selector);\n}\nexports.closest = closest;\nfunction parentElement(el) {\n    return el.parentElement;\n}\nexports.parentElement = parentElement;\nfunction elementData(el) {\n    return el.dataset;\n}\nexports.elementData = elementData;\nfunction dataToDatasetString(data) {\n    return Object.entries(data)\n        .map(([key, value]) => {\n        const stringified = typeof value === \"object\" ? JSON.stringify(value) : value;\n        return `data-${key}='${stringified}'`;\n    })\n        .join(\" \");\n}\nexports.dataToDatasetString = dataToDatasetString;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.getItems = exports.hasItemWithSourceId = exports.getItemWithSourceId = void 0;\nconst _1 = require(\".\");\nfunction getItems(actor, itemTypes = []) {\n    const types = typeof itemTypes === \"string\" ? [itemTypes] : itemTypes;\n    return types.length ? types.flatMap((type) => actor.itemTypes[type]) : actor.items;\n}\nexports.getItems = getItems;\nfunction hasItemWithSourceId(actor, sourceId, itemTypes) {\n    return getItems(actor, itemTypes).some((0, _1.getSourceIdCondition)(sourceId));\n}\nexports.hasItemWithSourceId = hasItemWithSourceId;\nfunction getItemWithSourceId(actor, sourceId, itemTypes) {\n    return getItems(actor, itemTypes).find((0, _1.getSourceIdCondition)(sourceId));\n}\nexports.getItemWithSourceId = getItemWithSourceId;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.subLocalize = exports.templateLocalize = exports.localizePath = exports.hasLocalization = exports.localizeIfExist = exports.localize = exports.localeCompare = void 0;\nconst _1 = require(\".\");\nfunction localize(...args) {\n    args.unshift(_1.MODULE.id);\n    const data = typeof args.at(-1) === \"object\" ? args.pop() : undefined;\n    const path = (0, _1.joinStr)(\".\", args);\n    if (typeof data === \"object\") {\n        return game.i18n.format(path, data);\n    }\n    return game.i18n.localize(path);\n}\nexports.localize = localize;\nfunction localizeIfExist(...args) {\n    args.unshift(_1.MODULE.id);\n    const data = typeof args.at(-1) === \"object\" ? args.pop() : undefined;\n    const path = (0, _1.joinStr)(\".\", args);\n    if (!game.i18n.has(path, false))\n        return;\n    if (typeof data === \"object\") {\n        return game.i18n.format(path, data);\n    }\n    return game.i18n.localize(path);\n}\nexports.localizeIfExist = localizeIfExist;\nfunction hasLocalization(...path) {\n    return game.i18n.has(`${_1.MODULE.path(path)}`, false);\n}\nexports.hasLocalization = hasLocalization;\nfunction localizePath(...path) {\n    return _1.MODULE.path(path);\n}\nexports.localizePath = localizePath;\nfunction templateLocalize(subKey) {\n    const fn = (key, { hash }) => localize(subKey, key, hash);\n    Object.defineProperties(fn, {\n        path: {\n            value: (key) => localizePath(subKey, key),\n            enumerable: false,\n            configurable: false,\n        },\n        sub: {\n            value: (key) => {\n                const joinedKey = subKey ? `${subKey}.${key}` : key;\n                return subLocalize(joinedKey).i18n;\n            },\n            enumerable: false,\n            configurable: false,\n        },\n    });\n    return fn;\n}\nexports.templateLocalize = templateLocalize;\nfunction subLocalize(subKey) {\n    const fn = (...args) => localize(subKey, ...args);\n    Object.defineProperties(fn, {\n        ifExist: {\n            value: (...args) => localizeIfExist(subKey, ...args),\n            enumerable: false,\n            configurable: false,\n        },\n        warn: {\n            value: (str, arg1, arg2) => (0, _1.warn)(`${subKey}.${str}`, arg1, arg2),\n            enumerable: false,\n            configurable: false,\n        },\n        info: {\n            value: (str, arg1, arg2) => (0, _1.info)(`${subKey}.${str}`, arg1, arg2),\n            enumerable: false,\n            configurable: false,\n        },\n        error: {\n            value: (str, arg1, arg2) => (0, _1.error)(`${subKey}.${str}`, arg1, arg2),\n            enumerable: false,\n            configurable: false,\n        },\n        has: {\n            value: (key) => hasLocalization(subKey, key),\n            enumerable: false,\n            configurable: false,\n        },\n        path: {\n            value: (key) => localizePath(subKey, key),\n            enumerable: false,\n            configurable: false,\n        },\n        sub: {\n            value: (key) => subLocalize(`${subKey}.${key}`),\n            enumerable: false,\n            configurable: false,\n        },\n        i18n: {\n            get() {\n                return templateLocalize(subKey);\n            },\n            enumerable: false,\n            configurable: false,\n        },\n    });\n    return fn;\n}\nexports.subLocalize = subLocalize;\nfunction localeCompare(a, b) {\n    return a.localeCompare(b, game.i18n.lang);\n}\nexports.localeCompare = localeCompare;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.getActiveModule = exports.MODULE = void 0;\nconst _1 = require(\".\");\nlet MODULE_ID = \"\";\nlet MODULE_NAME = \"\";\nconst MODULE = {\n    get id() {\n        if (!MODULE_ID) {\n            throw new Error(\"Module needs to be registered.\");\n        }\n        return MODULE_ID;\n    },\n    get name() {\n        if (!MODULE_ID) {\n            throw new Error(\"Module needs to be registered.\");\n        }\n        return MODULE_NAME;\n    },\n    get current() {\n        return game.modules.get(this.id);\n    },\n    throwError(str) {\n        throw new Error(`\\n[${this.name}] ${str}`);\n    },\n    error(str, error) {\n        let message = `[${this.name}] ${str}`;\n        if (error instanceof Error) {\n            message += `\\n${error.message}`;\n        }\n        else if (typeof error === \"string\") {\n            message += `\\n${error}`;\n        }\n        console.error(message);\n    },\n    log(str) {\n        console.log(`[${this.name}] ${str}`);\n    },\n    path(...path) {\n        return `${this.id}.${(0, _1.joinStr)(\".\", ...path)}`;\n    },\n    register(id, name) {\n        if (MODULE_ID) {\n            throw new Error(\"Module was already registered.\");\n        }\n        MODULE_ID = id;\n        MODULE_NAME = name;\n    },\n};\nexports.MODULE = MODULE;\nfunction getActiveModule(name) {\n    const module = game.modules.get(name);\n    return module?.active ? module : undefined;\n}\nexports.getActiveModule = getActiveModule;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.registerKeybind = void 0;\nconst localize_1 = require(\"./localize\");\nconst module_1 = require(\"./module\");\nfunction registerKeybind(name, data) {\n    game.keybindings.register(module_1.MODULE.id, name, {\n        ...data,\n        name: (0, localize_1.localizePath)(\"keybindings\", name, \"name\"),\n        hint: (0, localize_1.localizePath)(\"keybindings\", name, \"hint\"),\n    });\n}\nexports.registerKeybind = registerKeybind;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.unregisterWrapper = exports.registerWrapper = exports.createWrapper = void 0;\nconst _1 = require(\".\");\nfunction registerWrapper(path, fn, type) {\n    const ids = [];\n    const paths = Array.isArray(path) ? path : [path];\n    for (const key of paths) {\n        const id = libWrapper.register(_1.MODULE.id, key, fn, type);\n        ids.push(id);\n    }\n    // @ts-ignore\n    return ids.length === 1 ? ids[0] : ids;\n}\nexports.registerWrapper = registerWrapper;\nfunction unregisterWrapper(id) {\n    libWrapper.unregister(_1.MODULE.id, id);\n}\nexports.unregisterWrapper = unregisterWrapper;\nfunction createWrapper(path, callback, type, options) {\n    let wrapperId = null;\n    return {\n        activate() {\n            if (wrapperId !== null)\n                return;\n            //  @ts-ignore\n            wrapperId = registerWrapper(path, callback, type ?? \"WRAPPER\");\n            options?.onActivate?.();\n        },\n        disable() {\n            if (wrapperId === null)\n                return;\n            unregisterWrapper(wrapperId);\n            wrapperId = null;\n            options?.onDisable?.();\n        },\n        toggle(enabled) {\n            if (enabled)\n                this.activate();\n            else\n                this.disable();\n        },\n    };\n}\nexports.createWrapper = createWrapper;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.warn = exports.info = exports.error = void 0;\nconst _1 = require(\".\");\nfunction notify(str, arg1, arg2, arg3) {\n    const type = typeof arg1 === \"string\" ? arg1 : \"info\";\n    const data = typeof arg1 === \"object\" ? arg1 : typeof arg2 === \"object\" ? arg2 : undefined;\n    const permanent = typeof arg1 === \"boolean\" ? arg1 : typeof arg2 === \"boolean\" ? arg2 : arg3 ?? false;\n    ui.notifications.notify((0, _1.localize)(str, data), type, { permanent });\n}\nfunction warn(str, arg1, arg2) {\n    notify(str, \"warning\", arg1, arg2);\n}\nexports.warn = warn;\nfunction info(str, arg1, arg2) {\n    notify(str, \"info\", arg1, arg2);\n}\nexports.info = info;\nfunction error(str, arg1, arg2) {\n    notify(str, \"error\", arg1, arg2);\n}\nexports.error = error;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.setInMemory = exports.getInMemoryAndSetIfNot = exports.getInMemory = exports.isInstanceOf = exports.deleteInMemory = exports.AsyncFunction = void 0;\nconst module_1 = require(\"./module\");\nconst AsyncFunction = Object.getPrototypeOf(async function () { }).constructor;\nexports.AsyncFunction = AsyncFunction;\nfunction isInstanceOf(obj, name) {\n    if (typeof obj !== \"object\")\n        return false;\n    let cursor = Reflect.getPrototypeOf(obj);\n    while (cursor) {\n        if (cursor.constructor.name === name)\n            return true;\n        cursor = Reflect.getPrototypeOf(cursor);\n    }\n    return false;\n}\nexports.isInstanceOf = isInstanceOf;\nfunction getInMemory(obj, ...path) {\n    return getProperty(obj, `modules.${module_1.MODULE.id}.${path.join(\".\")}`);\n}\nexports.getInMemory = getInMemory;\nfunction setInMemory(obj, ...args) {\n    const value = args.pop();\n    return setProperty(obj, `modules.${module_1.MODULE.id}.${args.join(\".\")}`, value);\n}\nexports.setInMemory = setInMemory;\nfunction getInMemoryAndSetIfNot(obj, ...args) {\n    const value = args.pop();\n    const current = getInMemory(obj, ...args);\n    if (current != null)\n        return current;\n    // @ts-ignore\n    const result = typeof value === \"function\" ? value() : value;\n    setInMemory(obj, ...args, result);\n    return result;\n}\nexports.getInMemoryAndSetIfNot = getInMemoryAndSetIfNot;\nfunction deleteInMemory(obj, ...path) {\n    const split = [\"modules\", module_1.MODULE.id, ...path.flatMap((x) => x.split(\".\"))];\n    const last = split.pop();\n    let cursor = obj;\n    for (const key of split) {\n        if (typeof cursor !== \"object\" || !(key in cursor))\n            return true;\n        cursor = cursor[key];\n    }\n    return delete cursor[last];\n}\nexports.deleteInMemory = deleteInMemory;\n", "\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.settingPath = exports.setSetting = exports.registerSettingMenu = exports.registerSetting = exports.isClientSetting = exports.isWorldSetting = exports.isMenuSetting = exports.getSetting = void 0;\nconst R = __importStar(require(\"remeda\"));\nconst _1 = require(\".\");\n/**\n * scope = \"world\"\n *\n * config = true\n */\nfunction registerSetting(options) {\n    if (\"choices\" in options && Array.isArray(options.choices)) {\n        options.choices = R.mapToObj(options.choices, (choice) => [\n            choice,\n            settingPath(options.key, \"choices\", choice),\n        ]);\n    }\n    options.name ??= settingPath(options.key, \"name\");\n    options.hint ??= settingPath(options.key, \"hint\");\n    options.scope ??= \"world\";\n    options.config ??= true;\n    game.settings.register(_1.MODULE.id, options.key, options);\n}\nexports.registerSetting = registerSetting;\nfunction registerSettingMenu(options) {\n    options.name ??= settingPath(\"menus\", options.key, \"name\");\n    options.label ??= settingPath(\"menus\", options.key, \"label\");\n    options.hint ??= settingPath(\"menus\", options.key, \"hint\");\n    options.restricted ??= true;\n    options.icon ??= \"fas fa-cogs\";\n    game.settings.registerMenu(_1.MODULE.id, options.key, options);\n}\nexports.registerSettingMenu = registerSettingMenu;\nfunction settingPath(...path) {\n    return _1.MODULE.path(\"settings\", ...path);\n}\nexports.settingPath = settingPath;\nfunction getSetting(key) {\n    return game.settings.get(_1.MODULE.id, key);\n}\nexports.getSetting = getSetting;\nfunction setSetting(key, value) {\n    return game.settings.set(_1.MODULE.id, key, value);\n}\nexports.setSetting = setSetting;\nfunction isClientSetting(setting) {\n    if (\"restricted\" in setting)\n        return !setting.restricted;\n    return \"scope\" in setting && setting.scope === \"client\";\n}\nexports.isClientSetting = isClientSetting;\nfunction isWorldSetting(setting) {\n    if (\"restricted\" in setting)\n        return !!setting.restricted;\n    return \"scope\" in setting && setting.scope === \"world\";\n}\nexports.isWorldSetting = isWorldSetting;\nfunction isMenuSetting(setting) {\n    return setting.type.prototype instanceof FormApplication;\n}\nexports.isMenuSetting = isMenuSetting;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.socketOn = exports.socketOff = exports.socketEmit = void 0;\nconst module_1 = require(\"./module\");\nfunction socketOn(callback) {\n    game.socket.on(`module.${module_1.MODULE.id}`, callback);\n}\nexports.socketOn = socketOn;\nfunction socketOff(callback) {\n    game.socket.off(`module.${module_1.MODULE.id}`, callback);\n}\nexports.socketOff = socketOff;\nfunction socketEmit(packet) {\n    game.socket.emit(`module.${module_1.MODULE.id}`, packet);\n}\nexports.socketEmit = socketEmit;\n", "\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.stringNumber = exports.stringBoolean = exports.safeSplit = exports.joinStr = exports.beautity = void 0;\nconst R = __importStar(require(\"remeda\"));\nfunction joinStr(separator, ...path) {\n    return R.pipe(path, R.flatten(), R.filter((x) => typeof x === \"string\"), R.join(separator));\n}\nexports.joinStr = joinStr;\nfunction safeSplit(str, selector = \",\") {\n    return str\n        .split(selector)\n        .map((s) => s.trim())\n        .filter(Boolean);\n}\nexports.safeSplit = safeSplit;\nfunction beautity(str) {\n    return str.replaceAll(/[-_.]([a-z])/g, (_, c) => ` ${c.toUpperCase()}`).capitalize();\n}\nexports.beautity = beautity;\nfunction stringBoolean(b) {\n    return String(b);\n}\nexports.stringBoolean = stringBoolean;\nfunction stringNumber(n) {\n    return String(n);\n}\nexports.stringNumber = stringNumber;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.userIsGM = exports.isActiveGM = exports.hasGMOnline = void 0;\nfunction getCurrentUser() {\n    return game.user ?? game.data.users.find((x) => x._id === game.data.userId);\n}\nfunction isActiveGM() {\n    return game.user === game.users.activeGM;\n}\nexports.isActiveGM = isActiveGM;\nfunction userIsGM(user) {\n    user ??= getCurrentUser();\n    return user && user.role >= CONST.USER_ROLES.ASSISTANT;\n}\nexports.userIsGM = userIsGM;\nfunction hasGMOnline() {\n    return game.users.some((user) => user.active && user.isGM);\n}\nexports.hasGMOnline = hasGMOnline;\n", "\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __exportStar = (this && this.__exportStar) || function(m, exports) {\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(exports, p)) __createBinding(exports, m, p);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.isOfType = void 0;\n__exportStar(require(\"./actor\"), exports);\n__exportStar(require(\"./application\"), exports);\n__exportStar(require(\"./array\"), exports);\n__exportStar(require(\"./canvas\"), exports);\n__exportStar(require(\"./chat\"), exports);\n__exportStar(require(\"./delay\"), exports);\n__exportStar(require(\"./dialog\"), exports);\n__exportStar(require(\"./document\"), exports);\n__exportStar(require(\"./event-manager\"), exports);\n__exportStar(require(\"./flags\"), exports);\n__exportStar(require(\"./handlebars\"), exports);\n__exportStar(require(\"./hooks\"), exports);\n__exportStar(require(\"./html\"), exports);\n__exportStar(require(\"./item\"), exports);\n__exportStar(require(\"./keybindings\"), exports);\n__exportStar(require(\"./libwrapper\"), exports);\n__exportStar(require(\"./localize\"), exports);\n__exportStar(require(\"./module\"), exports);\n__exportStar(require(\"./notifications\"), exports);\n__exportStar(require(\"./object\"), exports);\n__exportStar(require(\"./settings\"), exports);\n__exportStar(require(\"./socket\"), exports);\n__exportStar(require(\"./string\"), exports);\n__exportStar(require(\"./user\"), exports);\nfunction isOfType(variable, ...types) {\n    const type = typeof variable;\n    return types.includes(type);\n}\nexports.isOfType = isOfType;\n", "export * as R from \"remeda\";\r\nexport * from \"./dist\";\r\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.tupleHasValue = exports.traitSlugToObject = exports.setHasElement = exports.ordinalString = exports.objectHasKey = exports.localizer = exports.htmlQuery = exports.htmlClosest = exports.getActionGlyph = exports.extractNotes = exports.ErrorPF2e = exports.createHTMLElement = void 0;\nconst foundry_api_1 = require(\"foundry-api\");\nfunction ErrorPF2e(message) {\n    return Error(`PF2e System | ${message}`);\n}\nexports.ErrorPF2e = ErrorPF2e;\nfunction objectHasKey(obj, key) {\n    return (typeof key === \"string\" || typeof key === \"number\") && key in obj;\n}\nexports.objectHasKey = objectHasKey;\nfunction tupleHasValue(array, value) {\n    return array.includes(value);\n}\nexports.tupleHasValue = tupleHasValue;\nfunction setHasElement(set, value) {\n    return set.has(value);\n}\nexports.setHasElement = setHasElement;\nfunction ordinalString(value) {\n    const pluralRules = new Intl.PluralRules(game.i18n.lang, { type: \"ordinal\" });\n    const suffix = game.i18n.localize(`PF2E.OrdinalSuffixes.${pluralRules.select(value)}`);\n    return game.i18n.format(\"PF2E.OrdinalNumber\", { value, suffix });\n}\nexports.ordinalString = ordinalString;\nfunction htmlClosest(child, selectors) {\n    if (!(child instanceof Element))\n        return null;\n    return child.closest(selectors);\n}\nexports.htmlClosest = htmlClosest;\nfunction htmlQuery(parent, selectors) {\n    if (!(parent instanceof Element || parent instanceof Document))\n        return null;\n    return parent.querySelector(selectors);\n}\nexports.htmlQuery = htmlQuery;\nfunction localizer(prefix) {\n    return (...[suffix, formatArgs]) => formatArgs\n        ? game.i18n.format(`${prefix}.${suffix}`, formatArgs)\n        : game.i18n.localize(`${prefix}.${suffix}`);\n}\nexports.localizer = localizer;\nfunction traitSlugToObject(trait, dictionary) {\n    const traitObject = {\n        name: trait,\n        label: game.i18n.localize(dictionary[trait] ?? trait),\n        description: null,\n    };\n    if (objectHasKey(CONFIG.PF2E.traitsDescriptions, trait)) {\n        traitObject.description = CONFIG.PF2E.traitsDescriptions[trait];\n    }\n    return traitObject;\n}\nexports.traitSlugToObject = traitSlugToObject;\nconst actionGlyphMap = {\n    0: \"F\",\n    free: \"F\",\n    1: \"1\",\n    2: \"2\",\n    3: \"3\",\n    \"1 or 2\": \"1/2\",\n    \"1 to 3\": \"1 - 3\",\n    \"2 or 3\": \"2/3\",\n    \"2 rounds\": \"3,3\",\n    reaction: \"R\",\n};\nfunction getActionGlyph(action) {\n    if (!action && action !== 0)\n        return \"\";\n    const value = typeof action !== \"object\" ? action : action.type === \"action\" ? action.value : action.type;\n    const sanitized = String(value ?? \"\")\n        .toLowerCase()\n        .trim();\n    return actionGlyphMap[sanitized]?.replace(\"-\", \"\u2013\") ?? \"\";\n}\nexports.getActionGlyph = getActionGlyph;\nfunction extractNotes(rollNotes, selectors) {\n    return selectors.flatMap((s) => (rollNotes[s] ?? []).map((n) => n.clone()));\n}\nexports.extractNotes = extractNotes;\nfunction createHTMLElement(nodeName, { classes = [], dataset = {}, children = [], innerHTML } = {}) {\n    const element = document.createElement(nodeName);\n    if (classes.length > 0)\n        element.classList.add(...classes);\n    for (const [key, value] of Object.entries(dataset).filter(([, v]) => !foundry_api_1.R.isNil(v) && v !== false)) {\n        element.dataset[key] = value === true ? \"\" : String(value);\n    }\n    if (innerHTML) {\n        element.innerHTML = innerHTML;\n    }\n    else {\n        for (const child of children) {\n            const childElement = child instanceof HTMLElement ? child : new Text(child);\n            element.appendChild(childElement);\n        }\n    }\n    return element;\n}\nexports.createHTMLElement = createHTMLElement;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.transferItemToActor = exports.resetActors = void 0;\nconst foundry_api_1 = require(\"foundry-api\");\nconst utils_1 = require(\"./utils\");\nasync function transferItemToActor(targetActor, item, quantity, containerId, newStack = false) {\n    if (!item.isOfType(\"physical\")) {\n        throw (0, utils_1.ErrorPF2e)(\"Only physical items (with quantities) can be transfered between actors\");\n    }\n    const container = targetActor.inventory.get(containerId ?? \"\");\n    if (container && !container?.isOfType(\"backpack\")) {\n        throw (0, utils_1.ErrorPF2e)(\"containerId refers to a non-container\");\n    }\n    quantity = Math.min(quantity, item.quantity);\n    const newQuantity = item.quantity - quantity;\n    const removeFromSource = newQuantity < 1;\n    if (removeFromSource) {\n        await item.delete();\n    }\n    else {\n        await item.update({ \"system.quantity\": newQuantity });\n    }\n    const newItemData = item.toObject();\n    newItemData.system.quantity = quantity;\n    newItemData.system.equipped.carryType = \"worn\";\n    if (\"invested\" in newItemData.system.equipped) {\n        newItemData.system.equipped.invested = item.traits.has(\"invested\") ? false : null;\n    }\n    return targetActor.addToInventory(newItemData, container, newStack);\n}\nexports.transferItemToActor = transferItemToActor;\nasync function resetActors(actors, options = {}) {\n    actors ??= [\n        game.actors.contents,\n        game.scenes.contents\n            .flatMap((s) => s.tokens.contents)\n            .flatMap((t) => t.actor ?? []),\n    ].flat();\n    actors = foundry_api_1.R.uniq(Array.from(actors));\n    options.sheets ??= true;\n    for (const actor of actors) {\n        actor.reset();\n        if (options.sheets)\n            actor.render();\n    }\n    game.pf2e.effectPanel.refresh();\n    const refreshScenes = game.settings.get(\"pf2e\", \"automation.effectExpiration\") &&\n        !game.settings.get(\"pf2e\", \"automation.removeExpiredEffects\");\n    if (refreshScenes) {\n        const scenes = foundry_api_1.R.uniq(Array.from(actors)\n            .flatMap((a) => a.getActiveTokens(false, true))\n            .flatMap((t) => t.scene));\n        for (const scene of scenes) {\n            scene.reset();\n            if (scene.isView) {\n                canvas.perception.update({ initializeVision: true }, true);\n            }\n        }\n    }\n    if (options.tokens) {\n        for (const token of foundry_api_1.R.uniq(Array.from(actors).flatMap((a) => a.getActiveTokens(true, true)))) {\n            token.simulateUpdate();\n        }\n    }\n}\nexports.resetActors = resetActors;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.renderItemSheets = exports.renderCharacterSheets = exports.renderActorSheets = void 0;\nconst foundry_api_1 = require(\"foundry-api\");\nfunction renderApplication(type) {\n    const types = Array.isArray(type) ? type : [type];\n    const apps = Object.values(ui.windows).filter((app) => types.some((x) => (0, foundry_api_1.isInstanceOf)(app, x)));\n    for (const app of apps) {\n        app.render();\n    }\n}\nfunction renderActorSheets(type = [\"ActorSheetPF2e\"]) {\n    renderApplication(type);\n}\nexports.renderActorSheets = renderActorSheets;\nfunction renderCharacterSheets() {\n    renderActorSheets([\"CharacterSheetPF2e\"]);\n}\nexports.renderCharacterSheets = renderCharacterSheets;\nfunction renderItemSheets(type = [\"ItemSheetPF2e\"]) {\n    renderApplication(type);\n}\nexports.renderItemSheets = renderItemSheets;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.getTabFilterData = exports.filterTraits = void 0;\nfunction getTabFilterData(tabName) {\n    const tab = game.pf2e.compendiumBrowser.tabs[tabName];\n    return deepClone(tab.defaultFilterData ?? tab.filterData);\n}\nexports.getTabFilterData = getTabFilterData;\nfunction filterTraits(traits, selected, condition) {\n    const selectedTraits = selected.filter((s) => !s.not).map((s) => s.value);\n    const notTraits = selected.filter((t) => t.not).map((s) => s.value);\n    if (selectedTraits.length || notTraits.length) {\n        if (notTraits.some((t) => traits.includes(t))) {\n            return false;\n        }\n        const fullfilled = condition === \"and\"\n            ? selectedTraits.every((t) => traits.includes(t))\n            : selectedTraits.some((t) => traits.includes(t));\n        if (!fullfilled)\n            return false;\n    }\n    return true;\n}\nexports.filterTraits = filterTraits;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.extractEphemeralEffects = void 0;\nasync function extractEphemeralEffects({ affects, origin, target, item, domains, options, }) {\n    if (!(origin && target))\n        return [];\n    const [effectsFrom, effectsTo] = affects === \"target\" ? [origin, target] : [target, origin];\n    const fullOptions = [\n        ...options,\n        effectsFrom.getRollOptions(domains),\n        effectsTo.getSelfRollOptions(affects),\n    ].flat();\n    const resolvables = item ? (item.isOfType(\"spell\") ? { spell: item } : { weapon: item }) : {};\n    return (await Promise.all(domains\n        .flatMap((s) => effectsFrom.synthetics.ephemeralEffects[s]?.[affects] ?? [])\n        .map((d) => d({ test: fullOptions, resolvables })))).flatMap((e) => e ?? []);\n}\nexports.extractEphemeralEffects = extractEphemeralEffects;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.toggleOffShieldBlock = exports.selfApplyEffectFromMessage = exports.onClickShieldBlock = exports.createTradeMessage = exports.createTradeContent = exports.applyDamageFromMessage = void 0;\nconst foundry_api_1 = require(\"foundry-api\");\nconst utils_1 = require(\"./utils\");\nconst rules_1 = require(\"./rules\");\nfunction createTradeContent(message, img) {\n    return renderTemplate(\"systems/pf2e/templates/chat/action/content.hbs\", {\n        imgPath: img,\n        message: message.replace(/\\b1 \u00D7 /, \"\"),\n    });\n}\nexports.createTradeContent = createTradeContent;\nasync function createTradeMessage(subtitle, message, actor, item, senderId) {\n    const content = await createTradeContent(message, item.img);\n    return createManipulationMessage(subtitle, content, actor, senderId);\n}\nexports.createTradeMessage = createTradeMessage;\nasync function createManipulationMessage(subtitle, content, actor, senderId) {\n    return ChatMessage.implementation.create({\n        user: senderId ?? game.user.id,\n        speaker: {\n            alias: (0, foundry_api_1.getHighestName)(actor),\n        },\n        flavor: await createManipulateFlavor(subtitle),\n        content: content,\n        type: CONST.CHAT_MESSAGE_TYPES.EMOTE,\n    });\n}\nfunction createManipulateFlavor(subtitle) {\n    return renderTemplate(\"systems/pf2e/templates/chat/action/flavor.hbs\", {\n        action: {\n            title: \"PF2E.Actions.Interact.Title\",\n            subtitle: subtitle,\n            glyph: (0, utils_1.getActionGlyph)(1),\n        },\n        traits: [\n            {\n                name: \"manipulate\",\n                label: CONFIG.PF2E.featTraits.manipulate,\n                description: CONFIG.PF2E.traitsDescriptions.manipulate,\n            },\n        ],\n    });\n}\nasync function applyDamageFromMessage({ message, multiplier = 1, addend = 0, promptModifier = false, rollIndex = 0, \n// added\ntokens, onDamageApplied, }) {\n    if (promptModifier)\n        return shiftAdjustDamage(message, multiplier, rollIndex, \n        // added\n        tokens, onDamageApplied);\n    const html = (0, utils_1.htmlQuery)(ui.chat.element[0], `li.chat-message[data-message-id=\"${message.id}\"]`);\n    // changed\n    tokens ??=\n        html?.dataset.actorIsTarget && message.token\n            ? [message.token]\n            : game.user.getActiveTokens();\n    if (tokens.length === 0) {\n        ui.notifications.error(\"PF2E.ErrorMessage.NoTokenSelected\", { localize: true });\n        return;\n    }\n    const shieldBlockRequest = CONFIG.PF2E.chatDamageButtonShieldToggle;\n    const roll = message.rolls.at(rollIndex);\n    if (!(0, foundry_api_1.isInstanceOf)(roll, \"DamageRoll\"))\n        throw (0, utils_1.ErrorPF2e)(\"Unexpected error retrieving damage roll\");\n    const damage = multiplier < 0 ? multiplier * roll.total + addend : roll.alter(multiplier, addend);\n    const messageRollOptions = [...(message.flags.pf2e.context?.options ?? [])];\n    const originRollOptions = messageRollOptions\n        .filter((o) => o.startsWith(\"self:\"))\n        .map((o) => o.replace(/^self/, \"origin\"));\n    const messageItem = message.item;\n    const effectRollOptions = messageItem?.isOfType(\"affliction\", \"condition\", \"effect\")\n        ? messageItem.getRollOptions(\"item\")\n        : [];\n    for (const token of tokens) {\n        if (!token.actor)\n            continue;\n        if (!messageRollOptions.some((o) => o.startsWith(\"target\"))) {\n            messageRollOptions.push(...token.actor.getSelfRollOptions(\"target\"));\n        }\n        const domain = multiplier > 0 ? \"damage-received\" : \"healing-received\";\n        const ephemeralEffects = multiplier > 0\n            ? await (0, rules_1.extractEphemeralEffects)({\n                affects: \"target\",\n                origin: message.actor,\n                target: token.actor,\n                item: message.item,\n                domains: [domain],\n                options: messageRollOptions,\n            })\n            : [];\n        const contextClone = token.actor.getContextualClone(originRollOptions, ephemeralEffects);\n        const rollOptions = new Set([\n            ...messageRollOptions.filter((o) => !/^(?:self|target):/.test(o)),\n            ...effectRollOptions,\n            ...originRollOptions,\n            ...contextClone.getSelfRollOptions(),\n        ]);\n        await contextClone.applyDamage({\n            damage,\n            token,\n            item: message.item,\n            skipIWR: multiplier <= 0,\n            rollOptions,\n            shieldBlockRequest,\n            outcome: message.flags.pf2e.context?.outcome,\n        });\n    }\n    toggleOffShieldBlock(message.id);\n    // added\n    onDamageApplied?.(message, tokens, rollIndex);\n}\nexports.applyDamageFromMessage = applyDamageFromMessage;\nasync function shiftAdjustDamage(message, multiplier, rollIndex, \n// added\ntokens, onDamageApplied) {\n    const content = await renderTemplate(\"systems/pf2e/templates/chat/damage/adjustment-dialog.hbs\");\n    const AdjustmentDialog = class extends Dialog {\n        activateListeners($html) {\n            super.activateListeners($html);\n            $html[0].querySelector(\"input\")?.focus();\n        }\n    };\n    const isHealing = multiplier < 0;\n    new AdjustmentDialog({\n        title: game.i18n.localize(isHealing ? \"PF2E.UI.shiftModifyHealingTitle\" : \"PF2E.UI.shiftModifyDamageTitle\"),\n        content,\n        buttons: {\n            ok: {\n                label: game.i18n.localize(\"PF2E.OK\"),\n                callback: async ($dialog) => {\n                    const adjustment = (Number($dialog[0].querySelector(\"input\")?.value) || 0) *\n                        Math.sign(multiplier);\n                    applyDamageFromMessage({\n                        message,\n                        multiplier,\n                        addend: adjustment,\n                        promptModifier: false,\n                        rollIndex,\n                        // added\n                        tokens,\n                        onDamageApplied,\n                    });\n                },\n            },\n            cancel: {\n                label: \"Cancel\",\n            },\n        },\n        default: \"ok\",\n        close: () => {\n            toggleOffShieldBlock(message.id);\n        },\n    }).render(true);\n}\nfunction toggleOffShieldBlock(messageId) {\n    for (const app of [\"#chat-log\", \"#chat-popout\"]) {\n        const selector = `${app} > li.chat-message[data-message-id=\"${messageId}\"] button[data-action$=shield-block]`;\n        // changed\n        for (const button of document.body.querySelectorAll(selector)) {\n            button?.classList.remove(\"shield-activated\");\n        }\n    }\n    CONFIG.PF2E.chatDamageButtonShieldToggle = false;\n}\nexports.toggleOffShieldBlock = toggleOffShieldBlock;\nfunction onClickShieldBlock(shieldButton, messageEl, \n// added\ntoken) {\n    const getTokens = () => {\n        // added\n        if (token) {\n            return [token];\n        }\n        const tokens = game.user.getActiveTokens();\n        if (tokens.length === 0) {\n            ui.notifications.error(\"PF2E.ErrorMessage.NoTokenSelected\", { localize: true });\n        }\n        return tokens;\n    };\n    const getNonBrokenShields = (tokens) => {\n        const actor = tokens.find((t) => !!t.actor)?.actor;\n        return (actor?.itemTypes.shield.filter((s) => s.isEquipped && !s.isBroken && !s.isDestroyed) ??\n            []);\n    };\n    if (!shieldButton.classList.contains(\"tooltipstered\")) {\n        $(shieldButton)\n            .tooltipster({\n            animation: \"fade\",\n            trigger: \"click\",\n            arrow: false,\n            content: (0, utils_1.htmlQuery)(messageEl, \"div.hover-content\"),\n            contentAsHTML: true,\n            contentCloning: true,\n            debug: false,\n            interactive: true,\n            side: [\"top\"],\n            theme: \"crb-hover\",\n            functionBefore: () => {\n                const tokens = getTokens();\n                if (tokens.length === 0)\n                    return false;\n                const nonBrokenShields = getNonBrokenShields(tokens);\n                const hasMultipleShields = tokens.length === 1 && nonBrokenShields.length > 1;\n                const shieldActivated = shieldButton.classList.contains(\"shield-activated\");\n                if (hasMultipleShields && !shieldActivated) {\n                    return true;\n                }\n                if (hasMultipleShields && shieldButton.dataset.shieldId) {\n                    shieldButton.attributes.removeNamedItem(\"data-shield-id\");\n                    shieldButton.classList.remove(\"shield-activated\");\n                    CONFIG.PF2E.chatDamageButtonShieldToggle = false;\n                    return true;\n                }\n                shieldButton.classList.toggle(\"shield-activated\");\n                CONFIG.PF2E.chatDamageButtonShieldToggle =\n                    !CONFIG.PF2E.chatDamageButtonShieldToggle;\n                return false;\n            },\n            functionFormat: (instance, _helper, contentEl) => {\n                const tokens = getTokens();\n                const nonBrokenShields = getNonBrokenShields(tokens);\n                const multipleShields = tokens.length === 1 && nonBrokenShields.length > 1;\n                const shieldActivated = shieldButton.classList.contains(\"shield-activated\");\n                if (multipleShields && !shieldActivated) {\n                    const listEl = (0, utils_1.htmlQuery)(contentEl, \"ul.shield-options\");\n                    if (!listEl)\n                        return $(contentEl);\n                    const shieldList = nonBrokenShields.map((shield) => {\n                        const input = document.createElement(\"input\");\n                        input.classList.add(\"data\");\n                        input.type = \"radio\";\n                        input.name = \"shield-id\";\n                        input.value = shield.id;\n                        input.addEventListener(\"click\", () => {\n                            shieldButton.dataset.shieldId = input.value;\n                            shieldButton.classList.add(\"shield-activated\");\n                            CONFIG.PF2E.chatDamageButtonShieldToggle = true;\n                            instance.close();\n                        });\n                        const shieldName = document.createElement(\"span\");\n                        shieldName.classList.add(\"label\");\n                        shieldName.innerHTML = shield.name;\n                        const hardness = document.createElement(\"span\");\n                        hardness.classList.add(\"tag\");\n                        const hardnessLabel = game.i18n.localize(\"PF2E.HardnessLabel\");\n                        hardness.innerHTML = `${hardnessLabel}: ${shield.hardness}`;\n                        const itemLi = document.createElement(\"li\");\n                        itemLi.classList.add(\"item\");\n                        itemLi.append(input, shieldName, hardness);\n                        return itemLi;\n                    });\n                    listEl.replaceChildren(...shieldList);\n                }\n                return $(contentEl);\n            },\n        })\n            .tooltipster(\"open\");\n    }\n}\nexports.onClickShieldBlock = onClickShieldBlock;\nasync function selfApplyEffectFromMessage(message, html) {\n    const item = message.item;\n    const actor = item?.actor ?? message.actor;\n    if (!item || !actor)\n        return;\n    const button = html.querySelector(\".message-content .message-buttons button[data-action='apply-effect'][data-targets]\");\n    if (!button)\n        return;\n    button.disabled = true;\n    const target = fromUuidSync(button.dataset.targets ?? \"\");\n    const effect = item.isOfType(\"action\", \"feat\") && item.system.selfEffect\n        ? await fromUuid(item.system.selfEffect.uuid)\n        : null;\n    if ((0, foundry_api_1.isInstanceOf)(target, \"ActorPF2e\") &&\n        (0, foundry_api_1.isInstanceOf)(effect, \"EffectPF2e\")) {\n        const traits = item.system.traits.value?.filter((t) => t in CONFIG.PF2E.effectTraits) ?? [];\n        const effectSource = mergeObject(effect.toObject(), {\n            _id: null,\n            system: {\n                context: {\n                    origin: {\n                        actor: actor.uuid,\n                        token: message.token?.uuid ?? null,\n                        item: item.uuid,\n                        spellcasting: null,\n                        rollOptions: item.getOriginData().rollOptions,\n                    },\n                    target: {\n                        actor: target.uuid,\n                        token: target.getActiveTokens(true, true).at(0)?.uuid ?? null,\n                    },\n                    roll: null,\n                },\n                traits: { value: traits },\n            },\n        });\n        await target.createEmbeddedDocuments(\"Item\", [effectSource]);\n        const parsedMessageContent = (() => {\n            const container = document.createElement(\"div\");\n            container.innerHTML = message.content;\n            return container;\n        })();\n        const buttons = (0, utils_1.htmlQuery)(parsedMessageContent, \".message-buttons\");\n        if (buttons) {\n            const span = (0, utils_1.createHTMLElement)(\"span\", { classes: [\"effect-applied\"] });\n            const anchor = effect.toAnchor({ attrs: { draggable: \"true\" } });\n            const locKey = \"PF2E.Item.Action.SelfAppliedEffect.Applied\";\n            const statement = game.i18n.format(locKey, { effect: anchor.outerHTML });\n            span.innerHTML = statement;\n            buttons.replaceChildren(span);\n            await message.update({ content: parsedMessageContent.innerHTML });\n        }\n    }\n}\nexports.selfApplyEffectFromMessage = selfApplyEffectFromMessage;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.getSpellCollectionClass = exports.getStatisticClass = exports.getSpellClass = exports.getDamageRollClass = void 0;\nfunction getStatisticClass(statistic) {\n    return statistic.constructor;\n}\nexports.getStatisticClass = getStatisticClass;\nfunction getSpellCollectionClass(actor) {\n    return actor.spellcasting.get(\"rituals\").spells\n        .constructor;\n}\nexports.getSpellCollectionClass = getSpellCollectionClass;\nfunction getSpellClass() {\n    return CONFIG.PF2E.Item.documentClasses.spell;\n}\nexports.getSpellClass = getSpellClass;\nfunction getDamageRollClass() {\n    return CONFIG.Dice.rolls.find((Roll) => Roll.name === \"DamageRoll\");\n}\nexports.getDamageRollClass = getDamageRollClass;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.saveTypes = void 0;\nconst saveTypes = [\"fortitude\", \"reflex\", \"will\"];\nexports.saveTypes = saveTypes;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.calculateRemainingDuration = void 0;\nconst DURATION_UNITS = {\n    rounds: 6,\n    minutes: 60,\n    hours: 3600,\n    days: 86400,\n};\nfunction calculateRemainingDuration(effect, durationData, \n//added stuff\nfightyActor) {\n    if (durationData.unit === \"encounter\") {\n        const isExpired = effect.system.expired;\n        return { expired: !!isExpired, remaining: isExpired ? 0 : Infinity };\n    }\n    else if (durationData.unit === \"unlimited\" || !(\"start\" in effect.system)) {\n        return { expired: false, remaining: Infinity };\n    }\n    const start = effect.system.start.value;\n    const { combatant } = game.combat ?? {};\n    const { unit, expiry } = durationData;\n    const duration = durationData.value * (DURATION_UNITS[durationData.unit] ?? 0);\n    const addend = !combatant &&\n        duration === 0 &&\n        unit === \"rounds\" &&\n        [\"turn-end\", \"round-end\"].includes(expiry ?? \"\")\n        ? 1\n        : 0;\n    const remaining = start + duration + addend - game.time.worldTime;\n    const result = { remaining, expired: remaining <= 0 };\n    if (remaining === 0 && combatant?.actor) {\n        const startInitiative = effect.system.start.initiative ?? 0;\n        const currentInitiative = combatant.initiative ?? 0;\n        fightyActor ??= effect.actor?.isOfType(\"familiar\")\n            ? effect.actor.master ?? effect.actor\n            : effect.actor;\n        const atTurnStart = () => startInitiative === currentInitiative &&\n            combatant.actor === (effect.origin ?? fightyActor);\n        result.expired =\n            expiry === \"turn-start\"\n                ? atTurnStart()\n                : expiry === \"turn-end\"\n                    ? currentInitiative < startInitiative\n                    : expiry === \"round-end\"\n                        ? remaining <= 0 && game.time.worldTime > start\n                        : false;\n    }\n    return result;\n}\nexports.calculateRemainingDuration = calculateRemainingDuration;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.hasFreePropertySlot = exports.getEquippedHandwraps = exports.getCarryTypeActionData = exports.getAnnotationLabel = exports.consumeItem = exports.changeCarryType = exports.calculateItemPrice = exports.MoveLootPopup = exports.HANDWRAPS_SLUG = exports.BANDS_OF_FORCE_SLUGS = void 0;\nconst foundry_api_1 = require(\"foundry-api\");\nconst classes_1 = require(\"./classes\");\nconst utils_1 = require(\"./utils\");\nconst HANDWRAPS_SLUG = \"handwraps-of-mighty-blows\";\nexports.HANDWRAPS_SLUG = HANDWRAPS_SLUG;\nconst BANDS_OF_FORCE_SLUGS = [\n    \"bands-of-force\",\n    \"bands-of-force-greater\",\n    \"bands-of-force-major\",\n];\nexports.BANDS_OF_FORCE_SLUGS = BANDS_OF_FORCE_SLUGS;\nfunction getAnnotationLabel(annotation, hands) {\n    if (!annotation)\n        return null;\n    const fullAnnotation = [\"draw\", \"pick-up\", \"retrieve\"].includes(annotation)\n        ? `${annotation}${hands}H`\n        : [\"grip\", \"sheathe\", \"modular\", \"drop\"].includes(annotation)\n            ? annotation\n            : null;\n    return fullAnnotation ? game.pf2e.system.sluggify(fullAnnotation, { camel: \"bactrian\" }) : null;\n}\nexports.getAnnotationLabel = getAnnotationLabel;\nfunction getCarryTypeActionData(item, annotation, action = \"interact\") {\n    switch (annotation) {\n        case \"draw\":\n            return [1, \"held\"];\n        case \"pick-up\":\n            return [1, \"held\"];\n        case \"retrieve\": {\n            const { container } = item;\n            if (container?.isHeld)\n                return [1, \"held\"];\n            const usage = container?.system.usage;\n            const actionCost = usage?.type === \"held\" || usage?.where === \"backpack\" ? 2 : 1;\n            return [actionCost, \"held\"];\n        }\n        case \"grip\":\n            return [action === \"interact\" ? 1 : 0, \"held\"];\n        case \"sheathe\":\n            return [1, \"worn\"];\n        case \"modular\":\n            return [1, null];\n        case \"drop\":\n            return [0, \"dropped\"];\n        case \"tower-shield\": {\n            const cost = action === \"take-cover\" ? 1 : 0;\n            return [cost, null];\n        }\n        default:\n            return [1, null];\n    }\n}\nexports.getCarryTypeActionData = getCarryTypeActionData;\nasync function changeCarryType(actor, item, handsHeld, annotation, action = \"interact\") {\n    const [actionCost, carryType] = getCarryTypeActionData(item, annotation, action);\n    if (!carryType)\n        return;\n    await actor.changeCarryType(item, { carryType, handsHeld });\n    if (!game.combat)\n        return;\n    const templates = {\n        flavor: \"./systems/pf2e/templates/chat/action/flavor.hbs\",\n        content: \"./systems/pf2e/templates/chat/action/content.hbs\",\n    };\n    const sluggify = game.pf2e.system.sluggify;\n    const actionKey = sluggify(action, { camel: \"bactrian\" });\n    const annotationKey = annotation ? sluggify(annotation, { camel: \"bactrian\" }) : null;\n    const fullAnnotationKey = getAnnotationLabel(annotation, handsHeld);\n    const flavorAction = {\n        title: `PF2E.Actions.${actionKey}.Title`,\n        subtitle: fullAnnotationKey ? `PF2E.Actions.${actionKey}.${fullAnnotationKey}.Title` : null,\n        glyph: (0, utils_1.getActionGlyph)(actionCost),\n    };\n    const [traits, message] = action === \"raise-a-shield\"\n        ? [[], `PF2E.Actions.${actionKey}.Content`]\n        : [\"take-cover\", \"end-cover\"].includes(action)\n            ? [[], `PF2E.Actions.${actionKey}.${annotationKey}.Description`]\n            : [\n                [(0, utils_1.traitSlugToObject)(\"manipulate\", CONFIG.PF2E.actionTraits)],\n                `PF2E.Actions.${actionKey}.${fullAnnotationKey}.Description`,\n            ];\n    const flavor = await renderTemplate(templates.flavor, { action: flavorAction, traits });\n    const content = await renderTemplate(templates.content, {\n        imgPath: item.img,\n        message: game.i18n.format(message, {\n            actor: actor.name,\n            weapon: item.name,\n            // shield: item.shield?.name ?? item.name,\n            // damageType: game.i18n.localize(`PF2E.Damage.RollFlavor.${selection}`),\n        }),\n    });\n    const token = actor.getActiveTokens(false, true).shift();\n    await ChatMessage.implementation.create({\n        content,\n        speaker: ChatMessage.getSpeaker({ actor, token }),\n        flavor,\n        type: CONST.CHAT_MESSAGE_TYPES.EMOTE,\n    });\n}\nexports.changeCarryType = changeCarryType;\nfunction hasFreePropertySlot(item) {\n    const potency = item.system.runes.potency;\n    return potency > 0 && item.system.runes.property.length < potency;\n}\nexports.hasFreePropertySlot = hasFreePropertySlot;\nfunction getEquippedHandwraps(actor) {\n    return actor.itemTypes.weapon.find((weapon) => {\n        const { category, slug, equipped, identification } = weapon._source.system;\n        const { carryType, invested, inSlot } = equipped;\n        return (category === \"unarmed\" &&\n            carryType === \"worn\" &&\n            inSlot &&\n            invested &&\n            identification.status === \"identified\" &&\n            slug === HANDWRAPS_SLUG);\n    });\n}\nexports.getEquippedHandwraps = getEquippedHandwraps;\nfunction calculateItemPrice(item, quantity = 1, ratio = 1) {\n    const coins = game.pf2e.Coins.fromPrice(item.price, quantity);\n    return ratio === 1 ? coins : coins.scale(ratio);\n}\nexports.calculateItemPrice = calculateItemPrice;\nasync function consumeItem(event, item) {\n    const uses = item.uses;\n    if (uses.max && uses.value < 1)\n        return null;\n    if ([\"wand\", \"scroll\"].includes(item.category) && item.system.spell) {\n        return item.consume();\n    }\n    const actor = item.actor;\n    const multiUse = uses.max > 1;\n    const key = uses.value === 1 && multiUse ? \"UseExhausted\" : multiUse ? \"UseMulti\" : \"UseSingle\";\n    const flags = {\n        pf2e: {\n            origin: {\n                sourceId: item.sourceId,\n                uuid: item.uuid,\n                type: item.type,\n            },\n        },\n    };\n    const speaker = ChatMessage.getSpeaker({ actor });\n    const template = (await item.toMessage(event, { create: false })).content;\n    const contentHTML = (0, foundry_api_1.createHTMLFromString)(template);\n    contentHTML.querySelector(\"button[data-action='consume']\")?.remove();\n    contentHTML.querySelector(\"footer\")?.remove();\n    const flavor = contentHTML.outerHTML;\n    if (item.system.damage) {\n        const DamageRoll = (0, classes_1.getDamageRollClass)();\n        const { formula, type, kind } = item.system.damage;\n        const roll = new DamageRoll(`(${formula})[${type},${kind}]`);\n        roll.toMessage({\n            speaker,\n            flavor,\n            flags,\n        });\n    }\n    else {\n        ChatMessage.create({ speaker, content: flavor, flags });\n    }\n    if (item.system.uses.autoDestroy && uses.value <= 1) {\n        const quantityRemaining = item.quantity;\n        const isPreservedAmmo = item.category === \"ammo\" && item.system.rules.length > 0;\n        if (quantityRemaining <= 1 && !isPreservedAmmo) {\n            return item.delete();\n        }\n        else {\n            return item.update({\n                \"system.quantity\": Math.max(quantityRemaining - 1, 0),\n                \"system.uses.value\": uses.max,\n            });\n        }\n    }\n    else {\n        return item.update({\n            \"system.uses.value\": Math.max(uses.value - 1, 0),\n        });\n    }\n}\nexports.consumeItem = consumeItem;\nclass MoveLootPopup extends FormApplication {\n    onSubmitCallback;\n    constructor(object, options, callback) {\n        super(object, options);\n        this.onSubmitCallback = callback;\n    }\n    async getData() {\n        const [prompt, buttonLabel] = this.options.isPurchase\n            ? [\"PF2E.loot.PurchaseLootMessage\", \"PF2E.loot.PurchaseLoot\"]\n            : [\"PF2E.loot.MoveLootMessage\", \"PF2E.loot.MoveLoot\"];\n        return {\n            ...(await super.getData()),\n            quantity: {\n                default: this.options.quantity.default,\n                max: this.options.quantity.max,\n            },\n            newStack: this.options.newStack,\n            lockStack: this.options.lockStack,\n            prompt,\n            buttonLabel,\n        };\n    }\n    static get defaultOptions() {\n        return {\n            ...super.defaultOptions,\n            id: \"MoveLootPopup\",\n            classes: [],\n            title: game.i18n.localize(\"PF2E.loot.MoveLootPopupTitle\"),\n            template: \"systems/pf2e/templates/popups/loot/move-loot-popup.hbs\",\n            width: \"auto\",\n            quantity: {\n                default: 1,\n                max: 1,\n            },\n            newStack: false,\n            lockStack: false,\n            isPurchase: false,\n        };\n    }\n    async _updateObject(_event, formData) {\n        this.onSubmitCallback(formData.quantity, formData.newStack);\n    }\n}\nexports.MoveLootPopup = MoveLootPopup;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.RollNotePF2e = void 0;\nconst utils_1 = require(\"./utils\");\nclass RollNotePF2e {\n    selector;\n    title;\n    text;\n    predicate;\n    outcome;\n    visibility;\n    rule;\n    constructor(params) {\n        this.selector = params.selector;\n        this.title = params.title ?? null;\n        this.text = params.text;\n        this.predicate = new game.pf2e.Predicate(params.predicate ?? []);\n        this.outcome = [...(params.outcome ?? [])];\n        this.visibility = params.visibility ?? null;\n        this.rule = params.rule ?? null;\n    }\n    static notesToHTML(notes) {\n        if (notes.length === 0)\n            return null;\n        return (0, utils_1.createHTMLElement)(\"ul\", {\n            classes: [\"notes\"],\n            children: [...notes.flatMap((n) => [\"\\n\", n.toHTML()]), \"\\n\"],\n        });\n    }\n    toHTML() {\n        const element = (0, utils_1.createHTMLElement)(\"li\", {\n            classes: [\"roll-note\"],\n            dataset: {\n                itemId: this.rule?.item.id,\n                visibility: this.visibility,\n            },\n            innerHTML: game.i18n.localize(this.text),\n        });\n        if (element.childNodes.length === 1 && element.firstChild instanceof HTMLElement) {\n            element.innerHTML = element.firstChild.innerHTML;\n        }\n        if (this.title) {\n            const strong = (0, utils_1.createHTMLElement)(\"strong\", {\n                innerHTML: game.i18n.localize(this.title),\n            });\n            element.prepend(strong, \" \");\n        }\n        return element;\n    }\n    clone() {\n        return new RollNotePF2e({ ...this.toObject(), rule: this.rule });\n    }\n    toObject() {\n        return {\n            selector: this.selector,\n            title: this.title,\n            text: this.text,\n            predicate: this.predicate.toObject(),\n            outcome: this.outcome,\n            visibility: this.visibility,\n        };\n    }\n}\nexports.RollNotePF2e = RollNotePF2e;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.warnInvalidDrop = exports.upgradeStatisticRank = exports.spellSlotGroupIdToNumber = exports.getSummarizedSpellsDataForRender = exports.getRankLabel = exports.getHighestSyntheticStatistic = exports.getHighestSpellcastingStatistic = exports.getActorMaxRank = exports.createCounteractStatistic = exports.coerceToSpellGroupId = exports.MAGIC_TRADITIONS = exports.EFFECT_AREA_SHAPES = void 0;\nconst foundry_api_1 = require(\"foundry-api\");\nconst _1 = require(\".\");\nconst EFFECT_AREA_SHAPES = [\n    \"burst\",\n    \"cone\",\n    \"cube\",\n    \"cylinder\",\n    \"emanation\",\n    \"line\",\n    \"square\",\n];\nexports.EFFECT_AREA_SHAPES = EFFECT_AREA_SHAPES;\nconst MAGIC_TRADITIONS = new Set([\"arcane\", \"divine\", \"occult\", \"primal\"]);\nexports.MAGIC_TRADITIONS = MAGIC_TRADITIONS;\nfunction getStatisticData(statistic) {\n    const data = deepClone(statistic.data);\n    data.modifiers = (statistic.modifiers ?? []).map((modifier) => modifier.toObject());\n    return data;\n}\nfunction createStatisticFromRawData(actor, data) {\n    const Statistic = (0, _1.getStatisticClass)(actor.skills.acrobatics);\n    const statisticData = deepClone(data);\n    statisticData.modifiers = data.modifiers.map((modifier) => new game.pf2e.Modifier(modifier));\n    return new Statistic(actor, statisticData);\n}\nfunction upgradeStatisticRank(statistic, rank) {\n    if (statistic.rank && statistic.rank >= rank) {\n        return statistic;\n    }\n    const statisticData = getStatisticData(statistic);\n    return createStatisticFromRawData(statistic.actor, statisticData);\n}\nexports.upgradeStatisticRank = upgradeStatisticRank;\nfunction createCounteractStatistic(ability) {\n    const actor = ability.actor;\n    const baseModifier = actor.isOfType(\"npc\")\n        ? ability.statistic.check.modifiers\n            .find((m) => m.type === \"untyped\" && m.slug === \"base\")\n            ?.clone()\n        : null;\n    const Statistic = (0, _1.getStatisticClass)(ability.statistic);\n    return new Statistic(actor, {\n        slug: \"counteract\",\n        label: \"PF2E.Item.Spell.Counteract.Label\",\n        attribute: ability.statistic.attribute,\n        rank: ability.statistic.rank || 1,\n        check: { type: \"check\", modifiers: foundry_api_1.R.compact([baseModifier]) },\n    });\n}\nexports.createCounteractStatistic = createCounteractStatistic;\nfunction getHighestSyntheticStatistic(actor, withClassDcs = true) {\n    const synthetics = Array.from(actor.synthetics.statistics.values());\n    const statistics = withClassDcs\n        ? [...synthetics, ...Object.values(actor.classDCs)]\n        : synthetics;\n    if (!statistics.length)\n        return;\n    const classStatistic = actor.classDC;\n    const groupedStatistics = foundry_api_1.R.groupBy(statistics, foundry_api_1.R.prop(\"mod\"));\n    const highestMod = foundry_api_1.R.pipe(groupedStatistics, foundry_api_1.R.keys, foundry_api_1.R.sortBy([foundry_api_1.R.identity, \"desc\"]), foundry_api_1.R.first());\n    if (classStatistic && highestMod && classStatistic.mod === highestMod) {\n        return classStatistic;\n    }\n    return groupedStatistics[highestMod][0];\n}\nexports.getHighestSyntheticStatistic = getHighestSyntheticStatistic;\nfunction getHighestSpellcastingStatistic(actor) {\n    const entries = actor.spellcasting.spellcastingFeatures;\n    if (!entries.length)\n        return;\n    const classAttribute = actor.classDC?.attribute;\n    const groupedEntries = foundry_api_1.R.groupBy(entries, (entry) => entry.statistic.mod);\n    const highestMod = foundry_api_1.R.pipe(groupedEntries, foundry_api_1.R.keys, foundry_api_1.R.sortBy([(x) => Number(x), \"desc\"]), foundry_api_1.R.first());\n    const highestResults = groupedEntries[highestMod].map((entry) => ({\n        tradition: entry.tradition,\n        statistic: entry.statistic,\n    }));\n    if (highestResults.length === 1 || !classAttribute) {\n        return highestResults[0];\n    }\n    return (highestResults.find((entry) => entry.statistic.attribute === classAttribute) ||\n        highestResults[0]);\n}\nexports.getHighestSpellcastingStatistic = getHighestSpellcastingStatistic;\nfunction getActorMaxRank(actor) {\n    return Math.max(1, Math.ceil(actor.level / 2));\n}\nexports.getActorMaxRank = getActorMaxRank;\nfunction getRankLabel(rank) {\n    return game.i18n.format(\"PF2E.Item.Spell.Rank.Ordinal\", {\n        rank: (0, _1.ordinalString)(rank),\n    });\n}\nexports.getRankLabel = getRankLabel;\nfunction coerceToSpellGroupId(value) {\n    if (value === \"cantrips\")\n        return value;\n    const numericValue = Number(value) || NaN;\n    return numericValue.between(1, 10) ? numericValue : null;\n}\nexports.coerceToSpellGroupId = coerceToSpellGroupId;\nfunction spellSlotGroupIdToNumber(groupId) {\n    if (groupId === \"cantrips\")\n        return 0;\n    const numericValue = Number(groupId ?? NaN);\n    return numericValue.between(0, 10) ? numericValue : null;\n}\nexports.spellSlotGroupIdToNumber = spellSlotGroupIdToNumber;\nfunction warnInvalidDrop(warning, { spell, groupId }) {\n    const localize = (0, _1.localizer)(\"PF2E.Item.Spell.Warning\");\n    if (warning === \"invalid-rank\" && typeof groupId === \"number\") {\n        const spellRank = game.i18n.format(\"PF2E.Item.Spell.Rank.Ordinal\", {\n            rank: (0, _1.ordinalString)(spell.baseRank),\n        });\n        const targetRank = game.i18n.format(\"PF2E.Item.Spell.Rank.Ordinal\", {\n            rank: (0, _1.ordinalString)(groupId),\n        });\n        ui.notifications.warn(localize(\"InvalidRank\", { spell: spell.name, spellRank, targetRank }));\n    }\n    else if (warning === \"cantrip-mismatch\") {\n        const locKey = spell.isCantrip ? \"CantripToRankedSlots\" : \"NonCantripToCantrips\";\n        ui.notifications.warn(localize(locKey, { spell: spell.name }));\n    }\n    else if (warning === \"invalid-spell\") {\n        const type = game.i18n.localize(\"PF2E.TraitFocus\");\n        ui.notifications.warn(localize(\"WrongSpellType\", { type }));\n    }\n}\nexports.warnInvalidDrop = warnInvalidDrop;\nasync function getSummarizedSpellsDataForRender(actor, sortByType, localize, entries) {\n    entries ??= await Promise.all(actor.spellcasting.collections.map((spells) => spells.entry.getSheetData({ spells })));\n    const focusPool = actor.system.resources?.focus ?? { value: 0, max: 0 };\n    const pf2eDailies = (0, foundry_api_1.getActiveModule)(\"pf2e-dailies\");\n    const spells = [];\n    const labels = [];\n    let hasFocusCantrip = false;\n    for (const entry of entries) {\n        const entryId = entry.id;\n        const entryDc = entry.statistic?.dc.value;\n        const entryTooltip = entryDc\n            ? `${entry.name} - ${game.i18n.format(\"PF2E.DCWithValue\", { dc: entryDc, text: \"\" })}`\n            : entry.name;\n        const isFocus = entry.isFocusPool;\n        const isRitual = entry.isRitual;\n        const isCharges = entry.category === \"charges\";\n        const isStaff = entry.isStaff;\n        const isInnate = entry.isInnate;\n        const isPrepared = entry.isPrepared;\n        const isSpontaneous = entry.isSpontaneous;\n        const isFlexible = entry.isFlexible;\n        const consumable = entry.category === \"items\"\n            ? actor.items.get(entryId.split(\"-\")[0])\n            : undefined;\n        for (const group of entry.groups) {\n            if (!group.active.length || group.uses?.max === 0)\n                continue;\n            const groupNumber = spellSlotGroupIdToNumber(group.id);\n            const slotSpells = [];\n            const isCantrip = group.id === \"cantrips\";\n            const isBroken = !isCantrip && isCharges && !pf2eDailies?.active;\n            const groupUses = typeof group.uses?.value === \"number\" ? group.uses : undefined;\n            for (let slotId = 0; slotId < group.active.length; slotId++) {\n                const active = group.active[slotId];\n                if (!active?.spell || active.uses?.max === 0)\n                    continue;\n                const { spell } = active;\n                const spellId = spell.id;\n                const uses = isCantrip || isFocus || consumable || (isPrepared && !isFlexible)\n                    ? undefined\n                    : isCharges && !isBroken\n                        ? entry.uses\n                        : active.uses ?? groupUses;\n                slotSpells.push({\n                    name: spell.name,\n                    itemId: spellId,\n                    entryId,\n                    groupId: group.id,\n                    slotId,\n                    action: spell.system.time.value,\n                    castRank: active.castRank ?? spell.rank,\n                    expended: isFocus ? !isCantrip && focusPool.value <= 0 : active.expended,\n                    img: spell.img,\n                    range: spell.system.range.value || \"-&nbsp;\",\n                    rank: spell.rank,\n                    entryName: entry.name,\n                    entryDc,\n                    entryTooltip,\n                    consumable,\n                    isBroken,\n                    isFocus,\n                    isRitual,\n                    isCharges,\n                    isStaff,\n                    isInnate,\n                    isPrepared,\n                    isSpontaneous,\n                    isFlexible,\n                    uses: uses\n                        ? {\n                            ...uses,\n                            input: isStaff\n                                ? \"\"\n                                : isCharges\n                                    ? \"system.slots.slot1.value\"\n                                    : isInnate\n                                        ? \"system.location.uses.value\"\n                                        : `system.slots.slot${groupNumber}.value`,\n                            itemId: isStaff ? \"\" : isInnate ? spellId : entryId,\n                        }\n                        : undefined,\n                    order: isCharges\n                        ? 0\n                        : isPrepared\n                            ? 1\n                            : isFocus\n                                ? 2\n                                : isInnate\n                                    ? 3\n                                    : isSpontaneous\n                                        ? 4\n                                        : 5,\n                    category: consumable\n                        ? `PF2E.Item.Consumable.Category.${consumable.category}`\n                        : isStaff\n                            ? localize(\"staff\")\n                            : isCharges\n                                ? localize(\"charges\")\n                                : isInnate\n                                    ? \"PF2E.PreparationTypeInnate\"\n                                    : isSpontaneous\n                                        ? \"PF2E.PreparationTypeSpontaneous\"\n                                        : isFlexible\n                                            ? \"PF2E.SpellFlexibleLabel\"\n                                            : isFocus\n                                                ? \"PF2E.TraitFocus\"\n                                                : \"PF2E.SpellPreparedLabel\",\n                });\n            }\n            if (slotSpells.length) {\n                if (isFocus) {\n                    if (isCantrip) {\n                        hasFocusCantrip = true;\n                    }\n                    else {\n                        spells[12] ??= [];\n                        spells[12].push(...slotSpells);\n                        continue;\n                    }\n                }\n                else if (isRitual) {\n                    spells[13] ??= [];\n                    spells[13].push(...slotSpells);\n                    continue;\n                }\n                labels[groupNumber] ??= group.label;\n                spells[groupNumber] ??= [];\n                spells[groupNumber].push(...slotSpells);\n            }\n        }\n    }\n    if (spells.length) {\n        const orderSort = (a, b) => a.order === b.order ? (0, foundry_api_1.localeCompare)(a.name, b.name) : a.order - b.order;\n        const nameSort = (a, b) => (0, foundry_api_1.localeCompare)(a.name, b.name);\n        const sort = sortByType ? orderSort : nameSort;\n        for (let i = 0; i < spells.length; i++) {\n            const entry = spells[i];\n            if (!entry || i > 11)\n                continue;\n            entry.sort(sort);\n        }\n    }\n    labels[12] = \"PF2E.Focus.Spells\";\n    labels[13] = \"PF2E.Actor.Character.Spellcasting.Tab.Rituals\";\n    return {\n        labels,\n        spells,\n        focusPool,\n        isOwner: actor.isOwner,\n        hasFocusCantrip,\n    };\n}\nexports.getSummarizedSpellsDataForRender = getSummarizedSpellsDataForRender;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.createConsumableFromSpell = void 0;\nconst foundry_api_1 = require(\"foundry-api\");\nconst _1 = require(\".\");\nconst CANTRIP_DECK_ID = \"tLa4bewBhyqzi6Ow\";\nconst scrollCompendiumIds = {\n    1: \"RjuupS9xyXDLgyIr\",\n    2: \"Y7UD64foDbDMV9sx\",\n    3: \"ZmefGBXGJF3CFDbn\",\n    4: \"QSQZJ5BC3DeHv153\",\n    5: \"tjLvRWklAylFhBHQ\",\n    6: \"4sGIy77COooxhQuC\",\n    7: \"fomEZZ4MxVVK3uVu\",\n    8: \"iPki3yuoucnj7bIt\",\n    9: \"cFHomF3tty8Wi1e5\",\n    10: \"o1XIHJ4MJyroAHfF\",\n};\nconst wandCompendiumIds = {\n    1: \"UJWiN0K3jqVjxvKk\",\n    2: \"vJZ49cgi8szuQXAD\",\n    3: \"wrDmWkGxmwzYtfiA\",\n    4: \"Sn7v9SsbEDMUIwrO\",\n    5: \"5BF7zMnrPYzyigCs\",\n    6: \"kiXh4SUWKr166ZeM\",\n    7: \"nmXPj9zuMRQBNT60\",\n    8: \"Qs8RgNH6thRPv2jt\",\n    9: \"Fgv722039TVM5JTc\",\n};\nconst SPELL_CONSUMABLE_NAME_TEMPLATES = {\n    cantripDeck5: \"PF2E.Item.Physical.FromSpell.CantripDeck5\",\n    scroll: \"PF2E.Item.Physical.FromSpell.Scroll\",\n    wand: \"PF2E.Item.Physical.FromSpell.Wand\",\n};\nfunction getIdForSpellConsumable(type, heightenedLevel) {\n    switch (type) {\n        case \"cantripDeck5\":\n            return CANTRIP_DECK_ID;\n        case \"scroll\":\n            return scrollCompendiumIds[heightenedLevel] ?? null;\n        default:\n            return wandCompendiumIds[heightenedLevel] ?? null;\n    }\n}\nfunction getNameForSpellConsumable(type, spellName, heightenedLevel) {\n    const templateId = SPELL_CONSUMABLE_NAME_TEMPLATES[type] ||\n        `${type} of {name} (Rank {level})`;\n    return game.i18n.format(templateId, { name: spellName, level: heightenedLevel });\n}\nasync function createConsumableFromSpell(spell, { type, heightenedLevel = spell.baseRank, mystified = false, temp, itemName, itemImg, }) {\n    const pack = game.packs.find((p) => p.collection === \"pf2e.equipment-srd\");\n    const itemId = getIdForSpellConsumable(type, heightenedLevel);\n    const consumable = await pack?.getDocument(itemId ?? \"\");\n    if (!(0, foundry_api_1.isInstanceOf)(consumable, \"ConsumablePF2e\")) {\n        throw (0, _1.ErrorPF2e)(\"Failed to retrieve consumable item\");\n    }\n    const consumableSource = { ...consumable.toObject(), _id: null }; // Clear _id\n    const traits = consumableSource.system.traits;\n    traits.value = foundry_api_1.R.uniq([...traits.value, ...spell.traits]);\n    traits.rarity = spell.rarity;\n    if (traits.value.includes(\"magical\") &&\n        traits.value.some((t) => (0, _1.setHasElement)(_1.MAGIC_TRADITIONS, t))) {\n        traits.value.splice(traits.value.indexOf(\"magical\"), 1);\n    }\n    traits.value.sort();\n    consumableSource.name = getNameForSpellConsumable(itemName ?? type, spell.name, heightenedLevel);\n    const description = consumableSource.system.description.value;\n    consumableSource.system.description.value = (() => {\n        const paragraphElement = document.createElement(\"p\");\n        paragraphElement.append(spell.sourceId ? `@UUID[${spell.sourceId}]{${spell.name}}` : spell.description);\n        const containerElement = document.createElement(\"div\");\n        const hrElement = document.createElement(\"hr\");\n        containerElement.append(paragraphElement, hrElement);\n        hrElement.insertAdjacentHTML(\"afterend\", description);\n        return containerElement.innerHTML;\n    })();\n    // Cantrip deck casts at level 1\n    if (type !== \"cantripDeck5\") {\n        consumableSource.system.spell = mergeObject(spell._source, { _id: randomID(), system: { location: { value: null, heightenedLevel } } }, { inplace: false });\n    }\n    if (mystified) {\n        consumableSource.system.identification.status = \"unidentified\";\n    }\n    if (typeof itemImg === \"string\") {\n        consumableSource.img = itemImg;\n    }\n    if (temp) {\n        consumableSource.system.temporary = true;\n    }\n    return consumableSource;\n}\nexports.createConsumableFromSpell = createConsumableFromSpell;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.getTranslatedSkills = exports.SKILL_LONG_FORMS = exports.SKILL_EXPANDED = exports.SKILL_DICTIONARY = exports.SKILL_ABBREVIATIONS = exports.ATTRIBUTE_ABBREVIATIONS = void 0;\nconst SKILL_ABBREVIATIONS = [\n    \"acr\",\n    \"arc\",\n    \"ath\",\n    \"cra\",\n    \"dec\",\n    \"dip\",\n    \"itm\",\n    \"med\",\n    \"nat\",\n    \"occ\",\n    \"prf\",\n    \"rel\",\n    \"soc\",\n    \"ste\",\n    \"sur\",\n    \"thi\",\n];\nexports.SKILL_ABBREVIATIONS = SKILL_ABBREVIATIONS;\nconst SKILL_DICTIONARY = {\n    acr: \"acrobatics\",\n    arc: \"arcana\",\n    ath: \"athletics\",\n    cra: \"crafting\",\n    dec: \"deception\",\n    dip: \"diplomacy\",\n    itm: \"intimidation\",\n    med: \"medicine\",\n    nat: \"nature\",\n    occ: \"occultism\",\n    prf: \"performance\",\n    rel: \"religion\",\n    soc: \"society\",\n    ste: \"stealth\",\n    sur: \"survival\",\n    thi: \"thievery\",\n};\nexports.SKILL_DICTIONARY = SKILL_DICTIONARY;\nconst SKILL_EXPANDED = {\n    acrobatics: { attribute: \"dex\", shortForm: \"acr\" },\n    arcana: { attribute: \"int\", shortForm: \"arc\" },\n    athletics: { attribute: \"str\", shortForm: \"ath\" },\n    crafting: { attribute: \"int\", shortForm: \"cra\" },\n    deception: { attribute: \"cha\", shortForm: \"dec\" },\n    diplomacy: { attribute: \"cha\", shortForm: \"dip\" },\n    intimidation: { attribute: \"cha\", shortForm: \"itm\" },\n    medicine: { attribute: \"wis\", shortForm: \"med\" },\n    nature: { attribute: \"wis\", shortForm: \"nat\" },\n    occultism: { attribute: \"int\", shortForm: \"occ\" },\n    performance: { attribute: \"cha\", shortForm: \"prf\" },\n    religion: { attribute: \"wis\", shortForm: \"rel\" },\n    society: { attribute: \"int\", shortForm: \"soc\" },\n    stealth: { attribute: \"dex\", shortForm: \"ste\" },\n    survival: { attribute: \"wis\", shortForm: \"sur\" },\n    thievery: { attribute: \"dex\", shortForm: \"thi\" },\n};\nexports.SKILL_EXPANDED = SKILL_EXPANDED;\nconst ATTRIBUTE_ABBREVIATIONS = new Set([\"str\", \"dex\", \"con\", \"int\", \"wis\", \"cha\"]);\nexports.ATTRIBUTE_ABBREVIATIONS = ATTRIBUTE_ABBREVIATIONS;\nconst SKILL_LONG_FORMS = new Set(Object.values(SKILL_DICTIONARY));\nexports.SKILL_LONG_FORMS = SKILL_LONG_FORMS;\nlet TRANSLATED_SKILL;\nfunction getTranslatedSkills() {\n    if (!TRANSLATED_SKILL) {\n        TRANSLATED_SKILL = {};\n        for (const [key, value] of Object.entries(CONFIG.PF2E.skillList)) {\n            TRANSLATED_SKILL[key] = game.i18n\n                .localize(value)\n                .toLocaleLowerCase(game.i18n.lang);\n        }\n    }\n    return deepClone(TRANSLATED_SKILL);\n}\nexports.getTranslatedSkills = getTranslatedSkills;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.getTemplateTokens = void 0;\n/**\n * @param {unknown} measuredTemplate\n * @param {{collisionOrigin?: {x: number, y: number}, collisionType?: \"move\" | \"sight\"}} [options]\n * @returns {unknown[]}\n */\nfunction getTemplateTokens(measuredTemplate, { collisionOrigin, collisionType = \"move\", } = {}) {\n    const { grid, dimensions } = canvas;\n    const template = measuredTemplate instanceof MeasuredTemplateDocument\n        ? measuredTemplate.object\n        : measuredTemplate;\n    if (!canvas.scene || !template?.highlightId || !grid || !dimensions)\n        return [];\n    const gridHighlight = grid.getHighlightLayer(template.highlightId);\n    if (!gridHighlight || grid.type !== CONST.GRID_TYPES.SQUARE)\n        return [];\n    const origin = collisionOrigin ?? template.center;\n    const tokens = canvas.tokens.quadtree.getObjects(gridHighlight.getLocalBounds(undefined, true));\n    const gridSize = grid.size;\n    const containedTokens = [];\n    for (const token of tokens) {\n        const tokenDoc = token.document;\n        const tokenPositions = [];\n        for (let h = 0; h < tokenDoc.height; h++) {\n            const tokenX = Math.floor(token.x / gridSize) * gridSize;\n            const tokenY = Math.floor(token.y / gridSize) * gridSize;\n            const y = tokenY + h * gridSize;\n            tokenPositions.push(`${tokenX}.${y}`);\n            if (tokenDoc.width > 1) {\n                for (let w = 1; w < tokenDoc.width; w++) {\n                    tokenPositions.push(`${tokenX + w * gridSize}.${y}`);\n                }\n            }\n        }\n        for (const position of tokenPositions) {\n            if (!gridHighlight.positions.has(position)) {\n                continue;\n            }\n            const [gx, gy] = position.split(\".\").map((s) => Number(s));\n            const destination = {\n                x: gx + dimensions.size * 0.5,\n                y: gy + dimensions.size * 0.5,\n            };\n            if (destination.x < 0 || destination.y < 0)\n                continue;\n            const hasCollision = canvas.ready &&\n                collisionType &&\n                CONFIG.Canvas.polygonBackends[collisionType].testCollision(origin, destination, {\n                    type: collisionType,\n                    mode: \"any\",\n                });\n            if (!hasCollision) {\n                containedTokens.push(token);\n                break;\n            }\n        }\n    }\n    return containedTokens;\n}\nexports.getTemplateTokens = getTemplateTokens;\n", "\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __exportStar = (this && this.__exportStar) || function(m, exports) {\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(exports, p)) __createBinding(exports, m, p);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\n__exportStar(require(\"./actor\"), exports);\n__exportStar(require(\"./application\"), exports);\n__exportStar(require(\"./browser\"), exports);\n__exportStar(require(\"./chat\"), exports);\n__exportStar(require(\"./classes\"), exports);\n__exportStar(require(\"./classes\"), exports);\n__exportStar(require(\"./data\"), exports);\n__exportStar(require(\"./effect\"), exports);\n__exportStar(require(\"./item\"), exports);\n__exportStar(require(\"./notes\"), exports);\n__exportStar(require(\"./rules\"), exports);\n__exportStar(require(\"./spell\"), exports);\n__exportStar(require(\"./spell-consumables\"), exports);\n__exportStar(require(\"./skills\"), exports);\n__exportStar(require(\"./template\"), exports);\n__exportStar(require(\"./utils\"), exports);\n", "export * from 'foundry-api'\r\nexport * from './dist'\r\n", "import {\r\n    MODULE,\r\n    beforeHTMLFromString,\r\n    elementData,\r\n    htmlElement,\r\n    localize,\r\n    querySelector,\r\n    registerSetting,\r\n} from \"pf2e-api\";\r\nimport { ToolConfig } from \"./tool\";\r\n\r\nconst firstSettings: { tool: string; key: string }[] = [];\r\n\r\nfunction onRenderSettingsConfig(app: SettingsConfig, $html: JQuery) {\r\n    const html = htmlElement($html);\r\n    const tab = querySelector(html, `.tab[data-tab=\"${MODULE.id}\"]`);\r\n    if (!tab) return;\r\n\r\n    for (const { tool, key } of firstSettings) {\r\n        const group = tab.querySelector(`[data-setting-id=\"${MODULE.id}.${key}\"]`);\r\n\r\n        if (group) {\r\n            const title = localize(\"settings\", tool, \"title\");\r\n            beforeHTMLFromString(group, `<h3>${title}</h3>`);\r\n        }\r\n    }\r\n\r\n    const groups = tab.querySelectorAll<HTMLElement>(\"[data-setting-id]\");\r\n\r\n    for (const group of groups) {\r\n        const { settingId } = elementData(group);\r\n        const setting = game.settings.settings.get(settingId)!;\r\n\r\n        if (setting.requiresReload) {\r\n            const label = querySelector(group, \"label\")!;\r\n            label.textContent = `${label.textContent} ${localize(\"settings.requiresReload\")}`;\r\n        }\r\n    }\r\n}\r\n\r\nfunction registerToolsSettings(tools: ToolConfig[], isGM: boolean) {\r\n    for (const { name, settings } of tools) {\r\n        for (const setting of settings) {\r\n            setting.key = `${name}.${setting.key}`;\r\n            registerSetting(setting);\r\n        }\r\n\r\n        const firstSetting = isGM\r\n            ? settings.find((setting) => setting.config !== false)\r\n            : settings.find((setting) => setting.scope === \"client\" && setting.config !== false);\r\n\r\n        if (firstSetting) {\r\n            firstSettings.push({\r\n                tool: name,\r\n                key: firstSetting.key,\r\n            });\r\n        }\r\n    }\r\n}\r\n\r\nexport { onRenderSettingsConfig, registerToolsSettings };\r\n", "import { MODULE, libWrapper, registerWrapper, unregisterWrapper } from \"pf2e-api\";\r\n\r\nfunction createSharedWrapper<TListener extends (...args: any[]) => any>(\r\n    path: string,\r\n    callback: (listeners: TListener[], wrapped: libWrapper.RegisterCallback, ...args: any[]) => any\r\n) {\r\n    let wrapperId: number | null = null;\r\n    const listeners: Record<string, TListener> = {};\r\n\r\n    const wrapper = function (this: any, wrapped: libWrapper.RegisterCallback, ...args: any[]) {\r\n        try {\r\n            return callback.call(this, Object.values(listeners), wrapped, ...args);\r\n        } catch (error) {\r\n            MODULE.error(`an error occured in the shared wrapper'\\n${path}`, error);\r\n\r\n            const wrapFn = args.splice(0)[0] as Function;\r\n            return wrapFn(...args);\r\n        }\r\n    };\r\n\r\n    return {\r\n        activate(id: string, callback: TListener) {\r\n            if (!(id in listeners)) {\r\n                listeners[id] = callback;\r\n            }\r\n            if (wrapperId === null) {\r\n                wrapperId = registerWrapper(path, wrapper, \"WRAPPER\");\r\n            }\r\n        },\r\n        disable(id: string) {\r\n            if (id in listeners) {\r\n                delete listeners[id];\r\n            }\r\n            if (wrapperId !== null && isEmpty(listeners)) {\r\n                unregisterWrapper(wrapperId);\r\n                wrapperId = null;\r\n            }\r\n        },\r\n        toggle(id: string, callback: TListener, enabled: boolean) {\r\n            if (enabled) this.activate(id, callback);\r\n            else this.disable(id);\r\n        },\r\n    };\r\n}\r\n\r\nexport { createSharedWrapper };\r\n", "import { htmlElement, isPlayedActor, libWrapper } from \"pf2e-api\";\r\nimport { createSharedWrapper } from \"./sharedWrapper\";\r\n\r\nconst CHARACTER_SHEET_RENDER =\r\n    \"CONFIG.Actor.sheetClasses.character['pf2e.CharacterSheetPF2e'].cls.prototype._render\";\r\nconst CHARACTER_SHEET_RENDER_INNER =\r\n    \"CONFIG.Actor.sheetClasses.character['pf2e.CharacterSheetPF2e'].cls.prototype._renderInner\";\r\nconst CHARACTER_SHEET_ACTIVATE_LISTENERS =\r\n    \"CONFIG.Actor.sheetClasses.character['pf2e.CharacterSheetPF2e'].cls.prototype.activateListeners\";\r\n\r\nconst characterSheetWrappers = {\r\n    [CHARACTER_SHEET_RENDER]: createSharedWrapper(CHARACTER_SHEET_RENDER, characterSheetPF2eRender),\r\n    [CHARACTER_SHEET_RENDER_INNER]: createSharedWrapper(\r\n        CHARACTER_SHEET_RENDER_INNER,\r\n        characterSheetPF2eRenderInner\r\n    ),\r\n    [CHARACTER_SHEET_ACTIVATE_LISTENERS]: createSharedWrapper(\r\n        CHARACTER_SHEET_ACTIVATE_LISTENERS,\r\n        characterSheetPF2eActivateListeners\r\n    ),\r\n};\r\n\r\nasync function characterSheetPF2eRender(\r\n    this: CharacterSheetPF2e,\r\n    listeners: ((event: \"before\" | \"after\", ...args: any[]) => Promise<void>)[],\r\n    wrapped: libWrapper.RegisterCallback,\r\n    ...args: any[]\r\n) {\r\n    if (!hasValidCharacter(this)) return wrapped(...args);\r\n\r\n    for (const listener of listeners) {\r\n        await listener.call(this, \"before\", ...args);\r\n    }\r\n\r\n    await wrapped(...args);\r\n\r\n    for (const listener of listeners) {\r\n        await listener.call(this, \"after\", ...args);\r\n    }\r\n}\r\n\r\nasync function characterSheetPF2eRenderInner(\r\n    this: CharacterSheetPF2e,\r\n    listeners: ((html: HTMLElement, data: CharacterSheetData) => Promise<void>)[],\r\n    wrapped: libWrapper.RegisterCallback,\r\n    data: CharacterSheetData\r\n) {\r\n    const $html = await wrapped(data);\r\n    const html = htmlElement($html);\r\n\r\n    if (!hasValidCharacter(this)) return $html;\r\n\r\n    for (const listener of listeners) {\r\n        await listener.call(this, html, data);\r\n    }\r\n\r\n    return $html;\r\n}\r\n\r\nfunction characterSheetPF2eActivateListeners(\r\n    this: CharacterSheetPF2e,\r\n    listeners: ((html: HTMLElement) => void)[],\r\n    wrapped: libWrapper.RegisterCallback,\r\n    $html: JQuery\r\n) {\r\n    wrapped($html);\r\n\r\n    if (!hasValidCharacter(this)) return;\r\n\r\n    const html = htmlElement($html);\r\n\r\n    for (const listener of listeners) {\r\n        listener.call(this, html);\r\n    }\r\n}\r\n\r\nfunction hasValidCharacter(sheet: CharacterSheetPF2e) {\r\n    const actor = sheet.actor;\r\n    return isPlayedActor(actor) && actor.permission > CONST.DOCUMENT_PERMISSION_LEVELS.LIMITED;\r\n}\r\n\r\nexport {\r\n    CHARACTER_SHEET_ACTIVATE_LISTENERS,\r\n    CHARACTER_SHEET_RENDER,\r\n    CHARACTER_SHEET_RENDER_INNER,\r\n    characterSheetWrappers,\r\n};\r\n", "import { libWrapper } from \"pf2e-api\";\r\nimport { createSharedWrapper } from \"./sharedWrapper\";\r\n\r\nconst WEAPON_PREPARE_BASE_DATA =\r\n    \"CONFIG.PF2E.Item.documentClasses.weapon.prototype.prepareBaseData\";\r\nconst WEAPON_PREPARE_DERIVED_DATA =\r\n    \"CONFIG.PF2E.Item.documentClasses.weapon.prototype.prepareDerivedData\";\r\nconst ARMOR_PREPARE_BASE_DATA = \"CONFIG.PF2E.Item.documentClasses.armor.prototype.prepareBaseData\";\r\nconst ARMOR_PREPARE_DERIVED_DATA =\r\n    \"CONFIG.PF2E.Item.documentClasses.armor.prototype.prepareDerivedData\";\r\n\r\nconst prepareDocumentWrappers = {\r\n    [WEAPON_PREPARE_BASE_DATA]: createSharedWrapper(\r\n        WEAPON_PREPARE_BASE_DATA,\r\n        prepareBaseData<WeaponPF2e>\r\n    ),\r\n    [ARMOR_PREPARE_BASE_DATA]: createSharedWrapper(\r\n        ARMOR_PREPARE_BASE_DATA,\r\n        prepareBaseData<ArmorPF2e>\r\n    ),\r\n};\r\n\r\nfunction prepareBaseData<T extends FoundryDocument>(\r\n    this: T,\r\n    listeners: (() => void)[],\r\n    wrapped: libWrapper.RegisterCallback\r\n) {\r\n    for (const listener of listeners) {\r\n        listener.call(this);\r\n    }\r\n\r\n    wrapped();\r\n}\r\n\r\nexport {\r\n    ARMOR_PREPARE_BASE_DATA,\r\n    ARMOR_PREPARE_DERIVED_DATA,\r\n    WEAPON_PREPARE_BASE_DATA,\r\n    WEAPON_PREPARE_DERIVED_DATA,\r\n    prepareDocumentWrappers,\r\n};\r\n", "import { libWrapper } from \"pf2e-api\";\r\nimport { createSharedWrapper } from \"./sharedWrapper\";\r\n\r\nconst TEXTEDITOR_ENRICH_HTML = \"TextEditor.enrichHTML\";\r\n\r\nconst textEditorWrappers = {\r\n    [TEXTEDITOR_ENRICH_HTML]: createSharedWrapper(TEXTEDITOR_ENRICH_HTML, textEditorEnrichHTML),\r\n};\r\n\r\nfunction textEditorEnrichHTML(\r\n    this: TextEditor,\r\n    listeners: ((enriched: string) => string)[],\r\n    wrapped: libWrapper.RegisterCallback,\r\n    content: string,\r\n    options?: EnrichmentOptions\r\n): Promisable<string> {\r\n    let enriched = wrapped(content, options) as string | Promise<string>;\r\n\r\n    if (typeof enriched === \"string\") {\r\n        for (const listener of listeners) {\r\n            enriched = listener.call(this, enriched);\r\n        }\r\n        return enriched;\r\n    }\r\n\r\n    return Promise.resolve().then(async () => {\r\n        enriched = await enriched;\r\n        for (const listener of listeners) {\r\n            enriched = listener.call(this, enriched);\r\n        }\r\n        return enriched;\r\n    });\r\n}\r\n\r\nexport { TEXTEDITOR_ENRICH_HTML, textEditorWrappers };\r\n", "import { htmlElement, libWrapper } from \"pf2e-api\";\r\nimport { createSharedWrapper } from \"./sharedWrapper\";\r\n\r\nconst CHATMESSAGE_GET_HTML = \"ChatMessage.prototype.getHTML\";\r\n\r\nconst chatMessageWrappers = {\r\n    [CHATMESSAGE_GET_HTML]: createSharedWrapper(CHATMESSAGE_GET_HTML, chatMessageGetHTML),\r\n};\r\n\r\nasync function chatMessageGetHTML(\r\n    this: ChatMessagePF2e,\r\n    listeners: ((html: HTMLElement) => Promisable<void>)[],\r\n    wrapped: libWrapper.RegisterCallback\r\n): Promise<JQuery> {\r\n    const $html = await wrapped();\r\n\r\n    const html = htmlElement($html);\r\n\r\n    for (const listener of listeners) {\r\n        await listener.call(this, html);\r\n    }\r\n\r\n    return $html;\r\n}\r\n\r\nexport { CHATMESSAGE_GET_HTML, chatMessageWrappers };\r\n", "import {\r\n    MODULE,\r\n    R,\r\n    RegisterSettingOptions,\r\n    deleteInMemory,\r\n    flagPath,\r\n    getFlag,\r\n    getFlagProperty,\r\n    getInMemory,\r\n    getInMemoryAndSetIfNot,\r\n    getSetting,\r\n    htmlElement,\r\n    libWrapper,\r\n    registerUpstreamHook,\r\n    registerWrapper,\r\n    render,\r\n    setFlag,\r\n    setFlagProperty,\r\n    setInMemory,\r\n    socketEmit,\r\n    socketOff,\r\n    socketOn,\r\n    subLocalize,\r\n    templatePath,\r\n    unregisterWrapper,\r\n    unsetFlag,\r\n    updateSourceFlag,\r\n} from \"pf2e-api\";\r\nimport { characterSheetWrappers } from \"./tools/shared/characterSheet\";\r\nimport { prepareDocumentWrappers } from \"./tools/shared/prepareDocument\";\r\nimport { textEditorWrappers } from \"./tools/shared/textEditor\";\r\nimport { chatMessageWrappers } from \"./tools/shared/chatMessage\";\r\n\r\nconst sharedWrappers = {\r\n    ...characterSheetWrappers,\r\n    ...prepareDocumentWrappers,\r\n    ...textEditorWrappers,\r\n    ...chatMessageWrappers,\r\n};\r\n\r\nfunction createTool<TConfig extends ToolConfig>(config: TConfig) {\r\n    const settings = R.pipe(\r\n        config.settings,\r\n        R.reduce((acc, setting) => {\r\n            Object.defineProperty(acc, setting.key, {\r\n                get() {\r\n                    return getSetting(setting.key);\r\n                },\r\n            });\r\n            return acc;\r\n        }, {})\r\n    );\r\n\r\n    const toolName = config.name;\r\n    const toolHooks = createToolHooks(config);\r\n    const [hook, hooks] =\r\n        toolHooks && \"activateAll\" in toolHooks\r\n            ? [undefined, toolHooks]\r\n            : toolHooks\r\n            ? [toolHooks, undefined]\r\n            : [undefined, undefined];\r\n\r\n    const toolWrappers = createToolWrappers(config);\r\n    const [wrapper, wrappers] =\r\n        toolWrappers && \"activateAll\" in toolWrappers\r\n            ? [undefined, toolWrappers]\r\n            : toolWrappers\r\n            ? [toolWrappers, undefined]\r\n            : [undefined, undefined];\r\n\r\n    const localize = subLocalize(toolName);\r\n\r\n    const waitDialog = async (\r\n        template: string,\r\n        dialogOptions: ToolWaitDialogOptions,\r\n        applicationOptions: ApplicationRenderOptions = {}\r\n    ) => {\r\n        const translate = localize.sub(template);\r\n\r\n        const data = dialogOptions.data ?? {};\r\n        data.i18n ??= translate.i18n;\r\n\r\n        return Dialog.wait(\r\n            {\r\n                title: dialogOptions.title ?? translate(\"title\"),\r\n                content: dialogOptions.content ?? (await render(`${toolName}/${template}`, data)),\r\n                buttons: {\r\n                    yes: {\r\n                        label: translate(\"yes\"),\r\n                        icon: `<i class=\"${dialogOptions.yes ?? \"fa-solid fa-check\"}\"></i>`,\r\n                        callback: htmlElement,\r\n                    },\r\n                    no: {\r\n                        label: translate(\"no\"),\r\n                        icon: `<i class=\"${dialogOptions.no ?? \"fa-solid fa-xmark\"}\"></i>`,\r\n                        callback: () => null,\r\n                    },\r\n                },\r\n                render: ($html) => {\r\n                    const html = htmlElement($html);\r\n                    dialogOptions.onRender?.(html);\r\n                },\r\n                close: () => null,\r\n            },\r\n            {\r\n                ...applicationOptions,\r\n                id: translate(\"dialog\"),\r\n            }\r\n        );\r\n    };\r\n\r\n    return {\r\n        config,\r\n        settings,\r\n        hook,\r\n        hooks,\r\n        wrapper,\r\n        wrappers,\r\n        waitDialog,\r\n        flagPath: (...path: string[]) => flagPath(toolName, ...path),\r\n        getFlag: (doc: FoundryDocument, ...path: string[]) => getFlag(doc, toolName, ...path),\r\n        setFlag: (doc: FoundryDocument, ...args: [...string[], unknown]) =>\r\n            setFlag(doc, toolName, ...args),\r\n        unsetFlag: (doc: FoundryDocument, ...path: string[]) => unsetFlag(doc, toolName, ...path),\r\n        updateSourceFlag: (doc: FoundryDocument, ...args: [...string[], any]) =>\r\n            updateSourceFlag(doc, toolName, ...args),\r\n        getFlagProperty: (obj: object, ...path: string[]) =>\r\n            getFlagProperty(obj, toolName, ...path),\r\n        setFlagProperty: (obj: object, ...args: [...string[], any]) =>\r\n            setFlagProperty(obj, toolName, ...args),\r\n        getInMemory: (obj: object, ...path: string[]) => getInMemory(obj, toolName, ...path),\r\n        setInMemory: (obj: object, ...args: [...string[], unknown]) =>\r\n            setInMemory(obj, toolName, ...args),\r\n        getInMemoryAndSetIfNot: (obj: object, ...args: [...string[], () => unknown | unknown]) =>\r\n            getInMemoryAndSetIfNot(obj, toolName, ...args),\r\n        deleteInMemory: (obj: object, ...path: string[]) => deleteInMemory(obj, toolName, ...path),\r\n        render: (...args: Parameters<typeof render>) => {\r\n            const data = args.at(-1) as Record<string, any>;\r\n            data.i18n = localize.sub(args[0]).i18n;\r\n            return render(toolName, ...args);\r\n        },\r\n        localize,\r\n        templatePath: (...path: string[]) => templatePath(toolName, ...path),\r\n        socket: createToolSocket(config),\r\n    } as unknown as ToolObject<TConfig>;\r\n}\r\n\r\nfunction createToolWrappers(config: ToolConfig) {\r\n    if (!Array.isArray(config.wrappers) || config.wrappers.length === 0) return;\r\n\r\n    const wrappers: [string | undefined, ToolActivable][] = [];\r\n\r\n    for (const { key, type, path, callback } of config.wrappers) {\r\n        let wrapper: ToolActivable;\r\n\r\n        if (path in sharedWrappers) {\r\n            const wrapperId = randomID();\r\n\r\n            wrapper = {\r\n                activate() {\r\n                    //@ts-ignore\r\n                    sharedWrappers[path].activate(wrapperId, callback);\r\n                },\r\n                disable() {\r\n                    //@ts-ignore\r\n                    sharedWrappers[path].disable(wrapperId);\r\n                },\r\n                toggle(enabled: boolean) {\r\n                    //@ts-ignore\r\n                    sharedWrappers[path].toggle(wrapperId, callback, enabled);\r\n                },\r\n            };\r\n        } else {\r\n            let wrapperId: number | null = null;\r\n\r\n            const wrapped = function (this: any, ...args: any[]) {\r\n                try {\r\n                    return callback.call(this, ...args);\r\n                } catch (error) {\r\n                    MODULE.error(\r\n                        `an error occured in the tool '${config.name}'\\nwrapper: ${path}`,\r\n                        error\r\n                    );\r\n\r\n                    if (type !== \"OVERRIDE\") {\r\n                        const wrapFn = args.splice(0)[0] as Function;\r\n                        return wrapFn(...args);\r\n                    }\r\n                }\r\n            };\r\n\r\n            wrapper = {\r\n                activate() {\r\n                    if (wrapperId === null) {\r\n                        // @ts-ignore\r\n                        wrapperId = registerWrapper(path, wrapped, type ?? \"WRAPPER\");\r\n                    }\r\n                },\r\n                disable() {\r\n                    if (wrapperId !== null) {\r\n                        unregisterWrapper(wrapperId);\r\n                        wrapperId = null;\r\n                    }\r\n                },\r\n                toggle(enabled: boolean) {\r\n                    if (enabled) this.activate();\r\n                    else this.disable();\r\n                },\r\n            };\r\n        }\r\n\r\n        wrappers.push([key, wrapper]);\r\n    }\r\n\r\n    if (wrappers.length === 1) {\r\n        return wrappers[0][1];\r\n    }\r\n\r\n    const wrappersMap = wrappers.map(([key, hook]) => hook);\r\n    const wrappersObj = wrappers.every(\r\n        (wrapper): wrapper is [string, ToolActivable] => !!wrapper[0]\r\n    )\r\n        ? R.fromPairs(wrappers)\r\n        : {};\r\n\r\n    return {\r\n        ...wrappersObj,\r\n        activateAll() {\r\n            for (const wrapper of wrappersMap) {\r\n                wrapper.activate();\r\n            }\r\n        },\r\n        disableAll() {\r\n            for (const wrapper of wrappersMap) {\r\n                wrapper.disable();\r\n            }\r\n        },\r\n        toggleAll(enabled: boolean) {\r\n            for (const wrapper of wrappersMap) {\r\n                wrapper.toggle(enabled);\r\n            }\r\n        },\r\n    };\r\n}\r\n\r\nfunction createToolHooks(config: ToolConfig) {\r\n    if (!Array.isArray(config.hooks) || config.hooks.length === 0) return;\r\n\r\n    const hooks: [string, ToolActivable][] = [];\r\n\r\n    for (const { event, listener, isUpstream } of config.hooks) {\r\n        let hookId: number | null = null;\r\n\r\n        const hook = {\r\n            activate() {\r\n                if (hookId !== null) return;\r\n                hookId = isUpstream\r\n                    ? registerUpstreamHook(event, listener)\r\n                    : Hooks.on(event, listener);\r\n            },\r\n            disable() {\r\n                if (hookId === null) return;\r\n                Hooks.off(event, hookId);\r\n                hookId = null;\r\n            },\r\n            toggle(enabled: boolean) {\r\n                if (enabled) this.activate();\r\n                else this.disable();\r\n            },\r\n        };\r\n\r\n        hooks.push([event, hook]);\r\n    }\r\n\r\n    if (hooks.length === 1) return hooks[0][1];\r\n\r\n    const hooksMap = hooks.map(([event, hook]) => hook);\r\n\r\n    return {\r\n        ...R.fromPairs(hooks),\r\n        activateAll() {\r\n            for (const hook of hooksMap) {\r\n                hook.activate();\r\n            }\r\n        },\r\n        disableAll() {\r\n            for (const hook of hooksMap) {\r\n                hook.disable();\r\n            }\r\n        },\r\n        toggleAll(enabled: boolean) {\r\n            for (const hook of hooksMap) {\r\n                hook.toggle(enabled);\r\n            }\r\n        },\r\n    };\r\n}\r\n\r\nfunction createToolSocket(config: ToolConfig) {\r\n    if (typeof config.onSocket !== \"function\") return;\r\n\r\n    let socketEnabled = false;\r\n\r\n    const onSocket = (packet: { __tool__?: string }, userId: string) => {\r\n        if (packet.__tool__ !== config.name) return;\r\n\r\n        delete packet.__tool__;\r\n        config.onSocket!(packet, userId);\r\n    };\r\n\r\n    return {\r\n        emit(packet: object) {\r\n            socketEmit({\r\n                ...packet,\r\n                __tool__: config.name,\r\n            });\r\n        },\r\n        activate() {\r\n            if (socketEnabled) return;\r\n            socketEnabled = true;\r\n            socketOn(onSocket);\r\n        },\r\n        disable() {\r\n            if (!socketEnabled) return;\r\n            socketEnabled = false;\r\n            socketOff(onSocket);\r\n        },\r\n        toggle(enabled?: boolean) {\r\n            if (enabled) this.activate();\r\n            else this.disable();\r\n        },\r\n    };\r\n}\r\n\r\ntype ToolConfig = {\r\n    name: string;\r\n    settings: RegisterSettingOptions[];\r\n    onSocket?: SocketCallback;\r\n    hooks?: ToolHook[];\r\n    wrappers?: (\r\n        | {\r\n              key?: string;\r\n              path: string;\r\n              callback: libWrapper.RegisterCallback;\r\n              type?: libWrapper.RegisterType;\r\n          }\r\n        | {\r\n              key?: string;\r\n              path: keyof typeof sharedWrappers;\r\n              type?: never;\r\n              callback: Parameters<\r\n                  (typeof sharedWrappers)[keyof typeof sharedWrappers][\"activate\"]\r\n              >[1];\r\n          }\r\n    )[];\r\n    api?: Record<string, Function>;\r\n    init?: (isGM: boolean) => void;\r\n    ready?: (isGM: boolean) => void;\r\n};\r\n\r\ntype ToolWaitDialogOptions = {\r\n    onRender?: (html: HTMLElement) => void;\r\n    yes?: string;\r\n    no?: string;\r\n    title?: string;\r\n} & RequireOnlyOne<{\r\n    data?: Record<string, any>;\r\n    content?: string;\r\n}>;\r\n\r\ntype ToolObject<TConfig extends ToolConfig> = {\r\n    config: TConfig;\r\n    localize: ReturnType<typeof subLocalize>;\r\n    templatePath: typeof templatePath;\r\n    render: typeof render;\r\n    waitDialog: (\r\n        template: string,\r\n        options: ToolWaitDialogOptions,\r\n        applicationOptions?: ApplicationRenderOptions\r\n    ) => Promise<HTMLElement | null>;\r\n    getFlag: typeof getFlag;\r\n    setFlag: typeof setFlag;\r\n    unsetFlag: typeof unsetFlag;\r\n    flagPath: typeof flagPath;\r\n    updateSourceFlag: typeof updateSourceFlag;\r\n    getFlagProperty: typeof getFlagProperty;\r\n    setFlagProperty: typeof setFlagProperty;\r\n    getInMemory: typeof getInMemory;\r\n    setInMemory: typeof setInMemory;\r\n    getInMemoryAndSetIfNot: typeof getInMemoryAndSetIfNot;\r\n    deleteInMemory: typeof deleteInMemory;\r\n    settings: ToolSettings<TConfig>;\r\n} & ToolSocket<TConfig> &\r\n    ToolHooks<TConfig> &\r\n    ToolWrappers<TConfig>;\r\n\r\ntype ToolSettings<TConfig extends ToolConfig> = TConfig[\"settings\"] extends {\r\n    key: infer K extends string;\r\n}[]\r\n    ? {\r\n          [k in K]: Extract<TConfig[\"settings\"][number], { key: k }> extends {\r\n              choices: Array<infer C>;\r\n          }\r\n              ? Readonly<C>\r\n              : Readonly<ReturnType<Extract<TConfig[\"settings\"][number], { key: k }>[\"type\"]>>;\r\n      }\r\n    : never;\r\n\r\ntype ToolHook = { event: string; listener: HookCallback; isUpstream?: boolean };\r\n\r\ntype ToolSocket<TConfig extends ToolConfig> = TConfig[\"onSocket\"] extends (\r\n    packet: infer P extends Record<string, any>,\r\n    senderId: string\r\n) => void\r\n    ? {\r\n          socket: {\r\n              emit: (packet: P) => void;\r\n              activate: () => void;\r\n              disable: () => void;\r\n              toggle: (enabled?: boolean) => void;\r\n          };\r\n      }\r\n    : {};\r\n\r\ntype ToolHooks<TConfig extends ToolConfig> = TConfig[\"hooks\"] extends [\r\n    { event: infer E extends string }\r\n]\r\n    ? {\r\n          hook: ToolActivable;\r\n      }\r\n    : TConfig[\"hooks\"] extends never[]\r\n    ? {}\r\n    : TConfig[\"hooks\"] extends {\r\n          event: infer E extends string;\r\n      }[]\r\n    ? {\r\n          hooks: ToolActivableAll & {\r\n              [e in E]: ToolActivable;\r\n          };\r\n      }\r\n    : {};\r\n\r\ntype ToolWrappers<TConfig extends ToolConfig> = TConfig[\"wrappers\"] extends [{ path: string }]\r\n    ? {\r\n          wrapper: ToolActivable;\r\n      }\r\n    : TConfig[\"wrappers\"] extends never[]\r\n    ? {}\r\n    : TConfig[\"wrappers\"] extends { key: infer K extends string }[]\r\n    ? {\r\n          wrappers: ToolActivableAll & {\r\n              [k in K]: ToolActivable;\r\n          };\r\n      }\r\n    : TConfig[\"wrappers\"] extends { path: string }[]\r\n    ? {\r\n          wrappers: ToolActivableAll;\r\n      }\r\n    : {};\r\n\r\ntype ToolActivable = {\r\n    activate: () => void;\r\n    disable: () => void;\r\n    toggle: (enabled: boolean) => void;\r\n};\r\n\r\ntype ToolActivableAll = {\r\n    activateAll: () => void;\r\n    disableAll: () => void;\r\n    toggleAll: (enabled: boolean) => void;\r\n};\r\n\r\nexport { createTool };\r\nexport type { ToolConfig };\r\n", "import { HANDWRAPS_SLUG, getEquippedHandwraps, htmlElement, libWrapper } from \"pf2e-api\";\r\nimport { createTool } from \"../tool\";\r\nimport {\r\n    ARMOR_PREPARE_BASE_DATA,\r\n    ARMOR_PREPARE_DERIVED_DATA,\r\n    WEAPON_PREPARE_BASE_DATA,\r\n    WEAPON_PREPARE_DERIVED_DATA,\r\n} from \"./shared/prepareDocument\";\r\n\r\nconst { config, localize, settings, hook, wrappers } = createTool({\r\n    name: \"arp\",\r\n    settings: [\r\n        {\r\n            key: \"enabled\",\r\n            type: Boolean,\r\n            default: false,\r\n            requiresReload: true,\r\n        },\r\n        {\r\n            key: \"force\",\r\n            type: Boolean,\r\n            default: true,\r\n            requiresReload: true,\r\n        },\r\n    ],\r\n    hooks: [\r\n        {\r\n            event: \"renderPhysicalItemSheetPF2e\",\r\n            listener: onRenderPhysicalItemSheetPF2e,\r\n        },\r\n    ],\r\n    wrappers: [\r\n        {\r\n            path: WEAPON_PREPARE_BASE_DATA,\r\n            callback: weaponPrepareBaseData,\r\n        },\r\n        {\r\n            path: WEAPON_PREPARE_DERIVED_DATA,\r\n            callback: weaponPrepareDerivedData,\r\n        },\r\n        {\r\n            path: ARMOR_PREPARE_BASE_DATA,\r\n            callback: armorPrepareBaseData,\r\n        },\r\n        {\r\n            path: ARMOR_PREPARE_DERIVED_DATA,\r\n            callback: armorPrepareDerivedData,\r\n        },\r\n    ],\r\n    init: () => {\r\n        if (!settings.enabled) return;\r\n\r\n        wrappers.activateAll();\r\n\r\n        if (settings.force) {\r\n            hook.activate();\r\n        }\r\n    },\r\n    ready: (isGM) => {\r\n        if (\r\n            isGM &&\r\n            settings.enabled &&\r\n            game.settings.get(\"pf2e\", \"automaticBonusVariant\") !== \"noABP\"\r\n        ) {\r\n            game.settings.set(\"pf2e\", \"automaticBonusVariant\", \"noABP\");\r\n            localize.warn(\"arp.forceVariant\", true);\r\n        }\r\n    },\r\n} as const);\r\n\r\nconst WEAPON_POTENCY_PRICE = {\r\n    1: 35,\r\n    2: 935,\r\n    3: 8935,\r\n    4: 8935,\r\n};\r\n\r\nconst WEAPON_STRIKING_PRICE = {\r\n    1: 65,\r\n    2: 1065,\r\n    3: 31065,\r\n};\r\n\r\nconst ARMOR_POTENCY_PRICE = {\r\n    1: 160,\r\n    2: 1060,\r\n    3: 20560,\r\n    4: 20560,\r\n};\r\n\r\nconst ARMOR_RESILIENCY_PRICE = {\r\n    1: 340,\r\n    2: 3440,\r\n    3: 49440,\r\n};\r\n\r\nfunction isValidActor(actor: ActorPF2e, isCharacter = false) {\r\n    return (\r\n        actor &&\r\n        !actor.getFlag(\"pf2e\", \"disableABP\") &&\r\n        (!isCharacter || actor.isOfType(\"character\"))\r\n    );\r\n}\r\n\r\nfunction isShieldWeapon(weapon: WeaponPF2e) {\r\n    return (\r\n        !!weapon._source.system.baseItem &&\r\n        [\"shield-boss\", \"shield-spikes\"].includes(weapon._source.system.baseItem)\r\n    );\r\n}\r\n\r\nfunction isValidWeapon(weapon: WeaponPF2e) {\r\n    const traits = weapon._source.system.traits.value;\r\n    const { group, category, slug } = weapon._source.system;\r\n\r\n    if (category === \"unarmed\" && slug !== HANDWRAPS_SLUG) {\r\n        return !!getEquippedHandwraps(weapon.actor);\r\n    }\r\n\r\n    return (\r\n        (group !== \"shield\" || isShieldWeapon(weapon)) &&\r\n        !traits.includes(\"alchemical\") &&\r\n        !traits.includes(\"bomb\")\r\n    );\r\n}\r\n\r\nfunction isValidArmor(armor: ArmorPF2e) {\r\n    return true;\r\n}\r\n\r\nfunction weaponPrepareBaseData(this: WeaponPF2e) {\r\n    const actor = this.actor;\r\n    if (!isValidActor(actor, true) || !isValidWeapon(this)) return;\r\n\r\n    const traits = this._source.system.traits.value;\r\n\r\n    if (traits.includes(\"alchemical\") && traits.includes(\"bomb\")) return;\r\n\r\n    const level = actor.level;\r\n    const forceUpdate = settings.force;\r\n    const expectedPotency: ZeroToFour = level < 2 ? 0 : level < 10 ? 1 : level < 16 ? 2 : 3;\r\n    const expectedStriking: ZeroToThree = level < 4 ? 0 : level < 12 ? 1 : level < 19 ? 2 : 3;\r\n\r\n    if (forceUpdate || this.system.runes.potency <= expectedPotency) {\r\n        this.system.runes.potency = expectedPotency;\r\n    }\r\n\r\n    if (forceUpdate || this.system.runes.striking <= expectedStriking) {\r\n        this.system.runes.striking = expectedStriking;\r\n    }\r\n}\r\n\r\nfunction weaponPrepareDerivedData(this: WeaponPF2e, wrapped: libWrapper.RegisterCallback) {\r\n    wrapped();\r\n\r\n    if (!isValidActor(this.actor) || this.isSpecific || !isValidWeapon(this)) return;\r\n\r\n    const coins = this.price.value.toObject();\r\n    if (!coins.gp) return;\r\n\r\n    const potency = this.system.runes.potency;\r\n    const striking = this.system.runes.striking;\r\n\r\n    if (potency) {\r\n        coins.gp -= WEAPON_POTENCY_PRICE[potency];\r\n    }\r\n\r\n    if (striking) {\r\n        coins.gp -= WEAPON_STRIKING_PRICE[striking];\r\n    }\r\n\r\n    let newPrice = new game.pf2e.Coins(coins);\r\n\r\n    if ((potency || striking) && !this.system.runes.property.length) {\r\n        newPrice = newPrice.plus(this._source.system.price.value);\r\n    }\r\n\r\n    this.system.price.value = newPrice;\r\n}\r\n\r\nfunction armorPrepareBaseData(this: ArmorPF2e) {\r\n    const actor = this.actor;\r\n\r\n    if (!isValidActor(actor, true) || !isValidArmor(this)) return;\r\n\r\n    const level = actor.level;\r\n    const forceUpdate = settings.force;\r\n\r\n    const expectedPotency: ZeroToFour = level < 5 ? 0 : level < 11 ? 1 : level < 18 ? 2 : 3;\r\n    const expectedResilient: ZeroToThree = level < 8 ? 0 : level < 14 ? 1 : level < 20 ? 2 : 3;\r\n\r\n    if (forceUpdate || this.system.runes.potency <= expectedPotency) {\r\n        this.system.runes.potency = expectedPotency;\r\n    }\r\n\r\n    if (forceUpdate || this.system.runes.resilient <= expectedResilient) {\r\n        this.system.runes.resilient = expectedResilient;\r\n    }\r\n}\r\n\r\nfunction armorPrepareDerivedData(this: ArmorPF2e, wrapped: libWrapper.RegisterCallback) {\r\n    wrapped();\r\n\r\n    if (!isValidActor(this.actor) || this.isSpecific || !isValidArmor(this)) return;\r\n\r\n    const coins = this.price.value.toObject();\r\n    if (!coins.gp) return;\r\n\r\n    const potency = this.system.runes.potency;\r\n    const resiliency = this.system.runes.resilient;\r\n\r\n    if (potency) {\r\n        coins.gp -= ARMOR_POTENCY_PRICE[potency];\r\n    }\r\n\r\n    if (resiliency) {\r\n        coins.gp -= ARMOR_RESILIENCY_PRICE[resiliency];\r\n    }\r\n\r\n    let newPrice = new game.pf2e.Coins(coins);\r\n\r\n    if ((potency || resiliency) && !this.system.runes.property.length) {\r\n        newPrice = newPrice.plus(this._source.system.price.value);\r\n    }\r\n\r\n    this.system.price.value = newPrice;\r\n}\r\n\r\nfunction onRenderPhysicalItemSheetPF2e(sheet: ItemSheetPF2e, $html: JQuery) {\r\n    const item = sheet.item;\r\n\r\n    if (!item.isOfType(\"weapon\", \"armor\") || !isValidActor(item.actor, true)) return;\r\n\r\n    const html = htmlElement($html);\r\n    const runesSection = html.querySelector(\".material-runes\");\r\n    if (!runesSection) return;\r\n\r\n    const lookups = [\"potency\", \"striking\", \"resilient\"]\r\n        .map((x) => `[name=\"system.runes.${x}\"]`)\r\n        .join(\", \");\r\n\r\n    const groups = runesSection.querySelectorAll<HTMLElement>(\r\n        `[data-tab=details] fieldset .form-group:has(${lookups})`\r\n    );\r\n\r\n    for (const group of groups) {\r\n        group.style.display = \"none\";\r\n    }\r\n}\r\n\r\nexport { config as arpTool };\r\n", "import { addListener, htmlElement } from \"pf2e-api\";\r\nimport { createTool } from \"../tool\";\r\n\r\nconst { config, settings, hooks } = createTool({\r\n    name: \"debug\",\r\n    settings: [\r\n        {\r\n            key: \"enabled\",\r\n            type: Boolean,\r\n            default: false,\r\n            config: false,\r\n            scope: \"client\",\r\n            onChange: (value) => {\r\n                hooks.toggleAll(value);\r\n            },\r\n        },\r\n    ],\r\n    hooks: [\r\n        {\r\n            event: \"renderApplication\",\r\n            listener: onRender,\r\n        },\r\n        {\r\n            event: \"renderActorSheet\",\r\n            listener: onRender,\r\n        },\r\n        {\r\n            event: \"renderItemSheet\",\r\n            listener: onRender,\r\n        },\r\n    ],\r\n    init: () => {\r\n        hooks.toggleAll(settings.enabled);\r\n    },\r\n} as const);\r\n\r\nfunction onRender(app: FormApplication<FoundryDocument>, $html: JQuery) {\r\n    const html = htmlElement($html);\r\n\r\n    addListener(html, \".document-id-link\", (event) => {\r\n        if (!event.shiftKey) return;\r\n\r\n        const obj = app.object;\r\n        if (!obj) return;\r\n\r\n        event.preventDefault();\r\n        event.stopPropagation();\r\n\r\n        const type = obj.type ?? obj.documentName.toLowerCase();\r\n\r\n        let i = 2;\r\n        let variable = type;\r\n\r\n        // @ts-ignore\r\n        while (window[variable]) {\r\n            variable = `${type}${i++}`;\r\n        }\r\n\r\n        // @ts-ignore\r\n        window[variable] = obj;\r\n        console.log(variable, obj);\r\n    });\r\n}\r\n\r\nexport { config as debugTool };\r\n", "import {\r\n    addListener,\r\n    appendHTMLFromString,\r\n    closest,\r\n    elementData,\r\n    htmlElement,\r\n    querySelector,\r\n} from \"pf2e-api\";\r\nimport { createTool } from \"../tool\";\r\n\r\nconst debouncedSetup = debounce(setup, 1);\r\n\r\nconst { localize, config, settings, hook } = createTool({\r\n    name: \"effectsPanel\",\r\n    settings: [\r\n        {\r\n            key: \"remove\",\r\n            type: Boolean,\r\n            default: false,\r\n            scope: \"client\",\r\n            onChange: debouncedSetup,\r\n        },\r\n        {\r\n            key: \"condition\",\r\n            type: Boolean,\r\n            default: false,\r\n            scope: \"client\",\r\n            onChange: debouncedSetup,\r\n        },\r\n    ],\r\n    hooks: [\r\n        {\r\n            event: \"renderEffectsPanel\",\r\n            listener: onRenderEffectsPanel,\r\n        },\r\n    ],\r\n    init: debouncedSetup,\r\n} as const);\r\n\r\nfunction setup() {\r\n    hook.toggle(settings.condition || settings.remove);\r\n    game.pf2e.effectPanel?.render();\r\n}\r\n\r\nfunction onRenderEffectsPanel(panel: EffectsPanel, $html: JQuery) {\r\n    const actor = panel.actor;\r\n    if (!actor) return;\r\n\r\n    const html = htmlElement($html);\r\n    const effectsPanels = html.querySelectorAll(\".effect-item[data-item-id]\");\r\n    const removeRow = `<div>${localize(\"remove\")}</div>`;\r\n    const editIcon = `<a data-action=\"edit\" data-tooltip=\"PF2E.EditItemTitle\">\r\n        <i class=\"fa-solid fa-fw fa-pencil\"></i>\r\n    </a>`;\r\n\r\n    for (const effectsPanel of effectsPanels) {\r\n        const { itemId } = elementData(effectsPanel);\r\n        const effect = actor.items.get<EffectPF2e>(itemId);\r\n        if (!effect) continue;\r\n\r\n        if (\r\n            settings.remove &&\r\n            !effect.isLocked &&\r\n            effect.badge &&\r\n            effect.badge.type === \"counter\"\r\n        ) {\r\n            appendHTMLFromString(\r\n                querySelector(effectsPanel, \".effect-info .instructions\"),\r\n                removeRow\r\n            );\r\n\r\n            addListener(\r\n                effectsPanel,\r\n                \".icon\",\r\n                \"contextmenu\",\r\n                (event, el) => onRemoveEffect(event, el, actor),\r\n                true\r\n            );\r\n        }\r\n\r\n        if (\r\n            settings.condition &&\r\n            effect.isOfType(\"condition\") &&\r\n            effect.slug !== \"persistent-damage\"\r\n        ) {\r\n            const h1 = querySelector(effectsPanel, \".effect-info > h1\");\r\n            if (!h1) continue;\r\n\r\n            appendHTMLFromString(h1, editIcon);\r\n            addListener(h1, \"[data-action='edit']\", (event, el) =>\r\n                onEditCondition(event, el, actor)\r\n            );\r\n        }\r\n    }\r\n}\r\n\r\nfunction onRemoveEffect(event: MouseEvent, el: HTMLElement, actor: ActorPF2e) {\r\n    if (!event.shiftKey) return;\r\n\r\n    const effect = getEffect(el, actor);\r\n    if (!effect?.badge || effect.isLocked || effect.badge.type !== \"counter\") return;\r\n\r\n    event.preventDefault();\r\n    event.stopPropagation();\r\n    event.stopImmediatePropagation();\r\n\r\n    effect.delete();\r\n}\r\n\r\nfunction onEditCondition(event: MouseEvent, el: HTMLElement, actor: ActorPF2e) {\r\n    const effect = getEffect(el, actor);\r\n\r\n    if (effect?.isOfType(\"condition\")) {\r\n        event.preventDefault();\r\n        effect.sheet.render(true);\r\n    }\r\n}\r\n\r\nfunction getEffect(target: HTMLElement, actor: ActorPF2e) {\r\n    const effectEl = closest(target, \".effect-item[data-item-id]\");\r\n    if (!effectEl) return;\r\n\r\n    const { itemId } = elementData(effectEl);\r\n    return actor.items.get<EffectPF2e>(itemId);\r\n}\r\n\r\nexport { config as effectsPanelTool };\r\n", "import {\r\n    MoveLootPopup,\r\n    createTradeMessage,\r\n    getDropTarget,\r\n    getHighestName,\r\n    hasGMOnline,\r\n    isPlayedActor,\r\n    transferItemToActor,\r\n} from \"pf2e-api\";\r\nimport { createTool } from \"../tool\";\r\n\r\nconst debouncedSetup = debounce(setup, 1);\r\n\r\nconst { config, localize, socket, settings, hook } = createTool({\r\n    name: \"giveth\",\r\n    settings: [\r\n        {\r\n            key: \"enabled\",\r\n            type: Boolean,\r\n            default: false,\r\n            onChange: debouncedSetup,\r\n        },\r\n        {\r\n            key: \"message\",\r\n            type: Boolean,\r\n            default: true,\r\n            onChange: debouncedSetup,\r\n        },\r\n    ],\r\n    hooks: [\r\n        {\r\n            event: \"dropCanvasData\",\r\n            listener: onDropCanvasData,\r\n            isUpstream: true,\r\n        },\r\n    ],\r\n    onSocket: giveth,\r\n    ready: debouncedSetup,\r\n} as const);\r\n\r\nfunction setup() {\r\n    const isGM = game.user.isGM;\r\n    const enabled = settings.enabled;\r\n\r\n    socket.toggle(isGM && enabled);\r\n    hook.toggle(!isGM && enabled && settings.message);\r\n}\r\n\r\nfunction onDropCanvasData(canvas: Canvas, data: DropCanvasItemDataPF2e) {\r\n    if (data.type !== \"Item\" || !data.fromInventory || !data.uuid) {\r\n        return true;\r\n    }\r\n\r\n    const item = fromUuidSync<ItemPF2e>(data.uuid);\r\n    if (!item?.isOfType(\"physical\")) return true;\r\n\r\n    const origin = item.actor;\r\n    if (!isValidActor(origin) || !origin.isOwner) return true;\r\n\r\n    const target = getDropTarget(canvas, data, (token) => {\r\n        const actor = token.actor as ActorPF2e | null;\r\n        return token.document.actorLink && isValidActor(actor, data.actorId);\r\n    })?.actor as ActorPF2e | undefined;\r\n\r\n    if (!target || target.isOwner) return true;\r\n\r\n    if (!hasGMOnline()) {\r\n        localize.error(\"error.noGM\");\r\n        return true;\r\n    }\r\n\r\n    const quantity = item.quantity;\r\n\r\n    if (quantity < 1) {\r\n        localize.warn(\"error.zero\");\r\n        return false;\r\n    }\r\n\r\n    const socketPacket: SocketPacket = {\r\n        itemId: item.id,\r\n        originId: origin.id,\r\n        targetId: target.id,\r\n    };\r\n\r\n    if (quantity === 1) {\r\n        socket.emit(socketPacket);\r\n        return false;\r\n    }\r\n\r\n    const stackable = !!target.inventory.findStackableItem(item._source);\r\n\r\n    new MoveLootPopup(\r\n        origin,\r\n        {\r\n            quantity: { max: quantity, default: quantity },\r\n            lockStack: !stackable,\r\n            isPurchase: false,\r\n        },\r\n        (quantity, newStack) => {\r\n            socketPacket.quantity = quantity;\r\n            socketPacket.newStack = newStack;\r\n            socket.emit(socketPacket);\r\n        }\r\n    ).render(true);\r\n\r\n    return false;\r\n}\r\n\r\nasync function giveth(\r\n    { itemId, originId, targetId, newStack = false, quantity = 1 }: SocketPacket,\r\n    senderId: string\r\n) {\r\n    const origin = game.actors.get<ActorPF2e>(originId);\r\n    const target = game.actors.get<ActorPF2e>(targetId);\r\n    const item = origin?.inventory.get(itemId);\r\n\r\n    if (!origin || !target || !item || item.quantity < 1) return;\r\n\r\n    const tradedQuantity = Math.min(quantity, item.quantity);\r\n    const newItem = await transferItemToActor(target, item, tradedQuantity, undefined, newStack);\r\n\r\n    if (!settings.message || !newItem) return;\r\n\r\n    const message = localize(\"trade\", {\r\n        giver: getHighestName(origin),\r\n        quantity: tradedQuantity,\r\n        item: newItem.link,\r\n        recipient: getHighestName(target),\r\n    });\r\n\r\n    createTradeMessage(localize(\"subtitle\"), message, origin, newItem, senderId);\r\n}\r\n\r\nfunction isValidActor<T extends ActorPF2e>(actor: T | null, excludeId?: string): actor is T {\r\n    return (\r\n        isPlayedActor(actor) &&\r\n        (!excludeId || actor.id !== excludeId) &&\r\n        actor.hasPlayerOwner &&\r\n        !actor.isToken &&\r\n        actor.isOfType(\"character\", \"npc\", \"vehicle\")\r\n    );\r\n}\r\n\r\ntype SocketPacket = {\r\n    originId: string;\r\n    targetId: string;\r\n    itemId: string;\r\n    quantity?: number;\r\n    newStack?: boolean;\r\n};\r\n\r\nexport { config as givethTool };\r\n", "import {\r\n    R,\r\n    addListener,\r\n    addListenerAll,\r\n    afterHTMLFromString,\r\n    appendHTMLFromString,\r\n    closest,\r\n    elementData,\r\n    getOwner,\r\n    hasGMOnline,\r\n    querySelector,\r\n    querySelectorArray,\r\n    refreshApplication,\r\n    renderCharacterSheets,\r\n} from \"pf2e-api\";\r\nimport { createTool } from \"../tool\";\r\nimport {\r\n    CHARACTER_SHEET_ACTIVATE_LISTENERS,\r\n    CHARACTER_SHEET_RENDER_INNER,\r\n} from \"./shared/characterSheet\";\r\n\r\nconst TABLE_UUID = \"Compendium.pf2e.rollable-tables.RollTable.zgZoI7h0XjjJrrNK\";\r\nconst JOURNAL_UUID = \"Compendium.pf2e.journals.JournalEntry.BSp4LUSaOmUyjBko\";\r\n\r\nconst {\r\n    config,\r\n    settings,\r\n    localize,\r\n    wrappers,\r\n    socket,\r\n    waitDialog,\r\n    render,\r\n    getFlag,\r\n    setFlag,\r\n    setFlagProperty,\r\n} = createTool({\r\n    name: \"heroActions\",\r\n    settings: [\r\n        {\r\n            key: \"enabled\",\r\n            type: Boolean,\r\n            default: false,\r\n            onChange: (value) => {\r\n                wrappers.toggleAll(value);\r\n                socket.toggle(value);\r\n                renderCharacterSheets();\r\n            },\r\n        },\r\n        {\r\n            key: \"table\",\r\n            type: String,\r\n            default: \"\",\r\n        },\r\n        {\r\n            key: \"count\",\r\n            type: Number,\r\n            default: 0,\r\n            range: {\r\n                min: 0,\r\n                max: 10,\r\n                step: 1,\r\n            },\r\n            onChange: renderCharacterSheets,\r\n        },\r\n        {\r\n            key: \"trade\",\r\n            type: Boolean,\r\n            default: true,\r\n            onChange: renderCharacterSheets,\r\n        },\r\n        {\r\n            key: \"private\",\r\n            type: Boolean,\r\n            default: false,\r\n        },\r\n    ],\r\n    wrappers: [\r\n        {\r\n            path: CHARACTER_SHEET_RENDER_INNER,\r\n            callback: characterSheetPF2eRenderInner,\r\n        },\r\n        {\r\n            path: CHARACTER_SHEET_ACTIVATE_LISTENERS,\r\n            callback: characterSheetPF2eActivateListeners,\r\n        },\r\n    ],\r\n    api: {\r\n        canTrade,\r\n        discardHeroActions,\r\n        drawHeroAction,\r\n        drawHeroActions,\r\n        getDeckTable,\r\n        getHeroActionDetails,\r\n        getHeroActions,\r\n        giveHeroActions,\r\n        removeHeroActions,\r\n        sendActionToChat,\r\n        tradeHeroAction,\r\n        usesCountVariant,\r\n        useHeroAction,\r\n    },\r\n    onSocket: (packet: SocketPacket, senderId) => {\r\n        switch (packet.type) {\r\n            case \"trade-request\": {\r\n                if (packet.receiver.id === game.user.id) {\r\n                    onTradeRequest(packet, senderId);\r\n                }\r\n                break;\r\n            }\r\n            case \"trade-error\": {\r\n                if (packet.sender.id === game.user.id) {\r\n                    onTradeError(packet, senderId);\r\n                }\r\n                break;\r\n            }\r\n            case \"trade-reject\": {\r\n                if (packet.sender.id === game.user.id) {\r\n                    onTradeRejected(packet, senderId);\r\n                }\r\n                break;\r\n            }\r\n            case \"trade-accept\": {\r\n                if (game.users.activeGM === game.user) {\r\n                    onTradeAccepted(packet, senderId);\r\n                }\r\n                break;\r\n            }\r\n        }\r\n    },\r\n    ready: () => {\r\n        const enabled = settings.enabled;\r\n        wrappers.toggleAll(enabled);\r\n        socket.toggle(enabled);\r\n    },\r\n} as const);\r\n\r\nfunction canTrade() {\r\n    return settings.trade;\r\n}\r\n\r\nfunction usesCountVariant() {\r\n    return settings.count > 0;\r\n}\r\n\r\nasync function characterSheetPF2eRenderInner(this: CharacterSheetPF2e, html: HTMLElement) {\r\n    const actor = this.actor;\r\n    const actions = getHeroActions(actor);\r\n    const usesCount = usesCountVariant();\r\n    const heroPoints = actor.heroPoints.value;\r\n    const diff = heroPoints - actions.length;\r\n    const mustDiscard = !usesCount && diff < 0;\r\n    const mustDraw = !usesCount && diff > 0;\r\n\r\n    const template = await render(\"sheet\", {\r\n        actions,\r\n        usesCount,\r\n        mustDiscard,\r\n        mustDraw,\r\n        canUse: (usesCount && heroPoints > 0) || diff >= 0,\r\n        canTrade: actions.length && !mustDiscard && !mustDraw && canTrade(),\r\n        diff: Math.abs(diff),\r\n        isOwner: actor.isOwner,\r\n        isGM: game.user.isGM,\r\n    });\r\n\r\n    const tab = querySelector(html, \".tab[data-tab=actions] .tab-content .tab[data-tab=encounter]\");\r\n    const attacks = querySelector(tab, \":scope > .strikes-list:not(.skill-action-list)\");\r\n\r\n    afterHTMLFromString(attacks, template);\r\n}\r\n\r\nfunction characterSheetPF2eActivateListeners(this: CharacterSheetPF2e, html: HTMLElement) {\r\n    const actor = this.actor;\r\n    const tab = querySelector(html, \".tab[data-tab=actions] .tab-content .tab[data-tab=encounter]\");\r\n    const list = querySelector(tab, \".heroActions-list\");\r\n    if (!list || !tab) return;\r\n\r\n    addListener(tab, \"[data-action='hero-actions-draw']\", () => drawHeroActions(actor));\r\n    addListener(tab, \"[data-action='hero-actions-trade']\", () => tradeHeroAction(actor, this));\r\n\r\n    if (game.user.isGM) {\r\n        addListener(tab, \"[data-action='give-actions']\", () => giveHeroActions(actor));\r\n    }\r\n\r\n    const addActionListener = (\r\n        action: string,\r\n        callback: (actor: CharacterPF2e, uuid: string, el: HTMLElement) => void\r\n    ) => {\r\n        addListenerAll(list, `[data-action=\"${action}\"]`, (event: Event, el: HTMLElement) => {\r\n            const actionEl = closest(el, \"[data-uuid]\");\r\n            if (!actionEl) return;\r\n\r\n            const { uuid } = elementData(actionEl);\r\n            callback(actor, uuid, actionEl);\r\n        });\r\n    };\r\n\r\n    addActionListener(\"hero-action-discard\", onDiscardAction);\r\n    addActionListener(\"hero-action-use\", useHeroAction);\r\n    addActionListener(\"hero-action-chat\", sendActionToChat);\r\n    addActionListener(\"hero-action-expand\", onExpandAction);\r\n}\r\n\r\nfunction isValidActor(actor: CharacterPF2e) {\r\n    if (actor?.isOfType(\"character\")) return true;\r\n    localize.warn(\"error.onlyCharacter\");\r\n    return false;\r\n}\r\n\r\nfunction getTradeDataFromPacket(packet: SocketPacket) {\r\n    const sender = game.actors.get<ActorPF2e>(packet.sender.cid);\r\n    const receiver = game.actors.get<ActorPF2e>(packet.receiver.cid);\r\n\r\n    if (!sender?.isOfType(\"character\") || !receiver?.isOfType(\"character\")) {\r\n        socket.emit({\r\n            ...packet,\r\n            type: \"trade-error\",\r\n        });\r\n        return;\r\n    }\r\n\r\n    const senderActions = getHeroActions(sender);\r\n    const receiverActions = getHeroActions(receiver);\r\n    const senderActionIndex = senderActions.findIndex((x) => x.uuid === packet.sender.uuid);\r\n    const receiverActionIndex = receiverActions.findIndex((x) => x.uuid === packet.receiver.uuid);\r\n\r\n    if (senderActionIndex === -1 || (packet.receiver.uuid && receiverActionIndex === -1)) {\r\n        socket.emit({\r\n            ...packet,\r\n            type: \"trade-error\",\r\n        });\r\n        return;\r\n    }\r\n\r\n    return {\r\n        sender: {\r\n            actor: sender,\r\n            actions: senderActions,\r\n            index: senderActionIndex,\r\n        },\r\n        receiver: {\r\n            actor: receiver,\r\n            actions: receiverActions,\r\n            index: receiverActionIndex,\r\n        },\r\n    };\r\n}\r\n\r\nfunction onTradeError(packet: SocketPacket, senderId: string) {\r\n    localize.error(\"error.tradeError\", {\r\n        sender: game.actors.get(packet.sender.cid)?.name ?? packet.sender.cid,\r\n        receiver: game.actors.get(packet.receiver.cid)?.name ?? packet.receiver.cid,\r\n    });\r\n}\r\n\r\nfunction onTradeRejected(packet: SocketPacket, senderId: string) {\r\n    localize.warn(\"trade.rejected\", {\r\n        sender: game.actors.get(packet.sender.cid)?.name ?? packet.sender.cid,\r\n        receiver: game.actors.get(packet.receiver.cid)?.name ?? packet.receiver.cid,\r\n    });\r\n}\r\n\r\nfunction onTradeAccepted(packet: SocketPacket, senderId: string) {\r\n    const data = getTradeDataFromPacket(packet);\r\n    if (!data) return;\r\n\r\n    const { sender, receiver } = data;\r\n    exchangeHeroActions(sender, receiver, senderId);\r\n}\r\n\r\nasync function onTradeRequest(packet: SocketPacket, senderId: string) {\r\n    const data = getTradeDataFromPacket(packet);\r\n    if (!data) return;\r\n\r\n    const { sender, receiver } = data;\r\n    const isPrivate = settings.private;\r\n    const translate = localize.sub(\"trade.request\");\r\n    const flavor = translate(\"flavor\", {\r\n        sender: sender.actor.name,\r\n        receiver: receiver.actor.name,\r\n    });\r\n\r\n    let content = `<div>${flavor}</div>`;\r\n\r\n    if (isPrivate) {\r\n        const rows = receiver.actions.map(({ uuid, name }, i) => {\r\n            const checked = i === 0 ? \"checked\" : \"\";\r\n            return `<div class=\"action\" data-uuid=\"${uuid}\">\r\n                <input type=\"radio\" name=\"action\" value=\"${uuid}\" ${checked} />\r\n                <label data-action=\"description\"> ${name}</label>\r\n            </div>`;\r\n        });\r\n\r\n        content += rows.join(\"\");\r\n    } else {\r\n        const give = translate(\"give\", {\r\n            give: `@UUID[${packet.sender.uuid}]`,\r\n        });\r\n        const want = translate(\"want\", {\r\n            want: `@UUID[${packet.receiver.uuid}]`,\r\n        });\r\n\r\n        content += `<div>${give}</div><div>${want}</div>`;\r\n    }\r\n\r\n    const html = await waitDialog(\"trade.request\", {\r\n        yes: \"fa-solid fa-handshake\",\r\n        content: await TextEditor.enrichHTML(content, { async: true }),\r\n        onRender: (html) => {\r\n            addListenerAll(html, \"[data-action='description']\", async (event, el) => {\r\n                const action = closest(el, \".action\");\r\n                if (!action) return;\r\n\r\n                const { uuid } = elementData(action);\r\n                const entry = await fromUuid(uuid);\r\n                entry?.sheet.render(true);\r\n            });\r\n        },\r\n    });\r\n\r\n    if (html === null) {\r\n        socket.emit({\r\n            ...packet,\r\n            type: \"trade-reject\",\r\n        });\r\n        return;\r\n    }\r\n\r\n    if (isPrivate) {\r\n        packet.receiver.uuid = querySelector<HTMLInputElement>(\r\n            html,\r\n            \"[name='action']:checked\"\r\n        )!.value;\r\n    }\r\n\r\n    if (game.user.isGM) {\r\n        exchangeHeroActions(sender, receiver, senderId);\r\n        return;\r\n    }\r\n\r\n    socket.emit({\r\n        ...packet,\r\n        type: \"trade-accept\",\r\n    });\r\n}\r\n\r\nasync function tradeHeroAction(actor: CharacterPF2e, app?: Application) {\r\n    if (!isValidActor(actor)) return;\r\n\r\n    if (!hasGMOnline()) {\r\n        localize.error(\"error.noGM\");\r\n        return;\r\n    }\r\n\r\n    const actions = getHeroActions(actor);\r\n\r\n    if (!actions.length) {\r\n        localize.warn(\"error.noAction\");\r\n        return;\r\n    }\r\n\r\n    const heroPoints = actor.heroPoints.value;\r\n    const usesCount = usesCountVariant();\r\n\r\n    if (!usesCount && heroPoints < actions.length) {\r\n        localize.warn(\"error.mustDiscard\", { nb: actions.length - heroPoints });\r\n        return;\r\n    }\r\n\r\n    const isPrivate = settings.private;\r\n    const others = (game.actors as Actors<ActorPF2e>)\r\n        .filter(\r\n            (x): x is CharacterPF2e => x !== actor && x.isOfType(\"character\") && x.hasPlayerOwner\r\n        )\r\n        .map((x) => ({\r\n            name: x.name,\r\n            id: x.id,\r\n            actions: getHeroActions(x),\r\n            isPrivate: isPrivate && !x.isOwner,\r\n        }))\r\n        .filter((x) => x.actions.length > 0);\r\n\r\n    if (others.length === 0) {\r\n        localize.warn(\"error.noOther\");\r\n        return;\r\n    }\r\n\r\n    const onRender = (html: HTMLElement) => {\r\n        addListener(html, \"[name='target']\", \"change\", (event, el: HTMLSelectElement) => {\r\n            const targetId = el.value;\r\n            const rightEls = html.querySelectorAll<HTMLElement>(\"[data-target-id]\");\r\n\r\n            for (const rightEl of rightEls) {\r\n                rightEl.classList.toggle(\"selected\", rightEl.dataset.targetId === targetId);\r\n            }\r\n\r\n            if (app) {\r\n                refreshApplication(app);\r\n            }\r\n        });\r\n\r\n        addListenerAll(html, \"[data-action='description']\", async (event, el) => {\r\n            const action = closest(el, \".action\");\r\n            if (!action) return;\r\n\r\n            const { uuid } = elementData(action);\r\n            const entry = await fromUuid(uuid);\r\n            entry?.sheet.render(true);\r\n        });\r\n    };\r\n\r\n    const html = await waitDialog(\r\n        \"trade\",\r\n        {\r\n            yes: \"fa-duotone fa-share-from-square\",\r\n            data: {\r\n                actions,\r\n                others,\r\n            },\r\n            onRender,\r\n        },\r\n        { width: 500 }\r\n    );\r\n\r\n    if (html === null) return;\r\n\r\n    const targetId = querySelector<HTMLSelectElement>(html, \".header [name='target']\")?.value;\r\n    const target = game.actors.get<CharacterPF2e>(targetId);\r\n    if (!target) return;\r\n\r\n    const actionUuid = querySelector<HTMLInputElement>(\r\n        html,\r\n        \".left [name='action']:checked\"\r\n    )?.value;\r\n    const targetActionUUid = html.querySelector<HTMLInputElement>(\r\n        `.right [name=\"action-${targetId}\"]:checked`\r\n    )?.value;\r\n\r\n    if (!actionUuid || !targetActionUUid) return;\r\n\r\n    if (target.isOwner && targetActionUUid) {\r\n        const targetActions = others.find((x) => x.id === targetId)!.actions;\r\n\r\n        exchangeHeroActions(\r\n            {\r\n                actor,\r\n                actions,\r\n                index: actions.findIndex((x) => x.uuid === actionUuid),\r\n            },\r\n            {\r\n                actor: target,\r\n                actions: targetActions,\r\n                index: targetActions.findIndex((x) => x.uuid === targetActionUUid),\r\n            }\r\n        );\r\n\r\n        return;\r\n    }\r\n\r\n    socket.emit({\r\n        type: \"trade-request\",\r\n        sender: {\r\n            id: game.user.id,\r\n            cid: actor.id,\r\n            uuid: actionUuid,\r\n        },\r\n        receiver: {\r\n            id: getOwner(target)?.id ?? game.users.activeGM!.id,\r\n            cid: targetId!,\r\n            uuid: targetActionUUid,\r\n        },\r\n    });\r\n}\r\n\r\nfunction exchangeHeroActions(trader1: ExchangeObj, trader2: ExchangeObj, senderId?: string) {\r\n    const trader1Action = trader1.actions.splice(trader1.index, 1)[0];\r\n    const trader2Action = trader2.actions.splice(trader2.index, 1)[0];\r\n\r\n    trader1.actions.push(trader2Action);\r\n    trader2.actions.push(trader1Action);\r\n\r\n    setHeroActions(trader1.actor, trader1.actions);\r\n    setHeroActions(trader2.actor, trader2.actions);\r\n\r\n    createActionsMessage(trader1.actor, [trader1Action, trader2Action], \"exchanged\", {\r\n        senderId,\r\n        other: trader2.actor.name,\r\n    });\r\n}\r\n\r\nasync function onExpandAction(actor: CharacterPF2e, uuid: string, actionEl: HTMLElement) {\r\n    const duration = 0.4;\r\n    const summaryEl = querySelector(actionEl, \".item-summary\")!;\r\n\r\n    if (!summaryEl.classList.contains(\"loaded\")) {\r\n        const details = await getHeroActionDetails(uuid);\r\n        if (!details) return;\r\n\r\n        const text = await TextEditor.enrichHTML(details.description, { async: true });\r\n        const descEl = querySelector(summaryEl, \".item-description\");\r\n\r\n        appendHTMLFromString(descEl, text);\r\n        summaryEl.classList.add(\"loaded\");\r\n    }\r\n\r\n    if (summaryEl.hidden) {\r\n        gsap.fromTo(\r\n            summaryEl,\r\n            { height: 0, opacity: 0, hidden: false },\r\n            { height: \"auto\", opacity: 1, duration }\r\n        );\r\n    } else {\r\n        gsap.to(summaryEl, {\r\n            height: 0,\r\n            duration,\r\n            opacity: 0,\r\n            paddingTop: 0,\r\n            paddingBottom: 0,\r\n            margin: 0,\r\n            clearProps: \"all\",\r\n            onComplete: () => {\r\n                summaryEl.hidden = true;\r\n            },\r\n        });\r\n    }\r\n}\r\n\r\nasync function sendActionToChat(actor: CharacterPF2e, uuid: string) {\r\n    if (!isValidActor(actor)) return;\r\n\r\n    const details = await getHeroActionDetails(uuid);\r\n    if (!details) return;\r\n\r\n    ChatMessage.implementation.create({\r\n        content: `<h3>${details.name}</h3>${details.description}`,\r\n        speaker: ChatMessage.getSpeaker({ actor }),\r\n    });\r\n}\r\n\r\nasync function useHeroAction(actor: CharacterPF2e, uuid: string) {\r\n    if (!isValidActor(actor)) return;\r\n\r\n    const points = actor.heroPoints.value;\r\n    if (points < 1) {\r\n        localize.warn(\"error.notEnoughPoint\");\r\n        return;\r\n    }\r\n\r\n    const actions = getHeroActions(actor);\r\n    const index = actions.findIndex((x) => x.uuid === uuid);\r\n    if (index === -1) return;\r\n\r\n    actions.splice(index, 1);\r\n\r\n    const details = await getHeroActionDetails(uuid);\r\n    if (!details) return;\r\n\r\n    const updates = setFlagProperty(\r\n        {\r\n            \"system.resources.heroPoints.value\": points - 1,\r\n        },\r\n        \"actions\",\r\n        actions\r\n    );\r\n\r\n    actor.update(updates);\r\n\r\n    ChatMessage.implementation.create({\r\n        flavor: `<h4 class=\"action\">${localize(\"message.used\")}</h4>`,\r\n        content: `<h3>${details.name}</h3>${details.description}`,\r\n        speaker: ChatMessage.getSpeaker({ actor }),\r\n    });\r\n}\r\n\r\nasync function getHeroActionDetails(uuid: string) {\r\n    const document = await fromUuid<JournalEntry | JournalEntryPage>(uuid);\r\n    if (!document) {\r\n        localize.error(\"error.noDetails\");\r\n        return;\r\n    }\r\n\r\n    const parent = document instanceof JournalEntry ? document : document.parent;\r\n    const page = document instanceof JournalEntry ? document.pages.contents[0] : document;\r\n\r\n    let text = page?.text.content;\r\n    if (!text) {\r\n        localize.error(\"error.noDetails\");\r\n        return;\r\n    }\r\n\r\n    if (parent.uuid === JOURNAL_UUID) text = text.replace(/^<p>/, \"<p><strong>Trigger</strong> \");\r\n    return { name: page.name, description: text };\r\n}\r\n\r\nfunction onDiscardAction(actor: CharacterPF2e, uuid: string, el: HTMLElement) {\r\n    const parent = closest(el, \".actions-list\")!;\r\n    const toDiscard = Number(elementData(parent).discard);\r\n    const discarded = querySelectorArray(parent, \".item.discarded\").map((x) => elementData(x).uuid);\r\n\r\n    if (discarded.includes(uuid)) {\r\n        el.classList.remove(\"discarded\");\r\n    } else if (discarded.length + 1 >= toDiscard) {\r\n        discarded.push(uuid);\r\n        discardHeroActions(actor, discarded);\r\n    } else {\r\n        el.classList.add(\"discarded\");\r\n    }\r\n}\r\n\r\nfunction discardHeroActions(actor: CharacterPF2e, uuids: string[] | string) {\r\n    if (!isValidActor(actor)) return;\r\n\r\n    const actions = getHeroActions(actor);\r\n    const removed = [];\r\n\r\n    uuids = Array.isArray(uuids) ? uuids : [uuids];\r\n\r\n    for (const uuid of uuids) {\r\n        const index = actions.findIndex((x) => x.uuid === uuid);\r\n\r\n        if (index !== -1) {\r\n            removed.push(actions[index]);\r\n            actions.splice(index, 1);\r\n        }\r\n    }\r\n\r\n    if (removed.length === 0) return;\r\n\r\n    setHeroActions(actor, actions);\r\n    createActionsMessage(actor, removed, \"discarded\");\r\n}\r\n\r\nasync function drawHeroActions(actor: CharacterPF2e) {\r\n    if (!isValidActor(actor)) return;\r\n\r\n    const drawn = [];\r\n    const count = settings.count;\r\n    const usesCount = count > 0;\r\n    const actions = usesCount ? [] : getHeroActions(actor);\r\n    const nb = count || actor.heroPoints.value - actions.length;\r\n\r\n    if (nb <= 0) {\r\n        localize.warn(\"error.notEnoughPoint\");\r\n        return;\r\n    }\r\n\r\n    for (let i = 0; i < nb; i++) {\r\n        const action = await drawHeroAction();\r\n\r\n        if (action === undefined) continue;\r\n        if (action === null) return;\r\n\r\n        actions.push(action);\r\n        drawn.push(action);\r\n    }\r\n\r\n    if (!drawn.length) return;\r\n\r\n    setHeroActions(actor, actions);\r\n    createActionsMessage(actor, drawn, \"drawn\");\r\n}\r\n\r\nfunction createActionsMessage(\r\n    actor: CharacterPF2e,\r\n    actions: HeroActionFlag[],\r\n    label: \"drawn\" | \"discarded\" | \"exchanged\" | \"given\",\r\n    { senderId = game.user.id, other }: { senderId?: string; other?: string } = {}\r\n) {\r\n    const links = actions.map(({ uuid }) => `@UUID[${uuid}]`);\r\n    const translate = localize.sub(\"message\");\r\n    const content =\r\n        label === \"exchanged\"\r\n            ? `<div>${translate(\"offer\", { offer: links[0] })}</div>\r\n            <div>${translate(\"receive\", { receive: links[1] })}</div>`\r\n            : links.map((x) => `<div>${x}</div>`).join(\"\");\r\n\r\n    const data: Partial<ChatMessageSourceData> = {\r\n        flavor: `<h4 class=\"action\">${translate(label, { nb: actions.length, name: other })}</h4>`,\r\n        content,\r\n        speaker: ChatMessage.getSpeaker({ actor }),\r\n        user: senderId,\r\n    };\r\n\r\n    if (settings.private) {\r\n        data.type = CONST.CHAT_MESSAGE_TYPES.ROLL;\r\n        data.rollMode = CONST.DICE_ROLL_MODES.PRIVATE;\r\n    }\r\n\r\n    ChatMessage.implementation.create(data);\r\n}\r\n\r\nasync function drawHeroAction() {\r\n    const table = await getDeckTable();\r\n    const translate = localize.sub(\"table\");\r\n\r\n    if (!table) {\r\n        translate.error(\"notFound\", true);\r\n        return null;\r\n    }\r\n\r\n    if (!table.formula) {\r\n        if (game.user.isGM) {\r\n            if (table.compendium) {\r\n                translate.error(\"noFormulaCompendium\", true);\r\n                return null;\r\n            }\r\n            await table.normalize();\r\n        } else {\r\n            translate.error(\"noFormula\", true);\r\n            return null;\r\n        }\r\n    }\r\n\r\n    if (table.replacement === false) {\r\n        const notDrawn = table.results.some((result) => !result.drawn);\r\n\r\n        if (!notDrawn) {\r\n            await table.resetResults();\r\n        }\r\n    }\r\n\r\n    const draw = (await table.draw({ displayChat: false })).results[0];\r\n\r\n    if (!draw) {\r\n        translate.warn(\"noDraw\");\r\n        return;\r\n    }\r\n\r\n    const uuid = documentUuidFromTableResult(draw);\r\n\r\n    if (!uuid) {\r\n        translate.warn(\"drawError\");\r\n        return;\r\n    }\r\n\r\n    const name = await getLabelfromTableResult(draw, uuid);\r\n    return { uuid, name };\r\n}\r\n\r\nasync function getLabelfromTableResult(result: TableResult, uuid: string) {\r\n    if (result.type !== CONST.TABLE_RESULT_TYPES.TEXT) {\r\n        return result.text;\r\n    }\r\n\r\n    const label = /@UUID\\[[\\w\\.]+\\]{([\\w -]+)}/.exec(result.text)?.[1];\r\n    return label ?? (uuid && (await fromUuid(uuid))?.name);\r\n}\r\n\r\nfunction documentUuidFromTableResult(result: TableResult) {\r\n    if (result.type === CONST.TABLE_RESULT_TYPES.TEXT) {\r\n        return /@UUID\\[([\\w\\.-]+)\\]/.exec(result.text)?.[1];\r\n    }\r\n    if (result.type === CONST.TABLE_RESULT_TYPES.DOCUMENT) {\r\n        return `${result.documentCollection}.${result.documentId}`;\r\n    }\r\n    if (result.type === CONST.TABLE_RESULT_TYPES.COMPENDIUM) {\r\n        return `Compendium.${result.documentCollection}.${result.documentId}`;\r\n    }\r\n    return undefined;\r\n}\r\n\r\nasync function getTableFromUuid(uuid: string) {\r\n    if (!uuid) return undefined;\r\n    const table = await fromUuid(uuid);\r\n    return table && table instanceof RollTable ? table : undefined;\r\n}\r\n\r\nfunction getDefaultWorldTable() {\r\n    return game.tables.find((x) => x.getFlag(\"core\", \"sourceId\") === TABLE_UUID);\r\n}\r\n\r\nasync function getDeckTable() {\r\n    return (\r\n        (await getTableFromUuid(settings.table)) ??\r\n        getDefaultWorldTable() ??\r\n        (await getTableFromUuid(TABLE_UUID))\r\n    );\r\n}\r\n\r\nfunction getHeroActions(actor: CharacterPF2e) {\r\n    return getFlag<HeroActionFlag[]>(actor, \"actions\")?.slice() ?? [];\r\n}\r\n\r\nfunction setHeroActions(actor: CharacterPF2e, actions: HeroActionFlag[]) {\r\n    return setFlag(actor, \"actions\", actions);\r\n}\r\n\r\nasync function giveHeroActions(actor: CharacterPF2e) {\r\n    if (!game.user.isGM) {\r\n        localize.warn(\"error.notGM\");\r\n        return;\r\n    }\r\n\r\n    if (!isValidActor(actor)) return;\r\n\r\n    const table = await getDeckTable();\r\n    if (!table) {\r\n        localize.error(\"table.notFound\", true);\r\n        return null;\r\n    }\r\n\r\n    const isUnique = table.replacement === false;\r\n    const actions = getHeroActions(actor);\r\n\r\n    const actionsList = (\r\n        await Promise.all(\r\n            table.results.map(async (result) => {\r\n                const uuid = documentUuidFromTableResult(result);\r\n                if (!uuid || actions.find((x) => x.uuid === uuid)) return;\r\n\r\n                return {\r\n                    key: result.id,\r\n                    uuid,\r\n                    name: await getLabelfromTableResult(result, uuid),\r\n                    drawn: isUnique && result.drawn,\r\n                };\r\n            })\r\n        )\r\n    ).filter(Boolean);\r\n\r\n    const html = await waitDialog(\"giveActions\", {\r\n        yes: \"fa-solid fa-gift\",\r\n        data: {\r\n            actions: actionsList,\r\n            isUnique,\r\n        },\r\n        onRender: (html) => {\r\n            addListenerAll(html, \"[data-action='expand']\", (event, el) => {\r\n                const actionEl = closest(el, \"[data-uuid]\");\r\n                if (!actionEl) return;\r\n\r\n                const { uuid } = elementData(actionEl);\r\n                onExpandAction(actor, uuid, actionEl);\r\n            });\r\n        },\r\n    });\r\n\r\n    if (!html) return;\r\n\r\n    const selected = querySelectorArray(html, \"[name='action']:checked\").map((el) => {\r\n        const parent = closest(el, \".action\")!;\r\n        return elementData<{ uuid: string; name: string; key: string }>(parent);\r\n    });\r\n    const asDrawn = querySelector<HTMLInputElement>(html, \"[name='drawn']\")?.checked;\r\n    const withMessage = querySelector<HTMLInputElement>(html, \"[name='message']\")!.checked;\r\n    const tableUpdates = [];\r\n\r\n    for (const { uuid, name, key } of selected) {\r\n        actions.push({ uuid, name });\r\n        if (!asDrawn) continue;\r\n\r\n        const result = table.results.get(key);\r\n        if (result && !result.drawn) tableUpdates.push(key);\r\n    }\r\n\r\n    if (tableUpdates.length) {\r\n        table.updateEmbeddedDocuments(\r\n            \"TableResult\",\r\n            tableUpdates.map((key) => ({ _id: key, drawn: true }))\r\n        );\r\n    }\r\n\r\n    setHeroActions(actor, actions);\r\n\r\n    if (withMessage) {\r\n        createActionsMessage(actor, selected, \"given\");\r\n    }\r\n}\r\n\r\nasync function removeHeroActions() {\r\n    if (!game.user.isGM) {\r\n        localize.warn(\"error.notGM\");\r\n        return;\r\n    }\r\n\r\n    const translate = localize.sub(\"removeActions\");\r\n\r\n    const onRender = (html: HTMLElement) => {\r\n        const allInput = querySelector<HTMLInputElement>(html, \"[name='all']\")!;\r\n        const actorInputs = querySelectorArray<HTMLInputElement>(html, \"[name='actor']\");\r\n\r\n        allInput.addEventListener(\"change\", () => {\r\n            const allChecked = allInput.checked;\r\n\r\n            for (const actorInput of actorInputs) {\r\n                actorInput.checked = allChecked;\r\n            }\r\n        });\r\n\r\n        for (const actorInput of actorInputs) {\r\n            actorInput.addEventListener(\"change\", () => {\r\n                const actorsChecked = actorInputs.filter((x) => x.checked);\r\n\r\n                if (actorInputs.length === actorsChecked.length) {\r\n                    allInput.indeterminate = false;\r\n                    allInput.checked = true;\r\n                } else if (!actorsChecked.length) {\r\n                    allInput.indeterminate = false;\r\n                    allInput.checked = false;\r\n                } else {\r\n                    allInput.indeterminate = true;\r\n                    allInput.checked = actorsChecked.length > actorInputs.length / 2;\r\n                }\r\n            });\r\n        }\r\n    };\r\n\r\n    const html = await waitDialog(\"removeActions\", {\r\n        yes: \"fa-solid fa-trash\",\r\n        data: {\r\n            actors: game.actors.filter((x) => x.type === \"character\"),\r\n        },\r\n        onRender,\r\n    });\r\n\r\n    if (!html) return;\r\n\r\n    const actors = R.pipe(\r\n        querySelectorArray<HTMLInputElement>(html, \"[name='actor']:checked\"),\r\n        R.map((input) => game.actors.get<CharacterPF2e>(input.value)),\r\n        R.compact\r\n    );\r\n\r\n    if (!actors.length) return;\r\n\r\n    for (const actor of actors) {\r\n        setHeroActions(actor, []);\r\n    }\r\n\r\n    translate.info(\"removed\");\r\n}\r\n\r\ntype HeroActionFlag = toolbelt.heroActions.HeroActionFlag;\r\n\r\ntype SocketPacket = {\r\n    type: \"trade-request\" | \"trade-reject\" | \"trade-error\" | \"trade-accept\";\r\n    sender: {\r\n        id: string;\r\n        cid: string;\r\n        uuid: string;\r\n    };\r\n    receiver: {\r\n        id: string;\r\n        cid: string;\r\n        uuid?: string;\r\n    };\r\n};\r\n\r\ntype ExchangeObj = {\r\n    actor: CharacterPF2e;\r\n    actions: HeroActionFlag[];\r\n    index: number;\r\n};\r\n\r\nexport { config as heroActionsTool };\r\n", "import { libWrapper } from \"pf2e-api\";\r\nimport { createTool } from \"../tool\";\r\n\r\nconst { config, settings, wrappers } = createTool({\r\n    name: \"noBulk\",\r\n    settings: [\r\n        {\r\n            key: \"dropped\",\r\n            type: Boolean,\r\n            default: false,\r\n            requiresReload: true,\r\n        },\r\n        {\r\n            key: \"coins\",\r\n            type: Boolean,\r\n            default: false,\r\n            requiresReload: true,\r\n        },\r\n    ],\r\n    wrappers: [\r\n        {\r\n            key: \"dropped\",\r\n            path: \"CONFIG.Actor.documentClass.prototype.prepareEmbeddedDocuments\",\r\n            callback: actorPrepareEmbeddedDocuments,\r\n        },\r\n        {\r\n            key: \"coins\",\r\n            path: \"CONFIG.PF2E.Item.documentClasses.treasure.prototype.prepareBaseData\",\r\n            callback: treasurePreparedBaseData,\r\n        },\r\n    ],\r\n    init: () => {\r\n        wrappers.dropped.toggle(settings.dropped);\r\n        wrappers.coins.toggle(settings.coins);\r\n    },\r\n} as const);\r\n\r\nfunction actorPrepareEmbeddedDocuments(this: ActorPF2e, wrapped: libWrapper.RegisterCallback) {\r\n    wrapped();\r\n\r\n    const InventoryBulkClass = this.inventory.bulk.constructor as typeof InventoryBulk;\r\n\r\n    let _value: Bulk | null = null;\r\n\r\n    Object.defineProperty(this.inventory.bulk, \"value\", {\r\n        get(this: InventoryBulk): Bulk {\r\n            if (_value) return _value;\r\n\r\n            _value = InventoryBulkClass.computeTotalBulk(\r\n                this.actor.inventory.filter(\r\n                    (item) => !item.isInContainer && item.system.equipped.carryType !== \"dropped\"\r\n                ),\r\n                this.actor.size\r\n            );\r\n\r\n            return _value;\r\n        },\r\n    });\r\n}\r\n\r\nfunction treasurePreparedBaseData(this: TreasurePF2e, wrapped: libWrapper.RegisterCallback) {\r\n    wrapped();\r\n\r\n    if (this.isCoinage) {\r\n        this.system.bulk.value = 0;\r\n    }\r\n}\r\n\r\nexport { config as noBulkTool };\r\n", "import { createTool } from \"../tool\";\r\n\r\nconst { config, settings, hooks } = createTool({\r\n    name: \"unided\",\r\n    settings: [\r\n        {\r\n            key: \"create\",\r\n            type: Boolean,\r\n            default: false,\r\n            onChange: (value) => {\r\n                hooks.preCreateItem.toggle(value);\r\n            },\r\n        },\r\n        {\r\n            key: \"update\",\r\n            type: Boolean,\r\n            default: false,\r\n            onChange: (value) => {\r\n                hooks.preUpdateItem.toggle(value);\r\n            },\r\n        },\r\n    ],\r\n    hooks: [\r\n        {\r\n            event: \"preCreateItem\",\r\n            listener: onPrecreateItem,\r\n        },\r\n        {\r\n            event: \"preUpdateItem\",\r\n            listener: onPreUpdateItem,\r\n        },\r\n    ],\r\n    init: () => {\r\n        hooks.preCreateItem.toggle(settings.create);\r\n        hooks.preUpdateItem.toggle(settings.update);\r\n    },\r\n} as const);\r\n\r\nfunction onPrecreateItem(item: ItemPF2e) {\r\n    if (!item.img || !item.isOfType(\"physical\")) return;\r\n    item.updateSource({ \"system.identification.unidentified.img\": item.img });\r\n}\r\n\r\nfunction onPreUpdateItem(item: ItemPF2e, data: DeepPartial<ItemSourcePF2e>) {\r\n    if (!(\"img\" in item) || !item.isOfType(\"physical\")) return;\r\n    setProperty(data, \"system.identification.unidentified.img\", data.img);\r\n}\r\n\r\nexport { config as unidedTool };\r\n", "import { createTool } from \"../tool\";\r\n\r\nconst debouncedSetup = debounce(setup, 1);\r\n\r\nconst { config, settings, hook } = createTool({\r\n    name: \"untarget\",\r\n    settings: [\r\n        {\r\n            key: \"force\",\r\n            type: Boolean,\r\n            default: false,\r\n            onChange: debouncedSetup,\r\n        },\r\n        {\r\n            key: \"enabled\",\r\n            type: Boolean,\r\n            default: false,\r\n            scope: \"client\",\r\n            onChange: debouncedSetup,\r\n        },\r\n    ],\r\n    hooks: [\r\n        {\r\n            event: \"updateCombat\",\r\n            listener: onUpdateCombat,\r\n        },\r\n    ],\r\n} as const);\r\n\r\nfunction setup() {\r\n    hook.toggle(settings.force || settings.enabled);\r\n}\r\n\r\nfunction onUpdateCombat(combat: EncounterPF2e, data: CombatSource) {\r\n    if (!(\"turn\" in data) && !(\"round\" in data)) return;\r\n\r\n    const user = game.user;\r\n    user.updateTokenTargets();\r\n    user.broadcastActivity({ targets: [] });\r\n}\r\n\r\nexport { config as untargetTool };\r\n", "import { getTemplateTokens, querySelector } from \"pf2e-api\";\r\nimport { createTool } from \"../tool\";\r\n\r\nconst { config, settings, hook, waitDialog } = createTool({\r\n    name: \"templateHelper\",\r\n    settings: [\r\n        {\r\n            key: \"enabled\",\r\n            type: Boolean,\r\n            default: false,\r\n            scope: \"client\",\r\n            onChange: (value) => {\r\n                hook.toggle(value);\r\n            },\r\n        },\r\n        {\r\n            key: \"dismiss\",\r\n            type: String,\r\n            choices: [\"disabled\", \"orphan\", \"all\"],\r\n            default: \"disabled\",\r\n            scope: \"client\",\r\n        },\r\n    ],\r\n    hooks: [\r\n        {\r\n            event: \"createMeasuredTemplate\",\r\n            listener: onCreateMeasuredTemplate,\r\n        },\r\n    ],\r\n    init: () => {\r\n        hook.toggle(settings.enabled);\r\n    },\r\n} as const);\r\n\r\nasync function onCreateMeasuredTemplate(\r\n    template: MeasuredTemplateDocumentPF2e,\r\n    context: any,\r\n    userId: string\r\n) {\r\n    const user = game.user;\r\n    if (user.id !== userId) return;\r\n\r\n    const actor = template.actor;\r\n    const self: Token | null | undefined = !actor\r\n        ? undefined\r\n        : actor.token?.object ?? actor.getActiveTokens()[0];\r\n\r\n    const html = await waitDialog(\r\n        \"menu\",\r\n        {\r\n            title: template.item?.name,\r\n            yes: \"fa-solid fa-bullseye-arrow\",\r\n            data: {\r\n                noSelf: !self,\r\n            },\r\n        },\r\n        { width: 300 }\r\n    );\r\n\r\n    if (html) {\r\n        const target = querySelector<HTMLInputElement>(html, \"[name='targets']:checked\")?.value;\r\n        const targetNeutral = querySelector<HTMLInputElement>(html, \"[name='neutral']\")?.checked;\r\n        const targetSelf = querySelector<HTMLInputElement>(html, \"[name='self']\")?.checked;\r\n        const alliance = actor ? actor.alliance : user.isGM ? \"opposition\" : \"party\";\r\n        const opposition =\r\n            alliance === \"party\" ? \"opposition\" : alliance === \"opposition\" ? \"party\" : null;\r\n\r\n        const tokens = getTemplateTokens(template);\r\n        const targets = tokens.filter((token) => {\r\n            const actor = token.actor;\r\n            if (token.document.hidden || !actor?.isOfType(\"creature\", \"hazard\", \"vehicle\")) {\r\n                return false;\r\n            }\r\n\r\n            if (self && token === self) return targetSelf;\r\n\r\n            const targetAlliance = actor.alliance;\r\n            if (targetAlliance === null) return targetNeutral;\r\n\r\n            return (\r\n                target === \"all\" ||\r\n                (target === \"allies\" && targetAlliance === alliance) ||\r\n                (target === \"enemies\" && targetAlliance === opposition)\r\n            );\r\n        });\r\n\r\n        const targetsIds = targets.map((token) => token.id);\r\n        user.updateTokenTargets(targetsIds);\r\n        user.broadcastActivity({ targets: targetsIds });\r\n    }\r\n\r\n    const dismissSetting = settings.dismiss;\r\n    if (dismissSetting === \"disabled\") return;\r\n\r\n    if (\r\n        dismissSetting === \"all\" ||\r\n        template.message?.getFlag(\"pf2e\", \"context.type\") !== \"spell-cast\"\r\n    ) {\r\n        template.delete();\r\n    }\r\n}\r\n\r\nexport { config as templateHelperTool };\r\n", "import {\r\n    addListener,\r\n    addListenerAll,\r\n    beforeHTMLFromString,\r\n    getActiveModule,\r\n    getSummarizedSpellsDataForRender,\r\n    isPlayedActor,\r\n    querySelector,\r\n    renderCharacterSheets,\r\n} from \"pf2e-api\";\r\nimport { createTool } from \"../tool\";\r\nimport {\r\n    CHARACTER_SHEET_ACTIVATE_LISTENERS,\r\n    CHARACTER_SHEET_RENDER_INNER,\r\n} from \"./shared/characterSheet\";\r\n\r\nconst { config, settings, wrappers, localize, render } = createTool({\r\n    name: \"spellsSummary\",\r\n    settings: [\r\n        {\r\n            key: \"enabled\",\r\n            type: Boolean,\r\n            default: false,\r\n            scope: \"client\",\r\n            onChange: (value) => {\r\n                wrappers.toggleAll(value);\r\n                renderCharacterSheets();\r\n            },\r\n        },\r\n        {\r\n            key: \"sort\",\r\n            type: Boolean,\r\n            default: false,\r\n            scope: \"client\",\r\n            onChange: renderCharacterSheets,\r\n        },\r\n    ],\r\n    wrappers: [\r\n        {\r\n            path: CHARACTER_SHEET_RENDER_INNER,\r\n            callback: characterSheetPF2eRenderInner,\r\n        },\r\n        {\r\n            path: CHARACTER_SHEET_ACTIVATE_LISTENERS,\r\n            callback: characterSheetPF2eActivateListeners,\r\n        },\r\n    ],\r\n    ready: () => {\r\n        wrappers.toggleAll(settings.enabled);\r\n    },\r\n} as const);\r\n\r\nasync function characterSheetPF2eRenderInner(\r\n    this: CharacterSheetPF2e,\r\n    html: HTMLElement,\r\n    data: CharacterSheetData\r\n) {\r\n    const actor = this.actor;\r\n\r\n    const entries = Object.values(data.spellCollectionGroups).flat();\r\n    const summarizedData = await getSummarizedSpellsDataForRender(\r\n        actor,\r\n        settings.sort,\r\n        localize.path,\r\n        entries\r\n    );\r\n    const tab = await render(\"sheet\", summarizedData);\r\n    const nav = `<a data-tab=\"spells-summary\" \r\n    data-group=\"spell-collections\">Spell Summary</a>`;\r\n    const spellcastingTab = getSpellcastingTab(html);\r\n    const knownSpellsTab = querySelector(spellcastingTab, \".tab[data-tab='known-spells']\");\r\n    const knownSpellsNav = querySelector(spellcastingTab, \"nav [data-tab='known-spells']\");\r\n\r\n    beforeHTMLFromString(knownSpellsNav, nav);\r\n    beforeHTMLFromString(knownSpellsTab, tab);\r\n}\r\n\r\nfunction characterSheetPF2eActivateListeners(this: CharacterSheetPF2e, html: HTMLElement) {\r\n    const actor = this.actor;\r\n\r\n    addListener(html, \"nav.sheet-navigation .item[data-tab='spellcasting']\", (event, el) =>\r\n        toggleSpellcastingTab.call(this, html, el)\r\n    );\r\n\r\n    const pf2eDailies = getActiveModule<PF2eDailiesModule>(\"pf2e-dailies\");\r\n    if (!pf2eDailies) return;\r\n\r\n    const spellcastingTab = getSpellcastingTab(html);\r\n    const spellsSummaryTab = querySelector(spellcastingTab, \".tab.spells-summary\");\r\n    if (!spellsSummaryTab) return;\r\n\r\n    addListenerAll(\r\n        spellsSummaryTab,\r\n        \"[data-action='update-staff-charges']\",\r\n        \"change\",\r\n        (event, el: HTMLInputElement) => {\r\n            const value = el.valueAsNumber;\r\n            pf2eDailies.api.setStaffChargesValue(actor, value);\r\n        }\r\n    );\r\n\r\n    addListenerAll(spellsSummaryTab, \"[data-action='reset-staff-charges']\", () => {\r\n        pf2eDailies.api.setStaffChargesValue(actor);\r\n    });\r\n}\r\n\r\nfunction toggleSpellcastingTab(this: CharacterSheetPF2e, html: HTMLElement, navIcon: HTMLElement) {\r\n    if (!navIcon.classList.contains(\"active\")) return;\r\n\r\n    const spellcastingTab = getSpellcastingTab(html);\r\n    const spellcastingNav = querySelector(spellcastingTab, \"nav\");\r\n    const isActive = querySelector(\r\n        spellcastingNav,\r\n        \"[data-tab='spells-summary']\"\r\n    )?.classList.contains(\"active\");\r\n\r\n    const tabName = isActive ? \"known-spells\" : \"spells-summary\";\r\n    this.activateTab(tabName, { group: \"spell-collections\" });\r\n}\r\n\r\nfunction getSpellcastingTab(html: HTMLElement) {\r\n    return querySelector(html, \".sheet-content .tab[data-tab='spellcasting']\");\r\n}\r\n\r\nexport { config as spellsSummaryTool };\r\n", "import {\r\n    addListenerAll,\r\n    beforeHTMLFromString,\r\n    elementData,\r\n    getItemWithSourceId,\r\n    hasItemWithSourceId,\r\n    isOwner,\r\n    querySelector,\r\n    renderCharacterSheets,\r\n} from \"pf2e-api\";\r\nimport { createTool } from \"../tool\";\r\nimport {\r\n    CHARACTER_SHEET_ACTIVATE_LISTENERS,\r\n    CHARACTER_SHEET_RENDER_INNER,\r\n} from \"./shared/characterSheet\";\r\n\r\nconst OPENING_STANCE = [\r\n    \"Compendium.pf2e.feats-srd.Item.yeSyGnYDkl2GUNmu\",\r\n    \"Compendium.pf2e.feats-srd.Item.LI9VtCaL5ZRk0Wo8\",\r\n];\r\n\r\nconst REPLACERS = new Map([\r\n    [\r\n        \"Compendium.pf2e.feats-srd.Item.nRjyyDulHnP5OewA\", // gorilla pound\r\n\r\n        {\r\n            replace: \"Compendium.pf2e.feats-srd.Item.DqD7htz8Sd1dh3BT\", // gorilla stance\r\n            effect: \"Compendium.pf2e.feat-effects.Item.UZKIKLuwpQu47feK\",\r\n        },\r\n    ],\r\n]);\r\n\r\nconst EXTRAS = new Map([\r\n    [\r\n        \"Compendium.pf2e.classfeatures.Item.09iL38CZZEa0q0Mt\", // arcane cascade\r\n        {\r\n            effect: \"Compendium.pf2e.feat-effects.Item.fsjO5oTKttsbpaKl\",\r\n            action: \"Compendium.pf2e.actionspf2e.Item.HbejhIywqIufrmVM\",\r\n        },\r\n    ],\r\n    [\r\n        \"Compendium.pf2e.feats-srd.Item.xQuNswWB3eg1UM28\", // cobra envenom\r\n        {\r\n            effect: \"Compendium.pf2e.feat-effects.Item.2Qpt0CHuOMeL48rN\",\r\n        },\r\n    ],\r\n    [\r\n        \"Compendium.pf2e.feats-srd.Item.R7c4PyTNkZb0yvoT\", // dread marshal\r\n        {\r\n            effect: \"Compendium.pf2e.feat-effects.Item.qX62wJzDYtNxDbFv\", // the stance aura\r\n        },\r\n    ],\r\n    [\r\n        \"Compendium.pf2e.feats-srd.Item.bvOsJNeI0ewvQsFa\", // inspiring marshal\r\n        {\r\n            effect: \"Compendium.pf2e.feat-effects.Item.er5tvDNvpbcnlbHQ\", // the stance aura\r\n        },\r\n    ],\r\n]);\r\n\r\nconst { config, settings, hooks, wrappers, localize, render, waitDialog } = createTool({\r\n    name: \"stances\",\r\n    settings: [\r\n        {\r\n            key: \"enabled\",\r\n            type: Boolean,\r\n            default: false,\r\n            scope: \"client\",\r\n            onChange: (value) => {\r\n                hooks.toggleAll(value);\r\n                wrappers.toggleAll(value);\r\n                renderCharacterSheets();\r\n            },\r\n        },\r\n    ],\r\n    hooks: [\r\n        {\r\n            event: \"preDeleteCombatant\",\r\n            listener: onPreDeleteCombatant,\r\n        },\r\n        {\r\n            event: \"createCombatant\",\r\n            listener: onCreateCombatant,\r\n        },\r\n        {\r\n            event: \"deleteCombatant\",\r\n            listener: onDeleteCombatant,\r\n        },\r\n    ],\r\n    wrappers: [\r\n        {\r\n            path: CHARACTER_SHEET_RENDER_INNER,\r\n            callback: characterSheetPF2eRenderInner,\r\n        },\r\n        {\r\n            path: CHARACTER_SHEET_ACTIVATE_LISTENERS,\r\n            callback: characterSheetPF2eActivateListeners,\r\n        },\r\n    ],\r\n    api: {\r\n        canUseStances,\r\n        getStances,\r\n        isValidStance,\r\n        toggleStance,\r\n    },\r\n    ready: () => {\r\n        const enabled = settings.enabled;\r\n        hooks.toggleAll(enabled);\r\n        wrappers.toggleAll(enabled);\r\n    },\r\n} as const);\r\n\r\nasync function characterSheetPF2eRenderInner(\r\n    this: CharacterSheetPF2e,\r\n    html: HTMLElement,\r\n    data: CharacterSheetData\r\n) {\r\n    const actor = this.actor;\r\n    if (!actor.isOwner) return;\r\n\r\n    const stances = getStances(actor);\r\n    if (!stances.length) return;\r\n\r\n    const encounterTab = getEncounterTab(html);\r\n    const template = await render(\"sheet\", {\r\n        inCombat: canUseStances(actor),\r\n        stances,\r\n    });\r\n\r\n    beforeHTMLFromString(querySelector(encounterTab, \"header\"), template);\r\n}\r\n\r\nfunction characterSheetPF2eActivateListeners(this: CharacterSheetPF2e, html: HTMLElement) {\r\n    const actor = this.actor;\r\n    if (!actor.isOwner) return;\r\n\r\n    const encounterTab = getEncounterTab(html);\r\n    if (!encounterTab) return;\r\n\r\n    addListenerAll(encounterTab, \".pf2e-stances .stance\", (event, el) => {\r\n        const uuid = elementData(el).effectUuid;\r\n        toggleStance(actor, uuid, event.ctrlKey);\r\n    });\r\n}\r\n\r\nfunction onPreDeleteCombatant(combatant: CombatantPF2e) {\r\n    const actor = combatant.actor;\r\n    if (!actor?.isOfType(\"character\")) return;\r\n\r\n    const effects = getStanceEffects(actor);\r\n\r\n    if (!effects.length) {\r\n        actor.sheet.render();\r\n        return;\r\n    }\r\n\r\n    actor.deleteEmbeddedDocuments(\r\n        \"Item\",\r\n        effects.map(({ effectID }) => effectID)\r\n    );\r\n}\r\n\r\nfunction onDeleteCombatant(combatant: CombatantPF2e) {\r\n    renderCharacterSheets();\r\n}\r\n\r\nasync function onCreateCombatant(combatant: CombatantPF2e) {\r\n    const actor = combatant.actor;\r\n    if (!actor?.isOfType(\"character\")) return;\r\n\r\n    if (game.user.isGM || !isOwner(actor)) {\r\n        actor.sheet.render();\r\n        return;\r\n    }\r\n\r\n    const stances = getStances(actor);\r\n    if (!stances.length) return;\r\n\r\n    const hasStancesEffects = stances.some(({ effectID }) => !!effectID);\r\n    if (hasStancesEffects) return;\r\n\r\n    const hasOpeningStanceFeat = hasItemWithSourceId(actor, OPENING_STANCE, \"feat\");\r\n    if (!hasOpeningStanceFeat) return;\r\n\r\n    if (stances.length === 1) {\r\n        addStance(actor, stances[0].effectUUID);\r\n        return;\r\n    }\r\n\r\n    const html = await waitDialog(\"opening\", {\r\n        yes: \"fa-solid fa-person-running\",\r\n        data: {\r\n            stances,\r\n            actor,\r\n        },\r\n    });\r\n\r\n    const effectUUID = html\r\n        ? querySelector<HTMLInputElement>(html, \"[name='stance']:checked\")?.value\r\n        : stances[0].effectUUID;\r\n\r\n    if (!effectUUID) return;\r\n    addStance(actor, effectUUID);\r\n}\r\n\r\nasync function toggleStance(actor: CharacterPF2e, effectUUID: string, force?: boolean) {\r\n    if (!force && !canUseStances(actor)) {\r\n        localize.warn(\"error.noCombat\");\r\n        return;\r\n    }\r\n\r\n    const effects = getStanceEffects(actor);\r\n    const effect = effects.find((stance) => stance.effectUUID === effectUUID);\r\n\r\n    if (!effect) {\r\n        await addStance(actor, effectUUID);\r\n    }\r\n\r\n    if (effects.length) {\r\n        actor.deleteEmbeddedDocuments(\r\n            \"Item\",\r\n            effects.map(({ effectID }) => effectID)\r\n        );\r\n    }\r\n}\r\n\r\nfunction getStanceEffects(actor: CharacterPF2e) {\r\n    const stances = getStances(actor);\r\n    return stances.filter((stance): stance is StanceDataWithEffect => !!stance.effectID);\r\n}\r\n\r\nasync function addStance(actor: CharacterPF2e, effectUUID: string) {\r\n    const effect = await fromUuid<ItemPF2e>(effectUUID);\r\n    if (!(effect instanceof Item) || !effect.isOfType(\"effect\")) return;\r\n\r\n    const source = effect.toObject();\r\n    setProperty(source, \"flags.core.sourceId\", effectUUID);\r\n\r\n    const [item] = await actor.createEmbeddedDocuments(\"Item\", [source]);\r\n    item?.toMessage();\r\n}\r\n\r\nfunction canUseStances(actor: CharacterPF2e) {\r\n    return actor.getActiveTokens(true, true).some((token) => token.inCombat);\r\n}\r\n\r\nfunction getEncounterTab(html: HTMLElement) {\r\n    return querySelector(\r\n        html,\r\n        \".sheet-content [data-tab=actions] .tab-content .actions-panels [data-tab=encounter]\"\r\n    );\r\n}\r\n\r\nfunction getStances(actor: CharacterPF2e) {\r\n    const stances: toolbelt.stances.StanceData[] = [];\r\n    const replaced = new Set<string>();\r\n\r\n    for (const feat of actor.itemTypes.feat) {\r\n        const uuid = feat.sourceId;\r\n        if (!uuid) continue;\r\n\r\n        const replacer = REPLACERS.get(uuid);\r\n        const extra = EXTRAS.get(uuid);\r\n        if (!replacer && !extra && !isValidStance(feat)) continue;\r\n\r\n        const effectUUID = replacer?.effect ?? extra?.effect ?? feat.system.selfEffect!.uuid;\r\n        const effect = fromUuidSync(effectUUID);\r\n        if (!effect) continue;\r\n\r\n        if (replacer?.replace) {\r\n            replaced.add(replacer.replace);\r\n        }\r\n\r\n        const existingEffect = getItemWithSourceId(actor, effectUUID, \"effect\");\r\n        const foundAction =\r\n            (extra?.action && getItemWithSourceId<ItemPF2e>(actor, extra.action, \"action\")) || feat;\r\n\r\n        stances.push({\r\n            name: (replacer && fromUuidSync(replacer.replace)?.name) ?? feat.name,\r\n            itemName: feat.name,\r\n            uuid,\r\n            img: effect.img,\r\n            effectUUID,\r\n            effectID: existingEffect?.id,\r\n            actionUUID: foundAction.sourceId!,\r\n            actionID: foundAction.id,\r\n        });\r\n    }\r\n\r\n    return stances.filter(({ uuid }) => !replaced.has(uuid));\r\n}\r\n\r\nfunction isValidStance(stance: ItemPF2e): stance is FeatPF2e {\r\n    return (\r\n        stance.isOfType(\"feat\") &&\r\n        stance.system.traits.value.includes(\"stance\") &&\r\n        !!stance.system.selfEffect?.uuid\r\n    );\r\n}\r\n\r\ntype StanceData = toolbelt.stances.StanceData;\r\n\r\ntype StanceDataWithEffect = Omit<StanceData, \"effectID\"> & { effectID: string };\r\n\r\nexport { config as stancesTool };\r\n", "import {\r\n    BANDS_OF_FORCE_SLUGS,\r\n    R,\r\n    SKILL_ABBREVIATIONS,\r\n    SKILL_DICTIONARY,\r\n    SKILL_EXPANDED,\r\n    beforeHTMLFromString,\r\n    calculateRemainingDuration,\r\n    getStatisticClass,\r\n    htmlElement,\r\n    isInstanceOf,\r\n    isPlayedActor,\r\n    libWrapper,\r\n    querySelector,\r\n    resetActors,\r\n    type BandsOfForceSlug,\r\n} from \"pf2e-api\";\r\nimport { createTool } from \"../tool\";\r\nimport { WEAPON_PREPARE_BASE_DATA } from \"./shared/prepareDocument\";\r\n\r\nconst characterShareOptions = [\"health\", \"turn\", \"skills\", \"hero\", \"weapon\", \"armor\"] as const;\r\nconst npcShareOptions = [\"health\", \"turn\", \"armor\"] as const;\r\n\r\nconst {\r\n    config,\r\n    settings,\r\n    hooks,\r\n    wrappers,\r\n    localize,\r\n    render,\r\n    getFlag,\r\n    unsetFlag,\r\n    flagPath,\r\n    getFlagProperty,\r\n    getInMemory,\r\n    setInMemory,\r\n} = createTool({\r\n    name: \"share\",\r\n    settings: [\r\n        {\r\n            key: \"enabled\",\r\n            type: Boolean,\r\n            default: false,\r\n            requiresReload: true,\r\n        },\r\n    ],\r\n    wrappers: [\r\n        {\r\n            path: \"DocumentSheet.prototype._renderInner\",\r\n            callback: documentSheetRenderInner,\r\n        },\r\n        {\r\n            path: \"CONFIG.Actor.documentClass.prototype.prepareBaseData\",\r\n            callback: actorPrepareBaseData,\r\n        },\r\n        {\r\n            path: \"CONFIG.Actor.documentClass.prototype.prepareDerivedData\",\r\n            callback: actorPrepareDerivedData,\r\n        },\r\n        {\r\n            path: \"CONFIG.Actor.documentClass.prototype.prepareData\",\r\n            callback: actorPrepareData,\r\n        },\r\n        {\r\n            path: \"CONFIG.Combatant.documentClass.prototype.startTurn\",\r\n            callback: combatantStartTurn,\r\n        },\r\n        {\r\n            path: \"CONFIG.Combatant.documentClass.prototype.endTurn\",\r\n            callback: combatantEndTurn,\r\n        },\r\n        {\r\n            path: \"CONFIG.Combat.documentClass.prototype.resetActors\",\r\n            callback: combatResetActors,\r\n            type: \"OVERRIDE\",\r\n        },\r\n        {\r\n            path: \"CONFIG.PF2E.Item.documentClasses.effect.prototype.remainingDuration\",\r\n            callback: effectRemainingDuration,\r\n            type: \"OVERRIDE\",\r\n        },\r\n        {\r\n            path: WEAPON_PREPARE_BASE_DATA,\r\n            callback: weaponPrepareBaseData,\r\n        },\r\n    ],\r\n    hooks: [\r\n        {\r\n            event: \"updateActor\",\r\n            listener: onUpdateActor,\r\n        },\r\n        {\r\n            event: \"deleteActor\",\r\n            listener: onDeleteActor,\r\n        },\r\n    ],\r\n    init: (isGM) => {\r\n        const enabled = settings.enabled;\r\n\r\n        hooks.toggleAll(enabled);\r\n        wrappers.toggleAll(enabled);\r\n    },\r\n} as const);\r\n\r\nasync function documentSheetRenderInner(\r\n    this: DocumentSheet,\r\n    wrapped: libWrapper.RegisterCallback,\r\n    ...args: any[]\r\n): Promise<JQuery> {\r\n    const $html = await wrapped(...args);\r\n    if (!game.user.isGM || !isInstanceOf<CreatureConfig>(this, \"CreatureConfig\")) return $html;\r\n\r\n    const actor = this.actor;\r\n    if (!isPlayedActor(actor) || !actor.isOfType(\"character\", \"npc\")) return $html;\r\n\r\n    const config = getFlag<ConfigFlags>(actor, \"config\");\r\n\r\n    const masters = getSlaves(actor).length\r\n        ? []\r\n        : (game.actors as Actors<ActorPF2e>)\r\n              .filter((x): x is CharacterPF2e => isValidMaster(x, actor.id))\r\n              .map((x) => ({ value: x.id, label: x.name }));\r\n\r\n    const shareOptions = actor.isOfType(\"character\") ? characterShareOptions : npcShareOptions;\r\n    const groups = shareOptions.map((group) => ({\r\n        label: localize(\"config\", group, \"label\"),\r\n        hint: localize(\"config\", group, \"hint\"),\r\n        checked: config?.[group] ?? false,\r\n        input: flagPath(\"config\", group),\r\n    }));\r\n\r\n    const html = htmlElement($html);\r\n    const template = await render(\"config\", {\r\n        masterInput: flagPath(\"config.master\"),\r\n        masters,\r\n        masterId: config?.master ?? \"\",\r\n        groups,\r\n    });\r\n\r\n    const btn = querySelector(html, \":scope > button[type='submit']\");\r\n    beforeHTMLFromString(btn, template);\r\n\r\n    return $html;\r\n}\r\n\r\nfunction weaponPrepareBaseData(this: WeaponPF2e) {\r\n    const actor = this.actor;\r\n    if (!actor?.isOfType(\"character\")) return;\r\n\r\n    const { config, master } = getMasterAndConfig(actor) ?? {};\r\n    if (!config?.weapon || !master) return;\r\n\r\n    const weapon = R.pipe(\r\n        master.itemTypes.weapon,\r\n        R.filter((item) => !!item.isInvested && !!item.system.runes.property),\r\n        R.sortBy(\r\n            [(item) => item.system.runes.property, \"desc\"],\r\n            [(item) => item.system.runes.striking, \"desc\"],\r\n            [(item) => item.system.runes.property.length, \"desc\"]\r\n        ),\r\n        R.first()\r\n    );\r\n\r\n    if (!weapon) return;\r\n\r\n    this.system.runes.potency = weapon.system.runes.potency;\r\n    this.system.runes.striking = weapon.system.runes.striking;\r\n    this.system.runes.property = weapon.system.runes.property.slice();\r\n}\r\n\r\nfunction effectRemainingDuration(this: EffectPF2e) {\r\n    const actor = this.actor;\r\n    const master = actor ? getMaster(actor) : undefined;\r\n\r\n    return calculateRemainingDuration(this, this.system.duration, master);\r\n}\r\n\r\nasync function combatResetActors(this: EncounterPF2e): Promise<void> {\r\n    const actors = R.pipe(\r\n        this.combatants.contents,\r\n        R.flatMap((combatant) => {\r\n            const actor = combatant.actor;\r\n\r\n            if (!actor) return [];\r\n            if (!actor.isOfType(\"character\")) return [actor];\r\n\r\n            const familiar = actor.familiar;\r\n            const slaves = getSlaves(actor, \"turn\");\r\n\r\n            return [actor, familiar, ...slaves];\r\n        }),\r\n        R.compact\r\n    );\r\n\r\n    resetActors(actors, { sheets: false, tokens: true });\r\n}\r\n\r\nasync function combatantStartTurn(\r\n    this: CombatantPF2e,\r\n    wrapped: libWrapper.RegisterCallback\r\n): Promise<void> {\r\n    await wrapped();\r\n\r\n    const { actor, encounter } = this;\r\n    if (!encounter || !actor?.isOfType(\"character\", \"npc\")) return;\r\n\r\n    const slaves = getSlaves(actor, \"turn\");\r\n\r\n    for (const slave of slaves) {\r\n        if (!slave || slave.combatant) return;\r\n\r\n        const eventType = \"turn-start\";\r\n        const slaveUpdates: Record<string, unknown> = {};\r\n\r\n        for (const rule of slave?.rules ?? []) {\r\n            await rule.onUpdateEncounter?.({ event: eventType, actorUpdates: slaveUpdates });\r\n        }\r\n\r\n        await slave?.update(slaveUpdates);\r\n\r\n        for (const effect of slave.itemTypes.effect) {\r\n            await effect.onEncounterEvent(eventType);\r\n        }\r\n\r\n        if (slave.isOfType(\"character\") && slave.familiar) {\r\n            for (const effect of slave.familiar.itemTypes.effect) {\r\n                await effect.onEncounterEvent(eventType);\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nasync function combatantEndTurn(\r\n    this: CombatantPF2e,\r\n    wrapped: libWrapper.RegisterCallback,\r\n    options: { round: number }\r\n): Promise<void> {\r\n    await wrapped(options);\r\n\r\n    const { actor, encounter } = this;\r\n    if (!encounter || !actor?.isOfType(\"character\", \"npc\")) return;\r\n\r\n    const slaves = getSlaves(actor, \"turn\");\r\n\r\n    for (const slave of slaves) {\r\n        if (!slave || slave.combatant) return;\r\n\r\n        const scene = game.scenes.get<ScenePF2e>(this.sceneId);\r\n        const token = slave.getDependentTokens({ linked: true, scenes: scene })[0];\r\n\r\n        const activeConditions = slave.conditions.active;\r\n        for (const condition of activeConditions) {\r\n            await condition.onEndTurn({ token });\r\n        }\r\n\r\n        const eventType = \"turn-end\";\r\n\r\n        for (const effect of slave.itemTypes.effect) {\r\n            await effect.onEncounterEvent(eventType);\r\n        }\r\n\r\n        if (slave.isOfType(\"character\") && slave.familiar) {\r\n            for (const effect of slave.familiar.itemTypes.effect) {\r\n                await effect.onEncounterEvent(eventType);\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nfunction onDeleteActor(actor: ActorPF2e) {\r\n    if (!actor.primaryUpdater || !actor.isOfType(\"character\", \"npc\")) return;\r\n\r\n    const master = getMaster(actor);\r\n    if (master) {\r\n        removeSlave(master, actor);\r\n    }\r\n\r\n    const slaves = getSlaves(actor);\r\n    for (const slave of slaves) {\r\n        unsetFlag(slave, \"config.master\");\r\n    }\r\n}\r\n\r\nfunction onUpdateActor(actor: ActorPF2e, changed: DeepPartial<ActorSourcePF2e>) {\r\n    const isCharacter = actor.isOfType(\"character\");\r\n    if (!actor.primaryUpdater || (!isCharacter && !actor.isOfType(\"npc\"))) return;\r\n\r\n    const masterUpdate = getFlagProperty<string>(changed, \"config.master\");\r\n    if (masterUpdate !== undefined) {\r\n        const master = getMaster(actor);\r\n\r\n        if (master) {\r\n            removeSlave(master, actor);\r\n        }\r\n    }\r\n\r\n    const data = getMasterAndConfig(actor);\r\n    if (!data) return;\r\n\r\n    const { master, config } = data;\r\n\r\n    if (config.health) {\r\n        const update = getProperty<CharacterHitPoints>(changed, \"system.attributes.hp\");\r\n        if (update) {\r\n            master.update({ \"system.attributes.hp\": deepClone(update) });\r\n        }\r\n    }\r\n\r\n    if (isCharacter && config.hero) {\r\n        const update = getProperty<ValueAndMax>(changed, \"system.resources.heroPoints\");\r\n        if (update) {\r\n            master.update({ \"system.resources.heroPoints\": deepClone(update) });\r\n        }\r\n    }\r\n}\r\n\r\nfunction actorPrepareBaseData(this: ActorPF2e, wrapped: libWrapper.RegisterCallback) {\r\n    wrapped();\r\n\r\n    if (!this.isOfType(\"character\", \"npc\")) return;\r\n\r\n    const master = getMaster(this);\r\n    if (!master) return;\r\n\r\n    const slaveUUID = this.uuid;\r\n    const slaveUUIDs = getInMemory<string[]>(master, \"slaves\");\r\n\r\n    if (!slaveUUIDs) {\r\n        setInMemory(master, \"slaves\", [slaveUUID]);\r\n    } else if (!slaveUUIDs.includes(slaveUUID)) {\r\n        slaveUUIDs.push(slaveUUID);\r\n    }\r\n}\r\n\r\nfunction removeSlave(master: CharacterPF2e, slave: ActorPF2e) {\r\n    const slaveUUIDs = getInMemory<string[]>(master, \"slaves\");\r\n    if (!slaveUUIDs) return;\r\n\r\n    const slaveUUID = slave.uuid;\r\n    const slaveIndex = slaveUUIDs.indexOf(slaveUUID);\r\n\r\n    if (slaveIndex !== -1) {\r\n        slaveUUIDs.splice(slaveIndex, 1);\r\n    }\r\n}\r\n\r\nfunction actorPrepareDerivedData(this: ActorPF2e, wrapped: libWrapper.RegisterCallback) {\r\n    if (!game.ready || !this.isOfType(\"character\", \"npc\")) return wrapped();\r\n\r\n    const { master, config } = getMasterAndConfig(this) ?? {};\r\n    if (!config?.armor || !master) return wrapped();\r\n\r\n    const armor = master.wornArmor;\r\n    const bracers = R.pipe(\r\n        master.itemTypes.equipment,\r\n        R.filter(\r\n            (item): item is EquipmentPF2e<CharacterPF2e> & { slug: BandsOfForceSlug } =>\r\n                BANDS_OF_FORCE_SLUGS.includes(item.slug as BandsOfForceSlug) && !!item.isInvested\r\n        ),\r\n        R.sortBy([(item) => item.slug, \"desc\"]),\r\n        R.first()\r\n    );\r\n\r\n    const bracerBonus = (bracers ? BANDS_OF_FORCE_SLUGS.indexOf(bracers.slug) : -1) + 1;\r\n\r\n    if (!armor?.isInvested && !bracerBonus) return wrapped();\r\n\r\n    const bonuses = [\"ac\", \"saving-throw\"] as const;\r\n\r\n    for (const selector of bonuses) {\r\n        const armorBonus = armor?.system.runes[selector === \"ac\" ? \"potency\" : \"resilient\"] || 0;\r\n        if (!armorBonus && !bracerBonus) continue;\r\n\r\n        const construct = (options: DeferredValueParams = {}): ModifierPF2e | null => {\r\n            const label = armorBonus > bracerBonus ? armor!.name : bracers!.name;\r\n            const slug = game.pf2e.system.sluggify(label);\r\n\r\n            const modifier = new game.pf2e.Modifier({\r\n                slug,\r\n                label,\r\n                modifier: Math.max(armorBonus, bracerBonus),\r\n                type: \"potency\",\r\n            });\r\n\r\n            if (options.test) modifier.test(options.test);\r\n\r\n            return modifier;\r\n        };\r\n\r\n        const modifiers = (this.synthetics.modifiers[selector] ??= []);\r\n        modifiers.push(construct);\r\n    }\r\n\r\n    wrapped();\r\n}\r\n\r\nfunction actorPrepareData(this: ActorPF2e, wrapped: libWrapper.RegisterCallback) {\r\n    wrapped();\r\n\r\n    const isCharacter = this.isOfType(\"character\");\r\n    if (!game.ready || (!isCharacter && !this.isOfType(\"npc\"))) return;\r\n\r\n    const slaves = getSlaves(this);\r\n    if (slaves.length) {\r\n        for (const slave of slaves) {\r\n            slave.reset();\r\n            slave.sheet.render();\r\n\r\n            for (const token of slave.getActiveTokens()) {\r\n                token.renderFlags.set({ refreshBars: true });\r\n            }\r\n        }\r\n\r\n        return;\r\n    }\r\n\r\n    const { master, config } = getMasterAndConfig(this) ?? {};\r\n    if (!config || !master) return;\r\n\r\n    if (config.health) {\r\n        const masterHp = master.system.attributes.hp;\r\n        this.system.attributes.hp = mergeObject(new game.pf2e.StatisticModifier(\"hp\"), masterHp);\r\n    }\r\n\r\n    if (isCharacter && config.hero) {\r\n        this.system.resources.heroPoints.max = master.system.resources.heroPoints.max;\r\n        this.system.resources.heroPoints.value = master.system.resources.heroPoints.value;\r\n    }\r\n\r\n    if (isCharacter && config.skills) {\r\n        const Statistic = getStatisticClass(this.skills.acrobatics);\r\n\r\n        for (const shortForm of SKILL_ABBREVIATIONS) {\r\n            const longForm = SKILL_DICTIONARY[shortForm];\r\n            const masterSkill = master.skills[longForm];\r\n            const currentRank = this.skills[longForm].rank ?? 0;\r\n            if (currentRank > masterSkill.rank) continue;\r\n\r\n            const attribute = SKILL_EXPANDED[longForm].attribute;\r\n            const statistic = new Statistic(this, {\r\n                slug: longForm,\r\n                label: CONFIG.PF2E.skills[shortForm] ?? longForm,\r\n                attribute,\r\n                domains: [longForm, `${attribute}-based`, \"skill-check\", \"all\"],\r\n                modifiers: [],\r\n                lore: false,\r\n                rank: masterSkill.rank,\r\n                check: { type: \"skill-check\" },\r\n            });\r\n\r\n            // @ts-ignore\r\n            this.skills[longForm] = statistic;\r\n            // @ts-ignore\r\n            this.system.skills[shortForm] = mergeObject(statistic.getTraceData(), {\r\n                attribute,\r\n                rank: masterSkill.rank,\r\n            });\r\n        }\r\n    }\r\n}\r\n\r\nfunction getMaster(actor: ActorPF2e) {\r\n    const result = getMasterAndConfig(actor);\r\n    return result?.master;\r\n}\r\n\r\nfunction getMasterAndConfig(actor: ActorPF2e) {\r\n    const config = getFlag<ConfigFlags>(actor, \"config\");\r\n    if (!config?.master) return;\r\n\r\n    const master = game.actors.get<ActorPF2e>(config.master);\r\n    return isValidMaster(master) ? { master, config } : undefined;\r\n}\r\n\r\nfunction getSlaves(actor: ActorPF2e, withConfig?: ConfigOption) {\r\n    return R.pipe(\r\n        getInMemory<string[]>(actor, \"slaves\") ?? [],\r\n        R.map((slaveUUID) => fromUuidSync<CompendiumCollectionIndex | FoundryDocument>(slaveUUID)),\r\n        R.compact,\r\n        R.filter(\r\n            (slave): slave is ShareActor =>\r\n                isValidSlave(slave) && (!withConfig || !!getFlag(slave, \"config\", withConfig))\r\n        )\r\n    );\r\n}\r\n\r\nfunction isValidSlave(actor: FoundryDocument | CompendiumCollectionIndex): actor is ShareActor {\r\n    return (\r\n        isInstanceOf<ActorPF2e>(actor, \"ActorPF2e\") &&\r\n        isPlayedActor(actor) &&\r\n        actor.isOfType(\"character\", \"npc\")\r\n    );\r\n}\r\n\r\nfunction isValidMaster(actor: ActorPF2e | null | undefined, id?: string): actor is CharacterPF2e {\r\n    return (\r\n        isPlayedActor(actor) &&\r\n        !!actor.prototypeToken.actorLink &&\r\n        (!id || actor.id !== id) &&\r\n        actor.isOfType(\"character\") &&\r\n        !actor.traits.has(\"eidolon\") &&\r\n        !actor.traits.has(\"minion\") &&\r\n        !getFlag(actor, \"config.master\")\r\n    );\r\n}\r\n\r\ntype ConfigOption = (typeof characterShareOptions)[number];\r\n\r\ntype ConfigFlags = { [k in ConfigOption]: boolean } & {\r\n    master: string;\r\n};\r\n\r\ntype ShareActor = CharacterPF2e | NPCPF2e;\r\n\r\nexport { config as ShareTool };\r\n", "const DEGREE_OF_SUCCESS_STRINGS = [\r\n    \"criticalFailure\",\r\n    \"failure\",\r\n    \"success\",\r\n    \"criticalSuccess\",\r\n] as const;\r\n\r\ntype RollBrief = { dieValue: number; modifier: number };\r\n\r\nconst DEGREE_ADJUSTMENT_AMOUNTS = {\r\n    LOWER_BY_TWO: -2,\r\n    LOWER: -1,\r\n    INCREASE: 1,\r\n    INCREASE_BY_TWO: 2,\r\n    TO_CRITICAL_FAILURE: \"criticalFailure\",\r\n    TO_FAILURE: \"failure\",\r\n    TO_SUCCESS: \"success\",\r\n    TO_CRITICAL_SUCCESS: \"criticalSuccess\",\r\n} as const;\r\n\r\nclass DegreeOfSuccess {\r\n    readonly value: DegreeOfSuccessIndex;\r\n    readonly unadjusted: DegreeOfSuccessIndex;\r\n    readonly adjustment: { label: string; amount: DegreeAdjustmentAmount } | null;\r\n    readonly dieResult: number;\r\n    readonly rollTotal: number;\r\n    readonly dc: CheckDC;\r\n\r\n    constructor(\r\n        roll: Rolled<CheckRoll> | RollBrief,\r\n        dc: CheckDC | number,\r\n        dosAdjustments: DegreeAdjustmentsRecord | null = null\r\n    ) {\r\n        if (roll instanceof Roll) {\r\n            this.dieResult =\r\n                (roll.isDeterministic\r\n                    ? roll.terms.find((t): t is NumericTerm => t instanceof NumericTerm)\r\n                    : roll.dice.find((d): d is Die => d instanceof Die && d.faces === 20)\r\n                )?.total ?? 1;\r\n            this.rollTotal = roll.total;\r\n        } else {\r\n            this.dieResult = roll.dieValue;\r\n            this.rollTotal = roll.dieValue + roll.modifier;\r\n        }\r\n\r\n        this.dc = typeof dc === \"number\" ? { value: dc } : dc;\r\n\r\n        this.unadjusted = this.#calculateDegreeOfSuccess();\r\n        this.adjustment = this.#getDegreeAdjustment(this.unadjusted, dosAdjustments);\r\n        this.value = this.adjustment\r\n            ? this.#adjustDegreeOfSuccess(this.adjustment.amount, this.unadjusted)\r\n            : this.unadjusted;\r\n    }\r\n\r\n    static readonly CRITICAL_FAILURE = 0;\r\n    static readonly FAILURE = 1;\r\n    static readonly SUCCESS = 2;\r\n    static readonly CRITICAL_SUCCESS = 3;\r\n\r\n    #getDegreeAdjustment(\r\n        degree: DegreeOfSuccessIndex,\r\n        adjustments: DegreeAdjustmentsRecord | null\r\n    ): { label: string; amount: DegreeAdjustmentAmount } | null {\r\n        if (!adjustments) return null;\r\n\r\n        for (const outcome of [\"all\", ...DEGREE_OF_SUCCESS_STRINGS] as const) {\r\n            const { label, amount } = adjustments[outcome] ?? {};\r\n            if (\r\n                amount &&\r\n                label &&\r\n                !(\r\n                    degree === DegreeOfSuccess.CRITICAL_SUCCESS &&\r\n                    amount === DEGREE_ADJUSTMENT_AMOUNTS.INCREASE\r\n                ) &&\r\n                !(\r\n                    degree === DegreeOfSuccess.CRITICAL_FAILURE &&\r\n                    amount === DEGREE_ADJUSTMENT_AMOUNTS.LOWER\r\n                ) &&\r\n                (outcome === \"all\" || DEGREE_OF_SUCCESS_STRINGS.indexOf(outcome) === degree)\r\n            ) {\r\n                return { label, amount };\r\n            }\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    #adjustDegreeOfSuccess(\r\n        amount: DegreeAdjustmentAmount,\r\n        degreeOfSuccess: DegreeOfSuccessIndex\r\n    ): DegreeOfSuccessIndex {\r\n        switch (amount) {\r\n            case \"criticalFailure\":\r\n                return 0;\r\n            case \"failure\":\r\n                return 1;\r\n            case \"success\":\r\n                return 2;\r\n            case \"criticalSuccess\":\r\n                return 3;\r\n            default:\r\n                return Math.clamped(degreeOfSuccess + amount, 0, 3) as DegreeOfSuccessIndex;\r\n        }\r\n    }\r\n\r\n    #adjustDegreeByDieValue(degree: DegreeOfSuccessIndex): DegreeOfSuccessIndex {\r\n        if (this.dieResult === 20) {\r\n            return this.#adjustDegreeOfSuccess(DEGREE_ADJUSTMENT_AMOUNTS.INCREASE, degree);\r\n        } else if (this.dieResult === 1) {\r\n            return this.#adjustDegreeOfSuccess(DEGREE_ADJUSTMENT_AMOUNTS.LOWER, degree);\r\n        }\r\n\r\n        return degree;\r\n    }\r\n\r\n    #calculateDegreeOfSuccess(): DegreeOfSuccessIndex {\r\n        const dc = this.dc.value;\r\n\r\n        if (this.rollTotal - dc >= 10) {\r\n            return this.#adjustDegreeByDieValue(DegreeOfSuccess.CRITICAL_SUCCESS);\r\n        } else if (dc - this.rollTotal >= 10) {\r\n            return this.#adjustDegreeByDieValue(DegreeOfSuccess.CRITICAL_FAILURE);\r\n        } else if (this.rollTotal >= dc) {\r\n            return this.#adjustDegreeByDieValue(DegreeOfSuccess.SUCCESS);\r\n        }\r\n\r\n        return this.#adjustDegreeByDieValue(DegreeOfSuccess.FAILURE);\r\n    }\r\n}\r\n\r\nexport { DEGREE_OF_SUCCESS_STRINGS, DegreeOfSuccess };\r\n", "import {\r\n    MODULE,\r\n    R,\r\n    RollNotePF2e,\r\n    addListener,\r\n    addListenerAll,\r\n    applyDamageFromMessage,\r\n    closest,\r\n    createHTMLFromString,\r\n    elementData,\r\n    extractNotes,\r\n    getActiveModule,\r\n    isActiveGM,\r\n    onClickShieldBlock,\r\n    querySelector,\r\n    querySelectorArray,\r\n    refreshLatestMessages,\r\n    saveTypes,\r\n    toggleOffShieldBlock,\r\n} from \"pf2e-api\";\r\nimport { DEGREE_OF_SUCCESS_STRINGS, DegreeOfSuccess } from \"pf2e-api/src/success\";\r\nimport { createTool } from \"../tool\";\r\nimport { CHATMESSAGE_GET_HTML } from \"./shared/chatMessage\";\r\nimport { TEXTEDITOR_ENRICH_HTML } from \"./shared/textEditor\";\r\n\r\nconst DAMAGE_MULTIPLIER = {\r\n    \"target-apply-healing\": -1,\r\n    \"target-half-damage\": 0.5,\r\n    \"target-apply-damage\": 1,\r\n    \"target-double-damage\": 2,\r\n    \"target-triple-damage\": 3,\r\n} as const;\r\n\r\nconst SAVES = {\r\n    fortitude: { icon: \"fa-solid fa-chess-rook\", label: \"PF2E.SavesFortitude\" },\r\n    reflex: { icon: \"fa-solid fa-person-running\", label: \"PF2E.SavesReflex\" },\r\n    will: { icon: \"fa-solid fa-brain\", label: \"PF2E.SavesWill\" },\r\n} as const;\r\n\r\nconst REROLL = {\r\n    hero: {\r\n        icon: \"fa-solid fa-hospital-symbol\",\r\n        reroll: \"PF2E.RerollMenu.HeroPoint\",\r\n        rerolled: \"PF2E.RerollMenu.MessageHeroPoint\",\r\n    },\r\n    new: {\r\n        icon: \"fa-solid fa-dice\",\r\n        reroll: \"PF2E.RerollMenu.KeepNew\",\r\n        rerolled: \"PF2E.RerollMenu.MessageKeep.new\",\r\n    },\r\n    lower: {\r\n        icon: \"fa-solid fa-dice-one\",\r\n        reroll: \"PF2E.RerollMenu.KeepLower\",\r\n        rerolled: \"PF2E.RerollMenu.MessageKeep.lower\",\r\n    },\r\n    higher: {\r\n        icon: \"fa-solid fa-dice-six\",\r\n        reroll: \"PF2E.RerollMenu.KeepHigher\",\r\n        rerolled: \"PF2E.RerollMenu.MessageKeep.higher\",\r\n    },\r\n} as const;\r\n\r\nconst debouncedRefreshMessages = debounce(() => refreshLatestMessages(20), 1);\r\n\r\nconst {\r\n    config,\r\n    settings,\r\n    hooks,\r\n    wrappers,\r\n    localize,\r\n    socket,\r\n    render,\r\n    getFlag,\r\n    setFlag,\r\n    updateSourceFlag,\r\n    setFlagProperty,\r\n    deleteInMemory,\r\n    getInMemory,\r\n    setInMemory,\r\n    waitDialog,\r\n} = createTool({\r\n    name: \"targetHelper\",\r\n    settings: [\r\n        {\r\n            key: \"enabled\",\r\n            type: Boolean,\r\n            default: false,\r\n            requiresReload: true,\r\n        },\r\n        {\r\n            key: \"addTargets\",\r\n            type: Boolean,\r\n            default: true,\r\n            scope: \"client\",\r\n            onChange: (value) => {\r\n                const addTargets = settings.enabled && value;\r\n\r\n                if (addTargets) {\r\n                    wrappers.enrichHTML.activate();\r\n                    wrappers.messageGetHTML.activate();\r\n                    document.body.addEventListener(\"dragstart\", onDragStart, true);\r\n                } else {\r\n                    wrappers.enrichHTML.disable();\r\n                    wrappers.messageGetHTML.disable();\r\n                    document.body.removeEventListener(\"dragstart\", onDragStart, true);\r\n                }\r\n\r\n                debouncedRefreshMessages();\r\n            },\r\n        },\r\n        {\r\n            key: \"smallButtons\",\r\n            type: Boolean,\r\n            default: true,\r\n            scope: \"client\",\r\n            onChange: () => {\r\n                debouncedRefreshMessages();\r\n            },\r\n        },\r\n    ],\r\n    hooks: [\r\n        {\r\n            event: \"preCreateChatMessage\",\r\n            listener: onPreCreateChatMessage,\r\n        },\r\n        {\r\n            event: \"getChatLogEntryContext\",\r\n            listener: onGetChatLogEntryContext,\r\n        },\r\n    ],\r\n    wrappers: [\r\n        {\r\n            key: \"messageGetHTML\",\r\n            path: CHATMESSAGE_GET_HTML,\r\n            callback: chatMessageGetHTML,\r\n        },\r\n        {\r\n            key: \"enrichHTML\",\r\n            path: TEXTEDITOR_ENRICH_HTML,\r\n            callback: textEditorEnrichHTML,\r\n        },\r\n    ],\r\n    onSocket,\r\n    init: (isGM) => {\r\n        const enabled = settings.enabled;\r\n        if (!enabled) return;\r\n\r\n        socket.toggle(isGM);\r\n\r\n        hooks.getChatLogEntryContext.activate();\r\n        hooks.preCreateChatMessage.activate();\r\n\r\n        if (settings.addTargets) {\r\n            wrappers.enrichHTML.activate();\r\n            wrappers.messageGetHTML.activate();\r\n            document.body.addEventListener(\"dragstart\", onDragStart, true);\r\n        }\r\n    },\r\n} as const);\r\n\r\nfunction onSocket(packet: SocketPacket, senderId: string) {\r\n    if (!isActiveGM()) return;\r\n\r\n    switch (packet.type) {\r\n        case \"update-applied\": {\r\n            const message = game.messages.get(packet.message);\r\n            message?.update(packet.updates);\r\n            break;\r\n        }\r\n        case \"dice-so-nice\": {\r\n            roll3dDice(packet.roll, packet.target, true);\r\n            break;\r\n        }\r\n        case \"update-save\": {\r\n            const message = game.messages.get(packet.message);\r\n            if (message) {\r\n                setFlag(message, \"saves\", packet.updates);\r\n            }\r\n            break;\r\n        }\r\n    }\r\n}\r\n\r\nconst INLINE_CHECK_REGEX = /(class=\"inline-check[\\w0-9 -]*\")/g;\r\nfunction textEditorEnrichHTML(this: TextEditor, enriched: string) {\r\n    return enriched.replace(INLINE_CHECK_REGEX, \"$1 draggable='true'\");\r\n}\r\n\r\nfunction isPersistentDamageMessage(message: ChatMessagePF2e) {\r\n    return message.rolls[0].options.evaluatePersistent;\r\n}\r\n\r\nlet HEALINGS_REGEX;\r\nfunction isRegenMessage(message: ChatMessagePF2e) {\r\n    HEALINGS_REGEX ??= (() => {\r\n        const healings = [\r\n            game.i18n.localize(\"PF2E.Encounter.Broadcast.FastHealing.fast-healing.ReceivedMessage\"),\r\n            game.i18n.localize(\"PF2E.Encounter.Broadcast.FastHealing.regeneration.ReceivedMessage\"),\r\n        ];\r\n        return new RegExp(`^<div>(${healings.join(\"|\")})</div>`);\r\n    })();\r\n    return HEALINGS_REGEX.test(message.flavor);\r\n}\r\n\r\nfunction isDamageMessage(\r\n    message: ChatMessagePF2e\r\n): message is Omit<ChatMessagePF2e, \"rolls\"> & { rolls: Rolled<DamageRoll>[] } {\r\n    return message.isDamageRoll;\r\n}\r\n\r\nfunction isDamageSpell(spell: SpellPF2e | undefined) {\r\n    return !!spell && spell.damageKinds.size > 0;\r\n}\r\n\r\nfunction getMessageTargets(message: ChatMessagePF2e) {\r\n    return getFlag<string[]>(message, \"targets\") ?? [];\r\n}\r\n\r\nfunction getCurrentTargets(): string[] {\r\n    return R.pipe(\r\n        Array.from(game.user.targets as Set<TokenPF2e>),\r\n        R.filter((target) => !!target.actor?.isOfType(\"creature\", \"hazard\", \"vehicle\")),\r\n        R.map((target) => target.document.uuid)\r\n    );\r\n}\r\n\r\nfunction onGetChatLogEntryContext($html: JQuery, data: EntryContextOption[]) {\r\n    const getMessageData = (html: JQuery) => {\r\n        const messageId = html.data(\"messageId\");\r\n        const message = game.messages.get<ChatMessagePF2e>(messageId);\r\n        if (!message) return;\r\n\r\n        return {\r\n            message,\r\n            canRollSave: getInMemory<string[]>(message, \"canRollSave\"),\r\n        };\r\n    };\r\n\r\n    data.unshift({\r\n        icon: '<i class=\"fa-solid fa-dice-d20\"></i>',\r\n        name: localize.path(\"context.rollAll\"),\r\n        condition: (html) => {\r\n            const data = getMessageData(html);\r\n            return !!data?.canRollSave?.length;\r\n        },\r\n        callback: async (html) => {\r\n            const { canRollSave, message } = getMessageData(html) ?? {};\r\n            if (!message || !canRollSave?.length) return;\r\n\r\n            const save = getSaveFlag(message);\r\n            if (!save) return;\r\n\r\n            const promisedTargets = await Promise.all(\r\n                canRollSave.map((uuid) => fromUuid<CreatureTokenDocument>(uuid))\r\n            );\r\n\r\n            const targets = R.compact(promisedTargets);\r\n            if (!targets.length) return;\r\n\r\n            rollSaves(new MouseEvent(\"click\"), message, save, targets);\r\n        },\r\n    });\r\n}\r\n\r\nfunction onPreCreateChatMessage(message: ChatMessagePF2e) {\r\n    const isDamage = isDamageMessage(message) && !isPersistentDamageMessage(message);\r\n    const item = message.item;\r\n    const isSpell = item?.isOfType(\"spell\");\r\n    if (!isDamage && !isSpell) return;\r\n\r\n    const token = message.token;\r\n    const actor = token?.actor;\r\n    const updates: Pairs<MessageFlag> = [];\r\n    const save = isSpell ? item.system.defense?.save : undefined;\r\n\r\n    if (!isDamage && isSpell && !save) return;\r\n\r\n    if (!getMessageTargets(message).length) {\r\n        if (isDamage && isRegenMessage(message)) {\r\n            updates.push([\"isRegen\", true]);\r\n\r\n            if (actor) {\r\n                updates.push([\"targets\", [token.uuid]]);\r\n            }\r\n        } else {\r\n            const targets = getCurrentTargets();\r\n            if (targets.length) {\r\n                updates.push([\"targets\", targets]);\r\n            }\r\n        }\r\n    }\r\n\r\n    if (isDamage && message.rolls.length === 2) {\r\n        const splashRollIndex = message.rolls.findIndex((roll) => roll.options.splashOnly);\r\n        const regularRollIndex = message.rolls.findIndex(\r\n            (roll) =>\r\n                !roll.options.splashOnly &&\r\n                roll.options.damage?.modifiers?.some(\r\n                    (modifier) =>\r\n                        \"damageCategory\" in modifier && modifier.damageCategory === \"splash\"\r\n                )\r\n        );\r\n\r\n        if (splashRollIndex !== -1 && regularRollIndex !== -1) {\r\n            updates.push([\"splashIndex\", splashRollIndex]);\r\n        }\r\n    }\r\n\r\n    if (isSpell && save) {\r\n        const dc = item.spellcasting?.statistic?.dc.value;\r\n\r\n        if (typeof dc === \"number\") {\r\n            updates.push([\"save\", { ...save, dc, author: actor?.uuid }]);\r\n        }\r\n    }\r\n\r\n    if (!updates.length) return;\r\n\r\n    updateSourceFlag(message, Object.fromEntries(updates));\r\n}\r\n\r\nasync function chatMessageGetHTML(this: ChatMessagePF2e, html: HTMLElement) {\r\n    if (!this.isContentVisible) return;\r\n\r\n    deleteInMemory(this, \"canRollSave\");\r\n    deleteInMemory(this, \"canApplyDamage\");\r\n\r\n    if (isDamageMessage(this)) {\r\n        if (isPersistentDamageMessage(this)) return;\r\n        await damageChatMessageGetHTML(this, html);\r\n        return;\r\n    }\r\n\r\n    const item = this.item;\r\n    if (!item || !item.isOfType(\"spell\")) return;\r\n\r\n    if (!isDamageSpell(item)) {\r\n        await spellChatMessageGetHTML(this, html);\r\n    } else {\r\n        addListener(html, \"[data-action='spell-damage']\", () => {\r\n            const messageId = this.id;\r\n            const save = getFlag<MessageSaveFlag>(this, \"save\");\r\n            if (!save) return;\r\n\r\n            Hooks.once(\"preCreateChatMessage\", (message) => {\r\n                updateSourceFlag(message, \"messageId\", messageId);\r\n                updateSourceFlag(message, \"save\", save);\r\n            });\r\n        });\r\n    }\r\n}\r\n\r\nasync function damageChatMessageGetHTML(message: ChatMessagePF2e, html: HTMLElement) {\r\n    const msgContent = querySelector(html, \".message-content\");\r\n    if (!msgContent) return;\r\n\r\n    const damageRows = querySelectorArray(msgContent, \".damage-application\");\r\n    const diceTotalElement = querySelector(msgContent, \".dice-result .dice-total\");\r\n    if (!damageRows.length || !diceTotalElement) return;\r\n\r\n    const data = await getMessageData(message);\r\n\r\n    html.addEventListener(\"drop\", onChatMessageDrop);\r\n\r\n    const wrapper = createHTMLFromString(\"<div class='pf2e-toolbelt-target-buttons'></div>\");\r\n\r\n    diceTotalElement.append(wrapper);\r\n\r\n    if (game.user.isGM || message.isAuthor) {\r\n        const setTargetsBtn = createSetTargetsBtn(message);\r\n        wrapper.append(setTargetsBtn);\r\n    }\r\n\r\n    if (data?.targets.length) {\r\n        const toggleTooltip = localize(\"toggleDamageRows\");\r\n        const toggleTemplate = `<button class=\"pf2e-toolbelt-target-toggleDamageRows\" \r\n            title=\"${toggleTooltip}\">\r\n                <i class=\"fa-solid fa-plus expand\"></i>\r\n                <i class=\"fa-solid fa-minus collapse\"></i>\r\n            </button>`;\r\n        const toggleBtn = createHTMLFromString(toggleTemplate);\r\n\r\n        toggleBtn.addEventListener(\"click\", (event) => {\r\n            event.stopPropagation();\r\n\r\n            toggleBtn.classList.toggle(\"expanded\");\r\n\r\n            for (const damageRow of damageRows) {\r\n                damageRow.classList.toggle(\"hidden\");\r\n            }\r\n        });\r\n\r\n        for (const damageRow of damageRows) {\r\n            damageRow.classList.add(\"hidden\");\r\n        }\r\n\r\n        wrapper.append(toggleBtn);\r\n    } else {\r\n        return;\r\n    }\r\n\r\n    const smallButtons = settings.smallButtons;\r\n    const clonedDamageRows = damageRows.map((el) => {\r\n        const clone = el.cloneNode(true) as HTMLElement;\r\n\r\n        clone.classList.remove(\"damage-application\");\r\n        clone.classList.add(\"target-damage-application\");\r\n\r\n        if (smallButtons) {\r\n            clone.classList.add(\"small\");\r\n        }\r\n\r\n        const actionElements = clone.querySelectorAll<HTMLElement>(\"[data-action]\");\r\n\r\n        for (const actionElement of actionElements) {\r\n            const action = actionElement.dataset.action;\r\n            actionElement.dataset.action = `target-${action}`;\r\n        }\r\n\r\n        return clone;\r\n    });\r\n\r\n    const rowsWrapper = createHTMLFromString(\"<div class='pf2e-toolbelt-target-targetRows'></div>\");\r\n\r\n    for (const { template, isOwner, save, uuid, applied } of data.targets) {\r\n        const hr = document.createElement(\"hr\");\r\n        const row = createHTMLFromString(template);\r\n\r\n        rowsWrapper.append(hr);\r\n        rowsWrapper.append(row);\r\n\r\n        if (!isOwner) continue;\r\n\r\n        const isBasic = isBasicSave(save);\r\n\r\n        for (let i = 0; i < clonedDamageRows.length; i++) {\r\n            const clonedDamageRow = clonedDamageRows[i];\r\n            const clone = clonedDamageRow.cloneNode(true) as HTMLElement;\r\n\r\n            clone.dataset.rollIndex = String(i);\r\n            clone.dataset.targetUuid = uuid;\r\n\r\n            clone.classList.toggle(\r\n                \"applied\",\r\n                !!applied[i] || (isBasic && save.result.success === \"criticalSuccess\")\r\n            );\r\n\r\n            if (isBasic) {\r\n                clone.classList.add(save.result.success);\r\n            }\r\n\r\n            rowsWrapper.append(clone);\r\n        }\r\n    }\r\n\r\n    msgContent.after(rowsWrapper);\r\n\r\n    addHeaderListeners(message, rowsWrapper, data.save);\r\n\r\n    addListenerAll(rowsWrapper, \"[data-action^='target-']\", (event, btn: HTMLButtonElement) =>\r\n        onTargetButton(event, btn, message)\r\n    );\r\n}\r\n\r\nlet BASIC_SAVE_REGEX: RegExp;\r\nfunction onDragStart(event: DragEvent) {\r\n    const target = event.target;\r\n    const dataTransfer = event.dataTransfer;\r\n\r\n    if (\r\n        !dataTransfer ||\r\n        !(target instanceof HTMLAnchorElement) ||\r\n        !target.classList.contains(\"inline-check\")\r\n    )\r\n        return;\r\n\r\n    const dataset = elementData(target);\r\n\r\n    if (\r\n        !dataset.pf2Dc ||\r\n        !saveTypes.includes(dataset.pf2Check as SaveType) ||\r\n        ![\"reflex\", \"will\", \"fortitude\"].includes(dataset.pf2Check)\r\n    ) {\r\n        event.preventDefault();\r\n        return;\r\n    }\r\n\r\n    event.stopPropagation();\r\n\r\n    const data: SaveDragData = {\r\n        dc: Number(dataset.pf2Dc),\r\n        basic: false,\r\n        statistic: dataset.pf2Check as SaveType,\r\n        options: dataset.pf2RollOptions?.split(\",\").map((o) => o.trim()) ?? [],\r\n        traits: dataset.pf2Traits?.split(\",\").map((o) => o.trim()) ?? [],\r\n        type: `${MODULE.id}-check-roll`,\r\n    };\r\n\r\n    if (dataset.isBasic == null) {\r\n        const label = target.querySelector(\"span.label\")?.lastChild?.textContent?.trim();\r\n\r\n        if (label) {\r\n            if (!BASIC_SAVE_REGEX) {\r\n                const saves = Object.values(CONFIG.PF2E.saves).map((x) => game.i18n.localize(x));\r\n                const joined = game.i18n.format(\"PF2E.InlineCheck.BasicWithSave\", {\r\n                    save: `(${saves.join(\"|\")})`,\r\n                });\r\n                BASIC_SAVE_REGEX = new RegExp(joined);\r\n            }\r\n            data.basic = BASIC_SAVE_REGEX.test(label);\r\n        }\r\n    }\r\n\r\n    dataTransfer.setData(\"text/plain\", JSON.stringify(data));\r\n}\r\n\r\nfunction onChatMessageDrop(event: DragEvent) {\r\n    const target = (event.target as HTMLElement)?.closest<HTMLLIElement>(\"li.chat-message\");\r\n    if (!target) return;\r\n\r\n    const data = TextEditor.getDragEventData<SaveDragData>(event);\r\n    if (!data) return;\r\n\r\n    const { type, dc, basic, options, statistic, traits } = data;\r\n    if (type !== `${MODULE.id}-check-roll`) return;\r\n\r\n    const messageId = target.dataset.messageId;\r\n    const message = game.messages.get<ChatMessagePF2e>(messageId);\r\n    if (!message || !message.isDamageRoll) return;\r\n\r\n    if (!game.user.isGM && !message.isAuthor) {\r\n        localize.warn(\"drop.unauth\");\r\n        return;\r\n    }\r\n\r\n    if (getFlag(message, \"save\")) {\r\n        localize.warn(\"drop.already\");\r\n        return;\r\n    }\r\n\r\n    const updates = {};\r\n\r\n    setFlagProperty(updates, \"save\", {\r\n        basic,\r\n        dc,\r\n        statistic,\r\n    });\r\n\r\n    setFlagProperty(updates, \"rollOptions\", [...options, ...traits]);\r\n\r\n    message.update(updates);\r\n\r\n    localize.info(\"drop.added\");\r\n}\r\n\r\nasync function onTargetButton(event: MouseEvent, btn: HTMLButtonElement, message: ChatMessagePF2e) {\r\n    const { rollIndex, targetUuid } = elementData(closest(btn, \"[data-target-uuid]\")!);\r\n    const target = await fromUuid<CreatureTokenDocument>(targetUuid);\r\n    if (!target) return;\r\n\r\n    const { action } = elementData<{ action: TargetButtonAction }>(btn);\r\n\r\n    if (action === \"target-shield-block\") {\r\n        const messageId = message.id;\r\n\r\n        if (!btn.classList.contains(\"shield-activated\")) {\r\n            toggleOffShieldBlock(messageId);\r\n        }\r\n\r\n        requestAnimationFrame(() => {\r\n            onClickShieldBlock(btn, closest(btn, \".chat-message\")!, target);\r\n        });\r\n\r\n        return;\r\n    }\r\n\r\n    applyDamageFromMessage({\r\n        message,\r\n        multiplier: DAMAGE_MULTIPLIER[action],\r\n        addend: 0,\r\n        promptModifier: event.shiftKey,\r\n        rollIndex: Number(rollIndex),\r\n        tokens: [target],\r\n        onDamageApplied,\r\n    });\r\n}\r\n\r\nexport function onDamageApplied(\r\n    message: ChatMessagePF2e,\r\n    tokens: TokenDocumentPF2e[],\r\n    rollIndex: number\r\n) {\r\n    const updates = {};\r\n    const [token] = tokens;\r\n    const tokenId = token.id;\r\n    const splashIndex = getFlag<number>(message, \"splashIndex\");\r\n\r\n    setFlagProperty(updates, \"applied\", tokenId, String(rollIndex), true);\r\n\r\n    if (splashIndex !== undefined) {\r\n        const regularIndex = splashIndex === 0 ? 1 : 0;\r\n\r\n        if (rollIndex === splashIndex) {\r\n            setFlagProperty(updates, \"applied\", tokenId, String(regularIndex), true);\r\n        } else {\r\n            setFlagProperty(updates, \"applied\", tokenId, String(splashIndex), true);\r\n\r\n            const targetsFlag = getMessageTargets(message);\r\n            for (const target of targetsFlag) {\r\n                const targetId = target.split(\".\").at(-1) as string;\r\n                if (targetId === tokenId) continue;\r\n\r\n                setFlagProperty(updates, \"applied\", targetId, String(regularIndex), true);\r\n            }\r\n        }\r\n    }\r\n\r\n    if (game.user.isGM || message.isAuthor) {\r\n        message.update(updates);\r\n    } else {\r\n        socket.emit({\r\n            type: \"update-applied\",\r\n            message: message.id,\r\n            updates,\r\n        });\r\n    }\r\n}\r\n\r\nfunction isBasicSave(\r\n    save: TargetSave | undefined\r\n): save is Omit<TargetSave, \"result\"> & { result: TargetSaveResult } {\r\n    return !!(save?.result && save.basic);\r\n}\r\n\r\nasync function spellChatMessageGetHTML(message: ChatMessagePF2e, html: HTMLElement) {\r\n    const data = await getMessageData(message);\r\n    if (!data?.save) return;\r\n\r\n    const msgContent = querySelector(html, \".message-content\");\r\n    if (!msgContent) return;\r\n\r\n    const cardBtns = msgContent?.querySelector<HTMLElement>(\".card-buttons\");\r\n    const saveBtn = cardBtns?.querySelector<HTMLButtonElement>(\"[data-action='spell-save']\");\r\n\r\n    if (saveBtn && (game.user.isGM || message.isAuthor)) {\r\n        const wrapper = createHTMLFromString(\"<div class='pf2e-toolbelt-target-wrapper'></div>\");\r\n        const setTargetsBtn = createSetTargetsBtn(message);\r\n\r\n        wrapper.append(setTargetsBtn, saveBtn);\r\n        cardBtns!.prepend(wrapper);\r\n    }\r\n\r\n    const { targets, save } = data;\r\n    if (!targets.length) return;\r\n\r\n    const rowsWrapper = createHTMLFromString(\"<div class='pf2e-toolbelt-target-targetRows'></div>\");\r\n\r\n    for (const { template } of targets) {\r\n        const hr = document.createElement(\"hr\");\r\n        const row = createHTMLFromString(template);\r\n\r\n        rowsWrapper.append(hr);\r\n        rowsWrapper.append(row);\r\n    }\r\n\r\n    msgContent.after(rowsWrapper);\r\n\r\n    addHeaderListeners(message, rowsWrapper, save);\r\n}\r\n\r\nfunction createSetTargetsBtn(message: ChatMessagePF2e) {\r\n    const tooltip = localize(\"setTargets\");\r\n    const template = `<button class=\"pf2e-toolbelt-target-setTargets\" data-action=\"set-targets\"\r\n        title=\"${tooltip}\">\r\n        <i class=\"fa-solid fa-bullseye-arrow\"></i>\r\n    </button>`;\r\n    const btn = createHTMLFromString(template);\r\n\r\n    btn.addEventListener(\"click\", (event) => onSetTargets(event, message));\r\n    return btn;\r\n}\r\n\r\nasync function addHeaderListeners(\r\n    message: ChatMessagePF2e,\r\n    html: HTMLElement,\r\n    save?: MessageSaveDataWithTooltip\r\n) {\r\n    const targetElements = html.querySelectorAll(\"[data-target-uuid]\");\r\n\r\n    for (const targetElement of targetElements) {\r\n        const { targetUuid } = elementData(targetElement);\r\n        const target = await fromUuid<CreatureTokenDocument>(targetUuid);\r\n        if (!target) continue;\r\n\r\n        addListener(targetElement, \"[data-action='ping-target']\", () => {\r\n            canvas.ping(target.center);\r\n        });\r\n\r\n        addListener(targetElement, \"[data-action='open-target-sheet']\", () => {\r\n            target.actor?.sheet.render(true);\r\n        });\r\n\r\n        if (save) {\r\n            addListener(targetElement, \"[data-action='roll-save']\", (event) => {\r\n                rollSaves(event, message, save, [target]);\r\n            });\r\n\r\n            addListener(targetElement, \"[data-action='reroll-save']\", (event) => {\r\n                rerollSave(event, message, save, target);\r\n            });\r\n        }\r\n    }\r\n}\r\n\r\nasync function rollSaves(\r\n    event: MouseEvent,\r\n    message: ChatMessagePF2e,\r\n    { dc, statistic }: MessageSaveData,\r\n    targets: CreatureTokenDocument[]\r\n) {\r\n    const user = game.user as UserPF2e;\r\n    const updates: Record<string, MessageTargetSave> = {};\r\n\r\n    await Promise.all(\r\n        targets.map((target) => {\r\n            const actor = target.actor;\r\n            if (!actor) return;\r\n\r\n            const save = actor.saves[statistic];\r\n            if (!save) return;\r\n\r\n            const item = message.item;\r\n            const rollOptions = getFlag<string[]>(message, \"rollOptions\");\r\n            const skipDefault = !user.settings.showCheckDialogs;\r\n            const skipDialog = targets.length > 1 || (event.shiftKey ? !skipDefault : skipDefault);\r\n\r\n            return new Promise<void>((resolve) => {\r\n                save.check.roll({\r\n                    event,\r\n                    dc: { value: dc },\r\n                    item,\r\n                    origin: actor,\r\n                    skipDialog,\r\n                    extraRollOptions: rollOptions,\r\n                    createMessage: false,\r\n                    callback: async (roll, success, msg) => {\r\n                        await roll3dDice(roll, target);\r\n\r\n                        const context = msg.getFlag<CheckContextChatFlag>(\"pf2e\", \"context\")!;\r\n                        const modifiers = msg.getFlag<RawModifier[]>(\"pf2e\", \"modifiers\")!;\r\n                        const data: MessageTargetSave = {\r\n                            whispers: msg.whisper.filter((userId) => game.users.get(userId)?.isGM),\r\n                            value: roll.total,\r\n                            die: (roll.terms[0] as NumericTerm).total,\r\n                            success: success!,\r\n                            roll: JSON.stringify(roll.toJSON()),\r\n                            dosAdjustments: context.dosAdjustments,\r\n                            unadjustedOutcome: context.unadjustedOutcome,\r\n                            notes: context.notes,\r\n                            modifiers: modifiers\r\n                                .filter((modifier) => modifier.enabled)\r\n                                .map(({ label, modifier }) => ({ label, modifier })),\r\n                        };\r\n\r\n                        updates[target.id] = data;\r\n\r\n                        resolve();\r\n                    },\r\n                });\r\n            });\r\n        })\r\n    );\r\n\r\n    if (user.isGM || message.isAuthor) {\r\n        setFlag(message, \"saves\", updates);\r\n    } else {\r\n        socket.emit({\r\n            type: \"update-save\",\r\n            message: message.id,\r\n            updates,\r\n        });\r\n    }\r\n}\r\n\r\nasync function rerollSave(\r\n    event: MouseEvent,\r\n    message: ChatMessagePF2e,\r\n    { dc, statistic }: MessageSaveData,\r\n    target: CreatureTokenDocument\r\n) {\r\n    const actor = target?.actor;\r\n    if (!actor) return;\r\n\r\n    const flag = getFlag<MessageTargetSave>(message, `saves.${target.id}`);\r\n    if (!flag?.roll || flag.rerolled) return;\r\n\r\n    const content = R.pipe(\r\n        Object.entries(REROLL),\r\n        actor.isOfType(\"character\") && actor.heroPoints.value > 0\r\n            ? R.identity\r\n            : R.filter(([type]) => type !== \"hero\"),\r\n        R.map.indexed(([type, { icon, reroll }], i) => {\r\n            const label = game.i18n.localize(reroll);\r\n            const checked = i === 0 ? \"checked\" : \"\";\r\n\r\n            return `<label>\r\n                <input type=\"radio\" name=\"reroll\" value=\"${type}\" ${checked}>\r\n                <i class=\"${icon}\"></i> ${label}\r\n            </label>`;\r\n        }),\r\n        R.compact,\r\n        R.join(\"\")\r\n    );\r\n\r\n    const html = await waitDialog(\"reroll\", {\r\n        title: `${target.name} - ${localize(\"reroll.title\")}`,\r\n        content,\r\n        yes: \"fa-solid fa-rotate rotate\",\r\n    });\r\n\r\n    if (!html) return;\r\n\r\n    const rerollElement = querySelector<HTMLInputElement>(html, \"[name='reroll']:checked\");\r\n    const reroll = rerollElement!.value as keyof typeof REROLL;\r\n    const isHeroReroll = reroll === \"hero\";\r\n    const keep = isHeroReroll ? \"new\" : reroll;\r\n\r\n    if (isHeroReroll) {\r\n        const { value, max } = (actor as CharacterPF2e).heroPoints;\r\n\r\n        if (value < 1) {\r\n            localize.warn(\"reroll.noPoints\");\r\n            return;\r\n        }\r\n\r\n        await actor.update({\r\n            \"system.resources.heroPoints.value\": Math.clamped(value - 1, 0, max),\r\n        });\r\n    }\r\n\r\n    const oldRoll = Roll.fromJSON<Rolled<CheckRoll>>(flag.roll);\r\n    const unevaluatedNewRoll = oldRoll.clone() as CheckRoll;\r\n    unevaluatedNewRoll.options.isReroll = true;\r\n\r\n    Hooks.callAll(\r\n        \"pf2e.preReroll\",\r\n        Roll.fromJSON(flag.roll),\r\n        unevaluatedNewRoll,\r\n        isHeroReroll,\r\n        keep\r\n    );\r\n\r\n    const newRoll = await unevaluatedNewRoll.evaluate({ async: true });\r\n    await roll3dDice(newRoll, target);\r\n\r\n    Hooks.callAll(\"pf2e.reroll\", Roll.fromJSON(flag.roll), newRoll, isHeroReroll, keep);\r\n\r\n    const keptRoll =\r\n        (keep === \"higher\" && oldRoll.total > newRoll.total) ||\r\n        (keep === \"lower\" && oldRoll.total < newRoll.total)\r\n            ? oldRoll\r\n            : newRoll;\r\n\r\n    if (keptRoll === newRoll) {\r\n        const success = new DegreeOfSuccess(newRoll, dc, flag.dosAdjustments);\r\n        keptRoll.options.degreeOfSuccess = success.value;\r\n    }\r\n\r\n    const domains = actor.saves[statistic].domains;\r\n    const rollOptions = getFlag<string[]>(message, \"rollOptions\") ?? [];\r\n    const outcome = DEGREE_OF_SUCCESS_STRINGS[keptRoll.degreeOfSuccess!];\r\n    const actorNotes = [...extractNotes(actor.synthetics.rollNotes, domains)];\r\n    const notes =\r\n        actorNotes\r\n            ?.map((n) => (n instanceof RollNotePF2e ? n : new RollNotePF2e(n)))\r\n            .filter((note) => {\r\n                if (\r\n                    !note.predicate.test([\r\n                        ...rollOptions,\r\n                        ...(note.rule?.item.getRollOptions(\"parent\") ?? []),\r\n                    ])\r\n                ) {\r\n                    return false;\r\n                }\r\n                if (note.outcome.length === 0) return true;\r\n                return !!(outcome && note.outcome.includes(outcome));\r\n            }) ?? [];\r\n\r\n    const data: MessageTargetSave = {\r\n        whispers: flag.whispers,\r\n        value: keptRoll.total,\r\n        die: (keptRoll.terms[0] as NumericTerm).total,\r\n        success: outcome,\r\n        roll: JSON.stringify(keptRoll.toJSON()),\r\n        dosAdjustments: deepClone(flag.dosAdjustments),\r\n        modifiers: deepClone(flag.modifiers),\r\n        notes: notes.map((note) => note.toObject()),\r\n        rerolled: reroll,\r\n    };\r\n\r\n    if (keptRoll.options.keeleyAdd10) {\r\n        data.modifiers.push({\r\n            label: localize(\"target.chat.save.reroll.keeley\"),\r\n            modifier: 10,\r\n        });\r\n    }\r\n\r\n    if (game.user.isGM || message.isAuthor) {\r\n        setFlag(message, \"saves\", target.id, data);\r\n    } else {\r\n        socket.emit({\r\n            type: \"update-save\",\r\n            message: message.id,\r\n            updates: { [target.id]: data },\r\n        });\r\n    }\r\n}\r\n\r\nasync function roll3dDice(\r\n    roll: Rolled<CheckRoll> | RollJSON,\r\n    target: CreatureTokenDocument | string | undefined | null,\r\n    self = false\r\n) {\r\n    if (!game.dice3d) return;\r\n\r\n    const user = game.user;\r\n    const synchronize = !self && game.pf2e.settings.metagame.breakdowns;\r\n\r\n    roll = roll instanceof Roll ? roll : Roll.fromData<Rolled<CheckRoll>>(roll);\r\n    target = typeof target === \"string\" ? await fromUuid<CreatureTokenDocument>(target) : target;\r\n\r\n    if (!self && !synchronize) {\r\n        socket.emit({\r\n            type: \"dice-so-nice\",\r\n            roll: roll.toJSON(),\r\n            target: target?.uuid,\r\n        });\r\n    } else if (self) {\r\n        if (!user.isGM && !target?.playersCanSeeName) {\r\n            roll.ghost = true;\r\n        }\r\n    }\r\n\r\n    return game.dice3d.showForRoll(roll, user, synchronize);\r\n}\r\n\r\nasync function onSetTargets(event: MouseEvent, message: ChatMessagePF2e) {\r\n    event.stopPropagation();\r\n\r\n    const targets = getCurrentTargets();\r\n\r\n    await setFlag(message, \"targets\", targets);\r\n    requestAnimationFrame(() => ui.chat.scrollBottom({ popout: true, waitImages: true }));\r\n}\r\n\r\nasync function getMessageData(message: ChatMessagePF2e) {\r\n    const targetsFlag = getMessageTargets(message);\r\n    const save = getSaveFlag(message) as MessageSaveDataWithTooltip | undefined;\r\n    if (!targetsFlag.length && !save) return;\r\n\r\n    const user = game.user;\r\n    const isGM = user.isGM;\r\n    const userId = user.id;\r\n    const author = save?.author ? await fromUuid<ActorPF2e>(save.author) : undefined;\r\n    const showDC = isGM || game.pf2e.settings.metagame.dcs || author?.hasPlayerOwner;\r\n    const showBreakdowns = isGM || game.pf2e.settings.metagame.breakdowns;\r\n    const showResults = isGM || game.pf2e.settings.metagame.results;\r\n\r\n    if (save) {\r\n        const saveLabel = game.i18n.format(\"PF2E.SavingThrowWithName\", {\r\n            saveName: game.i18n.localize(save.label),\r\n        });\r\n        const saveDC = showDC ? localize(\"tooltip.dcWithValue\", { dc: save.dc }) : \"\";\r\n        save.tooltipLabel = `${saveLabel} ${saveDC}`;\r\n        save.tooltip = await render(\"tooltip\", {\r\n            check: save.tooltipLabel,\r\n        });\r\n    }\r\n\r\n    const canRollSave: string[] = [];\r\n    const canApplyDamage: string[] = [];\r\n\r\n    const allTargets = await Promise.all(\r\n        targetsFlag.map(async (tokenUUID) => {\r\n            const target = await fromUuid<CreatureTokenDocument>(tokenUUID);\r\n            if (!target) return;\r\n\r\n            const targetId = target.id;\r\n            const targetActor = target.actor;\r\n            if (!targetActor) return;\r\n\r\n            const isHidden = target.hidden || targetActor.hasCondition(\"unnoticed\", \"undetected\");\r\n            if (!isGM && isHidden) return;\r\n\r\n            const isOwner = targetActor.isOwner;\r\n            const hasPlayerOwner = targetActor.hasPlayerOwner;\r\n            const isFriendly = isOwner || hasPlayerOwner;\r\n            const hasSave = save && !!targetActor.saves?.[save.statistic];\r\n            const saveFlag = getFlag<MessageTargetSave>(message, `saves.${targetId}`);\r\n\r\n            if (hasSave && !hasPlayerOwner && !saveFlag) {\r\n                canRollSave.push(tokenUUID);\r\n            }\r\n\r\n            const targetSave = await (async () => {\r\n                if (!hasSave || !saveFlag) return;\r\n\r\n                const rerolled = saveFlag.rerolled;\r\n                const canReroll = hasSave && isOwner && !rerolled;\r\n                const offset = saveFlag.value - save.dc;\r\n                const adjustment =\r\n                    (isFriendly || showBreakdowns) &&\r\n                    saveFlag.unadjustedOutcome &&\r\n                    saveFlag.success !== saveFlag.unadjustedOutcome\r\n                        ? saveFlag.dosAdjustments?.[saveFlag.unadjustedOutcome]?.label\r\n                        : undefined;\r\n                const isPrivate = !hasPlayerOwner && saveFlag.whispers.length;\r\n                const canSeeResult = isGM || !isPrivate;\r\n                const notes = saveFlag.notes.map((note) => new RollNotePF2e(note));\r\n                const notesList = RollNotePF2e.notesToHTML(notes);\r\n                notesList?.classList.add(\"pf2e-toolbelt-target-notes\");\r\n\r\n                let result = \"\";\r\n\r\n                if (canSeeResult) {\r\n                    if (isFriendly || showBreakdowns) {\r\n                        result += `(<i class=\"fa-solid fa-dice-d20\"></i> ${saveFlag.die}) `;\r\n                    }\r\n\r\n                    if (isFriendly || showResults) {\r\n                        result += localize(\r\n                            `tooltip.result.${showDC ? \"withOffset\" : \"withoutOffset\"}`,\r\n                            {\r\n                                success: game.i18n.localize(\r\n                                    `PF2E.Check.Result.Degree.Check.${saveFlag.success}`\r\n                                ),\r\n                                offset: offset >= 0 ? `+${offset}` : offset,\r\n                            }\r\n                        );\r\n                    }\r\n                }\r\n\r\n                return {\r\n                    ...saveFlag,\r\n                    notes: notesList?.outerHTML,\r\n                    canReroll,\r\n                    isPrivate,\r\n                    canSeeResult,\r\n                    tooltip: await render(\"tooltip\", {\r\n                        check: save.tooltipLabel,\r\n                        result: result ? localize(\"tooltip.result.format\", { result }) : undefined,\r\n                        modifiers: isFriendly || showBreakdowns ? saveFlag.modifiers : [],\r\n                        adjustment,\r\n                        canReroll,\r\n                        rerolled: rerolled ? REROLL[rerolled] : undefined,\r\n                    }),\r\n                };\r\n            })();\r\n\r\n            const templateSave: TargetSave | undefined = save && {\r\n                ...save,\r\n                result: targetSave,\r\n            };\r\n\r\n            const anonymous = getActiveModule<AnonymousModule>(\"anonymous\");\r\n            const canSeeName = isGM\r\n                ? true\r\n                : anonymous?.api.playersSeeName(target.actor) ??\r\n                  (!game.pf2e.settings.tokens.nameVisibility || target.playersCanSeeName);\r\n            const name = canSeeName\r\n                ? target.name\r\n                : anonymous?.api.getName(target.actor) ?? localize(\"unnamed\");\r\n\r\n            const applied = getFlag<boolean[]>(message, `applied.${targetId}`) ?? [];\r\n\r\n            return {\r\n                isOwner,\r\n                canSeeName,\r\n                hasPlayerOwner,\r\n                uuid: tokenUUID,\r\n                target,\r\n                applied,\r\n                save: templateSave,\r\n                template: await render(\"header\", {\r\n                    name,\r\n                    isGM,\r\n                    isOwner,\r\n                    hasPlayerOwner,\r\n                    isHidden,\r\n                    uuid: tokenUUID,\r\n                    showSuccess: isFriendly || showResults,\r\n                    save: hasSave && templateSave,\r\n                    canReroll: targetSave?.canReroll,\r\n                    isPrivate: isGM && targetSave?.isPrivate,\r\n                    canSeeResult: targetSave?.canSeeResult,\r\n                    rerolled: targetSave?.rerolled ? REROLL[targetSave.rerolled] : undefined,\r\n                }),\r\n            };\r\n        })\r\n    );\r\n\r\n    setInMemory(message, \"canRollSave\", canRollSave);\r\n    setInMemory(message, \"canApplyDamage\", canApplyDamage);\r\n\r\n    const targets = R.compact(allTargets);\r\n\r\n    if (isGM) {\r\n        targets.sort((a, b) => Number(a.hasPlayerOwner) - Number(b.hasPlayerOwner));\r\n    } else {\r\n        targets.sort((a, b) =>\r\n            !a.isOwner && !b.isOwner\r\n                ? Number(b.hasPlayerOwner) - Number(a.hasPlayerOwner)\r\n                : Number(b.isOwner) - Number(a.isOwner)\r\n        );\r\n    }\r\n\r\n    return { targets, save, isRegen: getFlag(message, \"isRegen\") };\r\n}\r\n\r\nfunction getSaveFlag(message: ChatMessagePF2e): MessageSaveData | undefined {\r\n    const flag = getFlag<MessageSaveFlag>(message, \"save\");\r\n    if (!flag) return;\r\n\r\n    return {\r\n        ...flag,\r\n        ...SAVES[flag.statistic],\r\n    };\r\n}\r\n\r\ntype TargetButtonAction =\r\n    | \"target-apply-healing\"\r\n    | \"target-half-damage\"\r\n    | \"target-apply-damage\"\r\n    | \"target-double-damage\"\r\n    | \"target-shield-block\"\r\n    | \"target-triple-damage\";\r\n\r\ntype MessageSaveDataWithTooltip = MessageSaveData & {\r\n    tooltipLabel: string;\r\n    tooltip: string;\r\n};\r\n\r\ntype MessageSaveData = MessageSaveFlag & {\r\n    icon: string;\r\n    label: string;\r\n};\r\n\r\ntype MessageSaveFlag = {\r\n    statistic: SaveType;\r\n    basic: boolean;\r\n    dc: number;\r\n    author?: string;\r\n};\r\n\r\ntype MessageTargetSave = {\r\n    whispers: string[];\r\n    value: number;\r\n    die: number;\r\n    success: DegreeOfSuccessString;\r\n    roll: string;\r\n    notes: RollNoteSource[];\r\n    dosAdjustments: DegreeAdjustmentsRecord | undefined;\r\n    unadjustedOutcome?: DegreeOfSuccessString | null;\r\n    modifiers: { label: string; modifier: number }[];\r\n    rerolled?: keyof typeof REROLL;\r\n};\r\n\r\ntype MessageFlag = {\r\n    targets?: string[];\r\n    save?: MessageSaveFlag;\r\n    saves?: Record<string, MessageTargetSave>;\r\n    splashIndex?: number;\r\n    isRegen?: boolean;\r\n    applied?: Record<string, boolean[]>;\r\n};\r\n\r\ntype TargetSaveResult = Omit<MessageTargetSave, \"notes\"> & {\r\n    canReroll: boolean;\r\n    tooltip: string;\r\n    notes: string | undefined;\r\n};\r\n\r\ntype TargetSave = MessageSaveDataWithTooltip & {\r\n    result: TargetSaveResult | undefined;\r\n};\r\n\r\ntype SocketPacket =\r\n    | {\r\n          type: \"update-applied\";\r\n          message: string;\r\n          updates: Record<string, any>;\r\n      }\r\n    | {\r\n          type: \"dice-so-nice\";\r\n          roll: RollJSON;\r\n          target: string | undefined;\r\n      }\r\n    | {\r\n          type: \"update-save\";\r\n          message: string;\r\n          updates: Record<string, MessageTargetSave>;\r\n      };\r\n\r\ntype CreatureTokenDocument = TokenDocumentPF2e<CreaturePF2e>;\r\n\r\ntype SaveDragData = {\r\n    basic: boolean;\r\n    dc: number;\r\n    statistic: SaveType;\r\n    type: `${typeof MODULE.id}-check-roll`;\r\n    options: string[];\r\n    traits: string[];\r\n};\r\n\r\nexport {\r\n    getMessageTargets,\r\n    setFlagProperty as setTargetHelperFlagProperty,\r\n    config as targetHelperTool,\r\n};\r\n", "import {\r\n    R,\r\n    addListener,\r\n    compareArrays,\r\n    createHTMLFromString,\r\n    getDamageRollClass,\r\n    htmlElement,\r\n    latestChatMessages,\r\n    querySelector,\r\n    refreshLatestMessages,\r\n} from \"pf2e-api\";\r\nimport { createTool } from \"../tool\";\r\nimport { getMessageTargets, setTargetHelperFlagProperty } from \"./targetHelper\";\r\nimport { DEGREE_OF_SUCCESS_STRINGS } from \"pf2e-api/src/success\";\r\n\r\nconst { config, settings, hook, localize, getFlag, render, setFlagProperty } = createTool({\r\n    name: \"mergeDamage\",\r\n    settings: [\r\n        {\r\n            key: \"enabled\",\r\n            type: Boolean,\r\n            default: false,\r\n            scope: \"client\",\r\n            onChange: (value) => {\r\n                hook.toggle(value);\r\n                refreshLatestMessages(20);\r\n            },\r\n        },\r\n    ],\r\n    hooks: [\r\n        {\r\n            event: \"renderChatMessage\",\r\n            listener: onRenderChatMessage,\r\n        },\r\n    ],\r\n    init: () => {\r\n        hook.toggle(settings.enabled);\r\n        refreshLatestMessages(20);\r\n    },\r\n} as const);\r\n\r\nasync function onRenderChatMessage(message: ChatMessagePF2e, $html: JQuery) {\r\n    const actor = message.actor;\r\n    if ((!game.user.isGM && !message.isAuthor) || !actor || !isDamageRoll(message)) return;\r\n\r\n    const html = htmlElement($html);\r\n    const merged = getFlag<boolean>(message, \"merged\");\r\n    const template = await render(\"buttons\", { merged });\r\n    const buttons = createHTMLFromString(template);\r\n    const targets = getTargets(message);\r\n\r\n    if (merged) {\r\n        html.classList.add(\"merged\");\r\n    }\r\n\r\n    querySelector(html, \".dice-result .dice-total\")?.append(buttons);\r\n\r\n    addListener(buttons, \"[data-action='merge-damage']\", (event) => {\r\n        event.stopPropagation();\r\n\r\n        for (const { message: otherMessage } of latestChatMessages<ChatMessagePF2e>(5, message)) {\r\n            if (otherMessage.actor !== actor || !isDamageRoll(otherMessage)) continue;\r\n\r\n            const otherTargets = getTargets(otherMessage);\r\n            if (!compareArrays(targets, otherTargets)) continue;\r\n\r\n            mergeDamages(message, otherMessage);\r\n            return;\r\n        }\r\n\r\n        localize.warn(\"noMatch\");\r\n    });\r\n\r\n    addListener(buttons, \"[data-action='split-damage']\", async (event) => {\r\n        event.stopPropagation();\r\n\r\n        const sources = getFlag<MessageData[]>(message, \"data\")?.flatMap((data) => data.source);\r\n\r\n        if (sources) {\r\n            await message.delete();\r\n            ChatMessage.implementation.createDocuments(sources);\r\n        }\r\n    });\r\n}\r\n\r\nasync function mergeDamages(message: ChatMessagePF2e, otherMessage: ChatMessagePF2e) {\r\n    const groups: Record<string, MessageGroup> = {};\r\n    const data = getMessageData(otherMessage).concat(getMessageData(message));\r\n    const damageLabel = game.i18n.localize(\"PF2E.DamageRoll\");\r\n\r\n    for (const { name, notes, tags, modifiers, outcome } of data) {\r\n        groups[name] ??= {\r\n            label: `${damageLabel}: ${name}`,\r\n            tags,\r\n            notes: [],\r\n            results: [],\r\n        };\r\n\r\n        if (notes && !groups[name].notes.includes(notes)) {\r\n            groups[name].notes.push(notes);\r\n        }\r\n\r\n        const exists = groups[name].results.find(\r\n            (result) => result.outcome === outcome && result.modifiers === modifiers\r\n        );\r\n\r\n        if (exists) {\r\n            exists.count++;\r\n        } else {\r\n            groups[name].results.push({\r\n                outcome,\r\n                modifiers,\r\n                label: game.i18n.localize(\r\n                    `PF2E.Check.Result.Degree.Attack.${outcome ?? DEGREE_OF_SUCCESS_STRINGS[2]}`\r\n                ),\r\n                count: 1,\r\n            });\r\n        }\r\n    }\r\n\r\n    const groupedInstances: GroupedInstance[] = [];\r\n    const messageRoll = message.rolls[0] as Rolled<DamageRoll>;\r\n    const otherRoll = otherMessage.rolls[0] as Rolled<DamageRoll>;\r\n\r\n    for (const roll of [otherRoll, messageRoll]) {\r\n        const instances = roll.instances as Rolled<DamageInstance>[];\r\n\r\n        for (const instance of instances) {\r\n            const exists = groupedInstances.find(\r\n                (x) => x.type === instance.type && x.persistent === instance.persistent\r\n            );\r\n\r\n            if (exists) {\r\n                exists.total += instance.total;\r\n                exists.terms.push(...instance.toJSON().terms);\r\n                exists.formulas.push(...instance.terms.map((x) => x.expression));\r\n                for (const material of instance.materials) {\r\n                    exists.materials.add(material);\r\n                }\r\n            } else {\r\n                groupedInstances.push({\r\n                    type: instance.type,\r\n                    persistent: instance.persistent,\r\n                    total: instance.total,\r\n                    materials: new Set(instance.materials),\r\n                    terms: instance.toJSON().terms.slice(),\r\n                    formulas: instance.terms.map((x) => x.expression),\r\n                    formula: \"\",\r\n                    term: null as unknown as RollTermData,\r\n                });\r\n            }\r\n        }\r\n    }\r\n\r\n    for (const group of groupedInstances) {\r\n        if (group.persistent) {\r\n            const DamageRoll = getDamageRollClass();\r\n            const { index } = group.formulas.reduce(\r\n                (prev, curr, index) => {\r\n                    const value = new DamageRoll(curr).expectedValue;\r\n                    if (value <= prev.value) return prev;\r\n                    return { value, index };\r\n                },\r\n                { value: 0, index: -1 }\r\n            );\r\n\r\n            group.formulas = [group.formulas[index]];\r\n            group.terms = [group.terms[index]];\r\n        }\r\n\r\n        group.formula = `(${group.formulas.join(\" + \")})[${group.type}]`;\r\n        group.term = group.terms.length < 2 ? group.terms[0] : createTermGroup(group.terms);\r\n    }\r\n\r\n    const showBreakdown = messageRoll.options.showBreakdown && otherRoll.options.showBreakdown;\r\n    const ignoredResistances = (messageRoll.options.ignoredResistances ?? []).concat(\r\n        otherRoll.options.ignoredResistances ?? []\r\n    );\r\n\r\n    const roll = {\r\n        class: \"DamageRoll\",\r\n        options: {\r\n            critRule: messageRoll.options.critRule,\r\n            ignoredResistances: ignoredResistances,\r\n            showBreakdown,\r\n        },\r\n        dice: [],\r\n        formula: `{${groupedInstances.map(({ formula }) => formula).join(\", \")}}`,\r\n        total: R.sumBy(groupedInstances, (x) => x.total),\r\n        evaluated: true,\r\n        terms: [\r\n            {\r\n                class: \"InstancePool\",\r\n                options: {},\r\n                evaluated: true,\r\n                terms: groupedInstances.map(({ formula }) => formula),\r\n                modifiers: [],\r\n                rolls: groupedInstances.map(({ formula, total, term, type, materials }) => ({\r\n                    class: \"DamageInstance\",\r\n                    options: {\r\n                        flavor: [type, ...materials].join(\",\"),\r\n                    },\r\n                    dice: [],\r\n                    formula,\r\n                    total,\r\n                    terms: [term],\r\n                    evaluated: true,\r\n                })),\r\n                results: groupedInstances.map(({ total }) => ({\r\n                    result: total,\r\n                    active: true,\r\n                })),\r\n            },\r\n        ],\r\n    };\r\n\r\n    await ChatMessage.deleteDocuments([message.id, otherMessage.id]);\r\n\r\n    const rolls: RollJSON[] = [roll];\r\n\r\n    for (const msg of [otherMessage, message]) {\r\n        if (msg.rolls.length > 1) {\r\n            rolls.push(...msg.rolls.slice(1).map((roll) => roll.toJSON()));\r\n        }\r\n    }\r\n\r\n    const messageData: ChatMessageCreateData = {\r\n        flavor: await render(\"merged\", {\r\n            groups,\r\n            showBreakdown,\r\n        }),\r\n        type: CONST.CHAT_MESSAGE_TYPES.ROLL,\r\n        speaker: message.speaker,\r\n        flags: {\r\n            pf2e: {\r\n                context: {\r\n                    options: R.uniq(data.flatMap(({ options }) => options)),\r\n                },\r\n            },\r\n        },\r\n        rolls,\r\n    };\r\n\r\n    setTargetHelperFlagProperty(messageData, \"targets\", getTargets(message));\r\n\r\n    setFlagProperty(messageData, \"type\", \"damage-roll\");\r\n    setFlagProperty(messageData, \"merged\", true);\r\n    setFlagProperty(messageData, \"data\", data);\r\n\r\n    ChatMessage.implementation.create(messageData);\r\n}\r\n\r\nfunction createTermGroup(terms: RollTermData[]): GroupingData {\r\n    return {\r\n        class: \"Grouping\",\r\n        options: {},\r\n        evaluated: true,\r\n        term: {\r\n            class: \"ArithmeticExpression\",\r\n            options: {},\r\n            evaluated: true,\r\n            operator: \"+\",\r\n            operands: [terms.shift()!, terms.length > 1 ? createTermGroup(terms) : terms[0]],\r\n        },\r\n    };\r\n}\r\n\r\nfunction getMessageData(message: ChatMessagePF2e): MessageData[] {\r\n    const flag = getFlag<MessageData[]>(message, \"data\");\r\n    if (flag) return flag;\r\n\r\n    const source = message.toObject() as PreCreate<ChatMessageSourceData>;\r\n    delete source._id;\r\n    delete source.timestamp;\r\n\r\n    const sourceFlag = source.flags!.pf2e as DamageDamageFlag;\r\n    const flavor = createHTMLFromString(message.flavor);\r\n    const tags = flavor.querySelector(\":scope > h4.action + .tags\")?.outerHTML.trim() ?? \"\";\r\n    const modifiers = flavor.querySelector(\":scope > .tags.modifiers\")?.outerHTML.trim() ?? \"\";\r\n    const notes = flavor.querySelector(\":scope > .notes\")?.outerHTML.trim() ?? \"\";\r\n    const options = sourceFlag.context.options.filter((option) => /^(item|self):/.test(option));\r\n\r\n    return [\r\n        {\r\n            source,\r\n            name: sourceFlag.strike?.name ?? message.item!.name,\r\n            outcome: sourceFlag.context.outcome,\r\n            options,\r\n            modifiers,\r\n            notes,\r\n            tags,\r\n        },\r\n    ];\r\n}\r\n\r\nfunction isDamageRoll(message: ChatMessagePF2e) {\r\n    return (\r\n        getFlag(message, \"type\") === \"damage-roll\" ||\r\n        message.getFlag(\"pf2e\", \"context.type\") === \"damage-roll\"\r\n    );\r\n}\r\n\r\nfunction getTargets(message: ChatMessagePF2e) {\r\n    const targets = getMessageTargets(message);\r\n    if (targets.length) return targets;\r\n\r\n    const target = message.getFlag<string>(\"pf2e\", \"context.target.token\");\r\n    return target ? [target] : [];\r\n}\r\n\r\ntype GroupedInstance = {\r\n    type: DamageType;\r\n    persistent: boolean;\r\n    total: number;\r\n    materials: Set<MaterialDamageEffect>;\r\n    formulas: string[];\r\n    formula: string;\r\n    terms: RollTermData[];\r\n    term: RollTermData | GroupingData;\r\n};\r\n\r\ntype MessageGroup = {\r\n    label: string;\r\n    tags: string;\r\n    notes: string[];\r\n    results: {\r\n        outcome: DegreeOfSuccessString | null;\r\n        modifiers: string;\r\n        label: string;\r\n        count: number;\r\n    }[];\r\n};\r\n\r\ntype MessageData = {\r\n    source: PreCreate<ChatMessageSourceData>;\r\n    name: string;\r\n    notes: string;\r\n    outcome: DegreeOfSuccessString | null;\r\n    options: string[];\r\n    modifiers: string;\r\n    tags: string;\r\n};\r\n\r\nexport { config as mergeDamageTool };\r\n", "import { refreshLatestMessages } from \"pf2e-api\";\r\nimport { createTool } from \"../tool\";\r\nimport { CHATMESSAGE_GET_HTML } from \"./shared/chatMessage\";\r\n\r\nconst { config, settings, wrapper } = createTool({\r\n    name: \"hideDamage\",\r\n    settings: [\r\n        {\r\n            key: \"enabled\",\r\n            type: Boolean,\r\n            default: false,\r\n            onChange: () => {\r\n                refreshLatestMessages(20);\r\n            },\r\n        },\r\n    ],\r\n    wrappers: [\r\n        {\r\n            key: \"messageGetHTML\",\r\n            path: CHATMESSAGE_GET_HTML,\r\n            callback: chatMessageGetHTML,\r\n        },\r\n    ],\r\n    init: () => {\r\n        wrapper.toggle(settings.enabled);\r\n    },\r\n} as const);\r\n\r\nasync function chatMessageGetHTML(this: ChatMessagePF2e, html: HTMLElement) {\r\n    if (!this.isContentVisible || !this.isDamageRoll) return;\r\n\r\n    const actor = this.actor;\r\n    if (!actor || actor.hasPlayerOwner) return;\r\n\r\n    const isGM = game.user.isGM;\r\n    const diceTotalElement = html.querySelector(\".dice-result .dice-total\");\r\n    const totalElement = diceTotalElement?.querySelector<HTMLElement>(\":scope > .total\");\r\n    const instancesElement = diceTotalElement?.querySelector<HTMLElement>(\":scope > .instances\");\r\n\r\n    if (totalElement) {\r\n        if (isGM) {\r\n            totalElement.dataset.visibility = \"gm\";\r\n        } else {\r\n            totalElement.innerText = \"???\";\r\n        }\r\n    }\r\n\r\n    if (instancesElement) {\r\n        if (isGM) {\r\n            instancesElement.dataset.visibility = \"gm\";\r\n        } else {\r\n            instancesElement.remove();\r\n        }\r\n    }\r\n}\r\n\r\nexport { config as hideDamageTool };\r\n", "import {\r\n    ErrorPF2e,\r\n    addListener,\r\n    addListenerAll,\r\n    elementData,\r\n    htmlElement,\r\n    isInstanceOf,\r\n    libWrapper,\r\n    querySelector,\r\n    renderCharacterSheets,\r\n    renderItemSheets,\r\n} from \"pf2e-api\";\r\nimport { createTool } from \"../tool\";\r\nimport {\r\n    CHARACTER_SHEET_ACTIVATE_LISTENERS,\r\n    CHARACTER_SHEET_RENDER_INNER,\r\n} from \"./shared/characterSheet\";\r\nimport { createActionUseButton, getItemFromActionButton, useButtonToolSetting } from \"./useButton\";\r\n\r\nconst { config, settings, localize, wrappers, getFlag, setFlag, unsetFlag, render } = createTool({\r\n    name: \"actionable\",\r\n    settings: [\r\n        {\r\n            key: \"enabled\",\r\n            type: Boolean,\r\n            default: false,\r\n            onChange: (value) => {\r\n                wrappers.toggleAll(value);\r\n                renderCharacterSheets();\r\n                renderItemSheets([\"AbilitySheetPF2e\", \"FeatSheetPF2e\"]);\r\n            },\r\n        },\r\n        {\r\n            key: \"message\",\r\n            type: Boolean,\r\n            default: true,\r\n            scope: \"client\",\r\n            onChange: () => {\r\n                renderCharacterSheets();\r\n            },\r\n        },\r\n    ],\r\n    wrappers: [\r\n        {\r\n            path: CHARACTER_SHEET_RENDER_INNER,\r\n            callback: characterSheetPF2eRenderInner,\r\n        },\r\n        {\r\n            path: CHARACTER_SHEET_ACTIVATE_LISTENERS,\r\n            callback: characterSheetPF2eActivateListeners,\r\n        },\r\n        {\r\n            path: \"CONFIG.Item.sheetClasses.action['pf2e.AbilitySheetPF2e'].cls.prototype._renderInner\",\r\n            callback: actionSheetPF2eRenderInner,\r\n        },\r\n        {\r\n            path: \"CONFIG.Item.sheetClasses.action['pf2e.AbilitySheetPF2e'].cls.prototype.activateListeners\",\r\n            callback: actionSheetPF2eActivateListeners,\r\n        },\r\n        {\r\n            path: \"CONFIG.Item.sheetClasses.action['pf2e.AbilitySheetPF2e'].cls.prototype._onDrop\",\r\n            callback: actionSheetPF2eOnDrop,\r\n            type: \"OVERRIDE\",\r\n        },\r\n        {\r\n            path: \"CONFIG.Item.sheetClasses.feat['pf2e.FeatSheetPF2e'].cls.prototype._renderInner\",\r\n            callback: actionSheetPF2eRenderInner,\r\n        },\r\n        {\r\n            path: \"CONFIG.Item.sheetClasses.feat['pf2e.FeatSheetPF2e'].cls.prototype.activateListeners\",\r\n            callback: actionSheetPF2eActivateListeners,\r\n        },\r\n        {\r\n            path: \"CONFIG.Item.sheetClasses.feat['pf2e.FeatSheetPF2e'].cls.prototype._onDrop\",\r\n            callback: actionSheetPF2eOnDrop,\r\n            type: \"OVERRIDE\",\r\n        },\r\n    ],\r\n    ready: () => {\r\n        wrappers.toggleAll(settings.enabled);\r\n    },\r\n} as const);\r\n\r\nasync function characterSheetPF2eRenderInner(this: CharacterSheetPF2e, html: HTMLElement) {\r\n    const actor = this.actor;\r\n    const useButton = useButtonToolSetting.actions;\r\n    const withMessage = settings.message;\r\n    const actionElements = html.querySelectorAll(\r\n        \".tab[data-tab='actions'] .actions-list:not(.heroActions-list):not(.strikes-list) .action[data-item-id]\"\r\n    );\r\n\r\n    for (const actionElement of actionElements) {\r\n        const { itemId } = elementData(actionElement);\r\n        const item = actor.items.get(itemId);\r\n        if (!item?.isOfType(\"feat\", \"action\") || item.system.selfEffect) continue;\r\n\r\n        const macro = await getActionMacro(item);\r\n        if (!macro) continue;\r\n\r\n        const btn = createActionUseButton(item);\r\n        btn.dataset.useActionMacro = \"true\";\r\n\r\n        if (!withMessage) {\r\n            btn.dataset.skipMessage = \"true\";\r\n        }\r\n\r\n        if (useButton && item.frequency) {\r\n            if (item.frequency.value >= 1) {\r\n                btn.dataset.toolbeltUse = \"true\";\r\n            } else {\r\n                btn.disabled = true;\r\n            }\r\n        }\r\n\r\n        actionElement.querySelector(\".button-group\")?.append(btn);\r\n    }\r\n}\r\n\r\nfunction characterSheetPF2eActivateListeners(this: CharacterSheetPF2e, html: HTMLElement) {\r\n    const actor = this.actor;\r\n\r\n    addListenerAll(\r\n        html,\r\n        \".use-action[data-use-action-macro='true']\",\r\n        async (event, btn: HTMLButtonElement) => {\r\n            const item = getItemFromActionButton(actor, btn);\r\n            if (!item?.isOfType(\"action\", \"feat\")) return;\r\n\r\n            const macro = await getActionMacro(item);\r\n            macro?.execute({ actor });\r\n\r\n            if (!btn.dataset.skipMessage && !btn.dataset.toolbeltUse) {\r\n                item.toMessage(event);\r\n            }\r\n        }\r\n    );\r\n}\r\n\r\nasync function getActionMacro(item: AbilityItemPF2e | FeatPF2e) {\r\n    const uuid = getFlag<string>(item, \"macro\");\r\n    return uuid ? fromUuid<Macro>(uuid) : null;\r\n}\r\n\r\nasync function actionSheetPF2eRenderInner(\r\n    this: AbilitySheetPF2e | FeatSheetPF2e,\r\n    wrapped: libWrapper.RegisterCallback,\r\n    data: ActionSheetData | FeatSheetData\r\n) {\r\n    const $html = await wrapped(data);\r\n    const item = this.item;\r\n    if (\r\n        item.system.actionType.value === \"passive\" ||\r\n        item.permission <= CONST.DOCUMENT_PERMISSION_LEVELS.LIMITED\r\n    ) {\r\n        return $html;\r\n    }\r\n\r\n    const html = htmlElement($html);\r\n    const label = localize(\"itemSheet.label\");\r\n    const group = querySelector(html, \"[data-drop-zone='self-applied-effect']\");\r\n    if (!group) return $html;\r\n\r\n    const labelEl = querySelector(group, \":scope > label\");\r\n    const hintEl = querySelector(group, \".hint\");\r\n\r\n    if (labelEl) labelEl.innerText += ` / ${label}`;\r\n    if (hintEl) hintEl.innerText += localize(\"itemSheet.hint\");\r\n\r\n    const dropZone = group?.querySelector(\".drop-zone.empty\");\r\n    if (!dropZone) return $html;\r\n\r\n    const macro = await getActionMacro(item);\r\n\r\n    if (macro) {\r\n        dropZone.outerHTML = await render(\"dropzone\", { macro });\r\n    } else {\r\n        const nameEl = querySelector(dropZone, \".name\");\r\n        if (nameEl) nameEl.innerText += ` / ${label}`;\r\n    }\r\n\r\n    return $html;\r\n}\r\n\r\nfunction actionSheetPF2eActivateListeners(\r\n    this: AbilitySheetPF2e | FeatSheetPF2e,\r\n    wrapped: libWrapper.RegisterCallback,\r\n    $html: JQuery\r\n) {\r\n    wrapped($html);\r\n\r\n    const item = this.item;\r\n    if (\r\n        item.system.actionType.value === \"passive\" ||\r\n        item.permission <= CONST.DOCUMENT_PERMISSION_LEVELS.LIMITED\r\n    ) {\r\n        return;\r\n    }\r\n\r\n    const html = htmlElement($html);\r\n    const group = querySelector(html, \"[data-drop-zone='self-applied-effect']\");\r\n    if (!group) return;\r\n\r\n    addListener(group, \"[data-action='open-macro-sheet']\", async () => {\r\n        const macro = await getActionMacro(item);\r\n        macro?.sheet.render(true);\r\n    });\r\n\r\n    addListener(group, \"[data-action='delete-macro']\", () => {\r\n        unsetFlag(item, \"macro\");\r\n    });\r\n}\r\n\r\nasync function actionSheetPF2eOnDrop(this: AbilitySheetPF2e | FeatSheetPF2e, event: DragEvent) {\r\n    const item = this.item;\r\n    if (!this.isEditable || item.system.actionType.value === \"passive\") return;\r\n\r\n    const doc = await (async (): Promise<Item | Macro | null> => {\r\n        try {\r\n            const dataString = event.dataTransfer?.getData(\"text/plain\");\r\n            const dropData = JSON.parse(dataString ?? \"{}\");\r\n            if (typeof dropData !== \"object\") return null;\r\n\r\n            if (dropData.type === \"Item\") {\r\n                return (await Item.implementation.fromDropData(dropData)) ?? null;\r\n            }\r\n\r\n            if (dropData.type === \"Macro\") {\r\n                return (await Macro.fromDropData(dropData)) ?? null;\r\n            }\r\n\r\n            return null;\r\n        } catch {\r\n            return null;\r\n        }\r\n    })();\r\n\r\n    if (\r\n        !(isInstanceOf<ItemPF2e>(doc, \"ItemPF2e\") && doc.isOfType(\"effect\")) &&\r\n        !(doc instanceof Macro)\r\n    ) {\r\n        throw ErrorPF2e(\"Invalid item drop\");\r\n    }\r\n\r\n    if (doc instanceof Item) {\r\n        await item.update({ \"system.selfEffect\": { uuid: item.uuid, name: item.name } });\r\n        return;\r\n    }\r\n\r\n    await setFlag(item, \"macro\", doc.uuid);\r\n}\r\n\r\nexport { config as actionableTool, getActionMacro };\r\n", "import {\r\n    addListenerAll,\r\n    closest,\r\n    consumeItem,\r\n    createHTMLFromString,\r\n    elementData,\r\n    getActionGlyph,\r\n    htmlElement,\r\n    querySelector,\r\n    renderCharacterSheets,\r\n    selfApplyEffectFromMessage,\r\n} from \"pf2e-api\";\r\nimport { createTool } from \"../tool\";\r\nimport {\r\n    CHARACTER_SHEET_ACTIVATE_LISTENERS,\r\n    CHARACTER_SHEET_RENDER_INNER,\r\n} from \"./shared/characterSheet\";\r\nimport { getActionMacro } from \"./actionable\";\r\n\r\nconst debouncedSetupWrappers = debounce(setupWrappers, 1);\r\n\r\nconst { config, settings, hook, wrappers } = createTool({\r\n    name: \"useButton\",\r\n    settings: [\r\n        {\r\n            key: \"actions\",\r\n            type: Boolean,\r\n            default: false,\r\n            scope: \"client\",\r\n            onChange: debouncedSetupWrappers,\r\n        },\r\n        {\r\n            key: \"consumables\",\r\n            type: Boolean,\r\n            default: false,\r\n            scope: \"client\",\r\n            onChange: debouncedSetupWrappers,\r\n        },\r\n        {\r\n            key: \"selfApplied\",\r\n            type: Boolean,\r\n            default: false,\r\n            scope: \"client\",\r\n            onChange: (value) => {\r\n                hook.toggle(value);\r\n            },\r\n        },\r\n    ],\r\n    hooks: [\r\n        {\r\n            event: \"createChatMessage\",\r\n            listener: onCreateChatMessage,\r\n        },\r\n    ],\r\n    wrappers: [\r\n        {\r\n            path: CHARACTER_SHEET_RENDER_INNER,\r\n            callback: characterSheetPF2eRenderInner,\r\n        },\r\n        {\r\n            path: CHARACTER_SHEET_ACTIVATE_LISTENERS,\r\n            callback: characterSheetPF2eActivateListeners,\r\n        },\r\n    ],\r\n    ready: () => {\r\n        hook.toggle(settings.selfApplied);\r\n        wrappers.toggleAll(settings.actions || settings.consumables);\r\n    },\r\n} as const);\r\n\r\nfunction setupWrappers() {\r\n    wrappers.toggleAll(settings.actions || settings.consumables);\r\n    renderCharacterSheets();\r\n}\r\n\r\nasync function characterSheetPF2eRenderInner(this: CharacterSheetPF2e, html: HTMLElement) {\r\n    const actor = this.actor;\r\n\r\n    if (settings.consumables) {\r\n        const consumableElements = html.querySelectorAll(\r\n            \".tab[data-tab='inventory'] .inventory-list [data-item-types='consumable'] > [data-item-id]\"\r\n        );\r\n        for (const consumableElement of consumableElements) {\r\n            const { itemId } = elementData(consumableElement);\r\n            const item = actor.items.get(itemId);\r\n            if (!item?.isOfType(\"consumable\") || item.category === \"ammo\") continue;\r\n\r\n            const [type, tooltip] =\r\n                item.uses.value < 1\r\n                    ? [\"span\", \"PF2E.Item.Consumable.Uses.None\"]\r\n                    : [\"a\", \"PF2E.Action.Use\"];\r\n            const template = `<${type} class=\"use-consumable\" data-tooltip=\"${tooltip}\">\r\n                <i class=\"fa-solid fa-play\"></i>\r\n            </${type}>`;\r\n\r\n            const btn = createHTMLFromString(template);\r\n\r\n            if (item.uses.value) {\r\n                btn.dataset.action = \"toolbelt-use-consumable\";\r\n            }\r\n\r\n            consumableElement.querySelector(\".item-controls\")?.prepend(btn);\r\n        }\r\n    }\r\n\r\n    if (settings.actions) {\r\n        const actionElements = html.querySelectorAll(\r\n            \".tab[data-tab='actions'] .actions-list:not(.heroActions-list):not(.strikes-list) .action[data-item-id]\"\r\n        );\r\n        for (const actionElement of actionElements) {\r\n            const { itemId } = elementData(actionElement);\r\n            const item = actor.items.get(itemId);\r\n            if (\r\n                !item?.isOfType(\"feat\", \"action\") ||\r\n                !item.frequency ||\r\n                (await getActionMacro(item))\r\n            ) {\r\n                continue;\r\n            }\r\n\r\n            let btn: HTMLButtonElement | null;\r\n\r\n            if (item.system.selfEffect) {\r\n                btn = actionElement.querySelector<HTMLButtonElement>(\"[data-action='use-action']\");\r\n            } else {\r\n                btn = createActionUseButton(item);\r\n                actionElement.querySelector(\".button-group\")?.append(btn);\r\n            }\r\n\r\n            if (btn instanceof HTMLButtonElement) {\r\n                if (item.frequency.value >= 1) {\r\n                    btn.dataset.toolbeltUse = \"true\";\r\n                } else {\r\n                    btn.disabled = true;\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nfunction createActionUseButton(item: AbilityItemPF2e | FeatPF2e) {\r\n    const useLabel = game.i18n.localize(\"PF2E.Action.Use\");\r\n    const actionIcon = getActionGlyph(item.actionCost);\r\n    const template = `<button type=\"button\" class=\"use-action\">\r\n            <span>${useLabel}</span>\r\n            <span class=\"action-glyph\">${actionIcon}</span>\r\n    </button>`;\r\n    return createHTMLFromString<HTMLButtonElement>(template);\r\n}\r\n\r\nfunction getItemFromActionButton(actor: CharacterPF2e, btn: HTMLButtonElement) {\r\n    const { itemId } = elementData(closest(btn, \"[data-item-id]\")!);\r\n    return actor.items.get<ItemPF2e<CharacterPF2e>>(itemId);\r\n}\r\n\r\nfunction characterSheetPF2eActivateListeners(this: CharacterSheetPF2e, html: HTMLElement) {\r\n    const actor = this.actor;\r\n\r\n    addListenerAll(\r\n        html,\r\n        \"[data-action='toolbelt-use-consumable']\",\r\n        (event, btn: HTMLButtonElement) => {\r\n            const item = getItemFromActionButton(actor, btn);\r\n            if (item?.isOfType(\"consumable\") && item.category !== \"ammo\") {\r\n                consumeItem(event, item);\r\n            }\r\n        }\r\n    );\r\n\r\n    addListenerAll(\r\n        html,\r\n        \".use-action[data-toolbelt-use='true']\",\r\n        (event, btn: HTMLButtonElement) => {\r\n            const item = getItemFromActionButton(actor, btn);\r\n            if (!item?.isOfType(\"feat\", \"action\")) return;\r\n\r\n            const { value } = item.frequency!;\r\n            if (value < 1) return;\r\n\r\n            item.update({ \"system.frequency.value\": value - 1 });\r\n\r\n            if (!btn.dataset.skipMessage && !item.system.selfEffect) {\r\n                item.toMessage(event);\r\n            }\r\n        }\r\n    );\r\n}\r\n\r\nasync function onCreateChatMessage(message: ChatMessagePF2e) {\r\n    if (!message.isAuthor || message.getFlag(\"pf2e\", \"context.type\") !== \"self-effect\") return;\r\n\r\n    const hookId = Hooks.on(\"renderChatMessage\", (msg: ChatMessagePF2e, $html: JQuery) => {\r\n        if (msg !== message) return;\r\n\r\n        const html = htmlElement($html);\r\n        Hooks.off(\"renderChatMessage\", hookId);\r\n        selfApplyEffectFromMessage(message, html);\r\n    });\r\n}\r\n\r\nexport {\r\n    config as useButtonTool,\r\n    settings as useButtonToolSetting,\r\n    createActionUseButton,\r\n    getItemFromActionButton,\r\n};\r\n", "import {\r\n    R,\r\n    addListener,\r\n    addListenerAll,\r\n    afterHTMLFromString,\r\n    appendHTMLFromString,\r\n    arrayIncludesOne,\r\n    calculateItemPrice,\r\n    closest,\r\n    createTradeMessage,\r\n    elementData,\r\n    filterTraits,\r\n    getHighestName,\r\n    htmlElement,\r\n    libWrapper,\r\n    querySelector,\r\n    transferItemToActor,\r\n} from \"pf2e-api\";\r\nimport { createTool } from \"../tool\";\r\n\r\nconst INFINITE = \"\u221E\";\r\n\r\nconst PULL_LIMIT = 100;\r\n\r\nconst RATIO = {\r\n    buy: {\r\n        min: 0,\r\n        max: 2,\r\n        default: 0.5,\r\n    },\r\n    sell: {\r\n        min: 0,\r\n        max: 5,\r\n        default: 1,\r\n    },\r\n};\r\n\r\nconst {\r\n    config,\r\n    settings,\r\n    wrappers,\r\n    localize,\r\n    socket,\r\n    getFlag,\r\n    setFlag,\r\n    setFlagProperty,\r\n    render,\r\n    getInMemory,\r\n    getInMemoryAndSetIfNot,\r\n    setInMemory,\r\n    deleteInMemory,\r\n    templatePath,\r\n} = createTool({\r\n    name: \"betterMerchant\",\r\n    settings: [\r\n        {\r\n            key: \"enabled\",\r\n            type: Boolean,\r\n            default: false,\r\n            requiresReload: true,\r\n        },\r\n    ],\r\n    wrappers: [\r\n        {\r\n            key: \"actorTransferItem\",\r\n            path: \"CONFIG.Actor.documentClass.prototype.transferItemToActor\",\r\n            callback: actorTransferItemToActor,\r\n            type: \"MIXED\",\r\n        },\r\n        {\r\n            key: \"lootSheetRenderInner\",\r\n            path: \"CONFIG.Actor.sheetClasses.loot['pf2e.LootSheetPF2e'].cls.prototype._renderInner\",\r\n            callback: lootSheetPF2eRenderInner,\r\n        },\r\n        {\r\n            key: \"lootSheetListeners\",\r\n            path: \"CONFIG.Actor.sheetClasses.loot['pf2e.LootSheetPF2e'].cls.prototype.activateListeners\",\r\n            callback: lootSheetPF2eActivateListeners,\r\n        },\r\n        {\r\n            key: \"lootActorTransfer\",\r\n            path: \"CONFIG.PF2E.Actor.documentClasses.loot.prototype.transferItemToActor\",\r\n            callback: lootActorTransferItemToActor,\r\n            type: \"OVERRIDE\",\r\n        },\r\n        {\r\n            key: \"browserRenderInner\",\r\n            path: \"game.pf2e.compendiumBrowser.constructor.prototype._renderInner\",\r\n            callback: browserRenderInner,\r\n        },\r\n        {\r\n            key: \"browserEquipmentTabRenderResults\",\r\n            path: \"game.pf2e.compendiumBrowser.tabs.equipment.constructor.prototype.renderResults\",\r\n            callback: browserEquipmentTabRenderResults,\r\n        },\r\n        {\r\n            key: \"browserListeners\",\r\n            path: \"game.pf2e.compendiumBrowser.constructor.prototype.activateListeners\",\r\n            callback: browserActivateListeners,\r\n        },\r\n        {\r\n            key: \"browserClose\",\r\n            path: \"game.pf2e.compendiumBrowser.constructor.prototype.close\",\r\n            callback: browserClose,\r\n        },\r\n        {\r\n            key: \"itemDerivedData\",\r\n            path: \"CONFIG.Item.documentClass.prototype.prepareDerivedData\",\r\n            callback: itemPrepareDerivedData,\r\n        },\r\n    ],\r\n    api: {\r\n        testItem,\r\n        compareItemWithFilter,\r\n    },\r\n    onSocket: buyItem,\r\n    init: () => {\r\n        if (!settings.enabled) return;\r\n\r\n        wrappers.itemDerivedData.activate();\r\n        wrappers.actorTransferItem.activate();\r\n        wrappers.lootActorTransfer.activate();\r\n    },\r\n    ready: (isGM) => {\r\n        if (!settings.enabled) return;\r\n\r\n        wrappers.lootSheetRenderInner.activate();\r\n\r\n        if (isGM) {\r\n            socket.activate();\r\n\r\n            wrappers.lootSheetListeners.activate();\r\n            wrappers.browserRenderInner.activate();\r\n            wrappers.browserEquipmentTabRenderResults.activate();\r\n            wrappers.browserListeners.activate();\r\n            wrappers.browserClose.activate();\r\n        }\r\n    },\r\n} as const);\r\n\r\nasync function actorTransferItemToActor(\r\n    this: ActorPF2e,\r\n    wrapped: libWrapper.RegisterCallback,\r\n    ...args: [ActorPF2e, ItemPF2e, number, string | undefined, boolean | undefined]\r\n) {\r\n    const [buyer, item, quantity = 1] = args;\r\n\r\n    if (!item.isOfType(\"physical\") || !buyer.isOfType(\"loot\") || !buyer.isMerchant) {\r\n        return wrapped(...args);\r\n    }\r\n\r\n    const hasPlayerOwner = this.hasPlayerOwner;\r\n\r\n    if ((this.isOfType(\"npc\") && !hasPlayerOwner) || !this.isOfType(\"character\", \"party\")) {\r\n        return wrapped(...args);\r\n    }\r\n\r\n    if (!this.canUserModify(game.user, \"update\")) {\r\n        ui.notifications.error(game.i18n.localize(\"PF2E.ErrorMessage.CantMoveItemSource\"));\r\n        return null;\r\n    }\r\n\r\n    if (!buyer.canUserModify(game.user, \"update\")) {\r\n        ui.notifications.error(game.i18n.localize(\"PF2E.ErrorMessage.CantMoveItemDestination\"));\r\n        return null;\r\n    }\r\n\r\n    const realQuantity = Math.min(quantity, item.quantity);\r\n    const itemFilter = testItem(buyer, item, \"buy\", realQuantity);\r\n\r\n    if (!itemFilter) {\r\n        localize.warn(\"buy.refuse\", {\r\n            actor: buyer.name,\r\n            item: item.name,\r\n            quantity: realQuantity === 1 ? \"\" : `x${realQuantity}`,\r\n        });\r\n        return;\r\n    }\r\n\r\n    if (game.user.isGM) {\r\n        buyItem(\r\n            {\r\n                buyer,\r\n                seller: this,\r\n                filter: itemFilter.filter,\r\n                item,\r\n                price: itemFilter.price.toObject(),\r\n                quantity: realQuantity,\r\n            },\r\n            game.user.id\r\n        );\r\n    } else {\r\n        socket.emit({\r\n            buyer: buyer.uuid,\r\n            seller: this.uuid,\r\n            item: item.uuid,\r\n            filter: itemFilter.filter.id,\r\n            price: itemFilter.price.toObject(),\r\n            quantity: realQuantity,\r\n        });\r\n    }\r\n}\r\n\r\nasync function buyItem(\r\n    options: {\r\n        buyer: string | LootPF2e;\r\n        seller: string | CharacterPF2e | NPCPF2e | PartyPF2e;\r\n        item: string | PhysicalItemPF2e;\r\n        quantity: number;\r\n        filter: ExtractedFilter | string;\r\n        price: Coins;\r\n    },\r\n    senderId: string\r\n) {\r\n    const buyer =\r\n        options.buyer instanceof Actor ? options.buyer : await fromUuid<LootPF2e>(options.buyer);\r\n    const seller =\r\n        options.seller instanceof Actor\r\n            ? options.seller\r\n            : await fromUuid<CharacterPF2e | NPCPF2e | PartyPF2e>(options.seller);\r\n    const item =\r\n        options.item instanceof Item\r\n            ? options.item\r\n            : await fromUuid<PhysicalItemPF2e>(options.item);\r\n    const filters = buyer ? getFilters(buyer, \"buy\", true) : [];\r\n    const filter =\r\n        typeof options.filter === \"string\"\r\n            ? filters.find((x) => x.id === options.filter)\r\n            : options.filter;\r\n\r\n    if (!buyer || !seller || !item || !filters.length || !filter) {\r\n        localize.error(\"buy.error\", { user: game.users.get(senderId)!.name });\r\n        return;\r\n    }\r\n\r\n    const quantity = Math.min(options.quantity, item.quantity);\r\n    const newItem = await transferItemToActor(buyer, item, quantity);\r\n    if (!newItem) {\r\n        localize.error(\"buy.error\");\r\n        return;\r\n    }\r\n\r\n    const updates = {};\r\n    const defaultFilter = filters.pop()!;\r\n    const price = new game.pf2e.Coins(options.price);\r\n    const goldValue = price.goldValue;\r\n\r\n    if (defaultFilter.purse !== Infinity && (filter.useDefault || filter.id === \"default\")) {\r\n        setFlagProperty(updates, \"default.buy.purse\", defaultFilter.purse - goldValue);\r\n    }\r\n\r\n    if (filter.id !== \"default\" && filter.purse !== Infinity) {\r\n        const filterIndex = filters.findIndex((x) => x.id === filter.id);\r\n\r\n        filter.purse -= goldValue;\r\n        filters.splice(filterIndex, 1, filter);\r\n\r\n        setFlagProperty(updates, \"filters.buy\", filters);\r\n    }\r\n\r\n    await buyer.update(updates);\r\n\r\n    await seller.inventory.addCoins(price);\r\n\r\n    const content = localize(\"buy.message.content\", {\r\n        buyer: getHighestName(buyer),\r\n        quantity,\r\n        item: newItem.link,\r\n        seller: getHighestName(seller),\r\n        price: parseFloat(goldValue.toFixed(2)),\r\n    });\r\n\r\n    createTradeMessage(localize(\"buy.message.subtitle\"), content, buyer, newItem, senderId);\r\n}\r\n\r\nasync function lootActorTransferItemToActor(\r\n    this: LootPF2e,\r\n    ...args: [ActorPF2e, ItemPF2e<ActorPF2e>, number, string | undefined, boolean | undefined]\r\n) {\r\n    const [targetActor, item, quantity] = args;\r\n    const thisSuper = (Actor.implementation as typeof ActorPF2e).prototype;\r\n\r\n    if (!(this.isOwner && targetActor.isOwner)) {\r\n        return thisSuper.transferItemToActor.apply(this, args);\r\n    }\r\n\r\n    if (this.isMerchant && item.isOfType(\"physical\")) {\r\n        const itemValue = game.pf2e.Coins.fromPrice(item.price, quantity);\r\n        const itemFilter = testItem(this, item, \"sell\", quantity);\r\n\r\n        if (!itemFilter) {\r\n            localize.warn(\"sell.refuse\", {\r\n                actor: this.name,\r\n                item: item.name,\r\n            });\r\n            return null;\r\n        } else if (itemFilter && (await targetActor.inventory.removeCoins(itemValue))) {\r\n            const goldValue = itemValue.goldValue;\r\n            const filters = getFlag<ItemFilter[]>(this, \"filters\", \"sell\")?.slice() ?? [];\r\n            const defaultFilter = getFlag<Partial<ItemFilter>>(this, \"default\", \"sell\");\r\n            const updates = setFlagProperty(\r\n                {},\r\n                \"default.sell.purse\",\r\n                (defaultFilter?.purse ?? 0) + goldValue\r\n            );\r\n\r\n            if (itemFilter.filter.id !== \"default\") {\r\n                const filterIndex = filters.findIndex((x) => x.id === itemFilter.filter.id);\r\n\r\n                if (filterIndex !== -1) {\r\n                    itemFilter.filter.purse += goldValue;\r\n                    filters.splice(filterIndex, 1, itemFilter.filter);\r\n\r\n                    setFlagProperty(updates, \"filters.sell\", filters);\r\n                }\r\n            }\r\n\r\n            await this.update(updates);\r\n\r\n            return thisSuper.transferItemToActor.apply(this, args);\r\n        } else {\r\n            return null;\r\n        }\r\n    }\r\n\r\n    return thisSuper.transferItemToActor.apply(this, args);\r\n}\r\n\r\nfunction itemPrepareDerivedData(this: ItemPF2e, wrapped: libWrapper.RegisterCallback) {\r\n    wrapped();\r\n\r\n    if (!this.isOfType(\"physical\") || this.isOfType(\"treasure\")) return;\r\n\r\n    const actor = this.actor;\r\n    if (!actor?.isOfType(\"loot\") || !actor.isMerchant) return;\r\n\r\n    deleteInMemory(this);\r\n\r\n    const infinite = getFlag<boolean>(actor, \"infiniteAll\");\r\n    const itemFilter = testItem(actor, this, \"sell\");\r\n\r\n    if (infinite) {\r\n        this.system.quantity = 9999;\r\n    }\r\n\r\n    if (itemFilter && itemFilter.filter.ratio !== 1) {\r\n        this.system.price.value = itemFilter.price;\r\n        setInMemory(this, \"filter\", itemFilter.filter.id);\r\n    }\r\n}\r\n\r\nfunction testItem(actor: LootPF2e, item: PhysicalItemPF2e, type: ItemFilterType, quantity = 1) {\r\n    const itemFilters = getFilters(actor, type, true);\r\n    const defaultFilter = itemFilters.pop()!;\r\n\r\n    for (const itemFilter of itemFilters) {\r\n        const { enabled, ratio, purse, useDefault, filter } = itemFilter;\r\n        if (!enabled) continue;\r\n\r\n        const price = calculateItemPrice(item, quantity, ratio);\r\n        const goldPrice = price.goldValue;\r\n\r\n        if (type === \"buy\") {\r\n            if (purse < goldPrice) continue;\r\n            if (useDefault && defaultFilter.purse < goldPrice) continue;\r\n        }\r\n\r\n        if (!compareItemWithFilter(item, filter)) continue;\r\n\r\n        return { price, filter: itemFilter };\r\n    }\r\n\r\n    if (!defaultFilter.enabled) return;\r\n\r\n    const price = calculateItemPrice(item, quantity, defaultFilter.ratio);\r\n    if (type === \"buy\" && defaultFilter.purse < price.goldValue) return;\r\n\r\n    return { price, filter: defaultFilter };\r\n}\r\n\r\nfunction compareItemWithFilter(item: PhysicalItemPF2e, filter: Partial<EquipmentFilters>) {\r\n    if (filter.search?.text) {\r\n        const itemName = item.name.toLocaleLowerCase(game.i18n.lang);\r\n        const wordSegmenter =\r\n            \"Segmenter\" in Intl\r\n                ? new Intl.Segmenter(game.i18n.lang, { granularity: \"word\" })\r\n                : {\r\n                      segment(term: string): { segment: string }[] {\r\n                          return [{ segment: term }];\r\n                      },\r\n                  };\r\n        const segments = Array.from(wordSegmenter.segment(filter.search.text))\r\n            .map((t) => t.segment.toLocaleLowerCase(game.i18n.lang).replace(/['\"]/g, \"\"))\r\n            .filter((t) => t.length > 1);\r\n        const nameChecks = segments.some((segment) => itemName.includes(segment));\r\n\r\n        if (!nameChecks) return false;\r\n    }\r\n\r\n    const { checkboxes, multiselects, ranges, sliders } = filter;\r\n\r\n    // Level\r\n    const itemLevel = item.level;\r\n    if (\r\n        sliders?.level &&\r\n        (itemLevel < sliders.level.values.min || itemLevel > sliders.level.values.max)\r\n    ) {\r\n        return false;\r\n    }\r\n\r\n    // Price\r\n    const priceInCopper = item.price.value.copperValue;\r\n    if (\r\n        ranges?.price &&\r\n        (priceInCopper < ranges.price.values.min || priceInCopper > ranges.price.values.max)\r\n    ) {\r\n        return false;\r\n    }\r\n\r\n    // Item type\r\n    const itemTypes = checkboxes?.itemTypes?.selected;\r\n    if (itemTypes && itemTypes.length > 0 && !itemTypes.includes(item.type)) {\r\n        return false;\r\n    }\r\n\r\n    const itemCategory = \"category\" in item ? (item.category as string) : \"\";\r\n    const itemGroup = \"group\" in item ? (item.group as string) : \"\";\r\n\r\n    // Armor\r\n    const armorTypes = checkboxes?.armorTypes?.selected;\r\n    if (\r\n        armorTypes &&\r\n        armorTypes.length > 0 &&\r\n        !arrayIncludesOne(armorTypes, [itemCategory, itemGroup])\r\n    ) {\r\n        return false;\r\n    }\r\n\r\n    // Weapon categories\r\n    const weaponTypes = checkboxes?.weaponTypes?.selected;\r\n    if (\r\n        weaponTypes &&\r\n        weaponTypes.length > 0 &&\r\n        !arrayIncludesOne(weaponTypes, [itemCategory, itemGroup])\r\n    ) {\r\n        return false;\r\n    }\r\n\r\n    // Traits\r\n    const traits = multiselects?.traits;\r\n    if (traits && !filterTraits([...item.traits], traits.selected, traits.conjunction)) {\r\n        return false;\r\n    }\r\n\r\n    // Source\r\n    const itemSource = game.pf2e.system\r\n        // @ts-ignore\r\n        .sluggify(item.system.publication?.title ?? item.system.source?.value ?? \"\")\r\n        .trim();\r\n    const sources = checkboxes?.source?.selected;\r\n    if (sources && sources.length > 0 && !sources.includes(itemSource)) {\r\n        return false;\r\n    }\r\n\r\n    // Rarity\r\n    const rarities = checkboxes?.rarity?.selected;\r\n    if (rarities && rarities.length > 0 && !rarities.includes(item.rarity)) {\r\n        return false;\r\n    }\r\n\r\n    return true;\r\n}\r\n\r\nasync function browserClose(\r\n    this: CompendiumBrowser,\r\n    wrapped: libWrapper.RegisterCallback,\r\n    options: any\r\n) {\r\n    deleteInMemory(this);\r\n    wrapped(options);\r\n}\r\n\r\nasync function browserRenderInner(\r\n    this: CompendiumBrowser,\r\n    wrapped: libWrapper.RegisterCallback,\r\n    sheetData: CompendiumBrowserSheetData\r\n) {\r\n    const $html = await wrapped(sheetData);\r\n\r\n    const data = getInMemory<BrowserData>(this);\r\n    if (!data?.actor.isMerchant) return $html;\r\n\r\n    const html = htmlElement($html);\r\n    const listButtons = querySelector(\r\n        html,\r\n        \"section.content .tab[data-tab='equipment'] .list-buttons\"\r\n    );\r\n    if (!listButtons) return $html;\r\n\r\n    html.classList.add(\"toolbelt-merchant\");\r\n\r\n    for (const button of listButtons.querySelectorAll(\"button\")) {\r\n        button.remove();\r\n    }\r\n\r\n    if (data.type === \"pull\") {\r\n        const template = await render(\"browserPull\", {});\r\n        appendHTMLFromString(listButtons, template);\r\n\r\n        const oweditems = R.pipe(\r\n            data.actor.inventory.contents,\r\n            R.map((item) => item.sourceId),\r\n            R.compact\r\n        );\r\n\r\n        deleteInMemory(this, \"selection\");\r\n        setInMemory(this, \"owned\", oweditems);\r\n    } else {\r\n        const typeLabel = localize(\"filter\", data.filterType);\r\n        const label = localize(\"browserFilter\", data.edit ? \"edit\" : \"create\", { type: typeLabel });\r\n\r\n        appendHTMLFromString(\r\n            listButtons,\r\n            `<button type='button' data-action=\"validate-filter\">${label}</button>>`\r\n        );\r\n    }\r\n\r\n    return $html;\r\n}\r\n\r\nfunction fillSelection(tab: CompendiumBrowserEquipmentTab, selection: string[], owned?: string[]) {\r\n    owned ??= getInMemory<string[]>(tab.browser, \"owned\") ?? [];\r\n    selection.length = 0;\r\n\r\n    for (const { uuid } of tab.currentIndex) {\r\n        if (owned.includes(uuid)) continue;\r\n        selection.push(uuid);\r\n        if (selection.length >= PULL_LIMIT) break;\r\n    }\r\n\r\n    return selection;\r\n}\r\n\r\nasync function browserEquipmentTabRenderResults(\r\n    this: CompendiumBrowserEquipmentTab,\r\n    wrapped: libWrapper.RegisterCallback,\r\n    start: number\r\n): Promise<HTMLLIElement[]> {\r\n    const browser = this.browser;\r\n    const itemElements = (await wrapped(start)) as HTMLLIElement[];\r\n    const data = getInMemory<BrowserData>(browser);\r\n    if (!data || !data.actor.isMerchant) return itemElements;\r\n\r\n    for (const itemElement of itemElements) {\r\n        for (const a of itemElement.querySelectorAll(\":scope > a\")) {\r\n            a.remove();\r\n        }\r\n    }\r\n\r\n    if (data.type !== \"pull\") return itemElements;\r\n\r\n    const selection = getInMemoryAndSetIfNot(browser, \"selection\", () => {\r\n        const selection = fillSelection(this, [], data.owned);\r\n        updateBrowser(selection);\r\n        return selection;\r\n    });\r\n\r\n    const isAtLimit =\r\n        selection.length >= PULL_LIMIT\r\n            ? `data-tooltip=\"${localize(\"browserPull.limit\")}\" disabled`\r\n            : \"\";\r\n\r\n    const ownedStr = localize(\"browserPull.owned\");\r\n    const isOwned = `<i class=\"fa-solid fa-box\" data-tooltip=\"${ownedStr}\"></i>`;\r\n\r\n    for (const itemElement of itemElements) {\r\n        const { entryUuid } = elementData(itemElement);\r\n\r\n        if (data.owned.includes(entryUuid)) {\r\n            itemElement.insertAdjacentHTML(\"beforeend\", isOwned);\r\n            continue;\r\n        }\r\n\r\n        const checked = selection.includes(entryUuid) ? \"checked\" : \"\";\r\n        itemElement.insertAdjacentHTML(\r\n            \"beforeend\",\r\n            `<input type='checkbox' data-uuid=\"${entryUuid}\" \r\n\t\t\t${checked} ${!checked ? isAtLimit : \"\"}>`\r\n        );\r\n\r\n        const checkbox = itemElement.querySelector(\"input\");\r\n        checkbox?.addEventListener(\"change\", () => {\r\n            if (checkbox.checked) {\r\n                selection.push(entryUuid);\r\n            } else {\r\n                const index = selection.indexOf(entryUuid);\r\n                selection.splice(index, 1);\r\n            }\r\n            updateBrowser(selection);\r\n        });\r\n    }\r\n\r\n    return itemElements;\r\n}\r\n\r\nfunction updateBrowser(selection: string[], skipAll = false) {\r\n    const browserApp = document.getElementById(\"compendium-browser\");\r\n    const browserTab = browserApp?.querySelector(\r\n        \".content-box.toolbelt-merchant .content .tab[data-tab=equipment]\"\r\n    );\r\n    if (!browserTab) return;\r\n\r\n    const listButtons = querySelector(browserTab, \".list-buttons\");\r\n    if (!listButtons) return;\r\n\r\n    const tab = game.pf2e.compendiumBrowser.tabs.equipment;\r\n    const selected = selection.length;\r\n    const total = tab.currentIndex.length;\r\n    const isAtLimit = selected >= PULL_LIMIT;\r\n    const reachedLimit = localize(\"browserPull.limit\");\r\n    const numbers = listButtons.querySelectorAll(\":scope > div span\");\r\n    const checkboxes = browserTab.querySelectorAll<HTMLInputElement>(\".result-list .item input\");\r\n\r\n    if (numbers.length) {\r\n        numbers[0].textContent = String(selected);\r\n        numbers[1].textContent = String(total);\r\n    }\r\n\r\n    if (!skipAll) {\r\n        const checkbox = listButtons.querySelector<HTMLInputElement>(\":scope > label input\");\r\n        if (checkbox) {\r\n            if (selected === 0) {\r\n                checkbox.indeterminate = false;\r\n                checkbox.checked = false;\r\n            } else if (isAtLimit || selected >= total) {\r\n                checkbox.indeterminate = false;\r\n                checkbox.checked = true;\r\n            } else {\r\n                checkbox.indeterminate = true;\r\n                checkbox.checked = true;\r\n            }\r\n        }\r\n    }\r\n\r\n    querySelector<HTMLButtonElement>(listButtons, \"button\")!.disabled = selected === 0;\r\n\r\n    for (const checkbox of checkboxes) {\r\n        const checked = checkbox.checked;\r\n        const disabled = !checked && isAtLimit;\r\n\r\n        checkbox.disabled = disabled;\r\n        checkbox.dataset.tooltip = disabled ? reachedLimit : \"\";\r\n    }\r\n}\r\n\r\nfunction browserActivateListeners(\r\n    this: CompendiumBrowser,\r\n    wrapped: libWrapper.RegisterCallback,\r\n    $html: JQuery\r\n) {\r\n    wrapped($html);\r\n\r\n    const data = getInMemory<BrowserData>(this);\r\n    if (!data?.actor?.isMerchant) return;\r\n\r\n    const html = htmlElement($html);\r\n    const tabEl = querySelector(html, \"section.content .tab[data-tab='equipment']\");\r\n    const listButtons = querySelector(tabEl, \".list-buttons\");\r\n    if (!listButtons) return;\r\n\r\n    const actor = data.actor;\r\n    const browser = this;\r\n    const tab = browser.tabs.equipment;\r\n\r\n    if (data.type === \"pull\") {\r\n        addListener(listButtons, \"[data-action='add-to-merchant']\", async () => {\r\n            const selection = getInMemory<string[]>(browser, \"selection\") ?? [];\r\n            const message = localize(\"browserPull.confirm\", { nb: selection.length });\r\n            const confirm = await Dialog.confirm({\r\n                title: `${localize(\"sheet.browser\")} - ${actor.name}`,\r\n                content: `<div style=\"margin-bottom: 0.5em;\">${message}</div>`,\r\n            });\r\n            if (!confirm) return;\r\n\r\n            localize.info(\"browserPull.wait\");\r\n            browser.close();\r\n\r\n            const items = R.pipe(\r\n                await Promise.all(selection.map((uuid) => fromUuid<PhysicalItemPF2e>(uuid))),\r\n                R.compact,\r\n                R.map((item) => item.toObject())\r\n            );\r\n\r\n            if (items.length) {\r\n                await actor.createEmbeddedDocuments(\"Item\", items);\r\n            }\r\n\r\n            localize.info(\"browserPull.finished\");\r\n        });\r\n\r\n        addListener(\r\n            listButtons,\r\n            \"[data-action='toggle-select-all']\",\r\n            (event, el: HTMLInputElement) => {\r\n                const checkAll = el.checked;\r\n                const selection = getInMemory<string[]>(browser, \"selection\") ?? [];\r\n\r\n                if (checkAll) {\r\n                    fillSelection(tab, selection);\r\n                } else {\r\n                    selection.length = 0;\r\n                }\r\n\r\n                const checkboxes = tabEl!.querySelectorAll<HTMLInputElement>(\".item input\");\r\n                for (const checkbox of checkboxes) {\r\n                    const { uuid } = elementData(checkbox);\r\n                    checkbox.checked = selection.includes(uuid);\r\n                }\r\n\r\n                updateBrowser(selection, false);\r\n            }\r\n        );\r\n    } else {\r\n        addListener(listButtons, \"[data-action='validate-filter']\", async () => {\r\n            const filterData = tab.filterData;\r\n            const defaultData = await tab.getFilterData();\r\n            const extractedData: Partial<EquipmentFilters> = {};\r\n            const search = filterData.search.text.trim();\r\n\r\n            if (search) {\r\n                setProperty(extractedData, \"search.text\", search);\r\n            }\r\n\r\n            for (const type of [\"checkboxes\", \"multiselects\"] as const) {\r\n                for (const [category, data] of Object.entries(filterData[type])) {\r\n                    if (!data.selected.length) continue;\r\n\r\n                    const path = `${type}.${category}`;\r\n\r\n                    setProperty(extractedData, `${path}.selected`, data.selected);\r\n\r\n                    if (\"conjunction\" in data) {\r\n                        setProperty(extractedData, `${path}.conjunction`, data.conjunction);\r\n                    }\r\n                }\r\n            }\r\n\r\n            for (const type of [\"ranges\", \"sliders\"] as const) {\r\n                const defaultType = defaultData[type];\r\n\r\n                for (const [category, data] of Object.entries(filterData[type])) {\r\n                    // @ts-ignore\r\n                    const defaultCategory = defaultType[category];\r\n                    if (objectsEqual(data.values, defaultCategory.values)) continue;\r\n\r\n                    setProperty(extractedData, `${type}.${category}.values`, data.values);\r\n                }\r\n            }\r\n\r\n            if (isEmpty(extractedData)) {\r\n                localize.warn(\"browserFilter.empty\");\r\n                return;\r\n            }\r\n\r\n            browser.close();\r\n\r\n            const filters = getFilters(actor, data.filterType, false) as ItemFilterBase[];\r\n\r\n            if (data.edit) {\r\n                const itemFilter = filters.find((x) => x.id === data.edit);\r\n\r\n                if (itemFilter) {\r\n                    itemFilter.filter = extractedData;\r\n                    setFilters(actor, data.filterType, filters);\r\n                    return;\r\n                }\r\n            }\r\n\r\n            const id = randomID();\r\n            const itemFilter: ItemFilter = {\r\n                id,\r\n                name: id,\r\n                enabled: true,\r\n                filter: extractedData,\r\n                useDefault: true,\r\n            };\r\n\r\n            filters.unshift(itemFilter);\r\n            setFilters(actor, data.filterType, filters);\r\n        });\r\n    }\r\n}\r\n\r\nasync function lootSheetPF2eRenderInner(\r\n    this: LootSheetPF2e,\r\n    wrapped: libWrapper.RegisterCallback,\r\n    data: LootSheetDataPF2e\r\n) {\r\n    const $html = await wrapped(data);\r\n\r\n    const actor = this.actor;\r\n    if (!actor?.isMerchant) return $html;\r\n\r\n    const isGM = game.user.isGM;\r\n    const html = htmlElement($html);\r\n    const infiniteAll = getFlag<boolean>(actor, \"infiniteAll\");\r\n\r\n    if (isGM) {\r\n        const sidebarEl = querySelector(html, \".sheet-sidebar\");\r\n        const template = await render(\"sheet\", {\r\n            infiniteAll,\r\n        });\r\n\r\n        afterHTMLFromString(querySelector(sidebarEl, \".image-container\"), template);\r\n    }\r\n\r\n    const itemFilters = isGM ? getFilters(actor, \"sell\", true) : false;\r\n    const itemElements = html.querySelectorAll(\r\n        \".sheet-body .inventory-list .items > [data-item-id]\"\r\n    );\r\n\r\n    for (const itemElement of itemElements) {\r\n        const { itemId } = elementData(itemElement);\r\n        const item = actor.items.get(itemId);\r\n        if (!item) continue;\r\n\r\n        if (itemFilters) {\r\n            const filterId = getInMemory<string>(item, \"filter\");\r\n            const filter = itemFilters.find((x) => x.id === filterId);\r\n\r\n            if (filter) {\r\n                const priceElement = querySelector(itemElement, \".price\");\r\n\r\n                if (priceElement) {\r\n                    priceElement.classList.add(filter.ratio < 1 ? \"cheap\" : \"expensive\");\r\n                    priceElement.dataset.tooltip = `${filter.name} (${filter.ratio})`;\r\n                }\r\n            }\r\n        }\r\n\r\n        if (infiniteAll) {\r\n            const quantityElement = querySelector(itemElement, \".quantity\");\r\n            if (quantityElement) quantityElement.innerHTML = INFINITE;\r\n        }\r\n    }\r\n\r\n    if (isGM && infiniteAll) {\r\n        const bulkElement = querySelector(html, \".total-bulk span\");\r\n        const wealthElement = querySelector(html, \".coinage .wealth .item-name:last-child span\");\r\n\r\n        if (bulkElement) {\r\n            bulkElement.innerHTML = game.i18n.format(\"PF2E.Actor.Inventory.TotalBulk\", {\r\n                bulk: INFINITE,\r\n            });\r\n        }\r\n        if (wealthElement) {\r\n            wealthElement.innerHTML = INFINITE;\r\n        }\r\n    }\r\n\r\n    return $html;\r\n}\r\n\r\nfunction lootSheetPF2eActivateListeners(\r\n    this: LootSheetPF2e,\r\n    wrapped: libWrapper.RegisterCallback,\r\n    $html: JQuery\r\n) {\r\n    wrapped($html);\r\n\r\n    const actor = this.actor;\r\n    if (!actor?.isMerchant) return;\r\n\r\n    const html = htmlElement($html);\r\n    const betterMenu = querySelector(html, \".better-merchant\");\r\n    if (!betterMenu) return;\r\n\r\n    addListener(betterMenu, \"[data-action='open-equipment-tab']\", () => {\r\n        openEquipmentTab({ actor, type: \"pull\", owned: [] });\r\n    });\r\n\r\n    addListener(betterMenu, \"[data-action='open-filtes-menu']\", () => {\r\n        new FiltersMenu(actor).render(true);\r\n    });\r\n\r\n    addListener(betterMenu, \"[name='infiniteAll']\", \"change\", (event, el: HTMLInputElement) => {\r\n        const value = el.checked;\r\n        setFlag(actor, \"infiniteAll\", value);\r\n    });\r\n}\r\n\r\nclass FiltersMenu extends Application {\r\n    actor: LootPF2e;\r\n\r\n    constructor(actor: LootPF2e) {\r\n        super();\r\n\r\n        this.actor = actor;\r\n    }\r\n\r\n    get id() {\r\n        return localize(\"filters.app\");\r\n    }\r\n\r\n    get title() {\r\n        return localize(\"filters.title\", this.actor);\r\n    }\r\n\r\n    get template() {\r\n        return templatePath(\"filters\");\r\n    }\r\n\r\n    render(force?: boolean, options?: ApplicationRenderOptions): this {\r\n        this.actor.apps[this.appId] = this;\r\n        return super.render(force, options);\r\n    }\r\n\r\n    async close(options?: { force?: boolean }) {\r\n        await super.close(options);\r\n        delete this.actor.apps?.[this.appId];\r\n    }\r\n\r\n    getData() {\r\n        const actor = this.actor;\r\n        const translate = localize.sub(\"filters\");\r\n        const buyFilters = getFilters(actor, \"buy\", true);\r\n        const sellFilters = getFilters(actor, \"sell\", true);\r\n\r\n        const templateFilter = (filters: ExtractedFilter[]) => {\r\n            const limit = filters.length - 1;\r\n            return (filter: ExtractedFilter, index: number) => ({\r\n                ...filter,\r\n                purse:\r\n                    filter.purse === Infinity\r\n                        ? undefined\r\n                        : typeof filter.purse === \"number\"\r\n                        ? Math.floor(filter.purse)\r\n                        : filter.purse,\r\n                cannotUp: index === 0 || index === limit,\r\n                cannotDown: index >= limit - 1,\r\n            });\r\n        };\r\n\r\n        return {\r\n            i18n: translate.i18n,\r\n            buyFilters: buyFilters.map(templateFilter(buyFilters)),\r\n            sellFilters: sellFilters.map(templateFilter(sellFilters)),\r\n            ratios: RATIO,\r\n        };\r\n    }\r\n\r\n    activateListeners($html: JQuery<HTMLElement>) {\r\n        const html = htmlElement($html);\r\n        const browser = game.pf2e.compendiumBrowser;\r\n        const tab = browser.tabs.equipment;\r\n\r\n        addListenerAll(html, \"[data-action='add-filter']\", (even, el) => {\r\n            const { type } = elementData<{ type: ItemFilterType }>(el);\r\n            openEquipmentTab({\r\n                actor: this.actor,\r\n                type: \"filter\",\r\n                filterType: type,\r\n                edit: false,\r\n            });\r\n        });\r\n\r\n        const getItemData = (el: HTMLElement) => {\r\n            const data = elementData<{ id: string; type: ItemFilterType }>(\r\n                closest(el, \"[data-id]\")!\r\n            );\r\n            const { type, id } = data;\r\n\r\n            const itemFilters = getFilters(this.actor, type, true);\r\n            const filterIndex = itemFilters.findIndex((x) => x.id === id);\r\n\r\n            return {\r\n                ...data,\r\n                itemFilters,\r\n                filterIndex,\r\n            };\r\n        };\r\n\r\n        addListenerAll(html, \"input\", \"change\", (event, el: HTMLInputElement) => {\r\n            const { itemFilters, filterIndex, type } = getItemData(el);\r\n            const filter = itemFilters.at(filterIndex);\r\n            if (!filter) return;\r\n\r\n            const key = el.name;\r\n            const value =\r\n                el.type === \"checkbox\"\r\n                    ? el.checked\r\n                    : el.type === \"number\"\r\n                    ? el.valueAsNumber\r\n                    : el.value.trim();\r\n\r\n            setProperty(filter, key, value);\r\n            setFilters(this.actor, type, itemFilters);\r\n        });\r\n\r\n        addListenerAll(html, \"input[type='text'], input[type='number']\", \"keydown\", (event, el) => {\r\n            if (event.key === \"Enter\") {\r\n                el.blur();\r\n            }\r\n        });\r\n\r\n        addListenerAll(html, \"[data-action='move-filter']\", (event, el) => {\r\n            const { itemFilters, filterIndex, type } = getItemData(el);\r\n            const { direction } = elementData<{ direction: \"up\" | \"down\" }>(el);\r\n            const newIndex = direction === \"up\" ? filterIndex - 1 : filterIndex + 1;\r\n\r\n            if (newIndex < 0 || newIndex >= itemFilters.length) return;\r\n\r\n            const newFilters = R.swapIndices(itemFilters, filterIndex, newIndex);\r\n            setFilters(this.actor, type, newFilters);\r\n        });\r\n\r\n        addListenerAll(html, \"[data-action='delete-filter']\", async (event, el) => {\r\n            const { type, filterIndex, itemFilters } = getItemData(el);\r\n            if (filterIndex === -1) return;\r\n\r\n            const filter = itemFilters.at(filterIndex);\r\n            const confirm = await Dialog.confirm({\r\n                title: localize(\"filters.delete.title\"),\r\n                content: localize(\"filters.delete.content\", { name: filter!.name || filter!.id }),\r\n            });\r\n\r\n            if (confirm) {\r\n                itemFilters.splice(filterIndex, 1);\r\n                setFilters(this.actor, type, itemFilters);\r\n            }\r\n        });\r\n\r\n        addListenerAll(html, \"[data-action='edit-filter']\", async (event, el) => {\r\n            const { type, id, filterIndex, itemFilters } = getItemData(el);\r\n            const defaultData = await tab.getFilterData();\r\n            const itemFilter = itemFilters.at(filterIndex)?.filter;\r\n            if (!itemFilter) return;\r\n\r\n            const filter = mergeObject(defaultData, itemFilter);\r\n\r\n            if (itemFilter.ranges) {\r\n                for (const key in itemFilter.ranges) {\r\n                    const range = filter.ranges[key as keyof EquipmentFilters[\"ranges\"]];\r\n                    range.isExpanded = true;\r\n                }\r\n            }\r\n\r\n            if (itemFilter.sliders) {\r\n                for (const key in itemFilter.sliders) {\r\n                    const slider = filter.sliders[key as keyof EquipmentFilters[\"sliders\"]];\r\n                    slider.isExpanded = true;\r\n                }\r\n            }\r\n\r\n            if (itemFilter.checkboxes) {\r\n                for (const key in itemFilter.checkboxes) {\r\n                    const checkbox = filter.checkboxes[key as keyof EquipmentFilters[\"checkboxes\"]];\r\n\r\n                    checkbox.isExpanded = true;\r\n                    for (const selected of checkbox.selected) {\r\n                        checkbox.options[selected].selected = true;\r\n                    }\r\n                }\r\n            }\r\n\r\n            openEquipmentTab(\r\n                {\r\n                    actor: this.actor,\r\n                    type: \"filter\",\r\n                    filterType: type,\r\n                    edit: id,\r\n                },\r\n                filter\r\n            );\r\n        });\r\n    }\r\n}\r\n\r\nasync function openEquipmentTab(data: BrowserData, filters?: EquipmentFilters) {\r\n    const browser = game.pf2e.compendiumBrowser;\r\n    const tab = browser.tabs.equipment;\r\n\r\n    deleteInMemory(browser);\r\n    setInMemory(browser, data);\r\n    tab.open(filters ?? (await tab.getFilterData()));\r\n}\r\n\r\nfunction getFilters<\r\n    T extends ItemFilterType,\r\n    F extends ItemFilter = T extends \"buy\" ? ItemFilterBuy : ItemFilterSell\r\n>(actor: LootPF2e, type: T, withDefault: boolean): ExtractedFilter<F>[] {\r\n    const filters = getFlag<F[]>(actor, \"filters\", type)?.slice() ?? [];\r\n\r\n    if (withDefault) {\r\n        const defaultFilter = getFlag<Partial<F>>(actor, \"default\", type) ?? {\r\n            enabled: true,\r\n        };\r\n\r\n        filters.push({\r\n            ...defaultFilter,\r\n            id: \"default\",\r\n            name: localize(\"filters.default\", type),\r\n            enabled: defaultFilter.enabled ?? true,\r\n            locked: true,\r\n            useDefault: true,\r\n        } as F);\r\n    }\r\n\r\n    return filters.map((filter) => ({\r\n        ...filter,\r\n        name: filter.name.trim() || filter.id,\r\n        ratio: clampPriceRatio(type, filter.ratio),\r\n        purse:\r\n            typeof filter.purse === \"number\"\r\n                ? Math.max(0, filter.purse)\r\n                : type === \"buy\"\r\n                ? Infinity\r\n                : 0,\r\n    }));\r\n}\r\n\r\nfunction setFilters<\r\n    T extends ItemFilterType,\r\n    F extends ItemFilter = T extends \"buy\" ? ItemFilterBuy : ItemFilterSell\r\n>(actor: LootPF2e, type: T, filters: F[]) {\r\n    const updates = {};\r\n    const defaultIndex = filters.findIndex((filter) => filter.id === \"default\");\r\n\r\n    if (defaultIndex !== -1) {\r\n        const defaultFilter = filters.splice(defaultIndex, 1)[0];\r\n\r\n        setFlagProperty(updates, \"default\", type, {\r\n            ratio: defaultFilter.ratio,\r\n            purse: defaultFilter.purse,\r\n            enabled: defaultFilter.enabled,\r\n        });\r\n    }\r\n\r\n    setFlagProperty(updates, \"filters\", type, filters);\r\n\r\n    return actor.update(updates);\r\n}\r\n\r\nfunction clampPriceRatio(type: ItemFilterType, value: number | undefined) {\r\n    if (typeof value !== \"number\") return RATIO[type].default;\r\n    return Math.clamped(value, RATIO[type].min, RATIO[type].max).toNearest(0.1, \"floor\");\r\n}\r\n\r\ntype ItemFilterType = \"buy\" | \"sell\";\r\n\r\ntype ItemFilter = ItemFilterBuy | ItemFilterSell;\r\n\r\ntype ItemFilterBase = {\r\n    id: string;\r\n    name: string;\r\n    enabled: boolean;\r\n    locked?: true;\r\n    useDefault: boolean;\r\n    ratio?: number;\r\n    purse?: number | null;\r\n    filter: Partial<EquipmentFilters>;\r\n};\r\n\r\ntype ItemFilterBuy = ItemFilterBase & {};\r\n\r\ntype ItemFilterSell = ItemFilterBase & {};\r\n\r\ntype ExtractedFilter<F extends ItemFilter = ItemFilter> = Omit<F, \"ratio\" | \"purse\"> & {\r\n    ratio: number;\r\n    purse: number;\r\n};\r\n\r\ntype BrowserData =\r\n    | {\r\n          type: \"pull\";\r\n          actor: LootPF2e;\r\n          owned: string[];\r\n      }\r\n    | {\r\n          type: \"filter\";\r\n          actor: LootPF2e;\r\n          filterType: ItemFilterType;\r\n          edit: string | false;\r\n      };\r\n\r\nexport { config as betterMerchantTool };\r\n", "import { MODULE, userIsGM } from \"pf2e-api\";\r\nimport { onRenderSettingsConfig, registerToolsSettings } from \"./settings\";\r\nimport type { ToolConfig } from \"./tool\";\r\nimport { arpTool } from \"./tools/arp\";\r\nimport { debugTool } from \"./tools/debug\";\r\nimport { effectsPanelTool } from \"./tools/effectsPanel\";\r\nimport { givethTool } from \"./tools/giveth\";\r\nimport { heroActionsTool } from \"./tools/heroActions\";\r\nimport { noBulkTool } from \"./tools/noBulk\";\r\nimport { unidedTool } from \"./tools/unided\";\r\nimport { untargetTool } from \"./tools/untarget\";\r\nimport { templateHelperTool } from \"./tools/templateHelper\";\r\nimport { spellsSummaryTool } from \"./tools/spellsSummary\";\r\nimport { stancesTool } from \"./tools/stances\";\r\nimport { ShareTool } from \"./tools/share\";\r\nimport { targetHelperTool } from \"./tools/targetHelper\";\r\nimport { mergeDamageTool } from \"./tools/mergeDamage\";\r\nimport { hideDamageTool } from \"./tools/hideDamage\";\r\nimport { useButtonTool } from \"./tools/useButton\";\r\nimport { betterMerchantTool } from \"./tools/betterMerchant\";\r\nimport { actionableTool } from \"./tools/actionable\";\r\n\r\nMODULE.register(\"pf2e-toolbelt\", \"PF2e Toolbelt\");\r\n\r\nconst TOOLS: ToolConfig[] = [\r\n    actionableTool,\r\n    arpTool,\r\n    betterMerchantTool,\r\n    debugTool,\r\n    untargetTool,\r\n    effectsPanelTool,\r\n    givethTool,\r\n    heroActionsTool,\r\n    hideDamageTool,\r\n    mergeDamageTool,\r\n    noBulkTool,\r\n    ShareTool,\r\n    unidedTool,\r\n    spellsSummaryTool,\r\n    stancesTool,\r\n    targetHelperTool,\r\n    templateHelperTool,\r\n    useButtonTool,\r\n];\r\n\r\nHooks.once(\"init\", () => {\r\n    const isGM = userIsGM();\r\n\r\n    registerToolsSettings(TOOLS, isGM);\r\n\r\n    const module = MODULE.current;\r\n    module.api = {};\r\n\r\n    for (const { init, api, name } of TOOLS) {\r\n        init?.(isGM);\r\n\r\n        if (typeof api === \"object\") {\r\n            module.api[name] = api;\r\n        }\r\n    }\r\n});\r\n\r\nHooks.once(\"ready\", () => {\r\n    const isGM = game.user.isGM;\r\n\r\n    for (const { ready } of TOOLS) {\r\n        ready?.(isGM);\r\n    }\r\n});\r\n\r\nHooks.on(\"renderSettingsConfig\", onRenderSettingsConfig);\r\n"],
  "mappings": "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",
  "names": ["require_purry", "__commonJSMin", "exports", "__spreadArray", "to", "from", "pack", "i", "l", "ar", "purry", "fn", "args", "lazy", "diff", "arrayArgs", "ret", "__name", "data", "require_add", "__commonJSMin", "exports", "purry_1", "add", "_add", "__name", "value", "addend", "require_addProp", "__commonJSMin", "exports", "__assign", "t", "s", "i", "p", "purry_1", "addProp", "_addProp", "__name", "obj", "prop", "value", "_a", "require_allPass", "__commonJSMin", "exports", "purry_1", "allPass", "_allPass", "__name", "data", "fns", "fn", "require_anyPass", "__commonJSMin", "exports", "purry_1", "anyPass", "_anyPass", "__name", "data", "fns", "fn", "require_withPrecision", "__commonJSMin", "exports", "MAX_PRECISION", "_withPrecision", "roundingFn", "value", "precision", "multiplier", "__name", "require_ceil", "__commonJSMin", "exports", "_withPrecision_1", "purry_1", "ceil", "__name", "require_chunk", "__commonJSMin", "exports", "purry_1", "chunk", "_chunk", "__name", "array", "size", "ret", "index", "require_clamp", "__commonJSMin", "exports", "purry_1", "clamp", "_clamp", "__name", "value", "limits", "require_type", "__commonJSMin", "exports", "type", "val", "__name", "require_clone", "__commonJSMin", "exports", "type_1", "_cloneRegExp", "pattern", "__name", "_clone", "value", "refFrom", "refTo", "deep", "copy", "copiedValue", "len", "idx", "key", "clone", "require_isTruthy", "__commonJSMin", "exports", "isTruthy", "data", "__name", "require_compact", "__commonJSMin", "exports", "isTruthy_1", "compact", "items", "__name", "require_concat", "__commonJSMin", "exports", "purry_1", "concat", "_concat", "__name", "arr1", "arr2", "require_purryOn", "__commonJSMin", "exports", "__spreadArray", "to", "from", "pack", "i", "l", "ar", "purryOn", "isArg", "implementation", "args", "callArgs", "dataOrArg", "rest", "data", "__name", "require_conditional", "__commonJSMin", "exports", "_purryOn_1", "conditional", "isCase", "conditionalImplementation", "__name", "data", "cases", "_i", "_a", "cases_1", "_b", "when", "then", "maybeCase", "rest", "trivialDefaultCase", "require_countBy", "__commonJSMin", "exports", "purry_1", "_countBy", "__name", "indexed", "array", "fn", "ret", "item", "index", "value", "countBy", "require_pipe", "__commonJSMin", "exports", "pipe", "value", "operations", "_i", "ret", "lazyOps", "op", "_a", "lazy", "lazyArgs", "fn", "opIdx", "lazyOp", "lazySeq", "j", "acc", "ret_1", "item", "_processItem", "lastLazySeq", "__name", "lazyResult", "isDone", "i", "lazyFn", "indexed", "index", "items", "nextValues", "nextValues_1", "subItem", "subResult", "require_createPipe", "__commonJSMin", "exports", "__spreadArray", "to", "from", "pack", "i", "l", "ar", "pipe_1", "createPipe", "operations", "_i", "value", "__name", "require_debounce", "__commonJSMin", "exports", "debounce", "func", "_a", "waitMs", "_b", "timing", "maxWaitMs", "coolDownTimeoutId", "maxWaitTimeoutId", "latestCallArgs", "result", "handleInvoke", "__name", "timeoutId", "args", "handleCoolDownEnd", "handleDebouncedCall", "_i", "require_reduceLazy", "__commonJSMin", "exports", "_reduceLazy", "array", "lazy", "indexed", "newArray", "index", "item", "result", "__name", "require_difference", "__commonJSMin", "exports", "purry_1", "_reduceLazy_1", "difference", "_difference", "__name", "array", "other", "lazy", "set", "value", "require_differenceWith", "__commonJSMin", "exports", "purry_1", "_reduceLazy_1", "differenceWith", "_differenceWith", "__name", "array", "other", "isEquals", "lazy", "value", "otherValue", "require_divide", "__commonJSMin", "exports", "purry_1", "divide", "_divide", "__name", "value", "divisor", "require_drop", "__commonJSMin", "exports", "purry_1", "_reduceLazy_1", "drop", "_drop", "__name", "array", "n", "lazy", "left", "value", "require_swapInPlace", "__commonJSMin", "exports", "swapInPlace", "data", "i", "j", "_a", "__name", "require_heap", "__commonJSMin", "exports", "_swapInPlace_1", "heapify", "heap", "compareFn", "i", "heapSiftDown", "__name", "heapMaybeInsert", "item", "head", "index", "currentIndex", "firstChildIndex", "swapIndex", "secondChildIndex", "require_purryOrderRules", "__commonJSMin", "exports", "__spreadArray", "to", "from", "pack", "i", "l", "ar", "COMPARATORS", "x", "y", "purryOrderRules", "func", "inputArgs", "_a", "dataOrRule", "rules", "isOrderRule", "compareFn_1", "orderRuleComparer", "compareFn", "data", "__name", "purryOrderRulesWithArgument", "first", "second", "rest", "arg", "argRemoved", "args", "_i", "primaryRule", "secondaryRule", "otherRules", "projector", "direction", "comparator", "nextComparer", "a", "b", "projectedA", "projectedB", "isProjection", "maybeProjection", "maybeDirection", "require_dropFirstBy", "__commonJSMin", "exports", "__spreadArray", "to", "from", "pack", "i", "l", "ar", "_heap_1", "_purryOrderRules_1", "dropFirstBy", "dropFirstByImplementation", "__name", "data", "compareFn", "n", "heap", "out", "rest", "_i", "rest_1", "item", "previousHead", "require_dropLast", "__commonJSMin", "exports", "__spreadArray", "to", "from", "pack", "i", "l", "ar", "purry_1", "dropLast", "_dropLast", "__name", "array", "n", "copy", "require_dropLastWhile", "__commonJSMin", "exports", "purry_1", "dropLastWhile", "_dropLastWhile", "__name", "data", "predicate", "i", "require_dropWhile", "__commonJSMin", "exports", "purry_1", "dropWhile", "_dropWhile", "__name", "data", "predicate", "i", "require_equals", "__commonJSMin", "exports", "purry_1", "isArray", "keyList", "equals", "_equals", "__name", "a", "b", "arrA", "arrB", "length_1", "key", "dateA", "dateB", "regexpA", "regexpB", "keys", "require_toPairs", "__commonJSMin", "exports", "toPairs", "object", "__name", "strict", "require_evolve", "__commonJSMin", "exports", "__assign", "t", "s", "i", "p", "purry_1", "toPairs_1", "evolve", "_evolve", "__name", "data", "evolver", "result", "_a", "key", "value", "require_toLazyIndexed", "__commonJSMin", "exports", "_toLazyIndexed", "__name", "fn", "require_filter", "__commonJSMin", "exports", "purry_1", "_reduceLazy_1", "_toLazyIndexed_1", "filter", "_filter", "__name", "indexed", "array", "fn", "_lazy", "value", "index", "valid", "require_toSingle", "__commonJSMin", "exports", "_toSingle", "__name", "fn", "require_find", "__commonJSMin", "exports", "purry_1", "_toLazyIndexed_1", "_toSingle_1", "find", "_find", "__name", "indexed", "array", "fn", "x", "_lazy", "value", "index", "valid", "require_findIndex", "__commonJSMin", "exports", "purry_1", "_toLazyIndexed_1", "_toSingle_1", "findIndex", "_findIndex", "__name", "indexed", "array", "fn", "x", "_lazy", "i", "value", "index", "valid", "require_findLast", "__commonJSMin", "exports", "purry_1", "findLast", "_findLast", "__name", "indexed", "array", "fn", "i", "require_findLastIndex", "__commonJSMin", "exports", "purry_1", "findLastIndex", "_findLastIndex", "__name", "indexed", "array", "fn", "i", "require_first", "__commonJSMin", "exports", "purry_1", "first", "_first", "__name", "_a", "lazy", "value", "require_hasAtLeast", "__commonJSMin", "exports", "purry_1", "hasAtLeast", "args", "_i", "hasAtLeastImplementation", "__name", "data", "minimum", "require_firstBy", "__commonJSMin", "exports", "_purryOrderRules_1", "hasAtLeast_1", "firstBy", "firstByImplementation", "__name", "data", "compareFn", "currentFirst", "rest", "_i", "rest_1", "item", "require_flatten", "__commonJSMin", "exports", "_reduceLazy_1", "purry_1", "flatten", "_flatten", "__name", "items", "lazy", "next", "require_flatMap", "__commonJSMin", "exports", "flatten_1", "purry_1", "flatMap", "_flatMap", "__name", "array", "fn", "item", "lazy", "value", "next", "require_flatMapToObj", "__commonJSMin", "exports", "purry_1", "flatMapToObj", "_flatMapToObj", "__name", "indexed", "array", "fn", "result", "element", "index", "items", "_a", "key", "value", "require_flattenDeep", "__commonJSMin", "exports", "_reduceLazy_1", "purry_1", "flattenDeep", "_flattenDeep", "__name", "items", "_flattenDeepValue", "value", "ret", "item", "lazy", "next", "require_floor", "__commonJSMin", "exports", "_withPrecision_1", "purry_1", "floor", "__name", "require_forEach", "__commonJSMin", "exports", "purry_1", "_reduceLazy_1", "_toLazyIndexed_1", "forEach", "_forEach", "__name", "indexed", "array", "fn", "_lazy", "value", "index", "require_forEachObj", "__commonJSMin", "exports", "purry_1", "forEachObj", "_forEachObj", "__name", "indexed", "object", "fn", "key", "val", "require_fromPairs", "__commonJSMin", "exports", "fromPairs", "entries", "out", "_i", "entries_1", "_a", "key", "value", "__name", "require_groupBy", "__commonJSMin", "exports", "purry_1", "groupBy", "_groupBy", "__name", "indexed", "array", "fn", "ret", "item", "index", "key", "actualKey", "require_identity", "__commonJSMin", "exports", "identity", "value", "__name", "require_indexBy", "__commonJSMin", "exports", "purry_1", "indexBy", "_indexBy", "__name", "indexed", "array", "fn", "ret", "item", "index", "value", "key", "indexByStrict", "_indexByStrict", "require_intersection", "__commonJSMin", "exports", "purry_1", "_reduceLazy_1", "intersection", "_intersection", "__name", "array", "other", "lazy", "value", "set", "require_intersectionWith", "__commonJSMin", "exports", "_reduceLazy_1", "purry_1", "intersectionWith", "_intersectionWith", "__name", "array", "other", "comparator", "lazy", "value", "otherValue", "require_invert", "__commonJSMin", "exports", "purry_1", "invert", "_invert", "__name", "object", "result", "key", "require_isArray", "__commonJSMin", "exports", "isArray", "data", "__name", "require_isBoolean", "__commonJSMin", "exports", "isBoolean", "data", "__name", "require_isDate", "__commonJSMin", "exports", "isDate", "data", "__name", "require_isDefined", "__commonJSMin", "exports", "isDefined", "data", "__name", "strict", "require_isObject", "__commonJSMin", "exports", "isObject", "data", "__name", "require_isString", "__commonJSMin", "exports", "isString", "data", "__name", "require_isEmpty", "__commonJSMin", "exports", "isArray_1", "isObject_1", "isString_1", "isEmpty", "data", "__name", "require_isError", "__commonJSMin", "exports", "isError", "data", "__name", "require_isFunction", "__commonJSMin", "exports", "isFunction", "data", "__name", "require_isNil", "__commonJSMin", "exports", "isNil", "data", "__name", "require_isNonNull", "__commonJSMin", "exports", "isNonNull", "data", "__name", "require_isNot", "__commonJSMin", "exports", "isNot", "predicate", "data", "__name", "require_isNumber", "__commonJSMin", "exports", "isNumber", "data", "__name", "require_isObjectType", "__commonJSMin", "exports", "isObjectType", "__name", "data", "require_isPlainObject", "__commonJSMin", "exports", "isPlainObject", "data", "proto", "__name", "require_isPromise", "__commonJSMin", "exports", "isPromise", "data", "__name", "require_isSymbol", "__commonJSMin", "exports", "isSymbol", "data", "__name", "require_join", "__commonJSMin", "exports", "purry_1", "join", "joinImplementation", "__name", "data", "glue", "require_keys", "__commonJSMin", "exports", "keys", "source", "__name", "require_last", "__commonJSMin", "exports", "purry_1", "last", "_last", "__name", "array", "require_length", "__commonJSMin", "exports", "purry_1", "length", "_length", "__name", "items", "require_map", "__commonJSMin", "exports", "purry_1", "_reduceLazy_1", "_toLazyIndexed_1", "map", "_map", "__name", "indexed", "array", "fn", "_lazy", "value", "index", "require_mapKeys", "__commonJSMin", "exports", "mapKeys", "arg1", "arg2", "data", "_mapKeys", "__name", "obj", "fn", "acc", "key", "require_mapToObj", "__commonJSMin", "exports", "purry_1", "mapToObj", "_mapToObj", "__name", "indexed", "array", "fn", "result", "element", "index", "_a", "key", "value", "require_mapValues", "__commonJSMin", "exports", "mapValues", "arg1", "arg2", "data", "_mapValues", "__name", "obj", "fn", "acc", "key", "require_maxBy", "__commonJSMin", "exports", "purry_1", "_maxBy", "__name", "indexed", "array", "fn", "ret", "retMax", "item", "i", "max", "maxBy", "require_meanBy", "__commonJSMin", "exports", "purry_1", "_meanBy", "__name", "indexed", "array", "fn", "sum", "item", "i", "meanBy", "require_merge", "__commonJSMin", "exports", "purry_1", "merge", "_merge", "__name", "a", "b", "require_mergeAll", "__commonJSMin", "exports", "__assign", "t", "s", "i", "p", "mergeAll", "items", "acc", "x", "__name", "require_mergeDeep", "__commonJSMin", "exports", "__assign", "t", "s", "i", "p", "purry_1", "mergeDeep", "mergeDeepImplementation", "__name", "destination", "source", "output", "key", "destinationValue", "isRecord", "sourceValue", "object", "require_minBy", "__commonJSMin", "exports", "purry_1", "_minBy", "__name", "indexed", "array", "fn", "ret", "retMin", "item", "i", "min", "minBy", "require_multiply", "__commonJSMin", "exports", "purry_1", "multiply", "_multiply", "__name", "value", "multiplicand", "require_noop", "__commonJSMin", "exports", "noop", "__name", "require_quickSelect", "__commonJSMin", "exports", "__spreadArray", "to", "from", "pack", "i", "l", "ar", "_swapInPlace_1", "quickSelect", "__name", "data", "index", "compareFn", "quickSelectImplementation", "left", "right", "pivotIndex", "partition", "pivot", "j", "require_nthBy", "__commonJSMin", "exports", "_purryOrderRules_1", "_quickSelect_1", "nthBy", "nthByImplementation", "__name", "data", "compareFn", "index", "require_objOf", "__commonJSMin", "exports", "purry_1", "objOf", "_objOf", "__name", "value", "key", "_a", "require_omit", "__commonJSMin", "exports", "__assign", "t", "s", "i", "p", "__rest", "e", "fromPairs_1", "purry_1", "omit", "_omit", "__name", "data", "propNames", "propName", "_a", "_b", "omitted", "remaining", "asSet", "key", "require_omitBy", "__commonJSMin", "exports", "purry_1", "omitBy", "_omitBy", "__name", "object", "fn", "acc", "key", "require_once", "__commonJSMin", "exports", "once", "fn", "called", "ret", "__name", "require_only", "__commonJSMin", "exports", "purry_1", "only", "_only", "__name", "array", "require_partition", "__commonJSMin", "exports", "purry_1", "partition", "_partition", "__name", "indexed", "array", "fn", "ret", "item", "index", "matches", "require_pathOr", "__commonJSMin", "exports", "purry_1", "pathOr", "_pathOr", "__name", "object", "path", "defaultValue", "current", "_i", "path_1", "prop", "require_pick", "__commonJSMin", "exports", "purry_1", "pick", "_pick", "__name", "object", "names", "acc", "name", "require_pickBy", "__commonJSMin", "exports", "purry_1", "pickBy", "_pickBy", "__name", "object", "fn", "acc", "key", "require_prop", "__commonJSMin", "exports", "prop", "__name", "propName", "_a", "_b", "value", "require_range", "__commonJSMin", "exports", "purry_1", "range", "_range", "__name", "start", "end", "ret", "i", "require_randomString", "__commonJSMin", "exports", "range_1", "randomString", "length", "characterSet", "randomChar", "__name", "text", "require_rankBy", "__commonJSMin", "exports", "_purryOrderRules_1", "rankBy", "rankByImplementation", "__name", "data", "compareFn", "targetItem", "rank", "_i", "data_1", "item", "require_reduce", "__commonJSMin", "exports", "purry_1", "reduce", "_reduce", "__name", "indexed", "items", "fn", "initialValue", "acc", "item", "index", "require_reject", "__commonJSMin", "exports", "purry_1", "_reduceLazy_1", "_toLazyIndexed_1", "reject", "_reject", "__name", "indexed", "array", "fn", "_lazy", "value", "index", "valid", "require_reverse", "__commonJSMin", "exports", "purry_1", "reverse", "_reverse", "__name", "array", "require_round", "__commonJSMin", "exports", "_withPrecision_1", "purry_1", "round", "__name", "require_sample", "__commonJSMin", "exports", "purry_1", "sample", "args", "_i", "sampleImplementation", "__name", "data", "sampleSize", "actualSampleSize", "sampleIndices", "randomIndex", "a", "b", "index", "_", "require_set", "__commonJSMin", "exports", "__assign", "t", "s", "i", "p", "purry_1", "set", "_set", "__name", "obj", "prop", "value", "_a", "require_setPath", "__commonJSMin", "exports", "__assign", "t", "s", "i", "p", "purry_1", "setPath", "_setPath", "__name", "object", "path", "value", "_a", "item", "index", "require_shuffle", "__commonJSMin", "exports", "purry_1", "shuffle", "_shuffle", "__name", "items", "result", "index", "rand", "value", "require_sliceString", "__commonJSMin", "exports", "sliceString", "__name", "indexStart", "indexEnd", "data", "require_sort", "__commonJSMin", "exports", "__spreadArray", "to", "from", "pack", "i", "l", "ar", "purry_1", "sort", "_sort", "__name", "items", "cmp", "ret", "require_sortBy", "__commonJSMin", "exports", "__spreadArray", "to", "from", "pack", "i", "l", "ar", "_purryOrderRules_1", "sortBy", "_sortBy", "__name", "data", "compareFn", "require_binarySearchCutoffIndex", "__commonJSMin", "exports", "_binarySearchCutoffIndex", "array", "predicate", "lowIndex", "highIndex", "pivotIndex", "pivot", "__name", "require_sortedIndex", "__commonJSMin", "exports", "purry_1", "_binarySearchCutoffIndex_1", "sortedIndex", "sortedIndexImplementation", "__name", "array", "item", "pivot", "require_sortedIndexBy", "__commonJSMin", "exports", "purry_1", "_binarySearchCutoffIndex_1", "sortedIndexBy", "sortedIndexByImplementation", "__name", "indexed", "array", "item", "valueFunction", "value", "pivot", "index", "require_sortedIndexWith", "__commonJSMin", "exports", "purry_1", "_binarySearchCutoffIndex_1", "sortedIndexWith", "__name", "indexed", "require_sortedLastIndex", "__commonJSMin", "exports", "purry_1", "_binarySearchCutoffIndex_1", "sortedLastIndex", "sortedLastIndexImplementation", "__name", "array", "item", "pivot", "require_sortedLastIndexBy", "__commonJSMin", "exports", "purry_1", "_binarySearchCutoffIndex_1", "sortedLastIndexBy", "sortedLastIndexByImplementation", "__name", "indexed", "array", "item", "valueFunction", "value", "pivot", "index", "require_splice", "__commonJSMin", "exports", "__spreadArray", "to", "from", "pack", "i", "l", "ar", "purry_1", "splice", "_splice", "__name", "items", "start", "deleteCount", "replacement", "result", "require_splitAt", "__commonJSMin", "exports", "__spreadArray", "to", "from", "pack", "i", "l", "ar", "purry_1", "splitAt", "_splitAt", "__name", "array", "index", "copy", "tail", "require_splitWhen", "__commonJSMin", "exports", "splitAt_1", "purry_1", "splitWhen", "_splitWhen", "__name", "array", "fn", "i", "require_stringToPath", "__commonJSMin", "exports", "__spreadArray", "to", "from", "pack", "i", "l", "ar", "stringToPath", "path", "_stringToPath", "__name", "_a", "match", "key", "rest", "require_subtract", "__commonJSMin", "exports", "purry_1", "subtract", "_subtract", "__name", "value", "subtrahend", "require_sumBy", "__commonJSMin", "exports", "purry_1", "_sumBy", "__name", "indexed", "array", "fn", "sum", "item", "i", "summand", "sumBy", "require_swapIndices", "__commonJSMin", "exports", "purry_1", "swapIndices", "_swapIndices", "__name", "item", "index1", "index2", "_swapString", "_swapArray", "result", "positiveIndexA", "positiveIndexB", "require_swapProps", "__commonJSMin", "exports", "__assign", "t", "s", "i", "p", "purry_1", "swapProps", "_swapProps", "__name", "obj", "key1", "key2", "_a", "_b", "_c", "value1", "_d", "value2", "require_take", "__commonJSMin", "exports", "purry_1", "_reduceLazy_1", "take", "_take", "__name", "array", "n", "lazy", "value", "require_takeFirstBy", "__commonJSMin", "exports", "__spreadArray", "to", "from", "pack", "i", "l", "ar", "_heap_1", "_purryOrderRules_1", "takeFirstBy", "takeFirstByImplementation", "__name", "data", "compareFn", "n", "heap", "rest", "_i", "rest_1", "item", "require_takeLastWhile", "__commonJSMin", "exports", "purry_1", "takeLastWhile", "_takeLastWhile", "__name", "data", "predicate", "i", "require_takeWhile", "__commonJSMin", "exports", "purry_1", "takeWhile", "_takeWhile", "__name", "array", "fn", "ret", "_i", "array_1", "item", "require_tap", "__commonJSMin", "exports", "purry_1", "tap", "_tap", "__name", "value", "fn", "require_times", "__commonJSMin", "exports", "purry_1", "times", "_times", "__name", "count", "fn", "res", "i", "require_uniq", "__commonJSMin", "exports", "purry_1", "_reduceLazy_1", "uniq", "_uniq", "__name", "array", "lazy", "set", "value", "require_uniqBy", "__commonJSMin", "exports", "purry_1", "_reduceLazy_1", "uniqBy", "_uniqBy", "lazyUniqBy", "__name", "array", "transformer", "set", "value", "appliedItem", "require_uniqWith", "__commonJSMin", "exports", "purry_1", "_reduceLazy_1", "_toLazyIndexed_1", "uniqWith", "_uniqWith", "__name", "array", "isEquals", "lazy", "_lazy", "value", "index", "otherValue", "require_values", "__commonJSMin", "exports", "values", "source", "__name", "require_zip", "__commonJSMin", "exports", "purry_1", "zip", "_zip", "__name", "first", "second", "resultLength", "result", "require_zipObj", "__commonJSMin", "exports", "purry_1", "zipObj", "_zipObj", "__name", "first", "second", "resultLength", "result", "require_zipWith", "__commonJSMin", "exports", "zipWith", "args", "f", "s", "_zipWith", "__name", "first", "second", "fn", "resultLength", "result", "i", "require_commonjs", "__commonJSMin", "exports", "__createBinding", "o", "m", "k", "k2", "desc", "__exportStar", "p", "require_actor", "__commonJSMin", "exports", "isPlayedActor", "actor", "__name", "getHighestName", "getOwner", "isValidUser", "user", "owners", "a", "b", "isOwner", "require_application", "__commonJSMin", "exports", "openApplication", "constructor", "args", "id", "app", "a", "__name", "refreshApplication", "canRender", "force", "renderApplication", "require_array", "__commonJSMin", "exports", "__createBinding", "o", "m", "k", "k2", "desc", "__setModuleDefault", "v", "__importStar", "mod", "result", "R", "arrayIncludesOne", "array", "other", "value", "__name", "compareArrays", "arr1", "arr2", "unique", "value1", "index", "value2", "getOnly", "collection", "condition", "isArray", "require_canvas", "__commonJSMin", "exports", "getDropTarget", "canvas", "data", "filter", "a", "b", "token", "maximumX", "maximumY", "__name", "require_chat", "__commonJSMin", "exports", "createChatLink", "docOrUuid", "label", "html", "isDocument", "link", "__name", "latestChatMessages", "nb", "fromMessage", "chat", "messages", "start", "m", "i", "message", "li", "refreshLatestMessages", "require_delay", "__commonJSMin", "exports", "createTimeout", "callback", "delay", "timeoutId", "cancel", "__name", "fn", "args", "require_dialog", "__commonJSMin", "exports", "_1", "waitDialog", "options", "yesIcon", "noIcon", "buttons", "content", "__name", "require_document", "__commonJSMin", "exports", "getSourceId", "doc", "__name", "includesSourceId", "list", "sourceId", "getSourceIdCondition", "item", "getSortBounds", "collection", "min", "max", "entry", "require_event_manager", "__commonJSMin", "exports", "withEventManager", "constructor", "_id", "_listeners", "event", "listener", "options", "id", "findFn", "x", "index", "args", "listeners", "once", "context", "__name", "require_flags", "__commonJSMin", "exports", "__createBinding", "o", "m", "k", "k2", "desc", "__setModuleDefault", "v", "__importStar", "mod", "result", "R", "_1", "getFlag", "doc", "path", "__name", "setFlag", "args", "value", "unsetFlag", "flagPath", "updateFlag", "updates", "pathed", "key", "updateSourceFlag", "getFlagProperty", "obj", "setFlagProperty", "getModuleFlag", "hasModuleFlag", "unsetMofuleFlag", "require_handlebars", "__commonJSMin", "exports", "_1", "templatePath", "path", "__name", "render", "args", "data", "require_hooks", "__commonJSMin", "exports", "registerUpstreamHook", "event", "listener", "id", "index", "x", "hooked", "__name", "createHook", "hook", "hookId", "enabled", "require_html", "__commonJSMin", "exports", "htmlElement", "el", "__name", "isCheckboxElement", "createHTMLFromString", "content", "wrap", "tmp", "children", "applyHtmlMethod", "fn", "context", "fnc", "insertHTMLFromString", "parent", "prepend", "html", "appendHTMLFromString", "prependHTMLFromString", "beforeHTMLFromString", "element", "afterHTMLFromString", "addListener", "selector", "arg1", "arg2", "arg3", "event", "listener", "useCapture", "e", "addListenerAll", "elements", "querySelector", "querySelectorArray", "queryInClosest", "parentSelector", "childSelector", "closest", "queryInParent", "parentElement", "elementData", "dataToDatasetString", "data", "key", "value", "stringified", "require_item", "__commonJSMin", "exports", "_1", "getItems", "actor", "itemTypes", "types", "type", "__name", "hasItemWithSourceId", "sourceId", "getItemWithSourceId", "require_localize", "__commonJSMin", "exports", "_1", "localize", "args", "data", "path", "__name", "localizeIfExist", "hasLocalization", "localizePath", "templateLocalize", "subKey", "fn", "key", "hash", "joinedKey", "subLocalize", "str", "arg1", "arg2", "localeCompare", "a", "b", "require_module", "__commonJSMin", "exports", "_1", "MODULE_ID", "MODULE_NAME", "MODULE", "str", "error", "message", "path", "id", "name", "getActiveModule", "module", "__name", "require_keybindings", "__commonJSMin", "exports", "localize_1", "module_1", "registerKeybind", "name", "data", "__name", "require_libwrapper", "__commonJSMin", "exports", "_1", "registerWrapper", "path", "fn", "type", "ids", "paths", "key", "id", "__name", "unregisterWrapper", "createWrapper", "callback", "options", "wrapperId", "enabled", "require_notifications", "__commonJSMin", "exports", "_1", "notify", "str", "arg1", "arg2", "arg3", "type", "data", "permanent", "__name", "warn", "info", "error", "require_object", "__commonJSMin", "exports", "module_1", "AsyncFunction", "isInstanceOf", "obj", "name", "cursor", "__name", "getInMemory", "path", "setInMemory", "args", "value", "getInMemoryAndSetIfNot", "current", "result", "deleteInMemory", "split", "x", "last", "key", "require_settings", "__commonJSMin", "exports", "__createBinding", "o", "m", "k", "k2", "desc", "__setModuleDefault", "v", "__importStar", "mod", "result", "R", "_1", "registerSetting", "options", "choice", "settingPath", "__name", "registerSettingMenu", "path", "getSetting", "key", "setSetting", "value", "isClientSetting", "setting", "isWorldSetting", "isMenuSetting", "require_socket", "__commonJSMin", "exports", "module_1", "socketOn", "callback", "__name", "socketOff", "socketEmit", "packet", "require_string", "__commonJSMin", "exports", "__createBinding", "o", "m", "k", "k2", "desc", "__setModuleDefault", "v", "__importStar", "mod", "result", "R", "joinStr", "separator", "path", "x", "__name", "safeSplit", "str", "selector", "s", "beautity", "_", "c", "stringBoolean", "b", "stringNumber", "n", "require_user", "__commonJSMin", "exports", "getCurrentUser", "x", "__name", "isActiveGM", "userIsGM", "user", "hasGMOnline", "require_dist", "__commonJSMin", "exports", "__createBinding", "o", "m", "k", "k2", "desc", "__exportStar", "p", "isOfType", "variable", "types", "type", "__name", "foundry_api_exports", "__export", "R", "init_foundry_api", "__esmMin", "__reExport", "require_utils", "__commonJSMin", "exports", "foundry_api_1", "ErrorPF2e", "message", "__name", "objectHasKey", "obj", "key", "tupleHasValue", "array", "value", "setHasElement", "set", "ordinalString", "pluralRules", "suffix", "htmlClosest", "child", "selectors", "htmlQuery", "parent", "localizer", "prefix", "formatArgs", "traitSlugToObject", "trait", "dictionary", "traitObject", "actionGlyphMap", "getActionGlyph", "action", "sanitized", "extractNotes", "rollNotes", "s", "createHTMLElement", "nodeName", "classes", "dataset", "children", "innerHTML", "element", "v", "childElement", "require_actor", "__commonJSMin", "exports", "foundry_api_1", "utils_1", "transferItemToActor", "targetActor", "item", "quantity", "containerId", "newStack", "container", "newQuantity", "newItemData", "__name", "resetActors", "actors", "options", "s", "t", "actor", "scenes", "a", "scene", "token", "require_application", "__commonJSMin", "exports", "foundry_api_1", "renderApplication", "type", "types", "apps", "app", "x", "__name", "renderActorSheets", "renderCharacterSheets", "renderItemSheets", "require_browser", "__commonJSMin", "exports", "getTabFilterData", "tabName", "tab", "__name", "filterTraits", "traits", "selected", "condition", "selectedTraits", "s", "notTraits", "t", "require_rules", "__commonJSMin", "exports", "extractEphemeralEffects", "affects", "origin", "target", "item", "domains", "options", "effectsFrom", "effectsTo", "fullOptions", "resolvables", "s", "d", "e", "__name", "require_chat", "__commonJSMin", "exports", "foundry_api_1", "utils_1", "rules_1", "createTradeContent", "message", "img", "__name", "createTradeMessage", "subtitle", "actor", "item", "senderId", "content", "createManipulationMessage", "createManipulateFlavor", "applyDamageFromMessage", "multiplier", "addend", "promptModifier", "rollIndex", "tokens", "onDamageApplied", "shiftAdjustDamage", "html", "shieldBlockRequest", "roll", "damage", "messageRollOptions", "originRollOptions", "o", "messageItem", "effectRollOptions", "token", "domain", "ephemeralEffects", "contextClone", "rollOptions", "toggleOffShieldBlock", "AdjustmentDialog", "$html", "isHealing", "$dialog", "adjustment", "messageId", "app", "selector", "button", "onClickShieldBlock", "shieldButton", "messageEl", "getTokens", "getNonBrokenShields", "t", "s", "nonBrokenShields", "hasMultipleShields", "shieldActivated", "instance", "_helper", "contentEl", "multipleShields", "listEl", "shieldList", "shield", "input", "shieldName", "hardness", "hardnessLabel", "itemLi", "selfApplyEffectFromMessage", "target", "effect", "traits", "effectSource", "parsedMessageContent", "container", "buttons", "span", "anchor", "statement", "require_classes", "__commonJSMin", "exports", "getStatisticClass", "statistic", "__name", "getSpellCollectionClass", "actor", "getSpellClass", "getDamageRollClass", "Roll", "require_data", "__commonJSMin", "exports", "saveTypes", "require_effect", "__commonJSMin", "exports", "DURATION_UNITS", "calculateRemainingDuration", "effect", "durationData", "fightyActor", "isExpired", "start", "combatant", "unit", "expiry", "duration", "addend", "remaining", "result", "startInitiative", "currentInitiative", "atTurnStart", "__name", "require_item", "__commonJSMin", "exports", "foundry_api_1", "classes_1", "utils_1", "HANDWRAPS_SLUG", "BANDS_OF_FORCE_SLUGS", "getAnnotationLabel", "annotation", "hands", "fullAnnotation", "__name", "getCarryTypeActionData", "item", "action", "container", "usage", "changeCarryType", "actor", "handsHeld", "actionCost", "carryType", "templates", "sluggify", "actionKey", "annotationKey", "fullAnnotationKey", "flavorAction", "traits", "message", "flavor", "content", "token", "hasFreePropertySlot", "potency", "getEquippedHandwraps", "weapon", "category", "slug", "equipped", "identification", "invested", "inSlot", "calculateItemPrice", "quantity", "ratio", "coins", "consumeItem", "event", "uses", "multiUse", "key", "flags", "speaker", "template", "contentHTML", "DamageRoll", "formula", "type", "kind", "quantityRemaining", "isPreservedAmmo", "MoveLootPopup", "object", "options", "callback", "prompt", "buttonLabel", "_event", "formData", "require_notes", "__commonJSMin", "exports", "utils_1", "RollNotePF2e", "_RollNotePF2e", "__name", "params", "notes", "n", "element", "strong", "require_spell", "__commonJSMin", "exports", "foundry_api_1", "_1", "EFFECT_AREA_SHAPES", "MAGIC_TRADITIONS", "getStatisticData", "statistic", "data", "modifier", "__name", "createStatisticFromRawData", "actor", "Statistic", "statisticData", "upgradeStatisticRank", "rank", "createCounteractStatistic", "ability", "baseModifier", "m", "getHighestSyntheticStatistic", "withClassDcs", "synthetics", "statistics", "classStatistic", "groupedStatistics", "highestMod", "getHighestSpellcastingStatistic", "entries", "classAttribute", "groupedEntries", "entry", "x", "highestResults", "getActorMaxRank", "getRankLabel", "coerceToSpellGroupId", "value", "numericValue", "spellSlotGroupIdToNumber", "groupId", "warnInvalidDrop", "warning", "spell", "localize", "spellRank", "targetRank", "locKey", "type", "getSummarizedSpellsDataForRender", "sortByType", "spells", "focusPool", "pf2eDailies", "labels", "hasFocusCantrip", "entryId", "entryDc", "entryTooltip", "isFocus", "isRitual", "isCharges", "isStaff", "isInnate", "isPrepared", "isSpontaneous", "isFlexible", "consumable", "group", "groupNumber", "slotSpells", "isCantrip", "isBroken", "groupUses", "slotId", "active", "spellId", "uses", "sort", "a", "b", "i", "require_spell_consumables", "__commonJSMin", "exports", "foundry_api_1", "_1", "CANTRIP_DECK_ID", "scrollCompendiumIds", "wandCompendiumIds", "SPELL_CONSUMABLE_NAME_TEMPLATES", "getIdForSpellConsumable", "type", "heightenedLevel", "__name", "getNameForSpellConsumable", "spellName", "templateId", "createConsumableFromSpell", "spell", "mystified", "temp", "itemName", "itemImg", "pack", "p", "itemId", "consumable", "consumableSource", "traits", "t", "description", "paragraphElement", "containerElement", "hrElement", "require_skills", "__commonJSMin", "exports", "SKILL_ABBREVIATIONS", "SKILL_DICTIONARY", "SKILL_EXPANDED", "ATTRIBUTE_ABBREVIATIONS", "SKILL_LONG_FORMS", "TRANSLATED_SKILL", "getTranslatedSkills", "key", "value", "__name", "require_template", "__commonJSMin", "exports", "getTemplateTokens", "measuredTemplate", "collisionOrigin", "collisionType", "grid", "dimensions", "template", "gridHighlight", "origin", "tokens", "gridSize", "containedTokens", "token", "tokenDoc", "tokenPositions", "h", "tokenX", "y", "w", "position", "gx", "gy", "s", "destination", "__name", "require_dist", "__commonJSMin", "exports", "__createBinding", "o", "m", "k", "k2", "desc", "__exportStar", "p", "pf2e_api_exports", "__export", "R", "init_foundry_api", "__reExport", "foundry_api_exports", "firstSettings", "onRenderSettingsConfig", "app", "$html", "html", "tab", "tool", "key", "group", "title", "groups", "settingId", "label", "__name", "registerToolsSettings", "tools", "isGM", "name", "settings", "setting", "firstSetting", "createSharedWrapper", "path", "callback", "wrapperId", "listeners", "wrapper", "__name", "wrapped", "args", "error", "wrapFn", "id", "enabled", "CHARACTER_SHEET_RENDER", "CHARACTER_SHEET_RENDER_INNER", "CHARACTER_SHEET_ACTIVATE_LISTENERS", "characterSheetWrappers", "createSharedWrapper", "characterSheetPF2eRender", "characterSheetPF2eRenderInner", "characterSheetPF2eActivateListeners", "listeners", "wrapped", "args", "hasValidCharacter", "listener", "__name", "data", "$html", "html", "sheet", "actor", "WEAPON_PREPARE_BASE_DATA", "WEAPON_PREPARE_DERIVED_DATA", "ARMOR_PREPARE_BASE_DATA", "ARMOR_PREPARE_DERIVED_DATA", "prepareDocumentWrappers", "createSharedWrapper", "prepareBaseData", "listeners", "wrapped", "listener", "__name", "TEXTEDITOR_ENRICH_HTML", "textEditorWrappers", "createSharedWrapper", "textEditorEnrichHTML", "listeners", "wrapped", "content", "options", "enriched", "listener", "__name", "CHATMESSAGE_GET_HTML", "chatMessageWrappers", "createSharedWrapper", "chatMessageGetHTML", "listeners", "wrapped", "$html", "html", "listener", "__name", "sharedWrappers", "characterSheetWrappers", "prepareDocumentWrappers", "textEditorWrappers", "chatMessageWrappers", "createTool", "config", "settings", "R", "acc", "setting", "toolName", "toolHooks", "createToolHooks", "hook", "hooks", "toolWrappers", "createToolWrappers", "wrapper", "wrappers", "localize", "__name", "template", "dialogOptions", "applicationOptions", "translate", "data", "$html", "html", "path", "doc", "args", "obj", "createToolSocket", "key", "type", "callback", "wrapperId", "enabled", "wrapped", "error", "wrapFn", "wrappersMap", "event", "listener", "isUpstream", "hookId", "hooksMap", "socketEnabled", "onSocket", "packet", "userId", "config", "localize", "settings", "hook", "wrappers", "createTool", "onRenderPhysicalItemSheetPF2e", "WEAPON_PREPARE_BASE_DATA", "weaponPrepareBaseData", "WEAPON_PREPARE_DERIVED_DATA", "weaponPrepareDerivedData", "ARMOR_PREPARE_BASE_DATA", "armorPrepareBaseData", "ARMOR_PREPARE_DERIVED_DATA", "armorPrepareDerivedData", "isGM", "WEAPON_POTENCY_PRICE", "WEAPON_STRIKING_PRICE", "ARMOR_POTENCY_PRICE", "ARMOR_RESILIENCY_PRICE", "isValidActor", "actor", "isCharacter", "__name", "isShieldWeapon", "weapon", "isValidWeapon", "traits", "group", "category", "slug", "isValidArmor", "armor", "level", "forceUpdate", "expectedPotency", "expectedStriking", "wrapped", "coins", "potency", "striking", "newPrice", "expectedResilient", "resiliency", "sheet", "$html", "item", "runesSection", "lookups", "x", "groups", "config", "settings", "hooks", "createTool", "value", "onRender", "app", "$html", "html", "event", "obj", "type", "i", "variable", "__name", "debouncedSetup", "setup", "localize", "config", "settings", "hook", "createTool", "onRenderEffectsPanel", "__name", "panel", "$html", "actor", "effectsPanels", "removeRow", "editIcon", "effectsPanel", "itemId", "effect", "event", "el", "onRemoveEffect", "h1", "onEditCondition", "getEffect", "target", "effectEl", "debouncedSetup", "setup", "config", "localize", "socket", "settings", "hook", "createTool", "onDropCanvasData", "giveth", "isGM", "enabled", "__name", "canvas", "data", "item", "origin", "isValidActor", "target", "token", "actor", "quantity", "socketPacket", "stackable", "newStack", "itemId", "originId", "targetId", "senderId", "tradedQuantity", "newItem", "message", "excludeId", "TABLE_UUID", "JOURNAL_UUID", "config", "settings", "localize", "wrappers", "socket", "waitDialog", "render", "getFlag", "setFlag", "setFlagProperty", "createTool", "value", "CHARACTER_SHEET_RENDER_INNER", "characterSheetPF2eRenderInner", "CHARACTER_SHEET_ACTIVATE_LISTENERS", "characterSheetPF2eActivateListeners", "canTrade", "discardHeroActions", "drawHeroAction", "drawHeroActions", "getDeckTable", "getHeroActionDetails", "getHeroActions", "giveHeroActions", "removeHeroActions", "sendActionToChat", "tradeHeroAction", "usesCountVariant", "useHeroAction", "packet", "senderId", "onTradeRequest", "onTradeError", "onTradeRejected", "onTradeAccepted", "enabled", "__name", "html", "actor", "actions", "usesCount", "heroPoints", "diff", "mustDiscard", "mustDraw", "template", "tab", "attacks", "list", "addActionListener", "action", "callback", "event", "el", "actionEl", "uuid", "onDiscardAction", "onExpandAction", "isValidActor", "getTradeDataFromPacket", "sender", "receiver", "senderActions", "receiverActions", "senderActionIndex", "x", "receiverActionIndex", "data", "exchangeHeroActions", "isPrivate", "translate", "content", "rows", "name", "i", "give", "want", "app", "others", "targetId", "rightEls", "rightEl", "target", "actionUuid", "targetActionUUid", "targetActions", "trader1", "trader2", "trader1Action", "trader2Action", "setHeroActions", "createActionsMessage", "summaryEl", "details", "text", "descEl", "points", "index", "updates", "document", "parent", "page", "toDiscard", "discarded", "uuids", "removed", "drawn", "count", "nb", "label", "other", "links", "table", "result", "draw", "documentUuidFromTableResult", "getLabelfromTableResult", "getTableFromUuid", "getDefaultWorldTable", "isUnique", "actionsList", "selected", "asDrawn", "withMessage", "tableUpdates", "key", "onRender", "allInput", "actorInputs", "allChecked", "actorInput", "actorsChecked", "actors", "R", "input", "config", "settings", "wrappers", "createTool", "actorPrepareEmbeddedDocuments", "treasurePreparedBaseData", "wrapped", "InventoryBulkClass", "_value", "item", "__name", "config", "settings", "hooks", "createTool", "value", "onPrecreateItem", "onPreUpdateItem", "item", "__name", "data", "debouncedSetup", "setup", "config", "settings", "hook", "createTool", "onUpdateCombat", "__name", "combat", "data", "user", "config", "settings", "hook", "waitDialog", "createTool", "value", "onCreateMeasuredTemplate", "template", "context", "userId", "user", "actor", "self", "html", "target", "targetNeutral", "targetSelf", "alliance", "opposition", "targetsIds", "token", "targetAlliance", "dismissSetting", "__name", "config", "settings", "wrappers", "localize", "render", "createTool", "value", "CHARACTER_SHEET_RENDER_INNER", "characterSheetPF2eRenderInner", "CHARACTER_SHEET_ACTIVATE_LISTENERS", "characterSheetPF2eActivateListeners", "html", "data", "actor", "entries", "summarizedData", "tab", "nav", "spellcastingTab", "getSpellcastingTab", "knownSpellsTab", "knownSpellsNav", "__name", "event", "el", "toggleSpellcastingTab", "pf2eDailies", "spellsSummaryTab", "navIcon", "spellcastingNav", "tabName", "OPENING_STANCE", "REPLACERS", "EXTRAS", "config", "settings", "hooks", "wrappers", "localize", "render", "waitDialog", "createTool", "value", "onPreDeleteCombatant", "onCreateCombatant", "onDeleteCombatant", "CHARACTER_SHEET_RENDER_INNER", "characterSheetPF2eRenderInner", "CHARACTER_SHEET_ACTIVATE_LISTENERS", "characterSheetPF2eActivateListeners", "canUseStances", "getStances", "isValidStance", "toggleStance", "enabled", "html", "data", "actor", "stances", "encounterTab", "getEncounterTab", "template", "__name", "event", "el", "uuid", "combatant", "effects", "getStanceEffects", "effectID", "addStance", "effectUUID", "force", "stance", "effect", "source", "item", "token", "replaced", "feat", "replacer", "extra", "existingEffect", "foundAction", "characterShareOptions", "npcShareOptions", "config", "settings", "hooks", "wrappers", "localize", "render", "getFlag", "unsetFlag", "flagPath", "getFlagProperty", "getInMemory", "setInMemory", "createTool", "documentSheetRenderInner", "actorPrepareBaseData", "actorPrepareDerivedData", "actorPrepareData", "combatantStartTurn", "combatantEndTurn", "combatResetActors", "effectRemainingDuration", "WEAPON_PREPARE_BASE_DATA", "weaponPrepareBaseData", "onUpdateActor", "onDeleteActor", "isGM", "enabled", "wrapped", "args", "$html", "actor", "masters", "getSlaves", "x", "isValidMaster", "groups", "group", "html", "template", "btn", "__name", "master", "getMasterAndConfig", "weapon", "R", "item", "getMaster", "actors", "combatant", "familiar", "slaves", "encounter", "slave", "eventType", "slaveUpdates", "rule", "effect", "options", "scene", "token", "activeConditions", "condition", "removeSlave", "changed", "isCharacter", "data", "update", "slaveUUID", "slaveUUIDs", "slaveIndex", "armor", "bracers", "bracerBonus", "bonuses", "selector", "armorBonus", "construct", "label", "slug", "modifier", "masterHp", "Statistic", "shortForm", "longForm", "masterSkill", "attribute", "statistic", "withConfig", "isValidSlave", "id", "DEGREE_OF_SUCCESS_STRINGS", "DEGREE_ADJUSTMENT_AMOUNTS", "DegreeOfSuccess", "_DegreeOfSuccess", "__name", "roll", "dc", "dosAdjustments", "t", "d", "#calculateDegreeOfSuccess", "#getDegreeAdjustment", "#adjustDegreeOfSuccess", "degree", "adjustments", "outcome", "label", "amount", "degreeOfSuccess", "#adjustDegreeByDieValue", "DAMAGE_MULTIPLIER", "SAVES", "REROLL", "debouncedRefreshMessages", "config", "settings", "hooks", "wrappers", "localize", "socket", "render", "getFlag", "setFlag", "updateSourceFlag", "setFlagProperty", "deleteInMemory", "getInMemory", "setInMemory", "waitDialog", "createTool", "value", "onDragStart", "onPreCreateChatMessage", "onGetChatLogEntryContext", "CHATMESSAGE_GET_HTML", "chatMessageGetHTML", "TEXTEDITOR_ENRICH_HTML", "textEditorEnrichHTML", "onSocket", "isGM", "packet", "senderId", "roll3dDice", "message", "__name", "INLINE_CHECK_REGEX", "enriched", "isPersistentDamageMessage", "HEALINGS_REGEX", "isRegenMessage", "healings", "isDamageMessage", "isDamageSpell", "spell", "getMessageTargets", "getCurrentTargets", "R", "target", "$html", "data", "getMessageData", "html", "messageId", "canRollSave", "save", "getSaveFlag", "promisedTargets", "uuid", "targets", "rollSaves", "isDamage", "item", "isSpell", "token", "actor", "updates", "splashRollIndex", "roll", "regularRollIndex", "modifier", "dc", "damageChatMessageGetHTML", "spellChatMessageGetHTML", "msgContent", "damageRows", "diceTotalElement", "onChatMessageDrop", "wrapper", "setTargetsBtn", "createSetTargetsBtn", "toggleTemplate", "toggleBtn", "event", "damageRow", "smallButtons", "clonedDamageRows", "el", "clone", "actionElements", "actionElement", "action", "rowsWrapper", "template", "isOwner", "applied", "hr", "row", "isBasic", "isBasicSave", "i", "addHeaderListeners", "btn", "onTargetButton", "BASIC_SAVE_REGEX", "dataTransfer", "dataset", "label", "saves", "x", "joined", "type", "basic", "options", "statistic", "traits", "rollIndex", "targetUuid", "onDamageApplied", "tokens", "tokenId", "splashIndex", "regularIndex", "targetsFlag", "targetId", "cardBtns", "saveBtn", "onSetTargets", "targetElements", "targetElement", "rerollSave", "user", "rollOptions", "skipDefault", "skipDialog", "resolve", "success", "msg", "context", "modifiers", "userId", "flag", "content", "icon", "reroll", "isHeroReroll", "keep", "max", "oldRoll", "unevaluatedNewRoll", "newRoll", "keptRoll", "DegreeOfSuccess", "domains", "outcome", "DEGREE_OF_SUCCESS_STRINGS", "notes", "n", "note", "self", "synchronize", "author", "showDC", "showBreakdowns", "showResults", "saveLabel", "saveDC", "canApplyDamage", "allTargets", "tokenUUID", "targetActor", "isHidden", "hasPlayerOwner", "isFriendly", "hasSave", "saveFlag", "targetSave", "rerolled", "canReroll", "offset", "adjustment", "isPrivate", "canSeeResult", "notesList", "result", "templateSave", "anonymous", "canSeeName", "name", "a", "b", "config", "settings", "hook", "localize", "getFlag", "render", "setFlagProperty", "createTool", "value", "onRenderChatMessage", "message", "$html", "actor", "isDamageRoll", "html", "merged", "template", "buttons", "targets", "getTargets", "event", "otherMessage", "otherTargets", "mergeDamages", "sources", "data", "__name", "groups", "getMessageData", "damageLabel", "name", "notes", "tags", "modifiers", "outcome", "exists", "result", "DEGREE_OF_SUCCESS_STRINGS", "groupedInstances", "messageRoll", "otherRoll", "roll", "instances", "instance", "x", "material", "group", "DamageRoll", "index", "prev", "curr", "createTermGroup", "showBreakdown", "ignoredResistances", "formula", "R", "total", "term", "type", "materials", "rolls", "msg", "messageData", "options", "terms", "flag", "source", "sourceFlag", "flavor", "option", "getMessageTargets", "target", "config", "settings", "wrapper", "createTool", "CHATMESSAGE_GET_HTML", "chatMessageGetHTML", "html", "actor", "isGM", "diceTotalElement", "totalElement", "instancesElement", "__name", "config", "settings", "localize", "wrappers", "getFlag", "setFlag", "unsetFlag", "render", "createTool", "value", "CHARACTER_SHEET_RENDER_INNER", "characterSheetPF2eRenderInner", "CHARACTER_SHEET_ACTIVATE_LISTENERS", "characterSheetPF2eActivateListeners", "actionSheetPF2eRenderInner", "actionSheetPF2eActivateListeners", "actionSheetPF2eOnDrop", "html", "actor", "useButton", "withMessage", "actionElements", "actionElement", "itemId", "item", "getActionMacro", "btn", "createActionUseButton", "__name", "event", "getItemFromActionButton", "uuid", "wrapped", "data", "$html", "label", "group", "labelEl", "hintEl", "dropZone", "macro", "nameEl", "doc", "dataString", "dropData", "debouncedSetupWrappers", "setupWrappers", "config", "settings", "hook", "wrappers", "createTool", "value", "onCreateChatMessage", "CHARACTER_SHEET_RENDER_INNER", "characterSheetPF2eRenderInner", "CHARACTER_SHEET_ACTIVATE_LISTENERS", "characterSheetPF2eActivateListeners", "__name", "html", "actor", "consumableElements", "consumableElement", "itemId", "item", "type", "tooltip", "template", "btn", "actionElements", "actionElement", "getActionMacro", "createActionUseButton", "useLabel", "actionIcon", "getItemFromActionButton", "event", "message", "hookId", "msg", "$html", "INFINITE", "PULL_LIMIT", "RATIO", "config", "settings", "wrappers", "localize", "socket", "getFlag", "setFlag", "setFlagProperty", "render", "getInMemory", "getInMemoryAndSetIfNot", "setInMemory", "deleteInMemory", "templatePath", "createTool", "actorTransferItemToActor", "lootSheetPF2eRenderInner", "lootSheetPF2eActivateListeners", "lootActorTransferItemToActor", "browserRenderInner", "browserEquipmentTabRenderResults", "browserActivateListeners", "browserClose", "itemPrepareDerivedData", "testItem", "compareItemWithFilter", "buyItem", "isGM", "wrapped", "args", "buyer", "item", "quantity", "hasPlayerOwner", "realQuantity", "itemFilter", "__name", "options", "senderId", "seller", "filters", "getFilters", "filter", "x", "newItem", "updates", "defaultFilter", "price", "goldValue", "filterIndex", "content", "targetActor", "thisSuper", "itemValue", "actor", "infinite", "type", "itemFilters", "enabled", "ratio", "purse", "useDefault", "goldPrice", "itemName", "wordSegmenter", "term", "t", "segment", "checkboxes", "multiselects", "ranges", "sliders", "itemLevel", "priceInCopper", "itemTypes", "itemCategory", "itemGroup", "armorTypes", "weaponTypes", "traits", "itemSource", "sources", "rarities", "sheetData", "$html", "data", "html", "listButtons", "button", "template", "oweditems", "R", "typeLabel", "label", "fillSelection", "tab", "selection", "owned", "uuid", "start", "browser", "itemElements", "itemElement", "a", "updateBrowser", "isAtLimit", "isOwned", "entryUuid", "checked", "checkbox", "index", "skipAll", "browserTab", "selected", "total", "reachedLimit", "numbers", "disabled", "tabEl", "message", "items", "event", "el", "checkAll", "filterData", "defaultData", "extractedData", "search", "category", "path", "defaultType", "defaultCategory", "setFilters", "id", "infiniteAll", "sidebarEl", "itemId", "filterId", "priceElement", "quantityElement", "bulkElement", "wealthElement", "betterMenu", "openEquipmentTab", "FiltersMenu", "value", "force", "translate", "buyFilters", "sellFilters", "templateFilter", "limit", "even", "getItemData", "key", "direction", "newIndex", "newFilters", "range", "slider", "withDefault", "clampPriceRatio", "defaultIndex", "TOOLS", "config", "isGM", "registerToolsSettings", "module", "init", "api", "name", "ready", "onRenderSettingsConfig"]
}
